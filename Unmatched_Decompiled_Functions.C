void ___14tFEApplication(tFEApplication *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___31tDialogMessageStringWithTimeout(tDialogMessageStringWithTimeout *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___16tListIteratorCar(tListIteratorCar *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___21tListIteratorCarColor(tListIteratorCarColor *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tDialogYesNoTri(tDialogYesNoTri *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tDialogYesNoMem(tDialogYesNoMem *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___12tDialogYesNo(tDialogYesNo *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tDialogInteractive(tDialogInteractive *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___21tDialogNoInputMessage(tDialogNoInputMessage *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___17tDialogBackUpOnly(tDialogBackUpOnly *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___20tDialogMessageString(tDialogMessageString *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___11tDialogHelp(tDialogHelp *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___11tDialogBase(tDialogBase *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___27tMenuItemGoToMenuNFS4Button(tMenuItemGoToMenuNFS4Button *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___28tMenuItemNFS4LeftRightChoice(tMenuItemNFS4LeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___9tMenuNFS4(tMenuNFS4 *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tMenuNFS4TwoPlayer(tMenuNFS4TwoPlayer *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tMenuNFS4Bottom(tMenuNFS4Bottom *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___10tMenuBlank(tMenuBlank *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___12tMenuOptions(tMenuOptions *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___29tMenuItemOptionsTwoItemChoice(tMenuItemOptionsTwoItemChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___31tMenuItemOptionsLeftRightChoice(tMenuItemOptionsLeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___12tOptionsMenu(tOptionsMenu *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___14tInsideBoxMenu(tInsideBoxMenu *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___20tMenuItemSlidingMenu(tMenuItemSlidingMenu *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___29tMenuItemLeftRightAudioSlider(tMenuItemLeftRightAudioSlider *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tInsideBoxSongMenu(tInsideBoxSongMenu *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tInsideBoxLeftRightSlider(tInsideBoxLeftRightSlider *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___22tInsideBoxTwoWaySlider(tInsideBoxTwoWaySlider *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___35tInsideBoxControllerLeftRightSlider( (tInsideBoxControllerLeftRightSlider *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___19tMemoryCardMenuItem(tMemoryCardMenuItem *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___27tMenuItemGoToMenuButtonFade(tMenuItemGoToMenuButtonFade *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___17tUserNameMenuItem(tUserNameMenuItem *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___34tMenuItemControllerLeftRightChoice(tMenuItemControllerLeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___29tMenuItemOnOffLeftRightChoice(tMenuItemOnOffLeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___31tMenuItemDisplayLeftRightChoice(tMenuItemDisplayLeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tMenuItemSlidingActivated(tMenuItemSlidingActivated *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___22tMenuItemLeftRightFade(tMenuItemLeftRightFade *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tListIteratorTrack(tListIteratorTrack *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___13tListIterator(tListIterator *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___20tListIteratorIndexed(tListIteratorIndexed *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___26tListIteratorDoubleIndexed(tListIteratorDoubleIndexed *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___24tListIteratorMultiPlayer(tListIteratorMultiPlayer *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tListIteratorRange(tListIteratorRange *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tListIteratorRangeIndexed(tListIteratorRangeIndexed *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___9tMenuItem(tMenuItem *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___20tMenuItemInteractive(tMenuItemInteractive *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___24tMenuItemLeftRightChoice(tMenuItemLeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___24tMenuItemLeftRightSlider(tMenuItemLeftRightSlider *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tMenuItemGoToMenuButton(tMenuItemGoToMenuButton *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___5tMenu(tMenu *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___7tScreen(tScreen *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___11tAllScreens(tAllScreens *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tGlobalMenuDefs(tGlobalMenuDefs *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___32tBlankMenuItemGoToMenuNFS4Button(tBlankMenuItemGoToMenuNFS4Button *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___33tBlankMenuItemNFS4LeftRightChoice(tBlankMenuItemNFS4LeftRightChoice *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tListIteratorTournament(tListIteratorTournament *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___11tScreenMain(tScreenMain *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___16tScreenPinkSlips(tScreenPinkSlips *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___24tScreenPinkSlipStandings(tScreenPinkSlipStandings *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___31tScreenTournamentStandings3item(tScreenTournamentStandings3item *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___26tScreenTournamentStandings(tScreenTournamentStandings *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___16tScreenCarSelect(tScreenCarSelect *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tScreenPinkSlipsCarSelect(tScreenPinkSlipsCarSelect *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tScreenCarSelectTwoPlayer(tScreenCarSelectTwoPlayer *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___20tScreenCarSelectDuel(tScreenCarSelectDuel *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tScreenTournSelect(tScreenTournSelect *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___17tScreenTrophyRoom(tScreenTrophyRoom *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___17tScreenTrophyInfo(tScreenTrophyInfo *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___18tScreenTrackSelect(tScreenTrackSelect *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___16tScreenTrackInfo(tScreenTrackInfo *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___19tScreenTrackRecords(tScreenTrackRecords *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tScreenControllerConfig(tScreenControllerConfig *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___14tScreenDisplay(tScreenDisplay *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___12tScreenAudio(tScreenAudio *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___14tScreenMemcard(tScreenMemcard *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___25tScreenTournamentCongrats(tScreenTournamentCongrats *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tScreenBeTheCopCongrats(tScreenBeTheCopCongrats *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tScreenPinkSlipCongrats(tScreenPinkSlipCongrats *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___23tScreenTournamentTrophy(tScreenTournamentTrophy *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tScreenCongrats(tScreenCongrats *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___15tScreenUserName(tScreenUserName *this,int __in_chrg)
{
  undefined4 in_v1;
  undefined4 in_t5;
  
  special2(in_v1,in_t5,5,0x13);
                    
  halt_baddata();


}

void ___11AIHigh_Base(AIHigh_Base *this,int __in_chrg)
{
  AIState_Base *pAVar1;
  
  pAVar1 = this->state_;
  this->_vf[0] = (__vtbl_ptr_type *)&table;
  if (pAVar1 != (AIState_Base *)0x0) {
    (**(code **)(pAVar1->_vf[0] + 0x14))
              ((int)&pAVar1->carObj_ + (int)*(short *)(pAVar1->_vf[0] + 0x10),3);
    this->state_ = (AIState_Base *)0x0;
  }
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___15AIHigh_BTC_Perp(AIHigh_BTC_Perp *this,int __in_chrg)
{
  (this->AIHigh_BasicPerp).AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___11AIHigh_None(AIHigh_None *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___12AIState_None(AIState_None *this,int __in_chrg)
{
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80054e3c;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___12AIState_Base(AIState_Base *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&DAT_80054e3c;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___16AIHigh_BasicPerp(AIHigh_BasicPerp *this,int __in_chrg)
{
  (this->AIHigh_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___15AIHigh_BasicCop(AIHigh_BasicCop *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___18AIHigh_BTC_Wingman(AIHigh_BTC_Wingman *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___19AIHigh_BTC_HumanCop(AIHigh_BTC_HumanCop *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___14AIHigh_BTC_Cop(AIHigh_BTC_Cop *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___17AIState_NonActive(AIState_NonActive *this,int __in_chrg)
{
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80054f24;
  (((this->AIState_Base).carObj_)->N).active = '\x01';
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80054f44;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___12AIState_Base(AIState_Base *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&DAT_80054f44;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___17AIHigh_BTC_AIPerp(AIHigh_BTC_AIPerp *this,int __in_chrg)
{
  int iVar1;
  Car_tObj *pCVar2;
  
  pCVar2 = (this->AIHigh_BTC_Perp).AIHigh_BasicPerp.AIHigh_Base.carObj_;
  iVar1 = this->timeUntilContact_;
  (this->AIHigh_BTC_Perp).AIHigh_BasicPerp.AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  (pCVar2->N).mass = iVar1;
  (((this->AIHigh_BTC_Perp).AIHigh_BasicPerp.AIHigh_Base.carObj_)->N).massInv =
       this->escapeDuration_;
  (this->AIHigh_BTC_Perp).AIHigh_BasicPerp.AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___20AIHigh_BTC_HumanPerp(AIHigh_BTC_HumanPerp *this,int __in_chrg)
{
  (this->AIHigh_BTC_Perp).AIHigh_BasicPerp.AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___15AIHigh_BTC_Perp(AIHigh_BTC_Perp *this,int __in_chrg)
{
  (this->AIHigh_BasicPerp).AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___17AIState_NonActive(AIState_NonActive *this,int __in_chrg)
{
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055000;
  (((this->AIState_Base).carObj_)->N).active = '\x01';
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055020;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___12AIState_Base(AIState_Base *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&DAT_80055020;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___13AIHigh_Player(AIHigh_Player *this,int __in_chrg)
{
  (this->AIHigh_BasicPerp).AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___12AIHigh_Human(AIHigh_Human *this,int __in_chrg)
{
  (this->AIHigh_Player).AIHigh_BasicPerp.AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___15AIHigh_Opponent(AIHigh_Opponent *this,int __in_chrg)
{
  (this->AIHigh_Player).AIHigh_BasicPerp.AIHigh_Base._vf[0] = (__vtbl_ptr_type *)&table;
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___10AIHigh_Cop(AIHigh_Cop *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___14AIHigh_Traffic(AIHigh_Traffic *this,int __in_chrg)
{
  ___11AIHigh_Base((AIHigh_Base *)this,__in_chrg);
  return;


}

void ___14AIDataRecord_t(AIDataRecord_t *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&table;
  SaveAndPurge__14AIDataRecord_t(this);
  RemoveRecordFromCollection__14AIDataRecord_t(this);
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___26AIDataRecord_CarTracking_t(AIDataRecord_CarTracking_t *this,int __in_chrg)
{
  ___14AIDataRecord_t((AIDataRecord_t *)this,__in_chrg);
  return;


}

void ___30AIDataRecord_CurveSpeedTable_t(AIDataRecord_CurveSpeedTable_t *this,int __in_chrg)
{
  ___14AIDataRecord_t((AIDataRecord_t *)this,__in_chrg);
  return;


}

void ___25AIDataRecord_TrackCurve_t(AIDataRecord_TrackCurve_t *this,int __in_chrg)
{
  ___14AIDataRecord_t((AIDataRecord_t *)this,__in_chrg);
  return;


}

void ___23AIDataRecord_BestLine_t(AIDataRecord_BestLine_t *this,int __in_chrg)
{
  ___14AIDataRecord_t((AIDataRecord_t *)this,__in_chrg);
  return;


}

void ___23AIDataRecord_AccTable_t(AIDataRecord_AccTable_t *this,int __in_chrg)
{
  ___14AIDataRecord_t((AIDataRecord_t *)this,__in_chrg);
  return;


}

void ___13AIState_Chase(AIState_Chase *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  
  pCVar1 = (this->AIState_Base).carObj_;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->aCar = 0;
  pCVar1->driveDirectionTimer = 0;
  pCVar1->driveDirection = 0;
  ((this->AIState_Base).carObj_)->aDesired = 0;
  ((this->AIState_Base).carObj_)->lateralVelocity = 0;
  (((this->AIState_Base).carObj_)->targetPos).x = 0;
  ((this->AIState_Base).carObj_)->timeOffRoad = 0x10000;
  ((this->AIState_Base).carObj_)->max_clacc = 0x10000;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___15AIState_Offroad(AIState_Offroad *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  
  pCVar1 = (this->AIState_Base).carObj_;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->aCar = 0;
  pCVar1->driveDirectionTimer = 0;
  pCVar1->driveDirection = 0;
  ((this->AIState_Base).carObj_)->aDesired = 0;
  pCVar1 = (this->AIState_Base).carObj_;
  pCVar1->carFlags = pCVar1->carFlags & 0xfffff7ff;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___17AIState_Purgatory(AIState_Purgatory *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  
  pCVar1 = (this->AIState_NonActive).AIState_Base.carObj_;
  (this->AIState_NonActive).AIState_Base._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->caravanTimer = 0;
  (((this->AIState_NonActive).AIState_Base.carObj_)->N).collision.disableCollisionTimer = 0;
  pCVar1 = (this->AIState_NonActive).AIState_Base.carObj_;
  pCVar1->desiredLatPos = pCVar1->desiredLatPos & 0xfffffffb;
  if ((((this->AIState_NonActive).AIState_Base.carObj_)->carFlags & 0x10U) != 0) {
    iGp00001830 = iGp00001830 + -1;
  }
  iVar3 = Cars_gNumCars + -1;
  piVar4 = &_Cars_gSortedList + iVar3;
  pCVar1 = (this->AIState_NonActive).AIState_Base.carObj_;
  (pCVar1->speechInfo).speechSource = SPEECH_SOURCE_SUPER_COP;
  (pCVar1->speechInfo).speechIntensity = SPEECH_INTENSITY_MED;
  do {
    if (iVar3 < 0) {
LAB_80071718:
      pCVar1 = (this->AIState_NonActive).AIState_Base.carObj_;
      (this->AIState_NonActive).AIState_Base._vf[0] = (__vtbl_ptr_type *)&DAT_800555a0;
      (pCVar1->N).active = '\x01';
      (this->AIState_NonActive).AIState_Base._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
      if ((__in_chrg & 1U) != 0) {
        __builtin_delete(this);
      }
      return;
    }
    iVar2 = *piVar4;
    piVar4 = piVar4 + -1;
    if ((*(uint *)(iVar2 + 0x260) & 0x100) != 0) {
      ((this->AIState_NonActive).AIState_Base.carObj_)->originalDesiredSpeed = iVar2;
      goto LAB_80071718;
    }
    iVar3 = iVar3 + -1;
  } while( true );


}

void ___14AIState_Donuts(AIState_Donuts *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  
  pCVar1 = (this->AIState_Base).carObj_;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->aCar = 0;
  pCVar1->driveDirectionTimer = 0;
  pCVar1->driveDirection = 0;
  ((this->AIState_Base).carObj_)->aDesired = 0;
  ((this->AIState_Base).carObj_)->slackProb = 0;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___14AIState_Cruise(AIState_Cruise *this,int __in_chrg)
{
  (this->AIState_Normal).AIState_Base._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___17AIState_GotoSlice(AIState_GotoSlice *this,int __in_chrg)
{
  (this->AIState_Normal).AIState_Base._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___21AIState_RovingTraffic(AIState_RovingTraffic *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  
  pCVar1 = (this->AIState_Base).carObj_;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->aCar = 0;
  pCVar1->driveDirectionTimer = 0;
  pCVar1->driveDirection = 0;
  ((this->AIState_Base).carObj_)->aDesired = 0;
  pCVar1 = (this->AIState_Base).carObj_;
  pCVar1->carFlags = pCVar1->carFlags & 0xfffff7ff;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___17AIState_NonActive(AIState_NonActive *this,int __in_chrg)
{
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_800555a0;
  (((this->AIState_Base).carObj_)->N).active = '\x01';
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___12AIState_Idle(AIState_Idle *this,int __in_chrg)
{
  Car_tObj *pCVar1;
  
  pCVar1 = (this->AIState_Base).carObj_;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&table;
  pCVar1->carFlags = pCVar1->carFlags & 0xfffffbff;
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___14AIState_Normal(AIState_Normal *this,int __in_chrg)
{
  (this->AIState_Base)._vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___12AIState_Base(AIState_Base *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&DAT_80055640;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___6Speech(Speech *this,int __in_chrg)
{
  MobileSpeaker **ppMVar1;
  Speech *pSVar2;
  int iVar3;
  
  if (this->fBankOffset != (long *)0x0) {
    SPCH_Deinit();
    purgememadr(this->fBankOffset);
  }
  if (this->fFileOpen != 0) {
    FILE_closesync(this->fFileHandle,100);
  }
  iVar3 = 0;
  __builtin_delete(this->fDispatch);
  pSVar2 = this;
  do {
    ppMVar1 = pSVar2->fMobile;
    pSVar2 = (Speech *)&(pSVar2->fCarBank).Mobile[0].fMake;
    iVar3 = iVar3 + 1;
    __builtin_delete(*ppMVar1);
  } while (iVar3 < 4);
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___14tPauseMenuDefs(tPauseMenuDefs *this,int __in_chrg)
{
  ___6tPMenu((tPMenu *)
             ((this->itemAudioSettingsSpeechVolume).tPMenuItemInteractive.tPMenuItem._vf + 1),2);
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)&(this->itemAudioSettingsFXVolume).fMaxVal,2);
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)
             ((this->itemAudioSettingsFXVolume).tPMenuItemInteractive.tPMenuItem._vf + 4),2);
  ___28tPMenuItemNonInteractiveText
            ((tPMenuItemNonInteractiveText *)
             ((this->itemAudioSettingsFXVolume).tPMenuItemInteractive.tPMenuItem._vf + 1),2);
  ___28tPMenuItemNonInteractiveText
            ((tPMenuItemNonInteractiveText *)&this->itemAudioSettingsFXVolume,2);
  ___6tPMenu((tPMenu *)&this->itemAudioSettingsAudioMode,2);
  ___32tPMenuItemLeftRightSliderIndexed
            ((tPMenuItemLeftRightSliderIndexed *)(this->iteratorAudioMode)._vf,2);
  ___32tPMenuItemLeftRightSliderIndexed
            ((tPMenuItemLeftRightSliderIndexed *)((this->itemAudioSettingsTitle).tPMenuItem._vf + 3)
             ,2);
  ___25tPMenuItemLeftRightChoice
            ((tPMenuItemLeftRightChoice *)
             &(this->itemAudioSettingsTitle).tPMenuItem.fTextDescription,2);
  ___28tPMenuItemNonInteractiveText((tPMenuItemNonInteractiveText *)((this->menuOptions)._vf + 3),2)
  ;
  ___21tPListIteratorIndexed((tPListIteratorIndexed *)&(this->menuOptions).fNumItems,2);
  ___6tPMenu((tPMenu *)&(this->itemControllerSettings).fNewMenu,2);
  ___25tPMenuItemLeftRightSlider
            ((tPMenuItemLeftRightSlider *)
             ((this->itemControllerSettings).tPMenuItemInteractive.tPMenuItem._vf + 2),2);
  ___25tPMenuItemLeftRightSlider
            ((tPMenuItemLeftRightSlider *)&(this->itemAudioSettings).fOnButtonPress,2);
  ___25tPMenuItemLeftRightSlider
            ((tPMenuItemLeftRightSlider *)
             ((this->itemAudioSettings).tPMenuItemInteractive.tPMenuItem._vf + 3),2);
  ___25tPMenuItemLeftRightSlider((tPMenuItemLeftRightSlider *)&this->itemAudioSettings,2);
  ___25tPMenuItemLeftRightSlider
            ((tPMenuItemLeftRightSlider *)((this->itemOptionsTitle).tPMenuItem._vf + 2),2);
  ___25tPMenuItemLeftRightChoice((tPMenuItemLeftRightChoice *)&this->itemOptionsTitle,2);
  ___14tPListIterator((tPListIterator *)((this->menuPause)._vf + 2),2);
  ___28tPMenuItemNonInteractiveText((tPMenuItemNonInteractiveText *)&(this->menuPause).fNumItems,2);
  ___6tPMenu((tPMenu *)((this->itemForfeitRace).tPMenuItemInteractive.tPMenuItem._vf + 6),2);
  ___24tPMenuItemGoToMenuButton
            ((tPMenuItemGoToMenuButton *)
             ((this->itemForfeitRace).tPMenuItemInteractive.tPMenuItem._vf + 1),2);
  ___24tPMenuItemGoToMenuButton
            ((tPMenuItemGoToMenuButton *)
             ((this->itemQuitRace).tPMenuItemInteractive.tPMenuItem._vf + 6),2);
  ___28tPMenuItemNonInteractiveText
            ((tPMenuItemNonInteractiveText *)
             ((this->itemQuitRace).tPMenuItemInteractive.tPMenuItem._vf + 3),2);
  ___6tPMenu((tPMenu *)((this->itemRestart).tPMenuItemInteractive.tPMenuItem._vf + 3),2);
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)
             &(this->itemRestart).tPMenuItemInteractive.tPMenuItem.fTextDescription,2);
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)
             ((this->itemContinue).tPMenuItemInteractive.tPMenuItem._vf + 5),2);
  ___24tPMenuItemGoToMenuButton
            ((tPMenuItemGoToMenuButton *)(this->itemContinue).tPMenuItemInteractive.tPMenuItem._vf,2
            );
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)((this->itemGamePaused).tPMenuItem._vf + 5),2);
  ___23tPMenuItemCommandButton
            ((tPMenuItemCommandButton *)((this->itemGamePaused).tPMenuItem._vf + 1),2);
  ___28tPMenuItemNonInteractiveText((tPMenuItemNonInteractiveText *)this,2);
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___14ObjectSignAnim(ObjectSignAnim *this,int __in_chrg)
{
  int *piVar1;
  void *deleteMe;
  
  deleteMe = (void *)this->objectAngle;
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x80056088;
  if (deleteMe != (void *)0x0) {
    if (*(void **)((int)deleteMe + 0x10) != (void *)0x0) {
      __builtin_vec_delete(*(void **)((int)deleteMe + 0x10));
    }
    __builtin_delete(deleteMe);
  }
  piVar1 = (int *)this->impactAngle;
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0xc))((int)piVar1 + (int)*(short *)(*piVar1 + 8),3);
  }
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x800560e8;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___22ObjectFinishedSignAnim(ObjectFinishedSignAnim *this,int __in_chrg)
{
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x800560e8;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___15ObjectMultiAnim(ObjectMultiAnim *this,int __in_chrg)
{
  int *piVar1;
  void *deleteMe;
  
  deleteMe = (void *)this->objectAngle;
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x800560b8;
  if (deleteMe != (void *)0x0) {
    if (*(void **)((int)deleteMe + 0x10) != (void *)0x0) {
      __builtin_vec_delete(*(void **)((int)deleteMe + 0x10));
    }
    __builtin_delete(deleteMe);
  }
  piVar1 = (int *)this->impactAngle;
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0xc))((int)piVar1 + (int)*(short *)(*piVar1 + 8),3);
  }
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x800560e8;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___23ObjectFinishedMultiAnim(ObjectFinishedMultiAnim *this,int __in_chrg)
{
  (this->ObjectAnim)._vf[0] = (__vtbl_ptr_type *)0x800560e8;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___10ObjectAnim(ObjectAnim *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)0x800560e8;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___14tPListIterator(tPListIterator *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&table;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___21tPListIteratorIndexed(tPListIteratorIndexed *this,int __in_chrg)
{
  (this->tPListIterator)._vf[0] = (__vtbl_ptr_type *)&table;
  ___14tPListIterator((tPListIterator *)this,__in_chrg);
  return;


}

void ___10tPMenuItem(tPMenuItem *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&table;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___28tPMenuItemNonInteractiveText(tPMenuItemNonInteractiveText *this,int __in_chrg)
{
  (this->tPMenuItem)._vf[0] = (__vtbl_ptr_type *)&table;
  ___10tPMenuItem((tPMenuItem *)this,__in_chrg);
  return;


}

void ___21tPMenuItemInteractive(tPMenuItemInteractive *this,int __in_chrg)
{
  (this->tPMenuItem)._vf[0] = (__vtbl_ptr_type *)&table;
  ___10tPMenuItem((tPMenuItem *)this,__in_chrg);
  return;


}

void ___25tPMenuItemLeftRightChoice(tPMenuItemLeftRightChoice *this,int __in_chrg)
{
  (this->tPMenuItemInteractive).tPMenuItem._vf[0] = (__vtbl_ptr_type *)&table;
  ___21tPMenuItemInteractive((tPMenuItemInteractive *)this,__in_chrg);
  return;


}

void ___25tPMenuItemLeftRightSlider(tPMenuItemLeftRightSlider *this,int __in_chrg)
{
  (this->tPMenuItemInteractive).tPMenuItem._vf[0] = (__vtbl_ptr_type *)&table;
  ___21tPMenuItemInteractive((tPMenuItemInteractive *)this,__in_chrg);
  return;


}

void ___32tPMenuItemLeftRightSliderIndexed(tPMenuItemLeftRightSliderIndexed *this,int __in_chrg)
{
  (this->tPMenuItemLeftRightSlider).tPMenuItemInteractive.tPMenuItem._vf[0] =
       (__vtbl_ptr_type *)&table;
  ___25tPMenuItemLeftRightSlider((tPMenuItemLeftRightSlider *)this,__in_chrg);
  return;


}

void ___24tPMenuItemGoToMenuButton(tPMenuItemGoToMenuButton *this,int __in_chrg)
{
  (this->tPMenuItemInteractive).tPMenuItem._vf[0] = (__vtbl_ptr_type *)&table;
  ___21tPMenuItemInteractive((tPMenuItemInteractive *)this,__in_chrg);
  return;


}

void ___23tPMenuItemCommandButton(tPMenuItemCommandButton *this,int __in_chrg)
{
  (this->tPMenuItemInteractive).tPMenuItem._vf[0] = (__vtbl_ptr_type *)&table;
  ___21tPMenuItemInteractive((tPMenuItemInteractive *)this,__in_chrg);
  return;


}

void ___6tPMenu(tPMenu *this,int __in_chrg)
{
  this->_vf[0] = (__vtbl_ptr_type *)&table;
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void ___11SaveSurface(SaveSurface *this,int __in_chrg)
{
  purgememadr(this->fStack);
  if ((__in_chrg & 1U) != 0) {
    __builtin_delete(this);
  }
  return;


}

void __main(void)
{
  return;


}

void entry(void)
{
  undefined4 *puVar1;
  undefined4 unaff_retaddr;
  
  puVar1 = &AIState_Purgatory_numTrafficCarsInPurgatory;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  } while (puVar1 < &endofcode);
  DAT_8013de5c = unaff_retaddr;
  InitHeap(0x80148b08,0xaf4fc);
  main();
  trap(1);
                    
  halt_baddata();


}

void * memset(void *__s,int __c,size_t __n)
{
  void *pvVar1;
  
                    
  pvVar1 = (void *)(*(code *)&LAB_000000a0)();
  return pvVar1;


}

uint fixedmult(int iParm1,int iParm2)
{
  uint uVar1;
  
  uVar1 = (int)((longlong)iParm1 * (longlong)iParm2) + 0x8000;
  return uVar1 >> 0x10 |
         ((int)((ulonglong)((longlong)iParm1 * (longlong)iParm2) >> 0x20) + (uint)(uVar1 < 0x8000))
         * 0x10000;


}

void transpose(undefined4 *puParm1,undefined4 *puParm2)
{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  if (puParm1 == puParm2) {
    uVar2 = puParm2[1];
    uVar1 = puParm2[2];
    puParm2[1] = puParm2[3];
    puParm2[2] = puParm2[6];
    uVar3 = puParm2[7];
    puParm2[3] = uVar2;
    puParm2[6] = uVar1;
    puParm2[7] = puParm2[5];
    puParm2[5] = uVar3;
    return;
  }
  *puParm2 = *puParm1;
  puParm2[1] = puParm1[3];
  puParm2[2] = puParm1[6];
  puParm2[3] = puParm1[1];
  puParm2[4] = puParm1[4];
  puParm2[5] = puParm1[7];
  puParm2[6] = puParm1[2];
  puParm2[7] = puParm1[5];
  puParm2[8] = puParm1[8];
  return;


}

int fixeddiv(uint uParm1,uint uParm2)
{
  bool bVar1;
  bool bVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  bVar1 = (int)uParm1 < 0;
  if ((int)uParm1 < 0) {
    uParm1 = -uParm1;
  }
  bVar2 = (int)uParm2 < 0;
  if ((int)uParm2 < 0) {
    uParm2 = -uParm2;
  }
  uVar6 = uParm1 % uParm2;
  uVar4 = (uint)(bVar1 != bVar2);
  uVar5 = 0x10000;
  if (uParm2 == 0) {
    return 0;
  }
  uVar3 = uParm1 / uParm2 << 0x10;
  if ((int)uVar6 < 0) {
    uParm2 = uParm2 >> 1;
    goto LAB_800e4478;
  }
  uVar6 = uVar6 << 1;
  do {
    bVar1 = uVar6 < uParm2;
    while (-1 < (int)uVar6) {
      uVar5 = uVar5 >> 1;
      if (!bVar1) {
        uVar3 = uVar3 | uVar5;
        uVar6 = uVar6 - uParm2;
      }
      uVar6 = uVar6 << 1;
      if (uVar5 == 1) {
        return (uVar3 ^ -uVar4) + uVar4;
      }
LAB_800e4478:
      bVar1 = uVar6 < uParm2;
    }
    uVar5 = uVar5 >> 1;
    if (!bVar1) {
      uVar3 = uVar3 | uVar5;
      uVar6 = uVar6 - uParm2;
    }
    uParm2 = uParm2 >> 1;
    if (uVar5 == 1) {
      return (uVar3 ^ -uVar4) + uVar4;
    }
  } while( true );


}

void SetSp(void)
{
  return;


}

int sprintf(char *__s,char *__format,...)
{
  char *__dest;
  uint uVar1;
  void *pvVar2;
  int *piVar3;
  char cVar4;
  int iVar5;
  int *in_a2;
  undefined4 in_a3;
  int *__n;
  int *__s_00;
  int iVar6;
  char *local_res4;
  int *local_res8;
  undefined4 local_resc;
  undefined local_41;
  undefined4 local_40;
  int *local_3c;
  int *local_38;
  int **local_30;
  
  local_30 = &local_res8;
  cVar4 = *__format;
  iVar6 = 0;
  local_res4 = __format;
  local_res8 = in_a2;
  local_resc = in_a3;
  while (cVar4 != '\0') {
    if (cVar4 == '%') {
      local_40 = 0;
      local_3c = (int *)0x0;
      local_38 = (int *)0x0;
      while( true ) {
        while( true ) {
          while( true ) {
            while( true ) {
              while( true ) {
                __dest = local_res4 + 1;
                iVar5 = (int)local_res4[1];
                if (iVar5 != 0x2d) break;
                local_40 = local_40 | 1;
                local_res4 = __dest;
              }
              if (iVar5 != 0x2b) break;
              local_40 = local_40 | 2;
              local_res4 = __dest;
            }
            if (iVar5 != 0x20) break;
            local_40._0_2_ = CONCAT11(local_res4[1],(undefined)local_40);
            local_40 = (uint)(ushort)local_40;
            local_res4 = __dest;
          }
          if (iVar5 != 0x23) break;
          local_40 = local_40 | 4;
          local_res4 = __dest;
        }
        if (iVar5 != 0x30) break;
        local_40 = local_40 | 8;
        local_res4 = __dest;
      }
      if (iVar5 == 0x2a) {
        local_3c = *local_30;
        local_30 = local_30 + 1;
        if ((int)local_3c < 0) {
          local_3c = (int *)-(int)local_3c;
          local_40 = local_40 | 1;
        }
        iVar5 = (int)local_res4[2];
        local_res4 = local_res4 + 2;
      }
      else {
        while (local_res4 = __dest, iVar5 - 0x30U < 10) {
          local_3c = (int *)((int)local_3c * 10 + -0x30 + iVar5);
          iVar5 = (int)local_res4[1];
          __dest = local_res4 + 1;
        }
      }
      if (iVar5 == 0x2e) {
        iVar5 = (int)local_res4[1];
        __dest = local_res4;
        if (iVar5 == 0x2a) {
          local_38 = *local_30;
          local_30 = local_30 + 1;
          iVar5 = (int)local_res4[2];
          local_res4 = local_res4 + 2;
        }
        else {
          while (local_res4 = __dest + 1, iVar5 - 0x30U < 10) {
            local_38 = (int *)((int)local_38 * 10 + -0x30 + iVar5);
            iVar5 = (int)__dest[2];
            __dest = local_res4;
          }
        }
        if (-1 < (int)local_38) {
          local_40 = local_40 | 0x10;
        }
      }
      __s_00 = &local_40;
      if ((local_40 & 1) != 0) {
        local_40 = local_40 & 0xfffffff7;
      }
      while (cVar4 = (char)iVar5, true) {
        switch(iVar5) {
        case 0x4c:
          local_40 = local_40 | 0x80;
          break;
        default:
          goto switchD_800e4778_caseD_4d;
        case 99:
          __s_00 = (int *)&local_41;
          __n = (int *)0x1;
          local_41 = *(undefined *)local_30;
          local_30 = local_30 + 1;
          goto LAB_800e4c5c;
        case 100:
        case 0x69:
          piVar3 = *local_30;
          if ((local_40 >> 5 & 1) != 0) {
            piVar3 = (int *)(int)(short)piVar3;
          }
          if ((int)piVar3 < 0) {
            piVar3 = (int *)-(int)piVar3;
            local_40._0_2_ = CONCAT11(0x2d,(undefined)local_40);
            local_40 = (uint)(ushort)local_40;
          }
          else {
            if ((local_40 >> 1 & 1) != 0) {
              local_40._0_2_ = CONCAT11(0x2b,(undefined)local_40);
              local_40 = (uint)(ushort)local_40;
            }
          }
          goto LAB_800e4850;
        case 0x68:
          local_40 = local_40 | 0x20;
          break;
        case 0x6c:
          local_40 = local_40 | 0x40;
          break;
        case 0x6e:
          __s_00 = *local_30;
          local_30 = local_30 + 1;
          if ((local_40 >> 5 & 1) == 0) {
            *__s_00 = iVar6;
          }
          else {
            *(short *)__s_00 = (short)iVar6;
          }
          goto LAB_800e4ce8;
        case 0x6f:
          piVar3 = *local_30;
          local_30 = local_30 + 1;
          if ((local_40 >> 5 & 1) != 0) {
            piVar3 = (int *)((uint)piVar3 & 0xffff);
          }
          if ((local_40 >> 4 & 1) == 0) {
            if ((local_40 >> 3 & 1) != 0) {
              local_38 = local_3c;
            }
            if ((int)local_38 < 1) {
              local_38 = (int *)0x1;
            }
          }
          __n = (int *)0x0;
          while (piVar3 != (int *)0x0) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = ((byte)piVar3 & 7) + 0x30;
            piVar3 = (int *)((uint)piVar3 >> 3);
            __n = (int *)((int)__n + 1);
          }
          if ((((local_40 >> 2 & 1) != 0) && (__n != (int *)0x0)) && (*(byte *)__s_00 != 0x30)) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = 0x30;
            __n = (int *)((int)__n + 1);
          }
          while ((int)__n < (int)local_38) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = 0x30;
            __n = (int *)((int)__n + 1);
          }
          goto LAB_800e4c5c;
        case 0x70:
          local_38 = (int *)0x8;
          local_40 = local_40 | 0x50;
        case 0x58:
          __dest = "0123456789ABCDEF";
          goto LAB_800e4a64;
        case 0x73:
          __s_00 = *local_30;
          local_30 = local_30 + 1;
          if ((local_40 >> 2 & 1) == 0) {
            if ((local_40 >> 4 & 1) == 0) {
              __n = (int *)strlen((char *)__s_00);
            }
            else {
              pvVar2 = memchr(__s_00,0,(size_t)local_38);
              __n = (int *)((int)pvVar2 - (int)__s_00);
              if (pvVar2 == (void *)0x0) {
                __n = local_38;
              }
            }
          }
          else {
            __n = (int *)(uint)*(byte *)__s_00;
            __s_00 = (int *)((int)__s_00 + 1);
            if (((local_40 >> 4 & 1) != 0) && ((int)local_38 < (int)__n)) {
              __n = local_38;
            }
          }
          goto LAB_800e4c5c;
        case 0x75:
          piVar3 = *local_30;
          if ((local_40 >> 5 & 1) != 0) {
            piVar3 = (int *)((uint)piVar3 & 0xffff);
          }
          local_40 = local_40 & 0xff;
LAB_800e4850:
          local_30 = local_30 + 1;
          if ((local_40 >> 4 & 1) == 0) {
            if (((local_40 >> 3 & 1) != 0) && (local_38 = local_3c, local_40._1_1_ != 0)) {
              local_38 = (int *)((int)local_3c + -1);
            }
            if ((int)local_38 < 1) {
              local_38 = (int *)0x1;
            }
          }
          __n = (int *)0x0;
          while (piVar3 != (int *)0x0) {
            __s_00 = (int *)((int)__s_00 + -1);
            __n = (int *)((int)__n + 1);
            *(byte *)__s_00 = (char)piVar3 + (char)(int *)((uint)piVar3 / 10) * -10 + 0x30;
            piVar3 = (int *)((uint)piVar3 / 10);
          }
          while ((int)__n < (int)local_38) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = 0x30;
            __n = (int *)((int)__n + 1);
          }
          if (local_40._1_1_ != 0) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = local_40._1_1_;
            __n = (int *)((int)__n + 1);
          }
          goto LAB_800e4c5c;
        case 0x78:
          __dest = "0123456789abcdef";
LAB_800e4a64:
          piVar3 = *local_30;
          local_30 = local_30 + 1;
          if ((local_40 >> 5 & 1) != 0) {
            piVar3 = (int *)((uint)piVar3 & 0xffff);
          }
          if ((local_40 >> 4 & 1) == 0) {
            if (((local_40 >> 3 & 1) != 0) && (local_38 = local_3c, (local_40 >> 2 & 1) != 0)) {
              local_38 = (int *)((int)local_3c + -2);
            }
            if ((int)local_38 < 1) {
              local_38 = (int *)0x1;
            }
          }
          __n = (int *)0x0;
          while (piVar3 != (int *)0x0) {
            __s_00 = (int *)((int)__s_00 + -1);
            uVar1 = (uint)piVar3 & 0xf;
            piVar3 = (int *)((uint)piVar3 >> 4);
            __n = (int *)((int)__n + 1);
            *(char *)__s_00 = __dest[uVar1];
          }
          while ((int)__n < (int)local_38) {
            __s_00 = (int *)((int)__s_00 + -1);
            *(byte *)__s_00 = 0x30;
            __n = (int *)((int)__n + 1);
          }
          if ((local_40 >> 2 & 1) != 0) {
            *(char *)((int)__s_00 + -1) = cVar4;
            __s_00 = (int *)((int)__s_00 + -2);
            *(byte *)__s_00 = 0x30;
            __n = (int *)((int)__n + 2);
          }
LAB_800e4c5c:
          __dest = __s + iVar6;
          if (((int)__n < (int)local_3c) && ((local_40 & 1) == 0)) {
            do {
              __s[iVar6] = ' ';
              local_3c = (int *)((int)local_3c + -1);
              iVar6 = iVar6 + 1;
            } while ((int)__n < (int)local_3c);
            __dest = __s + iVar6;
          }
          memmove(__dest,__s_00,(size_t)__n);
          iVar6 = iVar6 + (int)__n;
          while ((int)__n < (int)local_3c) {
            __s[iVar6] = ' ';
            __n = (int *)((int)__n + 1);
            iVar6 = iVar6 + 1;
          }
          goto LAB_800e4ce8;
        }
        iVar5 = (int)local_res4[1];
        local_res4 = local_res4 + 1;
      }
switchD_800e4778_caseD_4d:
      if (iVar5 != 0x25) break;
    }
    __s[iVar6] = cVar4;
    iVar6 = iVar6 + 1;
LAB_800e4ce8:
    cVar4 = local_res4[1];
    local_res4 = local_res4 + 1;
  }
  __s[iVar6] = '\0';
  return iVar6;


}

short * FREE_find(int iParm1,int iParm2,int iParm3)
{
  short *psVar1;
  
  psVar1 = (short *)(iParm1 + 0x10);
  if (iParm3 == 0) {
    do {
      psVar1 = *(short **)(psVar1 + 8);
    } while (*(int *)(psVar1 + 2) < iParm2);
  }
  else {
    do {
      psVar1 = *(short **)(psVar1 + 10);
    } while (*(int *)(psVar1 + 2) < iParm2);
  }
  if (*psVar1 == 0x4253) {
    psVar1 = (short *)0x0;
  }
  return psVar1;


}

short * FREE_findlargest(int iParm1,int iParm2,int iParm3)
{
  short sVar1;
  short *psVar2;
  short *psVar3;
  
  iParm2 = iParm2 + -1;
  psVar3 = (short *)(iParm1 + 0x10);
  if (iParm2 < 0) {
    iParm2 = 0;
  }
  psVar2 = (short *)0x0;
  if (iParm3 == 0) {
    psVar3 = *(short **)(iParm1 + 0x20);
    psVar2 = (short *)0x0;
    if (*(int *)(psVar3 + 2) <= iParm2) goto LAB_800e4e00;
    sVar1 = *psVar3;
    psVar2 = (short *)0x0;
    while (sVar1 != 0x4253) {
      iParm2 = *(int *)(psVar3 + 2);
      psVar2 = psVar3;
LAB_800e4e00:
      do {
        psVar3 = *(short **)(psVar3 + 8);
      } while (*(int *)(psVar3 + 2) <= iParm2);
      sVar1 = *psVar3;
    }
  }
  else {
    while( true ) {
      do {
        psVar3 = *(short **)(psVar3 + 10);
      } while (*(int *)(psVar3 + 2) <= iParm2);
      if (*psVar3 == 0x4253) break;
      iParm2 = *(int *)(psVar3 + 2);
      psVar2 = psVar3;
    }
  }
  return psVar2;


}

void FREE_add(int iParm1,undefined2 *puParm2)
{
  undefined2 *puVar1;
  undefined2 *puVar2;
  
  puVar1 = (undefined2 *)(iParm1 + 0x10);
  puVar2 = puVar1;
  if ((undefined2 *)
      (*(int *)(iParm1 + 0x20) + ((uint)(*(int *)(iParm1 + 0x24) - *(int *)(iParm1 + 0x20)) >> 1)) <
      puParm2) {
    do {
      puVar2 = *(undefined2 **)(puVar2 + 10);
    } while (puParm2 < puVar2);
    puVar1 = *(undefined2 **)(puVar2 + 8);
    *(undefined2 **)(puParm2 + 8) = puVar1;
  }
  else {
    do {
      puVar1 = *(undefined2 **)(puVar1 + 8);
    } while (puVar1 < puParm2);
    puVar2 = *(undefined2 **)(puVar1 + 10);
    *(undefined2 **)(puParm2 + 8) = puVar1;
  }
  *(undefined2 **)(puParm2 + 10) = puVar2;
  *(int *)(puParm2 + 2) = (*(int *)(puParm2 + 4) - (int)puParm2) + -0x10;
  *(undefined2 **)(puVar2 + 8) = puParm2;
  *(undefined2 **)(puVar1 + 10) = puParm2;
  *puParm2 = 0x4246;
  puParm2[1] = puParm2[1] | 0x4000;
  return;


}

void FREE_remove(undefined4 uParm1,undefined2 *puParm2)
{
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)(puParm2 + 10);
  iVar1 = *(int *)(puParm2 + 8);
  *(int *)(iVar2 + 0x10) = iVar1;
  *(int *)(iVar1 + 0x14) = iVar2;
  *puParm2 = 0;
  puParm2[1] = puParm2[1] & 0xbfff;
  return;


}

char * initmemblock(undefined2 *param_1,char *param_2,int param_3,int param_4,ushort param_5, undefined4 param_6,undefined4 param_7)
{
  size_t sVar1;
  int iVar2;
  char *__dest;
  
  iVar2 = (int)param_1 + param_3 + 0x10;
  *param_1 = 0x424d;
  *(int *)(param_1 + 2) = param_3;
  param_1[1] = param_5;
  *(undefined4 *)(param_1 + 4) = param_7;
  *(undefined4 *)(param_1 + 6) = param_6;
  if ((param_5 & 0x200) != 0) {
    putm(iVar2,0x42454e44,4);
  }
  if ((param_5 & 0x800) != 0) {
    puti(iVar2 + 0xc,0,4);
  }
  __dest = (char *)(iVar2 + param_4);
  if (param_2 != (char *)0x0) {
    if ((param_5 & 0x100) == 0) {
      return __dest + -(int)param_1;
    }
    strcpy(__dest,param_2);
    sVar1 = strlen(__dest);
    __dest = __dest + sVar1 + 1;
  }
  return __dest + -(int)param_1;


}

undefined4 MEM_infosize(uint uParm1)
{
  return *(undefined4 *)(*(int *)(&memclass + (uParm1 & 0xf) * 4) + 0x30);


}

int MEM_tailsize(char *pcParm1,uint uParm2)
{
  size_t sVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(&memclass + (uParm2 & 0xf) * 4);
  iVar2 = 0;
  if ((pcParm1 != (char *)0x0) && ((*(uint *)(iVar3 + 0x34) & 0x100) != 0)) {
    sVar1 = strlen(pcParm1);
    iVar2 = sVar1 + 1;
  }
  return *(int *)(iVar3 + 0x30) + iVar2;


}

undefined4 creatememclass(uint param_1,char *param_2,int param_3,int param_4,undefined4 param_5,int param_6, int param_7,int param_8,undefined4 param_9,int param_10,int param_11, undefined4 param_12)
{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  char *__dest;
  uint uVar4;
  int iVar5;
  char acStack296 [256];
  
  uVar4 = param_1;
  if (param_8 != 0) {
    uVar4 = param_1 | 0x200;
  }
  if (param_10 != 0) {
    uVar4 = uVar4 | 0x100;
  }
  uVar1 = param_3 + param_7 + param_6 + 0x6f & -param_6;
  iVar5 = uVar1 - 0x10;
  iVar3 = (param_3 + param_4) - (param_7 + 0x20);
  __dest = (char *)(param_3 + 0x10);
  sprintf(acStack296,"%s LOW",param_2);
  initmemblock(param_3,acStack296,0x40,param_7,uVar4 | 0x8000,0,iVar5);
  initmemblock(iVar5,0,(iVar3 - iVar5) + -0x10,param_7,uVar4,param_3,iVar3);
  sprintf(acStack296,"%s HIGH",param_2);
  initmemblock(iVar3,acStack296,0,param_7,uVar4 | 0x8010,iVar5,0);
  *(char **)(&memclass + (param_1 & 0xf) * 4) = __dest;
  blockclear(__dest,0x40);
  strcpy(__dest,param_2);
  *(undefined2 *)(param_3 + 0x20) = 0x4253;
  *(int *)(param_3 + 0x18) = param_3;
  *(int *)(param_3 + 0x1c) = iVar3;
  *(int *)(param_3 + 0x30) = param_3 + 0x20;
  *(int *)(param_3 + 0x34) = param_3 + 0x20;
  *(undefined4 *)(param_3 + 0x24) = 0x7fffffff;
  *(int *)(param_3 + 0x3c) = param_6;
  *(int *)(param_3 + 0x40) = param_7;
  *(uint *)(param_3 + 0x44) = uVar4;
  *(undefined4 *)(param_3 + 0x48) = 0;
  *(undefined4 *)(param_3 + 0x38) = param_5;
  *(undefined4 *)(param_3 + 0x4c) = param_12;
  FREE_add(__dest,iVar5);
  if (param_11 != 0) {
    uVar2 = allocmutex();
    *(undefined4 *)(param_3 + 0x48) = uVar2;
  }
  return *(undefined4 *)(uVar1 - 0xc);


}

undefined4 largestunused(void)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FREE_findlargest(_memclass,0,0);
  uVar2 = 0;
  if (iVar1 != 0) {
    uVar2 = *(undefined4 *)(iVar1 + 4);
  }
  return uVar2;


}

undefined4 getblocksize(int iParm1)
{
  return *(undefined4 *)(iParm1 + -0xc);


}

int getblockname(int iParm1)
{
  int iVar1;
  
  iVar1 = 0;
  if ((*(ushort *)(iParm1 + -0xe) & 0x100) != 0) {
    iVar1 = MEM_infosize();
    iVar1 = iParm1 + *(int *)(iParm1 + -0xc) + iVar1;
  }
  return iVar1;


}

int reservememadr(int iParm1,int iParm2,uint uParm3)
{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  iVar8 = 0;
  iVar6 = *(int *)(&memclass + (uParm3 & 0xf) * 4);
  iVar5 = iParm2;
  if ((7 < iParm2) || (iVar5 = 8, -1 < iParm2)) {
    iVar1 = MEM_tailsize(iParm1,uParm3);
    uVar7 = *(int *)(iVar6 + 0x28) - 1;
    uVar2 = iVar5 + iVar1 + *(int *)(iVar6 + 0x28) + 0xf & ~uVar7;
    iVar5 = uVar2 - 0x10;
    if ((uParm3 & 0x20) == 0) {
      iVar1 = FREE_find(iVar6,iVar5,uParm3 & 0x10);
    }
    else {
      iVar1 = FREE_findlargest(iVar6,iVar5,uParm3 & 0x10);
    }
    if (iVar1 != 0) {
      FREE_remove(iVar6,iVar1);
      uVar4 = *(int *)(iVar1 + 4) - iVar5;
      if (0x40 < (int)uVar4) {
        if ((uParm3 & 0x10) == 0) {
          iVar5 = iVar1 + uVar2;
          *(int *)(*(int *)(iVar1 + 8) + 0xc) = iVar5;
          initmemblock(iVar5,0,0,0,0,iVar1,*(undefined4 *)(iVar1 + 8));
          FREE_add(iVar6,iVar5);
          *(int *)(iVar1 + 8) = iVar5;
        }
        else {
          iVar5 = iVar1 + (uVar4 & ~uVar7);
          *(int *)(*(int *)(iVar1 + 8) + 0xc) = iVar5;
          uVar3 = *(undefined4 *)(iVar1 + 8);
          *(int *)(iVar5 + 0xc) = iVar1;
          *(undefined4 *)(iVar5 + 8) = uVar3;
          initmemblock(iVar1,0,0,0,0,*(undefined4 *)(iVar1 + 0xc),iVar5);
          FREE_add(iVar6,iVar1);
          iVar1 = iVar5;
        }
      }
      uParm3 = uParm3 | *(uint *)(iVar6 + 0x34) & 0x700;
      if (iParm1 == 0) {
        uParm3 = uParm3 & 0xfffffeff;
      }
      iVar8 = iVar1 + 0x10;
      initmemblock(iVar1,iParm1,iParm2,*(undefined4 *)(iVar6 + 0x30),uParm3,
                   *(undefined4 *)(iVar1 + 0xc),*(undefined4 *)(iVar1 + 8));
    }
  }
  return iVar8;


}

undefined4 purgememadr(int iParm1)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  
  if (iParm1 != 0) {
    iVar2 = *(int *)(iParm1 + -8);
    iVar3 = *(int *)(iParm1 + -4);
    uVar5 = *(undefined4 *)(&memclass + ((uint)*(ushort *)(iParm1 + -0xe) & 0xf) * 4);
    iVar1 = iParm1 + -0x10;
    iVar4 = iVar3;
    if ((*(ushort *)(iVar3 + 2) & 0x4000) != 0) {
      FREE_remove(uVar5,iVar3);
      iVar4 = *(int *)(iVar3 + 0xc);
      *(int *)(iVar3 + 8) = iVar2;
      *(int *)(iVar4 + 8) = iVar3;
      *(int *)(iVar2 + 0xc) = iVar3;
      iVar1 = iVar3;
    }
    if ((*(ushort *)(iVar2 + 2) & 0x4000) != 0) {
      FREE_remove(uVar5,iVar2);
      iVar2 = *(int *)(iVar2 + 8);
      *(int *)(iVar1 + 0xc) = iVar4;
      *(int *)(iVar1 + 8) = iVar2;
      *(int *)(iVar2 + 0xc) = iVar1;
    }
    FREE_add(uVar5,iVar1);
  }
  return 1;


}

undefined4 filesizeatomic(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_10 [2];
  
  iVar1 = FILE_opensync(*puParm2,1,iParm1,local_10);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FILE_sizesync(local_10[0],iParm1 + -1);
    FILE_closesync(local_10[0],iParm1 + -1);
  }
  return uVar2;


}

void filesize(undefined4 uParm1)
{
  undefined4 uVar1;
  undefined4 local_18 [3];
  undefined4 local_c;
  
  local_c = 0;
  local_18[0] = uParm1;
  uVar1 = asyncidle();
  FILE_atomic(filesizeatomic,uVar1,100,local_18);
  return;


}

int loadfileadratomic(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 local_20 [2];
  
  iVar1 = FILE_opensync(*puParm2,1,iParm1,local_20);
  iParm1 = iParm1 + -1;
  if (iVar1 != 0) {
    uVar2 = FILE_sizesync(local_20[0],iParm1);
    iVar1 = reservememadr(*puParm2,uVar2,puParm2[2]);
    if (iVar1 != 0) {
      FILE_readsync(local_20[0],0,iVar1,uVar2,iParm1);
      FILE_closesync(local_20[0],iParm1);
      if (true) {
        return iVar1;
      }
      iVar3 = (*(code *)0x0)(iVar1,*puParm2,puParm2[2]);
      if (iVar3 != 0) {
        return iVar3;
      }
      purgememadr(iVar1);
      return 0;
    }
    FILE_closesync(local_20[0],iParm1);
  }
  return 0;


}

void loadfileadrz(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  undefined4 local_18 [2];
  undefined4 local_10;
  undefined4 local_c;
  
  local_c = 0;
  local_18[0] = uParm1;
  local_10 = uParm2;
  uVar1 = asyncidle();
  FILE_atomic(loadfileadratomic,uVar1,100,local_18);
  return;


}

void loadfileadr(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  undefined4 local_18 [2];
  undefined4 local_10;
  undefined4 local_c;
  
  local_c = 0;
  local_18[0] = uParm1;
  local_10 = uParm2;
  uVar1 = asyncidle();
  FILE_atomic(loadfileadratomic,uVar1,100,local_18);
  return;


}

undefined4 loadfileatadratomic(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_18 [2];
  
  iVar1 = FILE_opensync(*puParm2,1,iParm1,local_18);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    FILE_readsync(local_18[0],0,puParm2[1],0x7fffffff,iParm1 + -1);
    FILE_closesync(local_18[0],iParm1 + -1);
    uVar2 = puParm2[1];
  }
  return uVar2;


}

void loadfileatadrz(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_c;
  
  local_c = 0;
  local_18 = uParm1;
  local_14 = uParm2;
  uVar1 = asyncidle();
  FILE_atomic(loadfileatadratomic,uVar1,100,&local_18);
  return;


}

void loadfileatadr(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_c;
  
  local_c = 0;
  local_18 = uParm1;
  local_14 = uParm2;
  uVar1 = asyncidle();
  FILE_atomic(loadfileatadratomic,uVar1,100,&local_18);
  return;


}

int loadbigfileheaderatomic(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  undefined4 local_20 [2];
  
  iVar1 = FILE_opensync(*puParm2,1,iParm1,local_20);
  if (iVar1 == 0) {
    return 0;
  }
  iVar1 = reservememadr(*puParm2,0xa90,puParm2[2]);
  if (iVar1 != 0) {
    FILE_readsync(local_20[0],0,iVar1,0xa90,iParm1 + -1);
    iVar2 = typeofbigfile(iVar1);
    if (iVar2 != 0) {
      uVar3 = sizeofbigfileheader(iVar1);
      iVar2 = iVar1;
      if (uVar3 < 0xa91) {
LAB_800e5a34:
        FILE_closesync(local_20[0],iParm1 + -1);
        return iVar2;
      }
      iVar2 = reservememadr(*puParm2,uVar3,puParm2[2]);
      if (iVar2 != 0) {
        blockmove(iVar1,iVar2,0xa90);
        purgememadr(iVar1);
        FILE_readsync(local_20[0],0xa90,iVar2 + 0xa90,uVar3 - 0xa90,iParm1 + -1);
        goto LAB_800e5a34;
      }
    }
    purgememadr(iVar1);
  }
  FILE_closesync(local_20[0],iParm1 + -1);
  return 0;


}

void loadbigfileheader(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  undefined4 local_18 [2];
  undefined4 local_10;
  undefined4 local_c;
  
  local_c = 0;
  local_18[0] = uParm1;
  local_10 = uParm2;
  uVar1 = asyncidle();
  FILE_atomic(loadbigfileheaderatomic,uVar1,100,local_18);
  return;


}

void xformy(undefined4 *puParm1,undefined4 uParm2)
{
  int local_10;
  undefined4 local_c;
  
  intsincos(uParm2,&local_10,&local_c);
  puParm1[1] = 0;
  puParm1[3] = 0;
  puParm1[4] = 0x10000;
  puParm1[5] = 0;
  puParm1[7] = 0;
  *puParm1 = local_c;
  puParm1[2] = -local_10;
  puParm1[6] = local_10;
  puParm1[8] = local_c;
  return;


}

char * strcpy(char *__dest,char *__src)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

int intatan(uint uParm1,uint uParm2)
{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  undefined4 local_18;
  undefined4 local_14;
  
  iVar4 = 0;
  bVar1 = (int)uParm2 < 0;
  if (bVar1) {
    uParm2 = -uParm2;
    iVar4 = 0x200;
  }
  uVar5 = (uint)bVar1;
  bVar1 = (int)uParm2 < (int)uParm1;
  if ((int)uParm1 < 0) {
    uParm1 = -uParm1;
    uVar5 = 1 - uVar5;
    iVar4 = -iVar4;
    bVar1 = (int)uParm2 < (int)uParm1;
  }
  uVar3 = uParm1;
  if (bVar1) {
    if (uVar5 == 0) {
      iVar4 = iVar4 + 0x100;
    }
    else {
      iVar4 = iVar4 + -0x100;
    }
    uVar5 = 1 - uVar5;
    uVar3 = uParm2;
    uParm2 = uParm1;
  }
  uVar2 = 0x80;
  if (uVar3 != uParm2) {
    if ((uVar3 & 0xff800000) == 0) {
      uVar3 = (uVar3 * 0x100 + ((int)uParm2 >> 1)) / uParm2;
      if (uParm2 == 0) {
        trap(0x1c00);
      }
    }
    else {
      make64(&local_18,uVar3,0x20);
      uVar3 = divu64(local_18,local_14,uParm2);
      if ((uVar3 & 0x800000) == 0) {
        uVar3 = uVar3 >> 0x18;
      }
      else {
        uVar3 = (uVar3 >> 0x18) + 1;
      }
    }
    uVar2 = (uint)(byte)(&atantbl)[uVar3];
  }
  if (uVar5 != 0) {
    uVar2 = -uVar2;
  }
  return iVar4 + uVar2;


}

void * loadpackadrz(undefined4 uParm1,uint uParm2)
{
  void *src;
  long lVar1;
  undefined4 uVar2;
  void *src_00;
  void *dst;
  
  src = (void *)loadfileadr();
  dst = (void *)0x0;
  if ((src != (void *)0x0) && (lVar1 = unpacksize(src), dst = src, lVar1 != 0)) {
    uVar2 = getblocksize(src);
    src_00 = (void *)reservememadr(uParm1,uVar2,uParm2 ^ 0x10);
    uVar2 = getblocksize(src);
    blockmove(src,src_00,uVar2);
    purgememadr(src);
    dst = (void *)reservememadr(uParm1,lVar1,uParm2);
    if ((dst != (void *)0x0) && (lVar1 = unpackz(src_00,dst), lVar1 == 0)) {
      purgememadr(dst);
      dst = (void *)0x0;
    }
    purgememadr(src_00);
  }
  return dst;


}

void loadpackadr(void)
{
  loadpackadrz();
  return;


}

int strcmp(char *__s1,char *__s2)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

void qsort(void *__base,size_t __nmemb,size_t __size,__compar_fn_t __compar)
{
  int iVar1;
  uint uVar2;
  void *pvVar3;
  void *pvVar4;
  size_t __nmemb_00;
  
  pvVar4 = (void *)((int)__base + __size);
  __nmemb_00 = 0;
  if (1 < __nmemb) {
    if (__nmemb == 2) {
      iVar1 = (*__compar)(__base,pvVar4);
      if (0 < iVar1) {
        FUN_800e5edc(__base,pvVar4,__size);
      }
    }
    else {
      uVar2 = 1;
      FUN_800e5edc(__base,(void *)((int)__base + (__nmemb >> 1) * __size),__size);
      pvVar3 = __base;
      if (1 < __nmemb) {
        do {
          iVar1 = (*__compar)(pvVar4,__base);
          if (iVar1 < 0) {
            pvVar3 = (void *)((int)pvVar3 + __size);
            __nmemb_00 = __nmemb_00 + 1;
            if (pvVar4 != pvVar3) {
              FUN_800e5edc(pvVar4,pvVar3,__size);
            }
          }
          uVar2 = uVar2 + 1;
          pvVar4 = (void *)((int)pvVar4 + __size);
        } while (uVar2 < __nmemb);
      }
      if (pvVar3 != __base) {
        FUN_800e5edc(__base,pvVar3,__size);
      }
      qsort(__base,__nmemb_00,__size,__compar);
      qsort((void *)((int)pvVar3 + __size),(__nmemb - __nmemb_00) - 1,__size,__compar);
    }
  }
  return;


}

void FUN_800e5edc(int iParm1,int iParm2,uint uParm3)
{
  undefined uVar1;
  undefined *puVar2;
  undefined *puVar3;
  uint uVar4;
  
  uVar4 = 0;
  if (uParm3 != 0) {
    do {
      puVar2 = (undefined *)(iParm1 + uVar4);
      puVar3 = (undefined *)(iParm2 + uVar4);
      uVar1 = *puVar2;
      uVar4 = uVar4 + 1;
      *puVar2 = *puVar3;
      *puVar3 = uVar1;
    } while (uVar4 < uParm3);
  }
  return;


}

undefined4 typeofbigfile(undefined4 uParm1)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = getm(uParm1,2);
  if (iVar1 == 0xc0fb) {
    uVar2 = 1;
  }
  else {
    iVar1 = getm(uParm1,4);
    uVar2 = 0;
    if (iVar1 == 0x42494746) {
      uVar2 = 2;
    }
  }
  return uVar2;


}

int sizeofbigfileheader(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar1 = typeofbigfile();
  if (iVar1 == 1) {
    iVar2 = getm(iParm1 + 2,2);
    iVar2 = iVar2 + 4;
  }
  else {
    iVar2 = 0;
    if (iVar1 == 2) {
      iVar2 = getm(iParm1 + 0xc,4);
    }
  }
  return iVar2;


}

int locatebigentryz(int param_1,int param_2,int param_3,undefined4 *param_4,undefined4 *param_5)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  size_t sVar4;
  uint uVar5;
  int iVar6;
  
  iVar6 = 0;
  iVar1 = sizeofbigfileheader();
  iVar2 = typeofbigfile(param_1);
  if (iVar2 == 1) {
    uVar5 = param_1 + 6;
    while (uVar5 < (uint)(param_1 + iVar1)) {
      if (param_2 == 0) {
        if (iVar6 == param_3) {
LAB_800e60a0:
          if (param_4 != (undefined4 *)0x0) {
            uVar3 = getm(uVar5,3);
            *param_4 = uVar3;
          }
          if (param_5 != (undefined4 *)0x0) {
            uVar3 = getm(uVar5 + 3,3);
            *param_5 = uVar3;
          }
          return uVar5 + 6;
        }
      }
      else {
        iVar2 = stricmp(uVar5 + 6,param_2);
        if (iVar2 == 0) goto LAB_800e60a0;
      }
      sVar4 = strlen((char *)(uVar5 + 6));
      uVar5 = uVar5 + sVar4 + 7;
      iVar6 = iVar6 + 1;
    }
  }
  else {
    if (iVar2 == 2) {
      uVar5 = param_1 + 0x10;
      while (uVar5 < (uint)(param_1 + iVar1)) {
        if (param_2 == 0) {
          if (iVar6 == param_3) {
LAB_800e612c:
            if (param_4 != (undefined4 *)0x0) {
              uVar3 = getm(uVar5,4);
              *param_4 = uVar3;
            }
            if (param_5 != (undefined4 *)0x0) {
              uVar3 = getm(uVar5 + 4,4);
              *param_5 = uVar3;
            }
            return uVar5 + 8;
          }
        }
        else {
          iVar2 = stricmp(uVar5 + 8,param_2);
          if (iVar2 == 0) goto LAB_800e612c;
        }
        sVar4 = strlen((char *)(uVar5 + 8));
        uVar5 = uVar5 + sVar4 + 9;
        iVar6 = iVar6 + 1;
      }
    }
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = 0;
  }
  if (param_5 != (undefined4 *)0x0) {
    *param_5 = 0;
  }
  return 0;


}

void locatebigentry(void)
{
  locatebigentryz();
  return;


}

undefined4 locatebigoffset(undefined4 uParm1,int iParm2)
{
  undefined4 local_10 [2];
  
  local_10[0] = 0;
  if (iParm2 != 0) {
    locatebigentry(uParm1,iParm2,0,local_10,&biglen);
  }
  return local_10[0];


}

int locatebig(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  iVar1 = locatebigoffset();
  if (iVar1 != 0) {
    iVar2 = iParm1 + iVar1;
  }
  return iVar2;


}

undefined4 bigcount(int iParm1)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = typeofbigfile();
  if (iVar1 == 1) {
    iParm1 = iParm1 + 4;
    uVar2 = 2;
  }
  else {
    if (iVar1 != 2) {
      return 0;
    }
    iParm1 = iParm1 + 8;
    uVar2 = 4;
  }
  uVar2 = getm(iParm1,uVar2);
  return uVar2;


}

char * strstr(char *__haystack,char *__needle)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

void blockmove(undefined4 *puParm1,undefined4 *puParm2,int iParm3)
{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  
  if (((int)puParm1 < (int)puParm2) && ((int)puParm2 < (int)puParm1 + iParm3)) {
    uVar2 = (int)puParm1 + iParm3;
    uVar3 = (int)puParm2 + iParm3;
    if (((uVar2 | uVar3) & 3) == 0) {
      iParm3 = iParm3 + -0x10;
      while (-1 < iParm3) {
        uVar5 = *(undefined4 *)(uVar2 - 0xc);
        uVar6 = *(undefined4 *)(uVar2 - 8);
        uVar7 = *(undefined4 *)(uVar2 - 4);
        *(undefined4 *)(uVar3 - 0x10) = *(undefined4 *)(uVar2 - 0x10);
        *(undefined4 *)(uVar3 - 0xc) = uVar5;
        *(undefined4 *)(uVar3 - 8) = uVar6;
        *(undefined4 *)(uVar3 - 4) = uVar7;
        uVar2 = uVar2 - 0x10;
        iParm3 = iParm3 + -0x10;
        uVar3 = uVar3 - 0x10;
      }
    }
    else {
      iParm3 = iParm3 + -0x10;
      while (-1 < iParm3) {
        uVar5 = *(undefined4 *)(uVar2 - 0xc);
        uVar6 = *(undefined4 *)(uVar2 - 8);
        uVar7 = *(undefined4 *)(uVar2 - 4);
        *(undefined4 *)(uVar3 - 0x10) = *(undefined4 *)(uVar2 - 0x10);
        *(undefined4 *)(uVar3 - 0xc) = uVar5;
        *(undefined4 *)(uVar3 - 8) = uVar6;
        *(undefined4 *)(uVar3 - 4) = uVar7;
        iParm3 = iParm3 + -0x10;
        uVar2 = uVar2 - 0x10;
        uVar3 = uVar3 - 0x10;
      }
    }
    iParm3 = iParm3 + 0xc;
    while (-1 < iParm3) {
      iParm3 = iParm3 + -4;
      *(undefined4 *)(uVar3 - 4) = *(undefined4 *)(uVar2 - 4);
      uVar2 = uVar2 - 4;
      uVar3 = uVar3 - 4;
    }
    iVar4 = iParm3 + 2;
    if (-1 < iParm3 + 3) {
      while( true ) {
        puVar1 = (undefined *)(uVar2 - 1);
        uVar2 = uVar2 - 1;
        *(undefined *)(uVar3 - 1) = *puVar1;
        uVar3 = uVar3 - 1;
        if (iVar4 < 0) break;
        iVar4 = iVar4 + -1;
      }
    }
    return;
  }
  if ((((uint)puParm1 | (uint)puParm2) & 3) != 0) {
    iParm3 = iParm3 + -0x10;
    while (-1 < iParm3) {
      uVar5 = puParm1[1];
      uVar6 = puParm1[2];
      uVar7 = puParm1[3];
      *puParm2 = *puParm1;
      puParm2[1] = uVar5;
      puParm2[2] = uVar6;
      puParm2[3] = uVar7;
      iParm3 = iParm3 + -0x10;
      puParm1 = puParm1 + 4;
      puParm2 = puParm2 + 4;
    }
    iParm3 = iParm3 + 0xc;
    while (-1 < iParm3) {
      iParm3 = iParm3 + -4;
      *puParm2 = *puParm1;
      puParm1 = puParm1 + 1;
      puParm2 = puParm2 + 1;
    }
    iParm3 = iParm3 + 3;
    while (-1 < iParm3) {
      iParm3 = iParm3 + -1;
      *(undefined *)puParm2 = *(undefined *)puParm1;
      puParm1 = (undefined4 *)((int)puParm1 + 1);
      puParm2 = (undefined4 *)((int)puParm2 + 1);
    }
    return;
  }
  iParm3 = iParm3 + -0x40;
  while (-1 < iParm3) {
    uVar5 = puParm1[1];
    uVar6 = puParm1[2];
    uVar7 = puParm1[3];
    uVar8 = puParm1[4];
    uVar9 = puParm1[5];
    uVar10 = puParm1[6];
    uVar11 = puParm1[7];
    *puParm2 = *puParm1;
    puParm2[1] = uVar5;
    puParm2[2] = uVar6;
    puParm2[3] = uVar7;
    puParm2[4] = uVar8;
    puParm2[5] = uVar9;
    puParm2[6] = uVar10;
    puParm2[7] = uVar11;
    uVar5 = puParm1[9];
    uVar6 = puParm1[10];
    uVar7 = puParm1[0xb];
    uVar8 = puParm1[0xc];
    uVar9 = puParm1[0xd];
    uVar10 = puParm1[0xe];
    uVar11 = puParm1[0xf];
    puParm2[8] = puParm1[8];
    puParm2[9] = uVar5;
    puParm2[10] = uVar6;
    puParm2[0xb] = uVar7;
    puParm2[0xc] = uVar8;
    puParm2[0xd] = uVar9;
    puParm2[0xe] = uVar10;
    puParm2[0xf] = uVar11;
    iParm3 = iParm3 + -0x40;
    puParm1 = puParm1 + 0x10;
    puParm2 = puParm2 + 0x10;
  }
  iParm3 = iParm3 + 0x30;
  while (-1 < iParm3) {
    uVar5 = puParm1[1];
    uVar6 = puParm1[2];
    uVar7 = puParm1[3];
    *puParm2 = *puParm1;
    puParm2[1] = uVar5;
    puParm2[2] = uVar6;
    puParm2[3] = uVar7;
    iParm3 = iParm3 + -0x10;
    puParm1 = puParm1 + 4;
    puParm2 = puParm2 + 4;
  }
  iParm3 = iParm3 + 0xc;
  while (-1 < iParm3) {
    iParm3 = iParm3 + -4;
    *puParm2 = *puParm1;
    puParm1 = puParm1 + 1;
    puParm2 = puParm2 + 1;
  }
  iParm3 = iParm3 + 3;
  while (-1 < iParm3) {
    iParm3 = iParm3 + -1;
    *(undefined *)puParm2 = *(undefined *)puParm1;
    puParm1 = (undefined4 *)((int)puParm1 + 1);
    puParm2 = (undefined4 *)((int)puParm2 + 1);
  }
  return;


}

undefined4 iSNDremovepatches(undefined4 uParm1,int iParm2)
{
  undefined4 *puVar1;
  int iVar2;
  undefined auStack2064 [2040];
  undefined4 local_18 [2];
  
  iVar2 = 0xff;
  puVar1 = local_18;
  do {
    *puVar1 = 0xffffffff;
    iVar2 = iVar2 + -1;
    puVar1 = puVar1 + -2;
  } while (-1 < iVar2);
  iVar2 = 0;
  if (0 < iParm2) {
    do {
      iSNDbankremovepat(uParm1,iVar2,auStack2064);
      iVar2 = iVar2 + 1;
    } while (iVar2 < iParm2);
  }
  return 0;


}

void SNDbankremove(undefined4 uParm1)
{
  cSNDbankremove(uParm1,0);
  return;


}

undefined4 cSNDbankremove(int iParm1)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    if (iParm1 == -1) {
      iVar2 = 0;
      if (_DAT_8014786c != 0) {
        do {
          cSNDbankremove(iVar2,0);
          iVar2 = iVar2 + 1;
        } while (iVar2 < (int)(uint)_DAT_8014786c);
      }
      uVar1 = 0;
    }
    else {
      iVar2 = iSNDvalidbank(iParm1);
      uVar1 = 0xfffffff8;
      if (iVar2 == 0) {
        iVar4 = *(int *)(iParm1 * 0xc + _DAT_801478f8);
        iVar2 = 0;
        if (DAT_80147871 != 0) {
          iVar3 = 0;
          do {
            if ((int)*(char *)((int)(undefined4 *)(_DAT_801478f4 + iVar3) + 10) == iParm1) {
              SNDstop(*(undefined4 *)(_DAT_801478f4 + iVar3));
            }
            iVar2 = iVar2 + 1;
            iVar3 = iVar3 + 100;
          } while (iVar2 < (int)(uint)DAT_80147871);
        }
        iVar2 = iParm1 * 0xc + _DAT_801478f8;
        if (*(char *)(iVar2 + 9) == '\0') {
          iSNDremovepatches(iParm1,(uint)*(ushort *)(iVar4 + 6));
        }
        else {
          iSNDplatformfree(*(undefined4 *)(iVar2 + 4));
          *(undefined *)(iParm1 * 0xc + _DAT_801478f8 + 9) = 0;
        }
        *(undefined4 *)(iParm1 * 0xc + _DAT_801478f8) = 0;
        uVar1 = 0;
        *(undefined *)(iParm1 * 0xc + _DAT_801478f8 + 8) = 0;
      }
    }
  }
  return uVar1;


}

undefined4 SNDplaysetdef(undefined4 *puParm1)
{
  *puParm1 = 0xffffffff;
  *(undefined *)(puParm1 + 1) = 0xff;
  *(undefined *)((int)puParm1 + 5) = 0x3c;
  *(undefined2 *)(puParm1 + 3) = 0x1000;
  *(undefined2 *)((int)puParm1 + 0xe) = 0x1000;
  *(undefined *)((int)puParm1 + 6) = 0x7f;
  *(undefined *)(puParm1 + 2) = 0x7f;
  *(undefined *)((int)puParm1 + 10) = 0x7f;
  *(undefined *)((int)puParm1 + 7) = 0x40;
  *(undefined *)((int)puParm1 + 9) = 0x40;
  *(undefined *)((int)puParm1 + 0xb) = 0;
  *(undefined2 *)(puParm1 + 4) = 0;
  *(undefined2 *)((int)puParm1 + 0x12) = 0;
  return 0;


}

int SNDpan(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int local_18 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      local_18[0] = -1;
      while ((iVar2 = iSNDpatchkey(iVar1,local_18), iVar2 != 0 &&
             (iVar2 = _DAT_801478f4 + local_18[0] * 100, (int)*(char *)(iVar2 + 0x3d) != iParm2))) {
        *(undefined *)(iVar2 + 0x3d) = (char)iParm2;
        iVar3 = iParm2;
        if ((int)*(char *)(iVar2 + 0x33) != 1) {
          iVar3 = (iParm2 + -0x40) * (int)*(char *)(iVar2 + 0x33) + 0x40;
        }
        iVar3 = (int)*(char *)(iVar2 + 0x2e) + iVar3 + -0x40;
        if (iVar3 < 0x80) {
          if (iVar3 < 0) {
            iVar3 = 0;
          }
        }
        else {
          iVar3 = 0x7f;
        }
        if (*(int *)(iVar2 + 0x48) != 0) {
          iVar3 = (int)*(char *)(*(int *)(iVar2 + 0x48) + iVar3);
        }
        iSNDplatform3dpos(local_18[0],(iVar3 + -0x40) * 0x100 & 0xff00,0);
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

int iSNDunsafevol(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  int local_20 [2];
  
  iVar1 = iSNDgetchan();
  if (-1 < iVar1) {
    local_20[0] = -1;
    while (iVar2 = iSNDpatchkey(iVar1,local_20), iVar2 != 0) {
      iVar2 = _DAT_801478f4 + local_20[0] * 100;
      if (*(int *)(iVar2 + 0x1c) == iParm2 << 0x10) {
        return 0;
      }
      *(int *)(iVar2 + 0x1c) = iParm2 << 0x10;
      *(undefined4 *)(iVar2 + 0x14) = 0;
      iSNDcalcvol();
      iSNDvol(local_20[0],(int)*(char *)(iVar2 + 0x2d));
    }
  }
  return iVar1;


}

undefined4 SNDvol(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iSNDenteraudio();
    uVar1 = iSNDunsafevol(uParm1,uParm2);
    iSNDleaveaudio();
  }
  return uVar1;


}

void addsystemtask(int iParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  
  iVar1 = libticks;
  iVar4 = 0;
  piVar6 = (int *)&systemtasksubs;
  iVar2 = -1;
  iVar5 = iGp000016ec;
  do {
    iVar3 = iVar4;
    if ((((*piVar6 != iParm1) && (iVar3 = iVar2, *piVar6 == 0)) && (iVar3 = iVar2, iVar2 == -1)) &&
       (iVar3 = iVar4, iVar5 != 0)) {
      iVar5 = iVar5 + -1;
      iVar3 = iVar2;
    }
    iVar4 = iVar4 + 1;
    piVar6 = piVar6 + 4;
    iVar2 = iVar3;
  } while (iVar4 < 0x10);
  if (iVar3 != -1) {
    iVar3 = iVar3 * 0x10;
    *(int *)(&systemtasksubs + iVar3) = iParm1;
    *(undefined4 *)(&DAT_8013e984 + iVar3) = uParm2;
    *(undefined4 *)(&DAT_8013e98c + iVar3) = 0;
    *(int *)(&DAT_8013e988 + iVar3) = iVar1 + iParm3;
  }
  return;


}

void delsystemtask(int iParm1)
{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = (int *)&systemtasksubs;
  do {
    if (*piVar2 == iParm1) break;
    iVar1 = iVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (iVar1 < 0x10);
  if ((iVar1 < 0x10) && (*(int *)(&systemtasksubs + iVar1 * 0x10) == iParm1)) {
    *(int *)(&systemtasksubs + iVar1 * 0x10) = 0;
  }
  return;


}

uint systemtask(undefined4 uParm1)
{
  int iVar1;
  uint uVar2;
  code **ppcVar3;
  int iVar4;
  uint uVar5;
  
  uVar5 = 0;
  if (iGp000016f0 != libticks) {
    iVar4 = 0;
    ppcVar3 = (code **)&systemtasksubs;
    iGp000016f0 = libticks;
    do {
      if (((*ppcVar3 != (code *)0x0) && ((int)ppcVar3[2] <= libticks)) &&
         (ppcVar3[3] == (code *)0x0)) {
        ppcVar3[3] = (code *)0x1;
        uVar2 = (**ppcVar3)(uParm1,libticks - (int)ppcVar3[2]);
        iVar1 = libticks;
        uVar5 = uVar5 | uVar2;
        ppcVar3[3] = (code *)0x0;
        ppcVar3[2] = ppcVar3[1] + iVar1;
      }
      iVar4 = iVar4 + 1;
      ppcVar3 = ppcVar3 + 4;
    } while (iVar4 < 0x10);
  }
  return uVar5;


}

undefined4 SNDSTRM_setpriority(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    if (iVar2 == 0) {
      uVar1 = 0xfffffff8;
    }
    else {
      STREAM_setpriority(*(undefined4 *)(iVar2 + 4),uParm2,uParm3);
      uVar1 = 0;
    }
  }
  return uVar1;


}

void SNDfxinitbus(int param_1,undefined4 param_2,int param_3,undefined4 param_4,undefined4 param_5)
{
  int iVar1;
  
  iVar1 = param_1 * 0x10;
  *(int *)(iVar1 + -0x7feb8704) = param_3;
  *(undefined4 *)(&DAT_80147904 + iVar1) = param_4;
  *(undefined4 *)(&DAT_80147908 + iVar1) = param_5;
  iSNDplatformfxinit(param_1,param_3);
  if (param_3 == 0) {
    param_2 = 0;
  }
  SNDfxmasterlevel(param_1,param_2);
  return;


}

int SNDfxmasterlevel(int iParm1,undefined4 uParm2)
{
  int iVar1;
  int iVar2;
  
  *(undefined4 *)(&DAT_80147900 + iParm1 * 0x10) = uParm2;
  iVar1 = iSNDplatformfxmasterlevel();
  if ((-1 < iVar1) && (iVar1 = 0, DAT_8014789c != '\0')) {
    iVar1 = 0;
    if (DAT_80147871 != 0) {
      iVar2 = 0;
      do {
        iVar1 = iVar1 + 1;
        SNDfxlevel(*(undefined4 *)(iVar2 + _DAT_801478f4),iParm1,
                   (int)*(char *)((int)(undefined4 *)(iVar2 + _DAT_801478f4) + iParm1 + 0x35));
        iVar2 = iVar2 + 100;
      } while (iVar1 < (int)(uint)DAT_80147871);
    }
    iVar1 = 0;
  }
  return iVar1;


}

uint VoxEvent_GetFilterLengthFlag(int iParm1)
{
  return (uint)*(byte *)(iParm1 + 10) & 1;


}

uint VoxEvent_GetKeepTillExpiresFlag(int iParm1)
{
  return (uint)(*(byte *)(iParm1 + 10) >> 2) & 1;


}

int iSPCH_GetOffset16(int iParm1,int iParm2,int iParm3)
{
  return iParm1 + (uint)*(ushort *)(iParm3 * 2 + iParm2) * 4;


}

ushort * iSPCH_SearchEventDat(int iParm1,uint uParm2)
{
  ushort uVar1;
  ushort *puVar2;
  int iVar3;
  
  uVar1 = *(ushort *)(iParm1 + 2);
  iVar3 = 0;
  if (uVar1 != 0) {
    do {
      puVar2 = (ushort *)iSPCH_GetOffset16(iParm1,iParm1 + 0xc,iVar3);
      iVar3 = iVar3 + 1;
      if ((uint)*puVar2 == uParm2) {
        return puVar2;
      }
    } while (iVar3 < (int)(uint)uVar1);
  }
  return (ushort *)0;


}

int iSPCH_FindEvent(undefined4 uParm1)
{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = 0;
  piVar2 = (int *)&gEventDats;
  while ((*piVar2 == 0 || (iVar1 = iSPCH_SearchEventDat(*piVar2,uParm1), iVar1 == 0))) {
    iVar3 = iVar3 + 1;
    piVar2 = piVar2 + 1;
    if (3 < iVar3) {
      return 0;
    }
  }
  return iVar1;


}

void iSPCH_InitEventDat(void)
{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 3;
  puVar1 = (undefined4 *)&DAT_80148054;
  do {
    *puVar1 = 0;
    iVar2 = iVar2 + -1;
    puVar1 = puVar1 + -1;
  } while (-1 < iVar2);
  return;


}

undefined4 GetFilterLength(void)
{
  return *(undefined4 *)(_gEventDats + 4);


}

undefined4 GetFilterPriority(void)
{
  return *(undefined4 *)(_gEventDats + 8);


}

void iSPCH_InitEventQueue(void)
{
  int iVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  puVar2 = &gVoxEvents;
  _gVoxEvents = 0;
  _DAT_80148064 = 0;
  do {
    iVar3 = 0;
    *(undefined2 *)(puVar2 + 8) = 0;
    *(undefined2 *)(puVar2 + 10) = 0;
    *(undefined4 *)(puVar2 + 0xc) = 0;
    *(undefined4 *)(puVar2 + 0x10) = 0;
    iVar1 = iVar4;
    do {
      *(undefined4 *)(&DAT_80148074 + iVar1) = 0;
      iVar3 = iVar3 + 1;
      iVar1 = iVar1 + 4;
    } while (iVar3 < 0xc);
    puVar2 = puVar2 + 0x3c;
    iVar4 = iVar4 + 0x3c;
  } while ((int)puVar2 < -0x7feb7be0);
  _gLastSubTick = 0;
  _gLastTick = 0;
  return;


}

int iSPCH_FindEventSlot(uint uParm1)
{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  
  if (_gVoxEvents < 0x10) {
    iVar1 = 0;
    puVar3 = &gVoxEvents;
    do {
      if (*(short *)(puVar3 + 8) == 0) {
        return iVar1;
      }
      iVar1 = iVar1 + 1;
      puVar3 = puVar3 + 0x3c;
    } while (iVar1 < 0x10);
  }
  iVar1 = gettick();
  iVar2 = 0;
  puVar3 = &gVoxEvents;
  while ((*(ushort *)(*(int *)(puVar3 + 0x10) + 2) == 0 ||
         ((uint)(iVar1 - *(int *)(puVar3 + 0xc)) <= (uint)*(ushort *)(*(int *)(puVar3 + 0x10) + 2)))
        ) {
    iVar2 = iVar2 + 1;
    puVar3 = puVar3 + 0x3c;
    if (0xf < iVar2) {
      iVar1 = 0;
      puVar3 = &gVoxEvents;
      do {
        if ((uint)*(ushort *)(*(int *)(puVar3 + 0x10) + 4) <= uParm1) {
          *(undefined2 *)(puVar3 + 8) = 0;
          _gVoxEvents = _gVoxEvents + -1;
          return iVar1;
        }
        iVar1 = iVar1 + 1;
        puVar3 = puVar3 + 0x3c;
      } while (iVar1 < 0x10);
      return 0xffffffff;
    }
  }
  *(undefined2 *)(puVar3 + 8) = 0;
  _gVoxEvents = _gVoxEvents + -1;
  return iVar2;


}

undefined4 SPCH_AddEvent(undefined4 *puParm1)
{
  char cVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  int iVar8;
  
  iVar3 = iSPCH_FindEvent(*puParm1);
  if (((iVar3 != 0) && (cVar1 = *(char *)(iVar3 + 9), iVar4 = iSPCH_Rand(100), iVar4 <= (int)cVar1))
     && (iVar4 = iSPCH_FindEventSlot((uint)*(ushort *)(iVar3 + 4)), -1 < iVar4)) {
    iVar5 = gettick();
    if (iVar5 == _gLastTick) {
      _gLastSubTick = _gLastSubTick + 1;
    }
    else {
      _gLastSubTick = 0;
    }
    sVar2 = _gLastSubTick;
    iVar8 = 0;
    iVar6 = iVar4 * 0x3c;
    _gLastTick = iVar5;
    *(int *)(&DAT_80148070 + iVar6) = iVar3;
    *(int *)(&DAT_8014806c + iVar6) = iVar5;
    *(short *)(&DAT_8014806a + iVar6) = sVar2;
    do {
      uVar7 = *puParm1;
      puParm1 = puParm1 + 1;
      iVar8 = iVar8 + 1;
      *(undefined4 *)(&DAT_80148074 + iVar6) = uVar7;
      iVar6 = iVar6 + 4;
    } while (iVar8 < 0xc);
    _gVoxEvents = _gVoxEvents + 1;
    *(undefined2 *)(&DAT_80148068 + iVar4 * 0x3c) = 1;
  }
  return 0;


}

int iSPCH_ChooseEvent(void)
{
  ushort uVar1;
  ushort uVar2;
  bool bVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  undefined *puVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  ushort local_30;
  
  iVar11 = -1;
  iVar5 = gettick();
  uVar13 = 0xffffffff;
  iVar12 = 0;
  puVar10 = &gVoxEvents;
  uVar4 = 0;
  local_30 = 0;
  iVar5 = iVar5 + _gPreLoadTicks;
  do {
    if (*(short *)(puVar10 + 8) != 0) {
      bVar3 = false;
      iVar8 = *(int *)(puVar10 + 0x10);
      uVar1 = *(ushort *)(iVar8 + 2);
      uVar9 = iVar5 - *(int *)(puVar10 + 0xc);
      if (((_gFilterSetting == 1) &&
          (uVar6 = VoxEvent_GetFilterLengthFlag(iVar8), (uVar6 & 0xff) != 0)) &&
         (uVar2 = *(ushort *)(iVar8 + 4), iVar7 = GetFilterPriority(), (int)(uint)uVar2 < iVar7)) {
        bVar3 = true;
      }
      if ((uVar1 != 0 && (uint)uVar1 < uVar9) || (bVar3)) {
        *(undefined2 *)(puVar10 + 8) = 0;
        _gVoxEvents = _gVoxEvents + -1;
      }
      else {
        uVar1 = *(ushort *)(iVar8 + 4);
        if (uVar4 < uVar1) {
          local_30 = *(ushort *)(&DAT_8014806a + iVar12 * 0x3c);
          iVar11 = iVar12;
          uVar13 = uVar9;
          uVar4 = uVar1;
        }
        else {
          if ((uVar1 == uVar4) &&
             ((uVar9 < uVar13 || ((uVar9 == uVar13 && (local_30 < *(ushort *)(puVar10 + 10))))))) {
            local_30 = *(ushort *)(&DAT_8014806a + iVar12 * 0x3c);
            iVar11 = iVar12;
            uVar13 = uVar9;
          }
        }
      }
    }
    iVar12 = iVar12 + 1;
    puVar10 = puVar10 + 0x3c;
  } while (iVar12 < 0x10);
  return iVar11;


}

void SPCH_ClearEventQueue(void)
{
  undefined *puVar1;
  int iVar2;
  
  iVar2 = 0;
  puVar1 = &gVoxEvents;
  do {
    if (*(short *)(puVar1 + 8) != 0) {
      *(undefined2 *)(puVar1 + 8) = 0;
      _gVoxEvents = _gVoxEvents + -1;
    }
    iVar2 = iVar2 + 1;
    puVar1 = puVar1 + 0x3c;
  } while (iVar2 < 0x10);
  return;


}

void iSPCH_ClearOldEvents(int iParm1)
{
  ushort uVar1;
  uint uVar2;
  undefined *puVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = 0;
  puVar3 = &gVoxEvents;
  uVar5 = *(uint *)(&DAT_8014806c + iParm1 * 0x3c);
  uVar1 = *(ushort *)(&DAT_8014806a + iParm1 * 0x3c);
  _DAT_80148064 = 0;
  do {
    if ((iVar4 != iParm1) && (*(short *)(puVar3 + 8) != 0)) {
      if ((*(uint *)(puVar3 + 0xc) < uVar5) ||
         ((*(uint *)(puVar3 + 0xc) == uVar5 && (*(ushort *)(puVar3 + 10) < uVar1)))) {
        uVar2 = VoxEvent_GetKeepTillExpiresFlag(*(undefined4 *)(puVar3 + 0x10));
        if ((uVar2 & 0xff) == 0) {
          *(undefined2 *)(puVar3 + 8) = 0;
          _gVoxEvents = _gVoxEvents + -1;
        }
      }
      else {
        if (*(char *)(*(int *)(puVar3 + 0x10) + 9) == 'd') {
          _DAT_80148064 = 1;
        }
      }
    }
    iVar4 = iVar4 + 1;
    puVar3 = puVar3 + 0x3c;
  } while (iVar4 < 0x10);
  return;


}

void SPCH_PlaySpeech(void)
{
  int iVar1;
  
  iVar1 = iSPCH_OneChosen();
  if ((iVar1 != 0) || (iVar1 = SPCH_ChooseSpeech(), iVar1 != 0)) {
    iSPCH_PlayChosen();
  }
  return;


}

int SPCH_ChooseSpeech(void)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  
  iVar4 = 0;
  if (_gVoxEvents != 0) {
    iVar1 = iSPCH_ChooseEvent();
    iVar4 = 0;
    if (-1 < iVar1) {
      iSPCH_ClearOldEvents(iVar1);
      puVar5 = &DAT_80148074 + iVar1 * 0x3c;
      iVar4 = iSPCH_ChooseSentence(puVar5);
      if ((iVar4 == 0) && (iVar3 = 0, false)) {
        do {
          iVar2 = (*(code *)0x0)(iVar3,puVar5);
          if (-1 < iVar2) {
            iVar4 = iSPCH_ChooseSentence(puVar5);
          }
          iVar3 = iVar3 + 1;
        } while ((iVar4 == 0) && (0 < iVar2));
      }
      if (iVar4 < 0) {
        iVar4 = 0;
      }
      _gVoxEvents = _gVoxEvents + -1;
      *(undefined2 *)(&DAT_80148068 + iVar1 * 0x3c) = 0;
    }
  }
  return iVar4;


}

long random(void)
{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  DAT_801234ac = DAT_801234ac + DAT_801234b0;
  uVar4 = DAT_801234a8 + DAT_801234ac + (uint)(DAT_801234ac < DAT_801234b0);
  uVar1 = (uint)(uVar4 < (uint)(DAT_801234ac < DAT_801234b0)) +
          (uint)(DAT_801234a8 + DAT_801234ac < DAT_801234ac);
  uVar3 = DAT_801234a4 + uVar4 + uVar1;
  uVar1 = (uint)(uVar3 < uVar1) + (uint)(DAT_801234a4 + uVar4 < uVar4);
  uVar2 = DAT_801234a0 + uVar3 + uVar1;
  seed = seed + uVar2 + (uint)(uVar2 < uVar1) + (uint)(DAT_801234a0 + uVar3 < uVar3);
  if ((((DAT_801234b0 + 1 == 0) && (DAT_801234ac = DAT_801234ac + 1, DAT_801234ac == 0)) &&
      (uVar4 = uVar4 + 1, uVar4 == 0)) &&
     ((uVar3 = uVar3 + 1, uVar3 == 0 && (uVar2 = uVar2 + 1, uVar2 == 0)))) {
    seed = seed + 1;
  }
  DAT_801234a0 = uVar2;
  DAT_801234a4 = uVar3;
  DAT_801234a8 = uVar4;
  DAT_801234b0 = DAT_801234b0 + 1;
  return seed;


}

void seedrandom(int iParm1)
{
  seed = iParm1 + -0xdd2f1aa;
  DAT_801234a0 = iParm1 + -0x77ced917;
  DAT_801234a4 = iParm1 + -0x39db22d1;
  DAT_801234a8 = iParm1 + 0x702c49c;
  DAT_801234ac = iParm1 + -0x61cac083;
  DAT_801234b0 = iParm1 + 0x6fdf3b64;
  return;


}

char * strcat(char *__dest,char *__src)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

int iSNDunsafebend(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  int local_20 [2];
  
  iVar1 = iSNDgetchan();
  if (-1 < iVar1) {
    local_20[0] = -1;
    while (iVar2 = iSNDpatchkey(iVar1,local_20), iVar2 != 0) {
      iVar2 = _DAT_801478f4 + local_20[0] * 100;
      if ((int)*(char *)(iVar2 + 0x2f) == iParm2) {
        return 0;
      }
      if (*(short *)(iVar2 + 0x5a) == 0) {
        return 0;
      }
      *(undefined *)(iVar2 + 0x2f) = (char)iParm2;
      *(undefined2 *)(iVar2 + 0x5e) = 0;
      iSNDcalcpitch(local_20[0]);
      iSNDplatformpitch(local_20[0],(uint)*(ushort *)(iVar2 + 0x62));
    }
  }
  return iVar1;


}

undefined4 SNDpitchbend(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iSNDenteraudio();
    uVar1 = iSNDunsafebend(uParm1,uParm2);
    iSNDleaveaudio();
  }
  return uVar1;


}

undefined4 SNDplay(undefined4 uParm1)
{
  undefined4 uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    uVar1 = cSNDplay(uParm1,0);
  }
  return uVar1;


}

undefined4 cSNDplay(int *piParm1)
{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar1 = iSNDvalidbank((int)*(char *)(piParm1 + 1));
  if (-1 < iVar1) {
    iVar1 = *piParm1;
    iVar3 = *(int *)((int)*(char *)(piParm1 + 1) * 0xc + _DAT_801478f8);
    if (iVar1 < 0) {
      return 0xfffffff8;
    }
    if (iVar1 < (int)(uint)*(ushort *)(iVar3 + 6)) {
      if (*(char *)(iVar3 + 4) == '\x04') {
        uVar2 = *(undefined4 *)(iVar3 + iVar1 * 4 + 0x14);
      }
      else {
        uVar2 = *(undefined4 *)(iVar3 + iVar1 * 4 + 0xc);
      }
      uVar2 = iSNDplaytaggedpatch(uVar2,piParm1);
      return uVar2;
    }
  }
  return 0xfffffff8;


}

uint SNDover(undefined4 uParm1)
{
  uint uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iSNDenteraudio();
    uVar1 = iSNDgetchan(uParm1);
    uVar1 = uVar1 >> 0x1f;
    iSNDleaveaudio();
  }
  return uVar1;


}

undefined4 SNDbankheadersize(int iParm1)
{
  if (DAT_8014789c != '\0') {
    return *(undefined4 *)(*(int *)(iParm1 * 0xc + _DAT_801478f8) + 8);
  }
  return 0xfffffff6;


}

size_t SNDbankheadercopy(void *pvParm1,int iParm2)
{
  size_t __n;
  int iVar1;
  int iVar2;
  void *pvVar3;
  int iVar4;
  void *pvVar5;
  int iVar6;
  
  if (DAT_8014789c == '\0') {
    __n = 0xfffffff6;
  }
  else {
    __n = SNDbankheadersize(iParm2);
    if (-1 < (int)__n) {
      memcpy(pvParm1,*(void **)(iParm2 * 0xc + _DAT_801478f8),__n);
      iVar6 = *(int *)(iParm2 * 0xc + _DAT_801478f8);
      iVar1 = 0;
      iVar2 = iVar6;
      pvVar3 = pvParm1;
      iVar4 = iVar6;
      pvVar5 = pvParm1;
      if (*(short *)(iVar6 + 6) != 0) {
        do {
          if (*(char *)(iVar6 + 4) == '\x04') {
            if (*(int *)(iVar2 + 0x14) != 0) {
              *(int *)((int)pvVar3 + 0x14) = (int)pvParm1 + (*(int *)(iVar2 + 0x14) - iVar6);
            }
          }
          else {
            if (*(int *)(iVar4 + 0xc) != 0) {
              *(int *)((int)pvVar5 + 0xc) = (int)pvParm1 + (*(int *)(iVar4 + 0xc) - iVar6);
            }
          }
          iVar1 = iVar1 + 1;
          iVar2 = iVar2 + 4;
          pvVar3 = (void *)((int)pvVar3 + 4);
          iVar4 = iVar4 + 4;
          pvVar5 = (void *)((int)pvVar5 + 4);
        } while (iVar1 < (int)(uint)*(ushort *)(iVar6 + 6));
      }
      __n = 0;
      *(void **)(iParm2 * 0xc + _DAT_801478f8) = pvParm1;
    }
  }
  return __n;


}

int SNDmemlargestunused(int *piParm1)
{
  int iVar1;
  int iVar2;
  ushort *puVar3;
  int iVar4;
  
  *piParm1 = 0x41;
  iVar4 = 0;
  if (_DAT_80147e30 == 0) {
    iVar4 = (uint)_DAT_80147e36 - 0x41;
  }
  else {
    iVar2 = 0;
    if (_DAT_80147e30 != 0) {
      puVar3 = (ushort *)&DAT_80147e38;
      do {
        if (iVar2 == 0) {
          if (iVar4 < (int)((uint)*puVar3 - 0x41)) {
            iVar4 = (uint)*puVar3 - 0x41;
          }
        }
        else {
          iVar1 = (uint)*puVar3 -
                  ((uint)*(ushort *)(&DAT_80147e34 + iVar2 * 4) +
                  (uint)*(ushort *)(&DAT_80147e36 + iVar2 * 4));
          if (iVar4 < iVar1) {
            *piParm1 = (uint)*(ushort *)(&DAT_80147e34 + iVar2 * 4) +
                       (uint)*(ushort *)(&DAT_80147e36 + iVar2 * 4);
            iVar4 = iVar1;
          }
        }
        iVar2 = iVar2 + 1;
        puVar3 = puVar3 + 2;
      } while (iVar2 < (int)(uint)_DAT_80147e30);
    }
    iVar1 = (uint)_DAT_80147e36 -
            ((uint)*(ushort *)(&DAT_80147e34 + iVar2 * 4) +
            (uint)*(ushort *)(&DAT_80147e36 + iVar2 * 4));
    if (iVar4 < iVar1) {
      *piParm1 = (uint)*(ushort *)(&DAT_80147e34 + iVar2 * 4) +
                 (uint)*(ushort *)(&DAT_80147e36 + iVar2 * 4);
      iVar4 = iVar1;
    }
  }
  *piParm1 = *piParm1 << 6;
  return iVar4 << 6;


}

undefined4 SNDbankadd(int *piParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  
  if (DAT_8014789c == '\0') {
    uVar3 = 0xfffffff6;
  }
  else {
    iVar1 = iSNDbankalloc();
    *piParm1 = iVar1;
    puVar2 = (undefined4 *)(_DAT_801478f8 + iVar1 * 0xc);
    *puVar2 = uParm2;
    puVar2[1] = uParm2;
    _DAT_801478dc = SNDbankremove;
    uVar3 = iSNDdownloadbank(uParm2,uParm2);
  }
  return uVar3;


}

int SNDstop(undefined4 uParm1)
{
  int iVar1;
  int iVar2;
  undefined4 local_10 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      local_10[0] = 0xffffffff;
      while (iVar2 = iSNDpatchkey(iVar1,local_10), iVar2 != 0) {
        iSNDstop(local_10[0]);
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

int SNDpitchmult(undefined4 uParm1,uint uParm2)
{
  int iVar1;
  int iVar2;
  int local_20 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      local_20[0] = -1;
      while (iVar2 = iSNDpatchkey(iVar1,local_20), iVar2 != 0) {
        iVar2 = _DAT_801478f4 + local_20[0] * 100;
        if ((uint)*(ushort *)(iVar2 + 0x60) == uParm2) break;
        *(undefined2 *)(iVar2 + 0x60) = (short)uParm2;
        iSNDcalcpitch();
        iSNDplatformpitch(local_20[0],(uint)*(ushort *)(iVar2 + 0x62));
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

undefined4 SNDmastervol(undefined uParm1)
{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar3 = 0;
    iSNDenteraudio();
    DAT_8014789d = uParm1;
    if (DAT_80147871 != 0) {
      iVar4 = 0;
      DAT_8014789d = uParm1;
      do {
        piVar2 = (int *)(_DAT_801478f4 + iVar4);
        if ((*(char *)((int)piVar2 + 0xb) == '\x01') && (-1 < *piVar2)) {
          iSNDcalcvol(iVar3);
          iSNDvol(iVar3,(int)*(char *)((int)piVar2 + 0x2d));
        }
        iVar3 = iVar3 + 1;
        iVar4 = iVar4 + 100;
      } while (iVar3 < (int)(uint)DAT_80147871);
    }
    iSNDleaveaudio();
    uVar1 = 0;
  }
  return uVar1;


}

int puts(char *__s)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&SUB_000000b0)();
  return iVar1;


}

int SND3dpos(undefined4 uParm1,uint uParm2,int iParm3)
{
  int iVar1;
  int iVar2;
  undefined4 local_18 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    if (iParm3 < 0x4000) {
      if (iParm3 < -0x4000) {
        iParm3 = -0x4000;
      }
    }
    else {
      iParm3 = 0x3fff;
    }
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      local_18[0] = 0xffffffff;
      while (iVar2 = iSNDpatchkey(iVar1,local_18), iVar2 != 0) {
        iSNDplatform3dpos(local_18[0],uParm2 & 0xffff,iParm3);
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

void SNDstopall(void)
{
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  if (DAT_80147871 != 0) {
    iVar2 = 0;
    do {
      iVar1 = iVar1 + 1;
      SNDstop(*(undefined4 *)(iVar2 + _DAT_801478f4));
      iVar2 = iVar2 + 100;
    } while (iVar1 < (int)(uint)DAT_80147871);
  }
  return;


}

undefined4 gettick(void)
{
  return ticks;


}

int elapsedticks(void)
{
  int iVar1;
  
  iVar1 = tickval;
  tickval = gettick();
  return tickval - iVar1;


}

void resettick(void)
{
  tickset = 0;
  tickval = 0;
  ticks = 0;
  return;


}

void timedwait(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar1 = gettick();
  while (iVar2 = gettick(), iVar2 - (iVar1 + iParm1) < 0) {
    systemtask(0);
  }
  return;


}

int SNDautovol(undefined4 uParm1,int iParm2,int iParm3)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int local_20 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      if (iParm2 < 1) {
        iParm2 = 1;
      }
      local_20[0] = -1;
      while (iVar2 = iSNDpatchkey(iVar1,local_20), iVar2 != 0) {
        iVar3 = _DAT_801478f4 + local_20[0] * 100;
        iVar2 = iParm3 * 0x10000 - *(int *)(iVar3 + 0x1c);
        if (iParm2 == 0) {
          trap(0x1c00);
        }
        if ((iParm2 == -1) && (iVar2 == -0x80000000)) {
          trap(0x1800);
        }
        *(int *)(iVar3 + 0x18) = iParm3 * 0x10000;
        *(int *)(iVar3 + 0x14) = iVar2 / iParm2;
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

int SNDSTRM_getvol(void)
{
  int iVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    iVar1 = -8;
    if ((iVar2 != 0) && (iVar1 = SNDgetvol(*(undefined4 *)(iVar2 + 8)), iVar1 < 0)) {
      iVar1 = (int)*(char *)(iVar2 + 0x54);
    }
  }
  return iVar1;


}

undefined4 CdDiskReady(int iParm1)
{
  int iVar1;
  int iVar2;
  byte local_18 [8];
  
  CdControlB(1,0,local_18);
  if ((local_18[0] & 0x10) != 0) {
    return 0x10;
  }
  iVar1 = CdControlB(0x13,0,local_18);
  if (iParm1 == 1) {
    if (local_18[0] == 2) {
      if (iVar1 == 0) {
        return 5;
      }
      return 2;
    }
  }
  else {
    iVar2 = 0;
    do {
      if ((local_18[0] & 2) != 0) {
        while ((local_18[0] != 2 || (iVar1 == 0))) {
          VSync(0x1e);
          iVar1 = CdControlB(0x13,0,local_18);
          if ((local_18[0] & 0x10) != 0) {
            return 0x10;
          }
        }
        return 2;
      }
      VSync(0x1e);
      iVar1 = CdControlB(0x13,0,local_18);
      if ((local_18[0] & 0x10) != 0) {
        return 0x10;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 10);
  }
  return 5;


}

uint CdGetDiskType(void)
{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined auStack2080 [8];
  undefined uStack2072;
  char acStack2071 [2047];
  byte local_18;
  byte local_17;
  
  CdControl(1,0,&local_18);
  uVar1 = 0x10;
  if ((local_18 & 0x10) == 0) {
    CdIntToPos(0x10,auStack2080);
    CdControl(0x1b,auStack2080,0);
    iVar3 = 0;
    while( true ) {
      iVar2 = CdReady(0,&local_18);
      iVar3 = iVar3 + 1;
      if ((iVar2 == 1) || (9 < iVar3)) break;
      CdControl(0x1b,auStack2080,0);
    }
    if (iVar2 == 1) {
      CdControl(9,0,0);
      CdGetSector(&uStack2072,0x200);
      iVar3 = strncmp(acStack2071,"CD001",5);
      uVar1 = 1;
      if (iVar3 == 0) {
        uVar1 = 2;
      }
    }
    else {
      uVar1 = 0x10;
      if ((local_18 & 0x10) == 0) {
        if (((local_18 & 1) == 0) || ((local_17 & 0x40) == 0)) {
          uVar1 = (uint)((local_18 & 2) != 0);
        }
        else {
          printf("Command Error: ");
          uVar1 = 1;
        }
      }
    }
  }
  return uVar1;


}

undefined4 SNDSTRM_status(undefined4 uParm1,int *piParm2)
{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  
  piParm2[2] = 0;
  piParm2[1] = 0;
  *piParm2 = 0;
  uVar1 = 0xfffffff6;
  if (DAT_8014789c != '\0') {
    piVar2 = (int *)iSNDstreamgetstreamptr();
    uVar1 = 0xfffffff8;
    if (piVar2 != (int *)0x0) {
      iSNDenteraudio();
      *piParm2 = (int)*(char *)((int)piVar2 + 0x16);
      if ((*(char *)((int)piVar2 + 0x16) != '\0') &&
         (piParm2[1] = *(int *)(*piVar2 + 4), *(short *)(piVar2 + 7) != 0)) {
        iVar3 = SNDPKTPLAY_unsafeframesoutstanding(piVar2[3]);
        if (*(ushort *)(piVar2 + 7) == 0) {
          trap(0x1c00);
        }
        piParm2[2] = (uint)(iVar3 * 1000) / (uint)*(ushort *)(piVar2 + 7);
      }
      iSNDleaveaudio();
      uVar1 = 0;
    }
  }
  return uVar1;


}

undefined4 SNDSTRM_requeststatus(uint uParm1,undefined4 *puParm2)
{
  ushort uVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  undefined4 local_18;
  undefined4 local_14;
  
  *puParm2 = 0;
  puParm2[1] = 0;
  puParm2[2] = 0;
  puParm2[3] = 0;
  if (DAT_8014789c == '\0') {
    uVar2 = 0xfffffff6;
  }
  else {
    uVar2 = 0xfffffff8;
    if (-1 < (int)uParm1) {
      piVar3 = (int *)iSNDstreamgetstreamptr(uParm1 & 0xff);
      uVar2 = 0xfffffff8;
      if (piVar3 != (int *)0x0) {
        iSNDenteraudio();
        iVar4 = iSNDstreamgetrequestptr(uParm1);
        if (iVar4 == 0) {
          *puParm2 = 3;
        }
        else {
          if (*(int *)(iVar4 + 8) < 0) {
            *puParm2 = 0;
          }
          else {
            if (*piVar3 == iVar4) {
              *puParm2 = 2;
              uVar1 = *(ushort *)(piVar3 + 7);
            }
            else {
              *puParm2 = 1;
              uVar1 = *(ushort *)(piVar3 + 8);
            }
            uVar5 = (uint)uVar1;
            iSNDmulu64(&local_18,*(undefined4 *)(iVar4 + 0x14),1000);
            uVar2 = iSNDdivu64(local_18,local_14,uVar5);
            puParm2[1] = uVar2;
            iSNDmulu64(&local_18,*(int *)(iVar4 + 0x18) - *(int *)(iVar4 + 0x14),1000);
            uVar2 = iSNDdivu64(local_18,local_14,uVar5);
            puParm2[2] = uVar2;
            if (uVar1 == 0) {
              trap(0x1c00);
            }
            puParm2[3] = (uint)(*(int *)(iVar4 + 0x1c) * 1000) / uVar5;
          }
        }
        iSNDleaveaudio();
        uVar2 = 0;
      }
    }
  }
  return uVar2;


}

char * strrstr(char *pcParm1,byte *pbParm2)
{
  byte bVar1;
  char *pcVar2;
  char *pcVar3;
  
  bVar1 = *pbParm2;
  pcVar3 = (char *)0x0;
  while (bVar1 != 0) {
    pcVar2 = strrchr(pcParm1,(uint)*pbParm2);
    if (pcVar3 < pcVar2) {
      pcVar3 = pcVar2;
    }
    pbParm2 = pbParm2 + 1;
    bVar1 = *pbParm2;
  }
  return pcVar3;


}

uint wildcard(byte *pbParm1,byte *pbParm2)
{
  char cVar1;
  byte bVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  undefined4 uVar7;
  
  pcVar3 = (char *)strrstr(pbParm2,"&|!~^");
  if (pcVar3 == (char *)0x0) {
LAB_800e8b1c:
    do {
      bVar2 = *pbParm2;
      if (bVar2 == 0x2a) {
        do {
          iVar4 = wildcard(pbParm1,pbParm2 + 1);
          if (iVar4 != 0) {
            return 1;
          }
          bVar2 = *pbParm1;
          pbParm1 = pbParm1 + 1;
        } while (bVar2 != 0);
        return 0;
      }
      if (bVar2 == 0x3f) {
        bVar2 = *pbParm1;
      }
      else {
        if (bVar2 != 0x23) {
          if (bVar2 == 0x7e) {
            iVar4 = wildcard(pbParm1,pbParm2 + 1);
            return (uint)(iVar4 == 0);
          }
          uVar6 = tolower((uint)*pbParm2);
          uVar5 = tolower((uint)*pbParm1);
          if ((uVar6 & 0xff) != (uVar5 & 0xff)) {
            return 0;
          }
          bVar2 = *pbParm2;
          pbParm2 = pbParm2 + 1;
          if (bVar2 == 0) {
            return 1;
          }
          pbParm1 = pbParm1 + 1;
          goto LAB_800e8b1c;
        }
        bVar2 = (&DAT_801371d1)[(uint)*pbParm1] & 4;
      }
      pbParm2 = pbParm2 + 1;
      pbParm1 = pbParm1 + 1;
    } while (bVar2 != 0);
    uVar7 = 0;
  }
  else {
    cVar1 = *pcVar3;
    if (cVar1 == '&') {
      *pcVar3 = '\0';
      uVar6 = 0;
      iVar4 = wildcard(pbParm1,pbParm2);
      if (iVar4 != 0) {
        iVar4 = wildcard(pbParm1,pcVar3 + 1);
        uVar6 = (uint)(iVar4 != 0);
      }
      *pcVar3 = '&';
      return uVar6;
    }
    if (cVar1 == '|') {
      *pcVar3 = '\0';
      uVar7 = 0;
      iVar4 = wildcard(pbParm1,pbParm2);
      if ((iVar4 != 0) || (iVar4 = wildcard(pbParm1,pcVar3 + 1), iVar4 != 0)) {
        uVar7 = 1;
      }
      cVar1 = '|';
    }
    else {
      if ((cVar1 != '!') && (cVar1 != '~')) {
        if (cVar1 == '^') {
          *pcVar3 = '\0';
          uVar6 = wildcard(pbParm1,pbParm2);
          uVar5 = wildcard(pbParm1,pcVar3 + 1);
          *pcVar3 = '^';
          return uVar6 ^ uVar5;
        }
        goto LAB_800e8b1c;
      }
      *pcVar3 = '\0';
      uVar7 = 0;
      iVar4 = wildcard(pbParm1,pbParm2);
      if ((iVar4 != 0) || (iVar4 = wildcard(pbParm1,pcVar3 + 1), iVar4 != 0)) {
        uVar7 = 1;
      }
      cVar1 = '!';
    }
    *pcVar3 = cVar1;
  }
  return uVar7;


}

undefined4 iSNDstreamdestroyall(void)
{
  int iVar1;
  
  iVar1 = 0;
  do {
    SNDSTRM_destroy(iVar1);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 1);
  return 0;


}

undefined4 iSNDstreamgetstreamptr(int iParm1)
{
  if (iParm1 == 0) {
    return _sndss;
  }
  return 0;


}

void iSNDstreamremoverequest(uint uParm1)
{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  char cVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  
  piVar6 = *(int **)(&sndss + (uParm1 & 0xff) * 4);
  cVar10 = '\0';
  iVar7 = 0;
  if (0 < (int)((uint)*(byte *)((int)piVar6 + 0x16) << 0x18)) {
    iVar9 = 0;
    iVar8 = 0;
    do {
      puVar3 = (undefined4 *)(*piVar6 + iVar9);
      if (puVar3[1] != uParm1) {
        if ((int)*(char *)((int)piVar6 + 0x17) == iVar7) {
          *(char *)((int)piVar6 + 0x17) = cVar10;
        }
        puVar1 = (undefined4 *)(iVar8 + *piVar6);
        puVar5 = puVar3;
        do {
          puVar4 = puVar5;
          puVar2 = puVar1;
          uVar11 = puVar4[1];
          uVar12 = puVar4[2];
          uVar13 = puVar4[3];
          *puVar2 = *puVar4;
          puVar2[1] = uVar11;
          puVar2[2] = uVar12;
          puVar2[3] = uVar13;
          puVar5 = puVar4 + 4;
          puVar1 = puVar2 + 4;
        } while (puVar5 != puVar3 + 8);
        uVar11 = puVar4[5];
        uVar12 = puVar4[6];
        puVar2[4] = *puVar5;
        puVar2[5] = uVar11;
        puVar2[6] = uVar12;
        iVar8 = iVar8 + 0x2c;
        cVar10 = cVar10 + '\x01';
      }
      iVar9 = iVar9 + 0x2c;
      iVar7 = iVar7 + 1;
    } while (iVar7 < (int)*(char *)((int)piVar6 + 0x16));
  }
  *(char *)((int)piVar6 + 0x16) = *(char *)((int)piVar6 + 0x16) + -1;
  if ((int)((uint)*(byte *)((int)piVar6 + 0x16) << 0x18) <
      (int)((uint)*(byte *)((int)piVar6 + 0x17) << 0x18)) {
    *(char *)((int)piVar6 + 0x17) = *(char *)((int)piVar6 + 0x17) + -1;
  }
  return;


}

void iSNDstreamreleasecallback(int iParm1)
{
  STREAM_release(*(undefined4 *)(*(int *)(&sndss + (uint)**(byte **)(iParm1 + -4) * 4) + 4));
  return;


}

void iSNDstreamnotifycallback(int iParm1,uint uParm2)
{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int *piVar4;
  
  piVar4 = *(int **)(&sndss + (int)(char)(&DAT_8013ea84)[iParm1] * 4);
  do {
    iVar1 = *piVar4;
    uVar2 = uParm2;
    uVar3 = 0;
    if (*(uint *)(iVar1 + 0x1c) < uParm2) {
      uVar3 = uParm2 - *(int *)(iVar1 + 0x1c);
      uVar2 = uParm2 - uVar3;
    }
    uParm2 = uVar3;
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + uVar2;
    *(int *)(iVar1 + 0x1c) = *(int *)(iVar1 + 0x1c) - uVar2;
    if (*(uint *)(iVar1 + 0x18) <= *(uint *)(iVar1 + 0x14)) {
      iSNDstreamremoverequest(*(undefined4 *)(iVar1 + 4));
    }
  } while (uParm2 != 0);
  return;


}

undefined4 iSNDstreamparseheader(int *piParm1,int iParm2)
{
  undefined4 uVar1;
  int iVar2;
  int *piVar3;
  undefined4 local_20 [2];
  
  piVar3 = piParm1 + 8;
  iVar2 = *piParm1 + (int)*(char *)((int)piParm1 + 0x17) * 0x2c;
  iSNDpatchtohdr(iParm2 + 0xc,piVar3,piParm1 + 0xe,local_20);
  *(undefined4 *)(iVar2 + 0x18) = local_20[0];
  STREAM_release(piParm1[1],iParm2);
  *(int *)(iVar2 + 0x18) = ((*(int *)(iVar2 + 0x18) + 0x1b) / 0x1c) * 0x1c;
  uVar1 = iSNDplatformcalcdatarate(piVar3);
  *(undefined4 *)(iVar2 + 0x10) = uVar1;
  iVar2 = memcmp(piParm1 + 7,piVar3,4);
  if ((iVar2 != 0) || (iVar2 = memcmp(piParm1 + 9,piParm1 + 0xe,0x14), iVar2 != 0)) {
    if (*(short *)(piParm1 + 7) != 0) {
      *(undefined *)(piParm1 + 5) = 2;
      return 0;
    }
    piParm1[7] = piParm1[8];
    piParm1[9] = piParm1[0xe];
    piParm1[10] = piParm1[0xf];
    piParm1[0xb] = piParm1[0x10];
    piParm1[0xc] = piParm1[0x11];
    piParm1[0xd] = piParm1[0x12];
  }
  if (*(char *)(piParm1 + 5) != '\x01') {
    iVar2 = SNDPKTPLAY_start(piParm1[3],piParm1 + 7,piParm1 + 9,piParm1 + 0x13);
    piParm1[2] = iVar2;
    *(undefined *)(piParm1 + 5) = 1;
  }
  return 0;


}

undefined4 iSNDstreamparsenumchunks(int *piParm1,int iParm2)
{
  STREAM_release(piParm1[1]);
  *(undefined4 *)((int)*(char *)((int)piParm1 + 0x17) * 0x2c + *piParm1 + 0x24) =
       *(undefined4 *)(iParm2 + 0xc);
  return 1;


}

undefined4 iSNDstreamparsedata(int *piParm1,undefined4 *puParm2)
{
  byte bVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined *puVar6;
  int iVar7;
  int *piVar8;
  undefined auStack40 [4];
  int local_24;
  int local_1c;
  
  iVar3 = puParm2[3];
  if (*(char *)((int)piParm1 + 0x2f) == '\0') {
    iVar7 = 0;
    if (*(char *)((int)piParm1 + 0x1e) != '\0') {
      puVar6 = auStack40;
      do {
        *(undefined4 **)(puVar6 + 0xc) = puParm2 + 4;
        iVar7 = iVar7 + 1;
        puVar6 = puVar6 + 4;
      } while (iVar7 < (int)(uint)*(byte *)((int)piParm1 + 0x1e));
    }
  }
  else {
    bVar1 = *(byte *)((int)piParm1 + 0x1e);
    iVar7 = 0;
    if (bVar1 != 0) {
      puVar6 = auStack40;
      piVar8 = puParm2 + 4;
      do {
        iVar4 = *piVar8;
        piVar8 = piVar8 + 1;
        iVar7 = iVar7 + 1;
        *(uint *)(puVar6 + 0xc) = (int)(puParm2 + 4) + iVar4 + (uint)bVar1 * 4;
        puVar6 = puVar6 + 4;
      } while (iVar7 < (int)(uint)*(byte *)((int)piParm1 + 0x1e));
    }
  }
  local_24 = ((iVar3 + 0x1b) / 0x1c) * 0x1c;
  cVar2 = *(char *)((int)piParm1 + 0x17);
  iVar3 = *piParm1;
  *(undefined4 **)(local_1c + -4) = puParm2;
  iVar3 = iVar3 + (int)cVar2 * 0x2c;
  *puParm2 = *(undefined4 *)(iVar3 + 4);
  *(int *)(iVar3 + 0x1c) = *(int *)(iVar3 + 0x1c) + local_24;
  *(int *)(iVar3 + 0x20) = *(int *)(iVar3 + 0x20) + 1;
  uVar5 = SNDPKTPLAY_submit(piParm1[3],auStack40);
  *(undefined4 *)(iVar3 + 0xc) = uVar5;
  if (*(int *)(iVar3 + 8) < 0) {
    *(undefined4 *)(iVar3 + 8) = *(undefined4 *)(iVar3 + 0xc);
  }
  return 1;


}

undefined4 iSNDstreamparseend(int iParm1)
{
  STREAM_release(*(undefined4 *)(iParm1 + 4));
  *(char *)(iParm1 + 0x17) = *(char *)(iParm1 + 0x17) + '\x01';
  return 1;


}

undefined4 iSNDstreamparsechunk(int iParm1,int *piParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *piParm2;
  uVar2 = 1;
  if (iVar1 == 0x6c444353) {
    uVar2 = iSNDstreamparsedata();
  }
  else {
    if (iVar1 == 0x6c484353) {
      uVar2 = iSNDstreamparseheader();
    }
    else {
      if (iVar1 == 0x6c454353) {
        uVar2 = iSNDstreamparseend();
      }
      else {
        if (iVar1 == 0x6c434353) {
          uVar2 = iSNDstreamparsenumchunks();
        }
        else {
          STREAM_release(*(undefined4 *)(iParm1 + 4));
        }
      }
    }
  }
  return uVar2;


}

undefined4 iSNDstreamisheld(int *piParm1)
{
  undefined4 uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = *piParm1 + (int)*(char *)((int)piParm1 + 0x17) * 0x2c;
  uVar1 = 0;
  if (((*(int *)(iVar4 + 0x10) != 0) &&
      (uVar1 = 1, -1 < (int)((uint)*(ushort *)(iVar4 + 0x28) << 0x10))) &&
     (uVar1 = 0, *(short *)(iVar4 + 0x28) != 0)) {
    uVar2 = STREAM_gettable(piParm1[1]);
    if (4000000 < uVar2) {
      uVar2 = 4000000;
    }
    if (*(uint *)(iVar4 + 0x10) == 0) {
      trap(0x1c00);
    }
    if (((uVar2 * 1000) / *(uint *)(iVar4 + 0x10) < (uint)(int)*(short *)(iVar4 + 0x28)) &&
       (iVar3 = STREAM_state(piParm1[1]), iVar3 != 2)) {
      return 1;
    }
    *(undefined2 *)(iVar4 + 0x28) = 0;
    uVar1 = 0;
  }
  return uVar1;


}

void iSNDstreamhotroddatachunks(void)
{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int **ppiVar5;
  int iVar6;
  
  iVar4 = 0;
  iVar6 = 0;
  ppiVar5 = (int **)&sndss;
  do {
    piVar2 = *ppiVar5;
    if (((((piVar2 != (int *)0x0) && (*(char *)((int)piVar2 + 0x16) != '\0')) &&
         (*(char *)(piVar2 + 5) == '\x01')) &&
        ((iVar1 = iSNDstreamisheld(piVar2), iVar1 == 0 &&
         (iVar1 = *piVar2 + (int)*(char *)((int)piVar2 + 0x17) * 0x2c, *(int *)(iVar1 + 0x24) != 0))
        )) && (*(int *)(iVar1 + 0x20) != 0)) {
      iVar3 = *(int *)(iVar1 + 0x24) - *(int *)(iVar1 + 0x20);
      iVar1 = SNDPKTPLAY_submitspace(piVar2[3]);
      if (iVar3 < iVar1) {
        iVar1 = iVar3;
      }
      if (0 < iVar1) {
        do {
          iVar1 = iVar1 + -1;
          iVar3 = STREAM_get(piVar2[1]);
          if (iVar3 != 0) {
            iVar4 = iVar4 + *(int *)(iVar3 + 4);
            iSNDstreamparsedata(piVar2);
          }
        } while ((0 < iVar1) && (iVar4 < 0x4000));
      }
    }
    iVar6 = iVar6 + 1;
    ppiVar5 = ppiVar5 + 1;
  } while (iVar6 < 1);
  return;


}

void iSNDstreamservice(void)
{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  
  iSNDenteraudio();
  iVar7 = 0;
  piVar6 = (int *)&sndss;
  do {
    iVar4 = *piVar6;
    if ((iVar4 != 0) && (*(char *)(iVar4 + 0x16) != '\0')) {
      if (*(char *)(iVar4 + 0x14) == '\x02') {
        iVar1 = SNDPKTPLAY_framesoutstanding(*(undefined4 *)(iVar4 + 0xc));
        if (0 < iVar1) goto LAB_800e96c4;
        *(undefined4 *)(iVar4 + 0x1c) = *(undefined4 *)(iVar4 + 0x20);
        SNDPKTPLAY_stop(*(undefined4 *)(iVar4 + 0xc));
        uVar2 = SNDPKTPLAY_start(*(undefined4 *)(iVar4 + 0xc),iVar4 + 0x1c,iVar4 + 0x24,iVar4 + 0x4c
                                );
        *(undefined4 *)(iVar4 + 8) = uVar2;
        *(undefined *)(iVar4 + 0x14) = 1;
      }
      iVar1 = iSNDstreamisheld(iVar4);
      if (iVar1 == 0) {
        iVar1 = 10;
        if (*(char *)(iVar4 + 0x14) == '\x01') {
          iVar1 = SNDPKTPLAY_submitspace(*(undefined4 *)(iVar4 + 0xc));
          if (iVar1 == 0) goto LAB_800e96c4;
          iVar5 = 0;
        }
        else {
          iVar5 = 0;
        }
        do {
          iVar1 = iVar1 + -1;
          iVar3 = STREAM_get(*(undefined4 *)(iVar4 + 4));
          if (iVar3 != 0) {
            iVar5 = iSNDstreamparsechunk(iVar4,iVar3);
          }
        } while ((iVar5 != 0) && (0 < iVar1));
      }
    }
LAB_800e96c4:
    iVar7 = iVar7 + 1;
    piVar6 = piVar6 + 1;
    if (0 < iVar7) {
      iSNDleaveaudio();
      return;
    }
  } while( true );


}

int iSNDstreamnumcreated(void)
{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar2 = 0;
  piVar1 = (int *)&sndss;
  do {
    if (*piVar1 != 0) {
      iVar3 = iVar3 + 1;
    }
    iVar2 = iVar2 + 1;
    piVar1 = piVar1 + 1;
  } while (iVar2 < 1);
  return iVar3;


}

int iSNDstreamcreate(int *param_1,int param_2,undefined4 param_3,int *param_4,int param_5, int param_6,int param_7)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar5 = 0;
    piVar4 = (int *)&sndss;
    do {
      if (*piVar4 == 0) {
        piVar4 = param_4 + 0x18;
        *(int **)param_4 = piVar4;
        iVar2 = SNDPKTPLAY_overhead(param_3);
        uVar1 = SNDPKTPLAY_overhead(param_3);
        iVar3 = SNDPKTPLAY_create(piVar4 + param_2 * 0xb,uVar1,iSNDstreamreleasecallback,
                                  iSNDstreamnotifycallback);
        param_4[3] = iVar3;
        if (param_4[3] < 0) {
          return param_4[3];
        }
        (&DAT_8013ea84)[param_4[3]] = (char)iVar5;
        if (param_7 == 0) {
          iVar2 = STREAM_create(param_2 + 1,1,1,(int)(piVar4 + param_2 * 0xb) + iVar2,
                                (param_5 + -0x60 + param_2 * -0x2c) - iVar2);
          param_4[1] = iVar2;
          *(undefined *)(param_4 + 6) = 0;
          iVar2 = STREAM_buffersize(iVar2);
          SNDSTRM_setgreedylevel(param_4[1],iVar2 / 3);
        }
        else {
          param_4[1] = param_6;
          *(undefined *)(param_4 + 6) = 1;
        }
        param_4[4] = 0;
        param_4[2] = -1;
        *(undefined *)((int)param_4 + 0x15) = (char)param_2;
        iVar3 = param_1[1];
        iVar6 = param_1[2];
        iVar2 = param_1[3];
        param_4[0x13] = *param_1;
        param_4[0x14] = iVar3;
        param_4[0x15] = iVar6;
        param_4[0x16] = iVar2;
        param_4[0x17] = param_1[4];
        iVar2 = iSNDstreamnumcreated();
        if (iVar2 == 0) {
          iSNDserveraddclient(iSNDstreamservice);
          _DAT_801478e8 = iSNDstreamdestroyall;
        }
        *(int **)(&sndss + iVar5 * 4) = param_4;
        SNDSTRM_purge(iVar5);
        return iVar5;
      }
      iVar5 = iVar5 + 1;
      piVar4 = piVar4 + 1;
    } while (iVar5 < 1);
    uVar1 = 0xfffffff7;
  }
  return uVar1;


}

int iSNDstreamqueue(uint param_1,undefined2 param_2,undefined4 param_3,int param_4,int param_5)
{
  int iVar1;
  int *piVar2;
  int *piVar3;
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    piVar2 = (int *)iSNDstreamgetstreamptr(param_1);
    iVar1 = -8;
    if (piVar2 != (int *)0x0) {
      iSNDenteraudio();
      if ((int)((uint)*(byte *)((int)piVar2 + 0x16) << 0x18) <
          (int)((uint)*(byte *)((int)piVar2 + 0x15) << 0x18)) {
        piVar3 = (int *)(*piVar2 + (int)*(char *)((int)piVar2 + 0x16) * 0x2c);
        if (param_5 == 0) {
          iVar1 = STREAM_queuefile(piVar2[1],param_3,param_4,0x6c454353);
          *piVar3 = iVar1;
        }
        else {
          if (param_5 == 1) {
            iVar1 = STREAM_queuemem(piVar2[1],param_3,0,0x6c454353);
            *piVar3 = iVar1;
          }
          else {
            *piVar3 = param_4;
          }
        }
        if (*piVar3 == 0) {
          iSNDleaveaudio();
          iVar1 = -1;
        }
        else {
          piVar2[4] = piVar2[4] + 0x100;
          if (piVar2[4] < 0) {
            piVar2[4] = 0;
          }
          piVar3[1] = piVar2[4] | param_1;
          *(undefined2 *)(piVar3 + 10) = param_2;
          *(char *)((int)piVar2 + 0x16) = *(char *)((int)piVar2 + 0x16) + '\x01';
          piVar3[4] = 0;
          piVar3[2] = -1;
          piVar3[3] = -1;
          piVar3[5] = 0;
          piVar3[7] = 0;
          piVar3[8] = 0;
          piVar3[9] = 0;
          iSNDleaveaudio();
          iVar1 = piVar3[1];
        }
      }
      else {
        iSNDleaveaudio();
        iVar1 = -0xd;
      }
    }
  }
  return iVar1;


}

void SNDSTRM_create(void)
{
  iSNDstreamcreate();
  return;


}

undefined4 SNDSTRM_destroy(int iParm1)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr(iParm1);
    uVar1 = 0xfffffff8;
    if (iVar2 != 0) {
      SNDSTRM_purge(iParm1);
      iVar3 = iSNDstreamnumcreated();
      if (iVar3 == 1) {
        iSNDserverremoveclient(iSNDstreamservice);
        _DAT_801478e8 = 0;
      }
      SNDPKTPLAY_destroy(*(undefined4 *)(iVar2 + 0xc));
      if (*(char *)(iVar2 + 0x18) == '\0') {
        STREAM_destroy(*(undefined4 *)(iVar2 + 4));
      }
      *(undefined4 *)(&sndss + iParm1 * 4) = 0;
      uVar1 = 0;
    }
  }
  return uVar1;


}

void SNDSTRM_queuefile(void)
{
  iSNDstreamqueue();
  return;


}

undefined4 SNDSTRM_purge(void)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    uVar1 = 0xfffffff8;
    if (iVar2 != 0) {
      if (-1 < *(int *)(iVar2 + 8)) {
        SNDPKTPLAY_stop(*(undefined4 *)(iVar2 + 0xc));
      }
      *(undefined4 *)(iVar2 + 8) = 0xffffffff;
      if (*(char *)(iVar2 + 0x18) == '\0') {
        STREAM_kill(*(undefined4 *)(iVar2 + 4));
      }
      *(undefined *)(iVar2 + 0x16) = 0;
      *(undefined *)(iVar2 + 0x17) = 0;
      *(undefined *)(iVar2 + 0x14) = 0;
      memset((void *)(iVar2 + 0x1c),0,4);
      memset((void *)(iVar2 + 0x20),0,4);
      memset((void *)(iVar2 + 0x24),0,0x14);
      memset((void *)(iVar2 + 0x38),0,0x14);
      uVar1 = 0;
    }
  }
  return uVar1;


}

undefined4 SNDSTRM_setgreedylevel(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    if (iVar2 == 0) {
      uVar1 = 0xfffffff8;
    }
    else {
      STREAM_setgreedylevel(*(undefined4 *)(iVar2 + 4),uParm2);
      uVar1 = 0;
    }
  }
  return uVar1;


}

undefined4 SNDSTRM_setgreedystate(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    if (iVar2 == 0) {
      uVar1 = 0xfffffff8;
    }
    else {
      STREAM_setgreedystate(*(undefined4 *)(iVar2 + 4),uParm2);
      uVar1 = 0;
    }
  }
  return uVar1;


}

undefined4 SNDSTRM_autovol(undefined4 uParm1,int iParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    if (iVar2 == 0) {
      uVar1 = 0xfffffff8;
    }
    else {
      *(undefined *)(iVar2 + 0x54) = (char)uParm3;
      SNDautovol(*(undefined4 *)(iVar2 + 8),iParm2 / 10,uParm3);
      uVar1 = 0;
    }
  }
  return uVar1;


}

undefined4 SetRCnt(uint uParm1,undefined2 uParm2,uint uParm3)
{
  undefined4 uVar1;
  ushort uVar2;
  
  uParm1 = uParm1 & 0xffff;
  uVar2 = 0x48;
  if (uParm1 < 3) {
    *(undefined2 *)(uParm1 * 0x10 + 0x1f801104) = 0;
    *(undefined2 *)(uParm1 * 0x10 + 0x1f801108) = uParm2;
    if (uParm1 < 2) {
      if ((uParm3 & 0x10) != 0) {
        uVar2 = 0x49;
      }
      if ((uParm3 & 1) == 0) {
        uVar2 = uVar2 | 0x100;
      }
    }
    else {
      if ((uParm1 == 2) && ((uParm3 & 1) == 0)) {
        uVar2 = 0x248;
      }
    }
    uVar1 = 1;
    if ((uParm3 & 0x1000) != 0) {
      uVar2 = uVar2 | 0x10;
    }
    *(ushort *)(uParm1 * 0x10 + 0x1f801104) = uVar2;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;


}

uint GetRCnt(uint uParm1)
{
  uint uVar1;
  
  if ((uParm1 & 0xffff) < 3) {
    uVar1 = (uint)*(ushort *)((uParm1 & 0xffff) * 0x10 + 0x1f801100);
  }
  else {
    uVar1 = 0;
  }
  return uVar1;


}

uint StartRCnt(uint uParm1)
{
  _DAT_1f801074 = _DAT_1f801074 | *(uint *)(&DAT_801234bc + (uParm1 & 0xffff) * 4);
  return (uint)((uParm1 & 0xffff) < 3);


}

size_t strlen(char *__s)
{
  size_t sVar1;
  
                    
  sVar1 = (*(code *)&LAB_000000a0)();
  return sVar1;


}

undefined4 SNDgetlimits(undefined4 *puParm1)
{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar2 = DAT_801234dc;
  uVar1 = DAT_801234d8;
  if (DAT_8014789c != '\0') {
    *puParm1 = sndpsxlimits;
    puParm1[1] = uVar1;
    puParm1[2] = uVar2;
    uVar1 = DAT_801234e4;
    puParm1[3] = DAT_801234e0;
    puParm1[4] = uVar1;
    return 0;
  }
  return 0xfffffff2;


}

undefined4 SNDsetlimits(undefined4 *puParm1)
{
  if (DAT_8014789c == '\0') {
    return 0xfffffff6;
  }
  if (0x1fff < (int)puParm1[4]) {
    sndpsxlimits = *puParm1;
    DAT_801234d8 = puParm1[1];
    DAT_801234dc = puParm1[2];
    DAT_801234e0 = puParm1[3];
    DAT_801234e4 = puParm1[4] & 0xffffe000;
    return 0;
  }
  return 0xffffffff;


}

int SNDSTRM_overheadtap(int iParm1,undefined4 uParm2)
{
  int iVar1;
  
  iVar1 = SNDPKTPLAY_overhead(uParm2);
  return iParm1 * 0x2c + 0x60 + iVar1;


}

int SNDSTRM_overhead(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar1 = SNDSTRM_overheadtap();
  iVar2 = STREAM_overhead(iParm1 + 1,1,1);
  return iVar1 + iVar2;


}

undefined4 SNDSTRM_vol(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  int iVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar2 = iSNDstreamgetstreamptr();
    if (iVar2 == 0) {
      uVar1 = 0xfffffff8;
    }
    else {
      *(undefined *)(iVar2 + 0x54) = (char)uParm2;
      SNDvol(*(undefined4 *)(iVar2 + 8),uParm2);
      uVar1 = 0;
    }
  }
  return uVar1;


}

void iSNDserver(void)
{
  uint uVar1;
  
  if (DAT_8014789e == '\0') {
    if (DAT_8014789f == '\0') {
      DAT_8014789e = 1;
      if (timerhz != (int)_DAT_80147910) {
        _DAT_80147910 = (short)timerhz;
        _DAT_801478a4 = 0;
        _DAT_8014790c = 0;
      }
      _DAT_8014790c = _DAT_8014790c + 1;
      uVar1 = (uint)(_DAT_8014790c * 100) / timerhz;
      if (timerhz == 0) {
        trap(0x1c00);
      }
      while (_DAT_801478a4 <= uVar1) {
        (*_DAT_801478a8)();
      }
      DAT_8014789e = '\0';
    }
    else {
      _DAT_80147912 = _DAT_80147912 + 1;
    }
  }
  return;


}

void iSND100hzserver(void)
{
  code **ppcVar1;
  bool bVar2;
  byte bVar3;
  char cVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  bool bVar8;
  undefined *puVar9;
  int *piVar10;
  int iVar11;
  int iVar12;
  
  puVar9 = &sndgs;
  _DAT_801478a4 = _DAT_801478a4 + 1;
  iVar11 = 0;
  iSNDserve();
  if ('\0' < DAT_801478a0) {
    do {
      ppcVar1 = (code **)(puVar9 + 0x4c);
      puVar9 = puVar9 + 4;
      (**ppcVar1)();
      iVar11 = iVar11 + 1;
    } while (iVar11 < (int)DAT_801478a0);
  }
  iVar11 = 0;
  if (DAT_80147871 != 0) {
    iVar12 = 0;
    do {
      piVar10 = (int *)(_DAT_801478f4 + iVar12);
      if ((*(char *)((int)piVar10 + 0xb) == '\x01') && (-1 < *piVar10)) {
        if (piVar10[0x15] != 0) {
          bVar3 = *(char *)((int)piVar10 + 0x3b) + 1;
          *(byte *)((int)piVar10 + 0x3b) = bVar3;
          if (*(byte *)((int)piVar10 + 0x39) <= bVar3) {
            *(undefined *)((int)piVar10 + 0x3b) = 0;
          }
          *(undefined2 *)((int)piVar10 + 0x5e) = 0;
          iSNDcalcpitch(iVar11);
          iSNDplatformpitch(iVar11,(uint)*(ushort *)((int)piVar10 + 0x62));
        }
        bVar8 = false;
        if (piVar10[0x14] != 0) {
          bVar8 = true;
          bVar3 = *(char *)((int)piVar10 + 0x3a) + 1;
          *(byte *)((int)piVar10 + 0x3a) = bVar3;
          if (*(byte *)(piVar10 + 0xe) <= bVar3) {
            *(undefined *)((int)piVar10 + 0x3a) = 0;
          }
        }
        iVar7 = piVar10[5];
        if (iVar7 == 0) {
LAB_800ea3f0:
          if (piVar10[8] != 0) {
            bVar8 = true;
            piVar10[9] = piVar10[9] + piVar10[8];
          }
          iVar7 = piVar10[10];
          if (iVar7 == 0) {
            cVar4 = *(char *)((int)piVar10 + 0x31) + '\x01';
            *(char *)((int)piVar10 + 0x31) = cVar4;
            if ((int)*(char *)(piVar10 + 0xc) <= (int)cVar4) goto LAB_800ea444;
            piVar6 = (int *)(piVar10[0x10] + (int)cVar4 * 8);
            iVar7 = *piVar6;
            piVar10[10] = iVar7;
            if (iVar7 < 0) {
              piVar10[10] = 0x7fffffff;
            }
            iVar5 = piVar10[10];
            iVar7 = piVar6[1] * 0x10000 - piVar10[9];
            if (iVar5 == 0) {
              trap(0x1c00);
            }
            if ((iVar5 == -1) && (iVar7 == -0x80000000)) {
              trap(0x1800);
            }
            piVar10[8] = iVar7 / iVar5;
            iVar7 = piVar10[10];
          }
          piVar10[10] = iVar7 + -1;
          if ((bVar8) && (iSNDcalcvol(iVar11), -1 < *piVar10)) {
            iSNDvol(iVar11,(int)*(char *)((int)piVar10 + 0x2d));
          }
        }
        else {
          bVar8 = true;
          iVar5 = piVar10[7] + iVar7;
          piVar10[7] = iVar5;
          if (iVar7 < 0) {
            iVar7 = piVar10[6];
            bVar2 = iVar7 < iVar5;
          }
          else {
            iVar7 = piVar10[6];
            bVar2 = iVar5 < iVar7;
          }
          if (!bVar2) {
            piVar10[7] = iVar7;
            piVar10[5] = 0;
          }
          if (-1 < piVar10[7]) goto LAB_800ea3f0;
LAB_800ea444:
          SNDstop(*piVar10);
        }
      }
      iVar12 = iVar12 + 100;
      iVar11 = iVar11 + 1;
    } while (iVar11 < (int)(uint)DAT_80147871);
  }
  return;


}

void iSNDenteraudio(void)
{
  SNDI_mutexlock();
  DAT_8014789f = DAT_8014789f + '\x01';
  return;


}

void iSNDleaveaudio(void)
{
  DAT_8014789f = DAT_8014789f + -1;
  SNDI_mutexunlock();
  if (DAT_8014789f == '\0') {
    while (_DAT_80147912 != 0) {
      _DAT_80147912 = _DAT_80147912 + -1;
      iSNDserver();
    }
  }
  return;


}

void iSNDserveradd100hzclient(undefined4 uParm1)
{
  *(undefined4 *)(&DAT_801478ac + (int)DAT_801478a0 * 4) = uParm1;
  DAT_801478a0 = DAT_801478a0 + '\x01';
  return;


}

void iSNDserverremove100hzclient(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  if ('\0' < DAT_801478a0) {
    iVar1 = 0;
    while (*(int *)(&DAT_801478ac + iVar1) != iParm1) {
      iVar2 = iVar2 + 1;
      iVar1 = iVar2 * 4;
      if ((int)DAT_801478a0 <= iVar2) {
        return;
      }
    }
    DAT_801478a0 = DAT_801478a0 + -1;
    if (iVar2 < (int)DAT_801478a0) {
      do {
        iVar1 = iVar2 * 4;
        iVar2 = iVar2 + 1;
        *(undefined4 *)(&DAT_801478ac + iVar1) = *(undefined4 *)(&DAT_801478ac + iVar2 * 4);
      } while (iVar2 < (int)DAT_801478a0);
    }
  }
  return;


}

void synccallback(undefined4 uParm1,int iParm2,undefined4 *puParm3)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FILE_completeop();
  puParm3[8] = 0;
  if (iParm2 == 1) {
    puParm3[2] = puParm3[2] + iVar1;
    puParm3[4] = puParm3[4] + iVar1;
    puParm3[6] = puParm3[6] + iVar1;
    if (iVar1 < (int)puParm3[5]) {
      puParm3[3] = 0;
    }
    else {
      puParm3[3] = puParm3[3] - iVar1;
    }
    if ((int)puParm3[3] < 1) {
      return;
    }
    uVar2 = 0x2000;
    if ((int)puParm3[3] < 0x2001) {
      uVar2 = puParm3[3];
    }
    puParm3[5] = uVar2;
    iVar1 = (*(code *)puParm3[7])(puParm3[1],puParm3[2],puParm3[6],puParm3[5],*puParm3,puParm3);
    puParm3[8] = iVar1;
    if (iVar1 != 0) {
      FILE_callbackop(iVar1,synccallback);
      return;
    }
  }
  puParm3[3] = 0;
  return;


}

undefined4 syncblockio(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4,undefined4 param_5, code *param_6)
{
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  code *local_14;
  int local_10;
  
  local_30 = param_5;
  local_20 = 0;
  local_14 = param_6;
  local_1c = param_4;
  if (0x2000 < param_4) {
    local_1c = 0x2000;
  }
  local_2c = param_1;
  local_28 = param_2;
  local_24 = param_4;
  local_18 = param_3;
  local_10 = (*param_6)(param_1,param_2,param_3,local_1c,param_5,&local_30);
  if (local_10 != 0) {
    FILE_callbackop(local_10,synccallback);
    while ((local_24 != 0 || (local_10 != 0))) {
      FILE_waitop(local_10);
    }
  }
  return local_20;


}

uint FILE_opensync(void)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *in_a3;
  uint uVar4;
  
  uVar4 = 0;
  iVar1 = FILE_open();
  if (iVar1 == 0) {
    *in_a3 = 0;
  }
  else {
    FILE_waitop(iVar1);
    iVar2 = FILE_opstatus(iVar1);
    uVar4 = (uint)(iVar2 == 1);
    uVar3 = FILE_completeop(iVar1);
    *in_a3 = uVar3;
  }
  return uVar4;


}

void FILE_readsync(void)
{
  syncblockio();
  return;


}

undefined4 FILE_closesync(undefined4 uParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FILE_close(uParm1,uParm2,0);
  uVar2 = 0;
  if (iVar1 != 0) {
    FILE_waitop(iVar1);
    uVar2 = FILE_completeop(iVar1);
  }
  return uVar2;


}

undefined4 FILE_sizesync(undefined4 uParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FILE_size(uParm1,uParm2,0);
  uVar2 = 0;
  if (iVar1 != 0) {
    FILE_waitop(iVar1);
    uVar2 = FILE_completeop(iVar1);
  }
  return uVar2;


}

uint FILE_addbigsync(void)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *in_a3;
  uint uVar4;
  
  uVar4 = 0;
  iVar1 = FILE_addbig();
  if (iVar1 == 0) {
    *in_a3 = 0;
  }
  else {
    FILE_waitop(iVar1);
    iVar2 = FILE_opstatus(iVar1);
    uVar4 = (uint)(iVar2 == 1);
    uVar3 = FILE_completeop(iVar1);
    *in_a3 = uVar3;
  }
  return uVar4;


}

undefined4 FILE_delbigsync(undefined4 uParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FILE_delbig(uParm1,uParm2,0);
  uVar2 = 0;
  if (iVar1 != 0) {
    FILE_waitop(iVar1);
    uVar2 = FILE_completeop(iVar1);
  }
  return uVar2;


}

void * memcpy(void *__dest,void *__src,size_t __n)
{
  void *pvVar1;
  
                    
  pvVar1 = (void *)(*(code *)&LAB_000000a0)();
  return pvVar1;


}

int rand(void)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

void crossproduct(undefined4 *puParm1,undefined4 *puParm2,int *piParm3)
{
  int iVar1;
  int iVar2;
  
  iVar1 = fixedmult(puParm1[1],puParm2[2]);
  iVar2 = fixedmult(puParm1[2],puParm2[1]);
  *piParm3 = iVar1 - iVar2;
  iVar1 = fixedmult(*puParm1,puParm2[2]);
  iVar2 = fixedmult(puParm1[2],*puParm2);
  piParm3[1] = iVar2 - iVar1;
  iVar1 = fixedmult(*puParm1,puParm2[1]);
  iVar2 = fixedmult(puParm1[1],*puParm2);
  piParm3[2] = iVar1 - iVar2;
  return;


}

void SetGeomScreen(undefined4 uParm1)
{
  setCopControlWord(2,0xd000,uParm1);
  return;


}

void fixedxformx(undefined4 *puParm1,undefined4 uParm2)
{
  int local_10;
  undefined4 local_c;
  
  fixedsincos(uParm2,&local_10,&local_c);
  *puParm1 = 0x10000;
  puParm1[1] = 0;
  puParm1[2] = 0;
  puParm1[3] = 0;
  puParm1[6] = 0;
  puParm1[5] = local_10;
  puParm1[4] = local_c;
  puParm1[7] = -local_10;
  puParm1[8] = local_c;
  return;


}

void fixedxformy(undefined4 *puParm1,undefined4 uParm2)
{
  int local_10;
  undefined4 local_c;
  
  fixedsincos(uParm2,&local_10,&local_c);
  puParm1[1] = 0;
  puParm1[3] = 0;
  puParm1[4] = 0x10000;
  puParm1[5] = 0;
  puParm1[7] = 0;
  *puParm1 = local_c;
  puParm1[2] = -local_10;
  puParm1[6] = local_10;
  puParm1[8] = local_c;
  return;


}

void fixedxformz(undefined4 *puParm1,undefined4 uParm2)
{
  int local_10;
  undefined4 local_c;
  
  fixedsincos(uParm2,&local_10,&local_c);
  puParm1[2] = 0;
  puParm1[5] = 0;
  puParm1[6] = 0;
  puParm1[7] = 0;
  puParm1[8] = 0x10000;
  puParm1[1] = local_10;
  *puParm1 = local_c;
  puParm1[3] = -local_10;
  puParm1[4] = local_c;
  return;


}

uint intarcsin(uint uParm1)
{
  bool bVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  
  bVar1 = (int)uParm1 < 0;
  if (bVar1) {
    uParm1 = -uParm1;
  }
  iVar4 = (int)uParm1 >> 7;
  if ((int)uParm1 < 0xfa01) {
    if ((uParm1 & 0x40) != 0) {
      iVar4 = iVar4 + 1;
    }
    uVar3 = (uint)(byte)(&asintbl)[iVar4];
  }
  else {
    uVar3 = 0x100;
    if ((int)uParm1 < 0x10000) {
      if (iVar4 == 0x1ff) {
        bVar2 = 0xf6;
        uVar3 = 0x100;
      }
      else {
        bVar2 = (&asintbl)[iVar4];
        uVar3 = (uint)(byte)(&DAT_80137261)[iVar4];
      }
      uVar3 = (uint)bVar2 + ((int)((uVar3 - (uint)bVar2) * (uParm1 & 0x7f)) >> 7);
    }
  }
  if (bVar1) {
    uVar3 = -uVar3;
  }
  return uVar3;


}

int intarccos(void)
{
  int iVar1;
  
  iVar1 = intarcsin();
  return 0x100 - iVar1;


}

void intsincos(uint uParm1,int *piParm2,int *piParm3)
{
  int iVar1;
  uint uVar2;
  
  uVar2 = (int)uParm1 >> 8 & 3;
  uParm1 = uParm1 & 0xff;
  if (uVar2 == 1) {
    *piParm2 = *(int *)(&sintbl + (0x100 - uParm1) * 4);
LAB_800eae5c:
    *piParm3 = -*(int *)(&sintbl + uParm1 * 4);
    return;
  }
  if (uVar2 < 2) {
    if (uVar2 != 0) {
      return;
    }
    *piParm2 = *(int *)(&sintbl + uParm1 * 4);
    iVar1 = (0x100 - uParm1) * 4;
  }
  else {
    if (uVar2 == 2) {
      *piParm2 = -*(int *)(&sintbl + uParm1 * 4);
      uParm1 = 0x100 - uParm1;
      goto LAB_800eae5c;
    }
    if (uVar2 != 3) {
      return;
    }
    *piParm2 = -*(int *)(&sintbl + (0x100 - uParm1) * 4);
    iVar1 = uParm1 << 2;
  }
  *piParm3 = *(int *)(&sintbl + iVar1);
  return;


}

void transform(undefined4 *puParm1,undefined4 *puParm2,int *piParm3)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  iVar1 = fixedmult(*puParm1,*puParm2);
  iVar2 = fixedmult(puParm1[1],puParm2[3]);
  iVar3 = fixedmult(puParm1[2],puParm2[6]);
  iVar4 = fixedmult(*puParm1,puParm2[1]);
  iVar5 = fixedmult(puParm1[1],puParm2[4]);
  iVar6 = fixedmult(puParm1[2],puParm2[7]);
  iVar7 = fixedmult(*puParm1,puParm2[2]);
  iVar8 = fixedmult(puParm1[1],puParm2[5]);
  iVar9 = fixedmult(puParm1[2],puParm2[8]);
  *piParm3 = iVar1 + iVar2 + iVar3;
  piParm3[1] = iVar4 + iVar5 + iVar6;
  piParm3[2] = iVar7 + iVar8 + iVar9;
  return;


}

void addtimer(int iParm1)
{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = &tmrsub;
  do {
    iVar2 = iVar2 + 1;
    if (*piVar1 == iParm1) {
      return;
    }
    piVar1 = piVar1 + 1;
  } while (iVar2 < 8);
  iVar2 = 0;
  piVar1 = &tmrsub;
  do {
    iVar2 = iVar2 + 1;
    if (*piVar1 == 0) {
      *piVar1 = iParm1;
      return;
    }
    piVar1 = piVar1 + 1;
  } while (iVar2 < 8);
  return;


}

void deltimer(int iParm1)
{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = &tmrsub;
  do {
    iVar2 = iVar2 + 1;
    if (*piVar1 == iParm1) {
      *piVar1 = 0;
      return;
    }
    piVar1 = piVar1 + 1;
  } while (iVar2 < 8);
  return;


}

void initgp(void)
{
  DAT_801234e8 = (undefined *)register0x00000070;
  return;


}

void savegp(undefined4 uParm1)
{
  *(BADSPACEBASE **)uParm1 = register0x00000070;
  return;


}

void restoregp(void)
{
  return;


}

int fixedsqrt(uint uParm1)
{
  longlong lVar1;
  int *piVar2;
  int *piVar3;
  uint uVar4;
  uint uVar5;
  
  uVar4 = 0x80000000;
  if (uParm1 != 0) {
    piVar3 = (int *)&UNK_8012356c;
    do {
      piVar2 = piVar3;
      uVar5 = uParm1 & uVar4;
      piVar3 = piVar2 + -1;
      uVar4 = uVar4 >> 1;
    } while (uVar5 == 0);
    lVar1 = (longlong)(int)uParm1 * (longlong)*piVar3;
    return ((uint)lVar1 >> 0x10 | (int)((ulonglong)lVar1 >> 0x20) << 0x10) + piVar2[0x20];
  }
  return 0;


}

int atoi(char *__nptr)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

int locateshape(int iParm1,int *piParm2)
{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = *(int *)(iParm1 + 8);
  if (iVar2 != 0) {
    iVar3 = iVar2 * 8 + iParm1;
    do {
      iVar2 = iVar2 + -1;
      if (iVar2 == 0) break;
      piVar1 = (int *)(iVar3 + 8);
      iVar3 = iVar3 + -8;
    } while (*piVar1 != *piParm2);
    iVar2 = iVar2 * 8 + iParm1;
    if (*(int *)(iVar2 + 0x10) == *piParm2) {
      return iParm1 + *(int *)(iVar2 + 0x14);
    }
  }
  return 0;


}

int locateshapez(int iParm1,int *piParm2)
{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = *(int *)(iParm1 + 8);
  if (iVar2 != 0) {
    iVar3 = iVar2 * 8 + iParm1;
    do {
      iVar2 = iVar2 + -1;
      if (iVar2 == 0) break;
      piVar1 = (int *)(iVar3 + 8);
      iVar3 = iVar3 + -8;
    } while (*piVar1 != *piParm2);
    iVar2 = iVar2 * 8 + iParm1;
    if (*(int *)(iVar2 + 0x10) == *piParm2) {
      return iParm1 + *(int *)(iVar2 + 0x14);
    }
  }
  return 0;


}

int strncmp(char *__s1,char *__s2,size_t __n)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

void iSPCH_InitBanks(void)
{
  gVoxBanks = 0;
  gNumBanks = 0;
  return;


}

void iSPCH_DisposeBanks(void)
{
  if (gVoxBanks != 0) {
    iSPCH_MemFree();
  }
  gVoxBanks = 0;
  gNumBanks = 0;
  return;


}

undefined4 * iSPCH_BankMemAlloc(int iParm1)
{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  
  if (((gVoxBanks == (undefined4 *)0x0) &&
      (gNumBanks = iParm1, puVar3 = (undefined4 *)iSPCH_MemAlloc(iParm1 << 2,"spch banks"),
      iVar1 = gNumBanks, gVoxBanks = puVar3, puVar3 != (undefined4 *)0x0)) &&
     (iVar2 = 0, gVoxBanks = puVar3, 0 < gNumBanks)) {
    do {
      *puVar3 = 0;
      iVar2 = iVar2 + 1;
      puVar3 = puVar3 + 1;
    } while (iVar2 < iVar1);
  }
  return gVoxBanks;


}

int iSPCH_GetFreeBank(void)
{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = gVoxBanks;
  if (0 < gNumBanks) {
    do {
      if (*piVar2 == 0) {
        return iVar1;
      }
      iVar1 = iVar1 + 1;
      piVar2 = piVar2 + 1;
    } while (iVar1 < gNumBanks);
  }
  return 0xffffffff;


}

int iSPCH_FindBank(short sParm1)
{
  int iVar1;
  short **ppsVar2;
  
  if ((gVoxBanks != (short **)0x0) && (iVar1 = 0, ppsVar2 = gVoxBanks, 0 < gNumBanks)) {
    do {
      if ((*ppsVar2 != (short *)0x0) && (**ppsVar2 == sParm1)) {
        return iVar1;
      }
      iVar1 = iVar1 + 1;
      ppsVar2 = ppsVar2 + 1;
    } while (iVar1 < gNumBanks);
  }
  return 0xffffffff;


}

uint iSPCH_TestSubBankBounds(int iParm1,int iParm2)
{
  ushort uVar1;
  uint uVar2;
  
  uVar2 = 0;
  if ((((gVoxBanks != 0) && (-1 < iParm1)) &&
      (uVar1 = *(ushort *)(*(int *)(iParm1 * 4 + gVoxBanks) + 6), uVar1 != 0xffff)) && (-1 < iParm2)
     ) {
    uVar2 = (uint)(iParm2 < (int)(uint)uVar1);
  }
  return uVar2;


}

void iSPCH_SetCycleBits(int iParm1)
{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  pbVar3 = (byte *)iSPCH_GetBankBits();
  bVar1 = *pbVar3;
  uVar4 = (uint)bVar1;
  if (bVar1 != 0) {
    if (bVar1 == 0) {
      trap(0x1c00);
    }
    if ((uVar4 == 0xffffffff) && (_gGameNum == -0x80000000)) {
      trap(0x1800);
    }
    iVar7 = (_gGameNum % uVar4) * (uint)*(byte *)(iParm1 + 3);
    iVar8 = iVar7 / (int)uVar4;
    if (bVar1 == 0) {
      trap(0x1c00);
    }
    if ((uVar4 == 0xffffffff) && (iVar7 == -0x80000000)) {
      trap(0x1800);
    }
    iVar7 = (_gGameNum % uVar4 + 1) * (uint)*(byte *)(iParm1 + 3);
    if (bVar1 == 0) {
      trap(0x1c00);
    }
    if ((uVar4 == 0xffffffff) && (iVar7 == -0x80000000)) {
      trap(0x1800);
    }
    iVar6 = iVar7 / (int)uVar4 - iVar8;
    iVar7 = iVar8;
    if (iVar8 < 0) {
      iVar7 = iVar8 + 7;
    }
    iVar5 = (iVar7 >> 3) + 1;
    uVar4 = iVar8 + (iVar7 >> 3) * -8;
    iVar7 = 0;
    if (0 < iVar6) {
      do {
        uVar2 = uVar4 & 0x1f;
        uVar4 = uVar4 + 1;
        pbVar3[iVar5] = pbVar3[iVar5] | (byte)(1 << uVar2);
        if (uVar4 == 8) {
          uVar4 = 0;
          iVar5 = iVar5 + 1;
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 < iVar6);
    }
  }
  return;


}

int SPCH_AddBank(int iParm1)
{
  int iVar1;
  
  iVar1 = -1;
  if ((gVoxBanks != 0) && (iVar1 = iSPCH_GetFreeBank(), -1 < iVar1)) {
    if ((*(byte *)(iParm1 + 2) & 0xf0) != 0) {
      iSPCH_SetCycleBits(iParm1);
    }
    *(int *)(iVar1 * 4 + gVoxBanks) = iParm1;
  }
  return iVar1;


}

undefined4 iSPCH_MemAlloc(void)
{
  undefined4 uVar1;
  
  uVar1 = 0;
  if (gMemAlloc != (code *)0x0) {
    uVar1 = (*gMemAlloc)();
  }
  return uVar1;


}

void iSPCH_MemFree(void)
{
  if (gMemFree != (code *)0x0) {
    (*gMemFree)();
  }
  return;


}

void SPCH_Deinit(void)
{
  if (gSPCH_Initialized == 0x1789a34) {
    gSampleRequest = 0;
    gSentenceRuleTest = 0;
    gSPCH_Initialized = 0;
    gSentenceRuleSet = 0;
    iSPCH_DisposeBanks();
    iSPCH_InitEventDat();
  }
  return;


}

void iSPCH_InitInGame(void)
{
  _gVoxInGame = 0xffffffff;
  _DAT_8014805c = 0;
  return;


}

int SPCH_GetSampleDataRate(int iParm1,int iParm2,int iParm3)
{
  int iVar1;
  
  iParm1 = iParm1 * iParm2;
  if (iParm1 < 0) {
    iParm1 = iParm1 + 7;
  }
  iVar1 = iParm1 >> 3;
  if (iParm3 == 1) {
    iVar1 = (iVar1 / 10 + (iVar1 >> 0x1f)) - (iParm1 >> 0x1f);
  }
  else {
    if ((iParm3 != 0) && (iParm3 == 2)) {
      iVar1 = (iVar1 * 2) / 7;
    }
  }
  return iVar1;


}

undefined4 SPCH_InitBankMem(int iParm1,int iParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  
  uVar1 = 0;
  if (((gSPCH_Initialized == 0x1789a34) && (iParm1 != 0)) && (iParm2 != 0)) {
    gMemAlloc = iParm1;
    gMemFree = iParm2;
    uVar1 = iSPCH_BankMemAlloc(uParm3);
  }
  return uVar1;


}

undefined4 SPCH_Init(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  gMemAlloc = 0;
  gMemFree = 0;
  gSentenceRuleTest = 0;
  gSentenceRuleSet = 0;
  gSampleRequest = uParm1;
  _gGameNum = uParm2;
  _gDataRate = uParm3;
  iSPCH_EACseedrandom();
  iSPCH_ClearChosen();
  SPCH_SetPreLoadTicks(0);
  _gFilterSetting = 0;
  iSPCH_InitEventDat();
  iSPCH_InitInGame();
  iSPCH_InitBanks();
  iSPCH_InitEventQueue();
  gSPCH_Initialized = 0x1789a34;
  return 1;


}

undefined8 __floatsidf(uint uParm1)
{
  int iVar1;
  uint uVar2;
  undefined4 local_20;
  uint local_1c;
  
  uVar2 = 0;
  iVar1 = 0x41d;
  if (uParm1 == 0) {
    local_20 = 0;
    uVar2 = 0;
  }
  else {
    if ((int)uParm1 < 0) {
      uVar2 = 0x80000000;
      uParm1 = -uParm1;
    }
    while (local_1c = uParm1, (int)uParm1 < 0x1000000) {
      uParm1 = uParm1 << 4;
      iVar1 = iVar1 + -4;
    }
    while ((int)local_1c < 0x40000000) {
      local_1c = local_1c << 1;
      iVar1 = iVar1 + -1;
    }
    local_20 = 0;
    _dbl_shift_us(&local_20,1,0,local_1c,10);
    uVar2 = local_1c & 0xffefffff | uVar2 | iVar1 << 0x14;
  }
  return CONCAT44(local_20,uVar2);


}

undefined4 __ltdf2(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  uint uVar1;
  uint uVar2;
  
  if ((uParm2 == uParm4) && (uParm1 == uParm3)) {
    return 0;
  }
  if (((((uParm2 & 0x7fffffff) != 0) || (uParm1 != 0)) || ((uParm4 & 0x7fffffff) != 0)) ||
     (uParm3 != 0)) {
    if ((uParm2 & 0x80000000) != (uParm4 & 0x80000000)) {
      if ((uParm2 & 0x80000000) != 0) {
        return 0xffffffff;
      }
      return 0;
    }
    uVar2 = (int)uParm2 >> 0x14 & 0x7ff;
    uVar1 = (int)uParm4 >> 0x14 & 0x7ff;
    if (uVar2 < uVar1) {
LAB_800eb99c:
      if ((int)uParm2 < 0) {
        return 0;
      }
      return 0xffffffff;
    }
    if (uVar2 == uVar1) {
      uVar1 = uParm2 & 0xfffff | 0x100000;
      uVar2 = uParm4 & 0xfffff | 0x100000;
      if ((uVar1 < uVar2) || ((uVar1 == uVar2 && (uParm1 < uParm3)))) goto LAB_800eb99c;
    }
    if ((int)uParm2 < 0) {
      return 0xffffffff;
    }
  }
  return 0;


}

int iSPCH_EACrandom(void)
{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  
  uVar1 = DAT_80123608 + DAT_80123604;
  iVar5 = 0;
  if ((uVar1 < DAT_80123608) || (uVar1 < DAT_80123604)) {
    iVar5 = 1;
  }
  uVar2 = uVar1 + DAT_80123600 + iVar5;
  uVar3 = uVar2 + DAT_801235fc + (uint)(uVar2 < DAT_80123600);
  uVar4 = uVar3 + DAT_801235f8 + (uint)(uVar3 < DAT_801235fc);
  seedX = uVar4 + seedX + (uint)(uVar4 < DAT_801235f8);
  DAT_801235f8 = uVar4;
  DAT_801235fc = uVar3;
  DAT_80123600 = uVar2;
  DAT_80123604 = uVar1;
  if ((((DAT_80123608 + 1 == 0) &&
       (DAT_80123604 = uVar1 + 1, DAT_801235f8 = uVar4, DAT_801235fc = uVar3, DAT_80123600 = uVar2,
       DAT_80123604 == 0)) &&
      (DAT_80123600 = uVar2 + 1, DAT_801235f8 = uVar4, DAT_801235fc = uVar3, DAT_80123600 == 0)) &&
     ((DAT_801235fc = uVar3 + 1, DAT_801235f8 = uVar4, DAT_801235fc == 0 &&
      (DAT_801235f8 = uVar4 + 1, DAT_801235f8 == 0)))) {
    seedX = seedX + 1;
  }
  DAT_80123608 = DAT_80123608 + 1;
  return seedX;


}

void iSPCH_EACseedrandom(int iParm1)
{
  seedX = iParm1 + -0xdd2f1aa;
  DAT_801235f8 = iParm1 + -0x77ced917;
  DAT_801235fc = iParm1 + -0x39db22d1;
  DAT_80123600 = iParm1 + 0x702c49c;
  DAT_80123604 = iParm1 + -0x61cac083;
  DAT_80123608 = iParm1 + 0x6fdf3b64;
  return;


}

int iSPCH_Rand(int iParm1)
{
  uint uVar1;
  
  uVar1 = iSPCH_EACrandom();
  if (iParm1 == 0) {
    trap(0x1c00);
  }
  if ((iParm1 == -1) && ((uVar1 & 0xffff) == 0x80000000)) {
    trap(0x1800);
  }
  return (int)(uVar1 & 0xffff) % iParm1;


}

undefined4 iSPCH_BindData(ushort *puParm1)
{
  ushort **ppuVar1;
  int iVar2;
  
  if (0x11d < *puParm1) {
    iVar2 = 0;
    ppuVar1 = (ushort **)&gEventDats;
    do {
      iVar2 = iVar2 + 1;
      if (*ppuVar1 == (ushort *)0x0) {
        *ppuVar1 = puParm1;
        return 1;
      }
      ppuVar1 = ppuVar1 + 1;
    } while (iVar2 < 4);
  }
  return 0;


}

void SPCH_ResolveData(void)
{
  iSPCH_BindData();
  return;


}

undefined4 FILE_init(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  
  if (_gFileDevice == 0) {
    uVar1 = FILE_overhead(uParm1,uParm2,uParm3);
    uVar1 = reservememadr("File Sys",uVar1,0);
    uVar1 = FILE_initwithmem(uParm1,uParm2,uParm3,uVar1);
  }
  else {
    uVar1 = 0;
  }
  return uVar1;


}

undefined4 FILE_initwithmem(int iParm1,int iParm2,int iParm3,int iParm4)
{
  undefined4 uVar1;
  int iVar2;
  
  if (iParm1 == 0) {
    iParm1 = 0x18;
  }
  if (iParm2 == 0) {
    iParm2 = 0x800;
  }
  if (iParm3 == 0) {
    iParm3 = 10;
  }
  if (_gFileDevice == 0) {
    _DAT_8013ea90 = 0xff;
    _gFileDevice = iParm3;
    _DAT_8013ea8c = iParm1;
    _DAT_8013eaa0 = iParm4;
    uVar1 = FILE_overhead(iParm1,iParm2);
    blockclear(_DAT_8013eaa0,uVar1);
    _DAT_8013eaa4 = _DAT_8013eaa0 + _gFileDevice * 0x30;
    if (disablecd == 0) {
      iVar2 = CD_Init(_DAT_8013ea8c,iParm2,_DAT_8013eaa4 + _DAT_8013ea8c * 0x4c,
                      iFILE_CommandCompleteCallback);
      disablecd = (uint)(iVar2 == 0);
    }
    initfileio();
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;


}

int FILE_overhead(int iParm1,int iParm2,int iParm3)
{
  if (iParm1 == 0) {
    iParm1 = 0x18;
  }
  if (iParm2 == 0) {
    iParm2 = 0x800;
  }
  if (iParm3 == 0) {
    iParm3 = 10;
  }
  return iParm1 * 0x50 + iParm3 * 0x30 + iParm2 * 0x14;


}

uint FILE_opstatus(uint uParm1)
{
  uint uVar1;
  uint *puVar2;
  
  if ((uParm1 == 0) ||
     (puVar2 = (uint *)((uParm1 >> 0x18) * 0x30 + _DAT_8013eaa0),
     (uParm1 & 0xfffff) != (*puVar2 & 0xfffff))) {
    uVar1 = 0xfffffffd;
  }
  else {
    uVar1 = puVar2[2];
  }
  return uVar1;


}

undefined4 FILE_operror(uint uParm1)
{
  return *(undefined4 *)((uParm1 >> 0x18) * 0x30 + _DAT_8013eaa0 + 0xc);


}

void FILE_callbackop(uint uParm1,code *pcParm2)
{
  int iVar1;
  
  iVar1 = _DAT_8013eaa0 + (uParm1 >> 0x18) * 0x30;
  *(code **)(iVar1 + 0x28) = pcParm2;
  if (*(int *)(iVar1 + 8) != 0) {
    _DAT_8013ea98 = _DAT_8013ea98 + 1;
    (*pcParm2)(uParm1,*(undefined4 *)(iVar1 + 8),*(undefined4 *)(iVar1 + 0x14));
    _DAT_8013ea98 = _DAT_8013ea98 + -1;
  }
  return;


}

void FILE_priorityop(uint uParm1,int iParm2)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = _DAT_8013eaa0 + (uParm1 >> 0x18) * 0x30;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar3 = *(int *)(iVar5 + 0x10);
  *(int *)(iVar5 + 0x10) = iParm2;
  iVar4 = _DAT_8013eaa8;
  if ((((1 < _DAT_8013ea94) && (iVar4 = _DAT_8013eaa8, iVar5 != _DAT_8013ea9c)) &&
      (iVar4 = _DAT_8013eaa8, *(int *)(iVar5 + 8) == 0)) && (iVar4 = _DAT_8013eaa8, iVar3 != iParm2)
     ) {
    iVar4 = 0;
    iVar3 = _DAT_8013eaa8;
    while ((iVar3 != 0 && (iVar3 != iVar5))) {
      iVar4 = iVar3;
      iVar3 = *(int *)(iVar3 + 0x2c);
    }
    if (iVar4 == 0) {
      _DAT_8013eaa8 = *(int *)(iVar5 + 0x2c);
    }
    else {
      *(undefined4 *)(iVar4 + 0x2c) = *(undefined4 *)(iVar5 + 0x2c);
    }
    bVar1 = _DAT_8013eaa8 != 0;
    *(int *)(iVar5 + 0x2c) = _DAT_8013eaa8;
    iVar3 = 0;
    if (bVar1) {
      iVar3 = 0;
      do {
        iVar4 = *(int *)(iVar5 + 0x2c);
        if (*(int *)(iVar5 + 0x10) < *(int *)(iVar4 + 0x10)) break;
        iVar2 = *(int *)(iVar4 + 0x2c);
        *(int *)(iVar5 + 0x2c) = iVar2;
        iVar3 = iVar4;
      } while (iVar2 != 0);
    }
    iVar4 = iVar5;
    if (iVar3 != 0) {
      *(int *)(iVar3 + 0x2c) = iVar5;
      iVar4 = _DAT_8013eaa8;
    }
  }
  _DAT_8013eaa8 = iVar4;
  setCopReg(0,Status,Status,0);
  return;


}

void FILE_cancelop(uint uParm1)
{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  int iVar6;
  uint *puVar7;
  
  uVar1 = Status;
  iVar6 = 0;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (uParm1 != 0) {
    puVar7 = (uint *)((uParm1 >> 0x18) * 0x30 + _DAT_8013eaa0);
    if ((((uParm1 & 0xfffff) == (*puVar7 & 0xfffff)) && (uVar4 = uParm1 >> 0x14 & 0xf, uVar4 != 3))
       && (uVar4 != 10)) {
      if (_DAT_8013ea9c == puVar7) {
        puVar7[1] = 1;
        iVar6 = 1;
      }
      else {
        if (puVar7[2] != 1) {
          puVar3 = _DAT_8013eaa8;
          puVar5 = (uint *)0x0;
          if (_DAT_8013eaa8 == (uint *)0x0) {
LAB_800ec0f4:
            setCopReg(0,Status,Status,0);
            return;
          }
          do {
            puVar2 = puVar3;
            puVar3 = puVar2;
            if (puVar2 == puVar7) break;
            puVar3 = (uint *)puVar2[0xb];
            puVar5 = puVar2;
          } while (puVar3 != (uint *)0x0);
          if (puVar3 == (uint *)0x0) goto LAB_800ec0f4;
          if (puVar5 == (uint *)0x0) {
            _DAT_8013eaa8 = (uint *)puVar7[0xb];
          }
          else {
            puVar5[0xb] = puVar7[0xb];
          }
          iVar6 = 2;
          _DAT_8013ea94 = _DAT_8013ea94 + -1;
        }
        puVar7[2] = 0xffffffff;
      }
      if ((iVar6 == 1) && ((*puVar7 >> 0x14 & 0xf) == 4)) {
        stopreadfile(*(undefined4 *)puVar7[9]);
      }
      else {
        if ((iVar6 == 2) && ((code *)puVar7[10] != (code *)0x0)) {
          (*(code *)puVar7[10])(*puVar7,0xffffffff,puVar7[5]);
        }
      }
    }
  }
  setCopReg(0,Status,uVar1,0);
  return;


}

uint FILE_waitop(uint uParm1)
{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  
  iVar2 = (uParm1 >> 0x18) * 0x30;
  puVar3 = (uint *)(_DAT_8013eaa0 + iVar2);
  if (uParm1 == 0) {
LAB_800ec270:
    uVar1 = 0xfffffffd;
  }
  else {
    uVar1 = 0xfffffffd;
    if ((uParm1 & 0xfffff) == (*puVar3 & 0xfffff)) {
      uVar1 = puVar3[2];
      while (uVar1 == 0) {
        systemtask(0);
        if (uParm1 == 0) {
          return 0xfffffffd;
        }
        if ((uParm1 & 0xfffff) != (*(uint *)(iVar2 + _DAT_8013eaa0) & 0xfffff)) goto LAB_800ec270;
        uVar1 = puVar3[2];
      }
      uVar1 = puVar3[2];
    }
  }
  return uVar1;


}

uint FILE_completeop(uint uParm1)
{
  uint *puVar1;
  uint uVar2;
  
  puVar1 = (uint *)(_DAT_8013eaa0 + (uParm1 >> 0x18) * 0x30);
  uVar2 = 0;
  if (puVar1[2] == 1) {
    switch(*puVar1 >> 0x14 & 0xf) {
    case 2:
    case 9:
      uVar2 = puVar1[9];
      break;
    case 3:
    case 7:
    case 10:
      uVar2 = puVar1[2];
      break;
    case 4:
    case 5:
      uVar2 = puVar1[7];
      break;
    case 6:
    case 8:
      uVar2 = puVar1[6];
    }
  }
  freeop(puVar1);
  return uVar2;


}

uint FILE_open(char *pcParm1,uint uParm2,uint uParm3,uint uParm4)
{
  uint *puVar1;
  uint uVar2;
  
  puVar1 = (uint *)reserveop();
  puVar1[5] = uParm4;
  puVar1[6] = uParm2;
  puVar1[4] = uParm3;
  *puVar1 = *puVar1 & 0xff0fffff | 0x200000;
  uVar2 = reservehandle();
  puVar1[9] = uVar2;
  if (uVar2 == 0) {
    puVar1[3] = 2;
    iFILE_perror(puVar1);
  }
  strlen(pcParm1);
  strncpy((char *)(puVar1[9] + 0xc),pcParm1,0x40);
  iFILE_ExecCommand(puVar1);
  return *puVar1;


}

uint FILE_close(uint uParm1,uint uParm2,uint uParm3)
{
  uint *puVar1;
  int iVar2;
  
  puVar1 = (uint *)reserveop();
  iVar2 = _DAT_8013eaac;
  puVar1[4] = uParm2;
  puVar1[5] = uParm3;
  puVar1[9] = uParm1;
  *puVar1 = *puVar1 & 0xff0fffff | 0x300000;
  do {
    if (iVar2 == 0) {
LAB_800ec4c4:
      iFILE_ExecCommand(puVar1);
      return *puVar1;
    }
    if (*(uint *)(iVar2 + 4) == uParm1) {
      puVar1[3] = 3;
      iFILE_perror(puVar1);
      goto LAB_800ec4c4;
    }
    iVar2 = *(int *)(iVar2 + 0xc);
  } while( true );


}

uint FILE_read(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5,uint param_6)
{
  uint *puVar1;
  
  puVar1 = (uint *)reserveop();
  *puVar1 = *puVar1 & 0xff0fffff | 0x400000;
  puVar1[5] = param_6;
  puVar1[4] = param_5;
  if (param_1 == 0) {
    puVar1[3] = 6;
    iFILE_perror(puVar1);
  }
  puVar1[9] = param_1;
  if ((*(int *)(param_1 + 4) < (int)(param_2 + param_4)) &&
     (param_4 = *(int *)(param_1 + 4) - param_2, (int)param_4 < 0)) {
    param_4 = 0;
  }
  puVar1[7] = param_4;
  puVar1[8] = param_3;
  puVar1[6] = param_2;
  iFILE_ExecCommand(puVar1);
  return *puVar1;


}

uint FILE_size(uint uParm1,uint uParm2,uint uParm3)
{
  uint *puVar1;
  
  puVar1 = (uint *)reserveop();
  puVar1[5] = uParm3;
  puVar1[4] = uParm2;
  *puVar1 = *puVar1 & 0xff0fffff | 0x600000;
  if (uParm1 == 0) {
    puVar1[3] = 6;
    iFILE_perror(puVar1);
  }
  puVar1[9] = uParm1;
  iFILE_ExecCommand(puVar1);
  return *puVar1;


}

void iFILE_addbigreadcallback(uint uParm1,undefined4 uParm2,int *piParm3)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  
  iVar2 = _DAT_8013eaa0 + (uParm1 >> 0x18) * 0x30;
  iVar1 = *(int *)(iVar2 + 0x24);
  uVar3 = *(undefined4 *)(iVar2 + 0x10);
  piParm3[1] = iVar1;
  *(int *)(piParm3[2] + 0x24) = iVar1;
  FILE_completeop();
  iVar1 = typeofbigfile(*piParm3);
  if (iVar1 == 0) {
    purgememadr(*piParm3);
  }
  iVar1 = sizeofbigfileheader(*piParm3);
  iVar2 = getblocksize(*piParm3);
  if (iVar2 < iVar1) {
    iVar2 = reservememadr("bigfile buf",iVar1,0x10);
    blockmove(*piParm3,iVar2,0x800);
    purgememadr(*piParm3);
    *piParm3 = iVar2;
    uVar3 = FILE_read(piParm3[1],0x800,iVar2 + 0x800,iVar1 + -0x800,uVar3,piParm3);
    FILE_callbackop(uVar3,iFILE_addbigreadcallback);
  }
  else {
    *(int **)(piParm3 + 3) = _DAT_8013eaac;
    _DAT_8013eaac = piParm3;
    iFILE_ExecCommand(piParm3[2]);
  }
  return;


}

void iFILE_addbigopencallback(uint uParm1,int iParm2,undefined4 *puParm3)
{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar2 = *(undefined4 *)((uParm1 >> 0x18) * 0x30 + _DAT_8013eaa0 + 0x10);
  uVar1 = FILE_completeop();
  if (iParm2 == 1) {
    uVar1 = FILE_read(uVar1,0,*puParm3,0x800,uVar2,puParm3);
    FILE_callbackop(uVar1,iFILE_addbigreadcallback);
  }
  else {
    *(undefined4 *)(puParm3[2] + 0xc) = 4;
    iFILE_ExecCommand(puParm3[2]);
  }
  return;


}

uint * FILE_addbig(char *pcParm1,undefined4 uParm2,uint uParm3,uint uParm4)
{
  uint *puVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int iVar5;
  
  iVar5 = _DAT_8013eaac;
  puVar1 = (uint *)reserveop();
  puVar1[5] = uParm4;
  puVar1[4] = uParm3;
  *puVar1 = *puVar1 & 0xff0fffff | 0x900000;
  iscurrentthread(0);
  if (iVar5 != 0) {
    do {
      iVar2 = strncmp(pcParm1,(char *)(*(int *)(iVar5 + 4) + 0xc),0x40);
      if (iVar2 == 0) {
        puVar1[9] = *(uint *)(iVar5 + 4);
        iFILE_ExecCommand(puVar1);
        return puVar1;
      }
      iVar5 = *(int *)(iVar5 + 0xc);
    } while (iVar5 != 0);
  }
  puVar3 = (undefined4 *)reservememadr(pcParm1,0x10,uParm2);
  *(uint **)(puVar3 + 2) = puVar1;
  uVar4 = reservememadr("bigfile header",0x800,0x10);
  *puVar3 = uVar4;
  uVar4 = FILE_open(pcParm1,1,uParm3,puVar3);
  FILE_callbackop(uVar4,iFILE_addbigopencallback);
  return (uint *)*puVar1;


}

void iFILE_delbigclosecallback(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  FILE_completeop();
  iFILE_ExecCommand(uParm3);
  return;


}

uint FILE_delbig(int iParm1,uint uParm2,uint uParm3)
{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  
  puVar6 = _DAT_8013eaac;
  puVar1 = (uint *)reserveop();
  piVar3 = _DAT_8013eaa4;
  puVar1[5] = uParm3;
  puVar1[4] = uParm2;
  *puVar1 = *puVar1 & 0xff0fffff | 0xa00000;
  puVar4 = (undefined4 *)0x0;
  if (*(int *)(iParm1 + 8) != 0) {
    puVar1[3] = 1;
  }
  iVar2 = 0;
  if (0 < _DAT_8013ea8c) {
    do {
      if (((piVar3 != (int *)0x0) && (piVar3[2] != 0)) && (*(int *)(*piVar3 + 4) == iParm1)) {
        puVar1[2] = 0xfffffffe;
        puVar1[3] = 1;
        break;
      }
      iVar2 = iVar2 + 1;
      piVar3 = piVar3 + 0x13;
    } while (iVar2 < _DAT_8013ea8c);
  }
  uVar7 = puVar6[1];
  puVar5 = puVar6;
  if (puVar6 != (undefined4 *)0x0) {
    do {
      puVar6 = puVar5;
      if (puVar5[1] == iParm1) break;
      puVar6 = (undefined4 *)puVar5[3];
      puVar4 = puVar5;
      puVar5 = puVar6;
    } while (puVar6 != (undefined4 *)0x0);
    if (puVar6 != (undefined4 *)0x0) goto LAB_800ecabc;
  }
  puVar1[3] = 1;
LAB_800ecabc:
  if (puVar4 == (undefined4 *)0x0) {
    _DAT_8013eaac = (undefined4 *)0x0;
  }
  else {
    puVar4[3] = puVar6[3];
  }
  purgememadr(*puVar6);
  purgememadr(puVar6);
  uVar7 = FILE_close(uVar7,uParm2,puVar1);
  FILE_callbackop(uVar7,iFILE_delbigclosecallback);
  return *puVar1;


}

undefined4 FILE_atomic(code *pcParm1,undefined4 uParm2,undefined4 uParm3,undefined4 uParm4)
{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar1 = _DAT_8013ea90;
  _DAT_8013ea90 = uParm3;
  uVar2 = (*pcParm1)(uParm3,uParm4);
  _DAT_8013ea90 = uVar1;
  iFILE_ExecCommand(0);
  return uVar2;


}

void iFILE_ExecCommand(uint *puParm1,uint uParm2)
{
  bool bVar1;
  uint uVar2;
  char *__src;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  uint uVar6;
  uint uVar7;
  undefined4 *puVar8;
  uint *puVar9;
  undefined4 *local_a8;
  char local_a0 [64];
  char local_60 [64];
  undefined4 local_20;
  undefined4 local_1c;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (puParm1 != (uint *)0x0) {
    bVar1 = _DAT_8013eaa8 != (uint *)0x0;
    *(uint **)(puParm1 + 0xb) = _DAT_8013eaa8;
    uVar7 = 0;
    if (bVar1) {
      uParm2 = puParm1[4];
      uVar7 = 0;
      do {
        uVar6 = puParm1[0xb];
        if ((int)uParm2 < *(int *)(uVar6 + 0x10)) break;
        uVar2 = *(uint *)(uVar6 + 0x2c);
        puParm1[0xb] = uVar2;
        uVar7 = uVar6;
      } while (uVar2 != 0);
    }
    puVar9 = puParm1;
    if (uVar7 != 0) {
      *(uint **)(uVar7 + 0x2c) = puParm1;
      puVar9 = _DAT_8013eaa8;
    }
    _DAT_8013eaa8 = puVar9;
    _DAT_8013ea94 = _DAT_8013ea94 + 1;
  }
  if (_DAT_8013ea9c != (uint *)0x0) {
    setCopReg(0,Status,Status,0);
    return;
  }
  if ((_DAT_8013eaa8 == (uint *)0x0) || (_DAT_8013ea90 < (int)_DAT_8013eaa8[4])) {
    puVar9 = (uint *)0x0;
  }
  else {
    _DAT_8013ea94 = _DAT_8013ea94 + -1;
    puVar9 = _DAT_8013eaa8;
    _DAT_8013eaa8 = (uint *)_DAT_8013eaa8[0xb];
  }
  setCopReg(0,Status,Status,0);
  if (puVar9 == (uint *)0x0) {
    _DAT_8013ea9c = puVar9;
    return;
  }
  _DAT_8013ea9c = puVar9;
  switch(*puVar9 >> 0x14 & 0xf) {
  case 2:
  case 8:
    local_60[0] = '\0';
    _DAT_8013ea9c = puVar9;
    __src = strchr((char *)(puVar9[9] + 0xc),0x7c);
    if (__src == (char *)0x0) {
      uVar6 = 0;
      bVar1 = true;
      if ((puVar9[6] & 1) != 0) {
        uVar6 = 3;
        bVar1 = true;
        __src = (char *)(puVar9[9] + 0xc);
        goto LAB_800ecdb4;
      }
    }
    else {
      uVar7 = puVar9[9];
      uVar6 = 2;
      if (*(char *)(uVar7 + 0xc) != '|') {
        __src = strchr((char *)(uVar7 + 0xc),0x7c);
        uVar7 = puVar9[9];
        uVar6 = 4;
        local_a0[0] = '\0';
        strncpy(local_a0,(char *)(puVar9[9] + 0xc),(size_t)(__src + (-0xc - uVar7)));
        local_a0[(int)(__src + (-0xc - uVar7))] = '\0';
        uVar7 = puVar9[9];
      }
      bVar1 = false;
      __src = strchr((char *)(uVar7 + 0xc),0x7c);
      __src = __src + 1;
LAB_800ecdb4:
      strcpy(local_60,__src);
    }
    uVar7 = 0;
    if ((bVar1) && (iVar3 = openfile(puVar9[9] + 0xc,puVar9[6]), iVar3 != 0)) {
      uVar7 = 1;
      if ((*puVar9 >> 0x14 & 0xf) == 8) {
        closefile(*(undefined4 *)puVar9[9]);
      }
      else {
        uVar4 = getfilesize(*(undefined4 *)puVar9[9]);
        *(undefined4 *)(puVar9[9] + 4) = uVar4;
      }
    }
    if (((uVar7 == 0) && ((uVar6 & 6) != 0)) &&
       (puVar8 = _DAT_8013eaac, _DAT_8013eaac != (undefined4 *)0x0)) {
      do {
        if (((uVar6 & 4) == 0) || (iVar3 = strcmp((char *)(puVar8[1] + 0xc),local_a0), iVar3 == 0))
        {
          local_a8 = &local_1c;
          iVar3 = locatebigentryz(*puVar8,local_60,0,&local_20);
          if (iVar3 != 0) {
            *(undefined4 **)puVar9[9] = puVar8;
            *(undefined4 *)(puVar9[9] + 4) = local_1c;
            uVar7 = 1;
            *(undefined4 *)(puVar9[9] + 8) = local_20;
          }
        }
        puVar8 = (undefined4 *)puVar8[3];
      } while ((puVar8 != (undefined4 *)0x0) && (uVar7 == 0));
    }
    if ((*puVar9 >> 0x14 & 0xf) == 8) {
      freehandle(puVar9[9]);
      puVar9[6] = uVar7;
    }
    break;
  case 3:
    puVar8 = (undefined4 *)puVar9[9];
    _DAT_8013ea9c = puVar9;
    puVar9[3] = 0;
    if (puVar8 != (undefined4 *)0x0) {
      if (puVar8[2] == 0) {
        uVar7 = closefile(*puVar8,uParm2,Status);
        puVar9[3] = uVar7;
      }
      freehandle(puVar9[9]);
      puVar9[9] = 0;
    }
  case 7:
  case 9:
  case 10:
    uVar7 = (uint)(puVar9[3] == 0);
    break;
  case 4:
    uVar7 = 1;
    _DAT_8013ea9c = puVar9;
    if (0 < (int)puVar9[7]) {
      piVar5 = (int *)puVar9[9];
      if (piVar5[2] != 0) {
        _DAT_8013ea9c = puVar9;
        readfile(**(undefined4 **)(*piVar5 + 4),puVar9[8],piVar5[2] + puVar9[6]);
        return;
      }
      _DAT_8013ea9c = puVar9;
      readfile(*piVar5,puVar9[8],puVar9[6]);
      return;
    }
    break;
  case 5:
    _DAT_8013ea9c = puVar9;
    writefile(*(undefined4 *)puVar9[9],puVar9[8],puVar9[6],puVar9[7]);
    return;
  case 6:
    uVar7 = 1;
    _DAT_8013ea9c = puVar9;
    puVar9[6] = *(uint *)(puVar9[9] + 4);
    break;
  default:
    goto switchD_800eccfc_caseD_9;
  }
  iFILE_CommandCompleteCallback(uVar7);
switchD_800eccfc_caseD_9:
  return;


}

void iFILE_CommandCompleteCallback(int iParm1)
{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  puVar1 = _DAT_8013ea9c;
  if (_DAT_8013ea9c != (undefined4 *)0x0) {
    uVar2 = 0xffffffff;
    if ((_DAT_8013ea9c[1] == 0) && (uVar2 = 0xfffffffe, iParm1 != 0)) {
      uVar2 = 1;
    }
    _DAT_8013ea9c[2] = uVar2;
    _DAT_8013ea9c = (undefined4 *)0x0;
    if (puVar1[10] != 0) {
      _DAT_8013ea98 = _DAT_8013ea98 + 1;
      (*(code *)puVar1[10])(*puVar1,puVar1[2],puVar1[5]);
      _DAT_8013ea98 = _DAT_8013ea98 + -1;
    }
    if (_DAT_8013ea98 == 0) {
      iFILE_ExecCommand(0);
    }
  }
  return;


}

void iFILE_perror(void)
{
  return;


}

int reserveop(void)
{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar3 = 0;
  if (0 < _gFileDevice) {
    iVar2 = 0;
    do {
      uVar1 = *(uint *)(iVar2 + _DAT_8013eaa0);
      if ((uVar1 >> 0x14 & 0xf) == 0) {
        *(uint *)(iVar2 + _DAT_8013eaa0) = uVar1 & 0xff0fffff | 0x100000;
        *(undefined *)(iVar2 + _DAT_8013eaa0 + 3) = (char)iVar3;
        uVar1 = uGp00001704 & 0xfffff;
        uGp00001704 = uGp00001704 + 1;
        *(uint *)(iVar2 + _DAT_8013eaa0) = *(uint *)(iVar2 + _DAT_8013eaa0) & 0xfff00000 | uVar1;
        if (0xfffff < (int)uGp00001704) {
          uGp00001704 = 0;
        }
        break;
      }
      iVar3 = iVar3 + 1;
      iVar2 = iVar2 + 0x30;
    } while (iVar3 < _gFileDevice);
  }
  setCopReg(0,Status,Status,0);
  if (iVar3 != _gFileDevice) {
    return _DAT_8013eaa0 + iVar3 * 0x30;
  }
  return 0;


}

void freeop(undefined4 uParm1)
{
  uint uVar1;
  
  uVar1 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  blockclear(uParm1,0x30);
  setCopReg(0,Status,uVar1,0);
  return;


}

int * reservehandle(void)
{
  int iVar1;
  int *piVar2;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar1 = 0;
  piVar2 = _DAT_8013eaa4;
  if (0 < _DAT_8013ea8c) {
    do {
      if (*piVar2 == 0) {
        *piVar2 = 1;
        break;
      }
      iVar1 = iVar1 + 1;
      piVar2 = piVar2 + 0x13;
    } while (iVar1 < _DAT_8013ea8c);
  }
  setCopReg(0,Status,Status,0);
  if (iVar1 == _DAT_8013ea8c) {
    return (int *)0;
  }
  return _DAT_8013eaa4 + iVar1 * 0x13;


}

void freehandle(undefined4 uParm1)
{
  uint uVar1;
  
  uVar1 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  blockclear(uParm1,0x4c);
  setCopReg(0,Status,uVar1,0);
  return;


}

int SNDtimeremaining(undefined4 uParm1)
{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 local_18 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar2 = iSNDgetchan(uParm1);
    if (iVar2 < 0) {
      iSNDleaveaudio();
      iVar1 = -8;
    }
    else {
      local_18[0] = 0xffffffff;
      iVar1 = -0x400;
      while (iVar3 = iSNDpatchkey(iVar2,local_18), iVar3 != 0) {
        iVar3 = iSNDtimeremaining(local_18[0]);
        if (iVar1 < iVar3) {
          iVar1 = iVar3;
        }
      }
      iSNDleaveaudio();
    }
  }
  return iVar1;


}

int rinverse(uint uParm1)
{
  uint uVar1;
  uint uVar2;
  
  uVar2 = (int)uParm1 >> 0x1f;
  uVar1 = (uParm1 ^ uVar2) - uVar2;
  return (0xffffffff / uVar1 + (uint)((uint)((int)uVar1 >> 1) < 0xffffffffU % uVar1) ^ uVar2) -
         uVar2;


}

int fixedsin(uint uParm1)
{
  int iVar1;
  int iVar2;
  
  iVar1 = fastintsin((int)uParm1 >> 6);
  iVar2 = fastintcos((int)uParm1 >> 6);
  return iVar1 + ((iVar2 >> 2) * ((int)((uParm1 & 0x3f) * 0x6487e) >> 9) >> 0x15);


}

int fixedcos(uint uParm1)
{
  int iVar1;
  int iVar2;
  
  iVar1 = fastintcos((int)uParm1 >> 6);
  iVar2 = fastintsin((int)uParm1 >> 6);
  return iVar1 + ((-iVar2 >> 2) * ((int)((uParm1 & 0x3f) * 0x6487e) >> 9) >> 0x15);


}

int fixedatan(int iParm1,int iParm2)
{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined4 local_18;
  undefined4 local_14;
  
  uVar3 = 0;
  if (iParm2 < 0) {
    uVar3 = 2;
    iParm2 = -iParm2;
  }
  if (iParm1 < 0) {
    uVar3 = uVar3 | 4;
    iParm1 = -iParm1;
  }
  if (iParm1 == iParm2) {
    iVar2 = 0x2000;
  }
  else {
    iVar2 = iParm1;
    if (iParm2 < iParm1) {
      uVar3 = uVar3 | 1;
      iVar2 = iParm2;
      iParm2 = iParm1;
    }
    make64(&local_18,iVar2,0x20);
    uVar1 = divu64(local_18,local_14,iParm2);
    iVar2 = *(int *)(&fatantbl + (uVar1 >> 0x18) * 4) +
            ((*(int *)(&fatantbl + ((uVar1 >> 0x18) + 1) * 4) -
             *(int *)(&fatantbl + (uVar1 >> 0x18) * 4)) * (uVar1 >> 8 & 0xffff) >> 0x10);
  }
  if (true) {
    switch(uVar3) {
    case 1:
      iVar2 = 0x4000 - iVar2;
      break;
    case 2:
      iVar2 = 0x8000 - iVar2;
      break;
    case 3:
      iVar2 = iVar2 + 0x4000;
      break;
    case 4:
      iVar2 = -iVar2;
      break;
    case 5:
      iVar2 = iVar2 + -0x4000;
      break;
    case 6:
      iVar2 = iVar2 + -0x8000;
      break;
    case 7:
      iVar2 = -0x4000 - iVar2;
    }
  }
  return iVar2;


}

uint ResetGraph(uint uParm1)
{
  uint uVar1;
  
  uVar1 = uParm1 & 7;
  if (uVar1 == 3) {
LAB_800ed6bc:
    printf("ResetGraph:jtb=%08x,env=%08x\n",&PTR_s__Id__sys_c_v_1_140_1998_01_12_07_80123654,&GEnv);
LAB_800ed6d8:
    FUN_800efe34(&GEnv,0,0x80);
    ResetCallback();
    GPU_cw(0x123654);
    GEnv = FUN_800ef86c(uParm1);
    DAT_8012369d = 1;
    DAT_801236a0 = *(undefined2 *)(&DAT_8012371c + (uint)GEnv * 4);
    DAT_801236a2 = *(undefined2 *)(&DAT_80123728 + (uint)GEnv * 4);
    FUN_800efe34(&DAT_801236ac,0xffffffff,0x5c);
    FUN_800efe34(&DAT_80123708,0xffffffff,0x14);
    uVar1 = (uint)GEnv;
  }
  else {
    if (uVar1 < 4) {
      if (uVar1 == 0) goto LAB_800ed6bc;
    }
    else {
      if (uVar1 == 5) goto LAB_800ed6d8;
    }
    if (false) {
      printf("ResetGraph(%d)...\n",uParm1);
    }
    uVar1 = FUN_800ef86c(1);
  }
  return uVar1;


}

void SetDispMask(int iParm1)
{
  undefined4 uVar1;
  
  if (false) {
    printf("SetDispMask(%d)...\n",iParm1);
  }
  if (iParm1 == 0) {
    FUN_800efe34(&DAT_80123708,0xffffffff,0x14);
  }
  uVar1 = 0x3000001;
  if (iParm1 != 0) {
    uVar1 = 0x3000000;
  }
  FUN_800ef248(uVar1);
  return;


}

void DrawSync(undefined4 uParm1)
{
  if (false) {
    printf("DrawSync(%d)...\n",uParm1);
  }
  FUN_800ef9bc(uParm1);
  return;


}

void FUN_800ed8e4(undefined4 uParm1,short *psParm2)
{
  int iVar1;
  char *__format;
  int iVar2;
  
  if (false) {
    iVar2 = (int)psParm2[2];
    if ((iVar2 <= (int)DAT_801236a0) && (iVar2 + (int)*psParm2 <= (int)DAT_801236a0)) {
      iVar1 = (int)psParm2[1];
      if (((iVar1 <= (int)DAT_801236a2) &&
          (((iVar1 + (int)psParm2[3] <= (int)DAT_801236a2 && (0 < iVar2)) && (-1 < (int)*psParm2))))
         && ((-1 < iVar1 && (0 < (int)psParm2[3])))) {
        return;
      }
    }
    __format = "%s:bad RECT";
  }
  else {
    if (true) {
      return;
    }
    __format = "%s:";
  }
  printf(__format,uParm1);
  printf("(%d,%d)-(%d,%d)\n",(int)*psParm2,(int)psParm2[1],(int)psParm2[2],(int)psParm2[3]);
  return;


}

void ClearImage(undefined4 uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  FUN_800ed8e4("ClearImage",uParm1);
  FUN_800ef35c(FUN_800eeb5c,uParm1,8,(uParm4 & 0xff) << 0x10 | (uParm3 & 0xff) << 8 | uParm2 & 0xff)
  ;
  return;


}

void LoadImage(undefined4 uParm1,undefined4 uParm2)
{
  FUN_800ed8e4("LoadImage",uParm1);
  FUN_800ef35c(FUN_800eed8c,uParm1,8,uParm2);
  return;


}

void StoreImage(undefined4 uParm1,undefined4 uParm2)
{
  FUN_800ed8e4("StoreImage",uParm1);
  FUN_800ef35c(FUN_800eefc8,uParm1,8,uParm2);
  return;


}

undefined4 MoveImage(undefined4 *puParm1,uint uParm2,int iParm3)
{
  undefined4 uVar1;
  
  FUN_800ed8e4("MoveImage",puParm1);
  uVar1 = 0xffffffff;
  if (*(short *)(puParm1 + 1) != 0) {
    if (*(short *)((int)puParm1 + 6) == 0) {
      uVar1 = 0xffffffff;
    }
    else {
      DAT_80123740 = iParm3 << 0x10 | uParm2 & 0xffff;
      DAT_8012373c = *puParm1;
      DAT_80123744 = puParm1[1];
      uVar1 = FUN_800ef35c(FUN_800ef2c0,&DAT_80123734,0x14,0);
    }
  }
  return uVar1;


}

void ClearOTagR(undefined4 *puParm1,undefined4 uParm2)
{
  if (false) {
    printf("ClearOTagR(%08x,%d)...\n",puParm1,uParm2);
  }
  FUN_800eea7c(puParm1,uParm2);
  DAT_8012375c = 0x4123748;
  *puParm1 = 0x12375c;
  return;


}

void DrawOTag(undefined4 uParm1)
{
  if (false) {
    printf("DrawOTag(%08x)...\n",uParm1);
  }
  FUN_800ef35c(FUN_800ef2c0,uParm1,0,0);
  return;


}

void * PutDrawEnv(void *pvParm1)
{
  if (false) {
    printf("PutDrawEnv(%08x)...\n",pvParm1);
  }
  FUN_800ee608((int)pvParm1 + 0x1c,pvParm1);
  *(uint *)((int)pvParm1 + 0x1c) = *(uint *)((int)pvParm1 + 0x1c) | 0xffffff;
  FUN_800ef35c(FUN_800ef2c0,(int)pvParm1 + 0x1c,0x40,0);
  memcpy(&DAT_801236ac,pvParm1,0x5c);
  return pvParm1;


}

ushort * PutDispEnv(ushort *puParm1)
{
  ushort uVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  
  uVar10 = 0x8000000;
  if (false) {
    printf("PutDispEnv(%08x)...\n",puParm1);
  }
  FUN_800ef248(((uint)puParm1[1] & 0x3ff) << 10 | (uint)*puParm1 & 0x3ff | 0x5000000);
  if ((((*(int *)(puParm1 + 8) != 0) || (*puParm1 != 0)) || (puParm1[1] != 0)) ||
     ((puParm1[2] != 0 || (puParm1[3] != 0)))) {
    uVar3 = GetVideoMode();
    *(char *)(puParm1 + 9) = (char)uVar3;
    if ((uVar3 & 0xff) == 1) {
      uVar10 = 0x8000008;
    }
    if (*(char *)((int)puParm1 + 0x11) != '\0') {
      uVar10 = uVar10 | 0x10;
    }
    if (*(char *)(puParm1 + 8) != '\0') {
      uVar10 = uVar10 | 0x20;
    }
    if (false) {
      uVar10 = uVar10 | 0x80;
    }
    uVar1 = puParm1[2];
    if (0x118 < (short)uVar1) {
      if ((short)uVar1 < 0x161) {
        uVar10 = uVar10 | 1;
      }
      else {
        if ((short)uVar1 < 0x191) {
          uVar10 = uVar10 | 0x40;
        }
        else {
          if ((short)uVar1 < 0x231) {
            uVar10 = uVar10 | 2;
          }
          else {
            uVar10 = uVar10 | 3;
          }
        }
      }
    }
    bVar2 = (short)puParm1[3] < 0x121;
    if (*(char *)(puParm1 + 9) == '\0') {
      bVar2 = (short)puParm1[3] < 0x101;
    }
    if (!bVar2) {
      uVar10 = uVar10 | 0x24;
    }
    FUN_800ef248(uVar10);
    *(undefined *)(puParm1 + 9) = 8;
  }
  if (((puParm1[4] == 0) && (puParm1[5] == 0)) &&
     ((puParm1[6] == 0 && ((puParm1[7] == 0 && (*(char *)(puParm1 + 9) != '\b'))))))
  goto LAB_800ee2ac;
  uVar10 = GetVideoMode();
  *(char *)(puParm1 + 9) = (char)uVar10;
  uVar3 = (int)(short)puParm1[5] + 0x13;
  if ((uVar10 & 0xff) == 0) {
    uVar3 = (int)(short)puParm1[5] + 0x10;
  }
  uVar10 = uVar3 + (int)(short)puParm1[7];
  if ((int)(short)puParm1[7] == 0) {
    uVar10 = uVar3 + 0xf0;
  }
  uVar1 = puParm1[2];
  iVar9 = 0;
  if ((((0x118 < (short)uVar1) && (iVar9 = 1, 0x160 < (short)uVar1)) &&
      (iVar9 = 2, 400 < (short)uVar1)) && (iVar9 = 4, (short)uVar1 < 0x231)) {
    iVar9 = 3;
  }
  iVar4 = ((uint)*(byte *)(puParm1 + 9) * 5 + iVar9) * 4;
  iVar5 = (uint)*(ushort *)(&DAT_80123772 + iVar4) - (uint)*(ushort *)(&DAT_80123770 + iVar4);
  uVar7 = (uint)*(ushort *)(&DAT_80123770 + iVar4) +
          (int)(short)puParm1[4] * (uint)(byte)(&DAT_80123798)[iVar9];
  if ((int)(short)puParm1[6] != 0) {
    iVar5 = iVar5 * (int)(short)puParm1[6] >> 8;
  }
  uVar6 = uVar7 + iVar5;
  if (*(char *)(puParm1 + 9) == '\0') {
    uVar8 = 500;
    if ((499 < (int)uVar7) && (uVar8 = 0xcb2, (int)uVar7 < 0xcb3)) {
      uVar8 = uVar7;
    }
    uVar7 = uVar8 + (uint)(byte)(&DAT_80123798)[iVar9] * 4;
    if (((int)uVar7 <= (int)uVar6) && (uVar7 = 0xcda, (int)uVar6 < 0xcdb)) {
      uVar7 = uVar6;
    }
    if ((int)uVar3 < 0x10) {
      uVar6 = 0x10;
    }
    else {
      uVar6 = 0x101;
      if ((int)uVar3 < 0x102) {
        uVar6 = uVar3;
      }
    }
    uVar3 = uVar6 + 2;
    bVar2 = (int)uVar10 < 0x103;
    if ((int)uVar3 <= (int)uVar10) {
      uVar3 = 0x102;
      goto LAB_800ee244;
    }
  }
  else {
    uVar8 = 0x21c;
    if ((0x21b < (int)uVar7) && (uVar8 = 0xc94, (int)uVar7 < 0xc95)) {
      uVar8 = uVar7;
    }
    uVar7 = uVar8 + (uint)(byte)(&DAT_80123798)[iVar9] * 4;
    if (((int)uVar7 <= (int)uVar6) && (uVar7 = 0xcbc, (int)uVar6 < 0xcbd)) {
      uVar7 = uVar6;
    }
    if ((int)uVar3 < 0x13) {
      uVar6 = 0x13;
    }
    else {
      uVar6 = 0x12f;
      if ((int)uVar3 < 0x130) {
        uVar6 = uVar3;
      }
    }
    bVar2 = (int)uVar10 < 0x132;
    uVar3 = uVar6 + 2;
    if ((int)(uVar6 + 2) <= (int)uVar10) {
      uVar3 = 0x131;
LAB_800ee244:
      if (bVar2) {
        uVar3 = uVar10;
      }
    }
  }
  FUN_800ef248((uVar7 & 0xfff) << 0xc | uVar8 & 0xfff | 0x6000000);
  FUN_800ef248((uVar3 & 0x3ff) << 10 | uVar6 & 0x3ff | 0x7000000);
LAB_800ee2ac:
  memcpy(&DAT_80123708,puParm1,0x14);
  return puParm1;


}

void SetTexWindow(int iParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  
  *(undefined *)(iParm1 + 3) = 2;
  uVar1 = FUN_800ee9e4(uParm2);
  *(undefined4 *)(iParm1 + 4) = uVar1;
  *(undefined4 *)(iParm1 + 8) = 0;
  return;


}

void SetDrawArea(int iParm1,ushort *puParm2)
{
  undefined4 uVar1;
  
  *(undefined *)(iParm1 + 3) = 2;
  uVar1 = FUN_800ee898((int)(short)*puParm2,(int)(short)puParm2[1]);
  *(undefined4 *)(iParm1 + 4) = uVar1;
  uVar1 = FUN_800ee930((int)(((uint)*puParm2 + (uint)puParm2[2] + -1) * 0x10000) >> 0x10,
                       (int)(((uint)puParm2[1] + (uint)puParm2[3] + -1) * 0x10000) >> 0x10);
  *(undefined4 *)(iParm1 + 8) = uVar1;
  return;


}

void SetDrawStp(int iParm1,int iParm2)
{
  undefined4 uVar1;
  
  *(undefined *)(iParm1 + 3) = 2;
  if (iParm2 == 0) {
    uVar1 = 0xe6000000;
  }
  else {
    uVar1 = 0xe6000001;
  }
  *(undefined4 *)(iParm1 + 4) = uVar1;
  *(undefined4 *)(iParm1 + 8) = 0;
  return;


}

void SetDrawMode(int param_1,undefined4 param_2,undefined4 param_3,uint param_4,undefined4 param_5)
{
  undefined4 uVar1;
  
  *(undefined *)(param_1 + 3) = 2;
  uVar1 = FUN_800ee878(param_2,param_3,param_4 & 0xffff);
  *(undefined4 *)(param_1 + 4) = uVar1;
  uVar1 = FUN_800ee9e4(param_5);
  *(undefined4 *)(param_1 + 8) = uVar1;
  return;


}

void SetDrawEnv(int iParm1,ushort *puParm2)
{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  undefined4 uVar4;
  char cVar5;
  undefined4 local_18;
  undefined4 local_14;
  
  uVar4 = FUN_800ee898((int)(short)*puParm2,(int)(short)puParm2[1]);
  *(undefined4 *)(iParm1 + 4) = uVar4;
  uVar4 = FUN_800ee930((int)(((uint)puParm2[2] + (uint)*puParm2 + -1) * 0x10000) >> 0x10,
                       (int)(((uint)puParm2[1] + (uint)puParm2[3] + -1) * 0x10000) >> 0x10);
  *(undefined4 *)(iParm1 + 8) = uVar4;
  uVar4 = FUN_800ee9c8((int)(short)puParm2[4],(int)(short)puParm2[5]);
  *(undefined4 *)(iParm1 + 0xc) = uVar4;
  uVar4 = FUN_800ee878((uint)*(byte *)((int)puParm2 + 0x17),(uint)*(byte *)(puParm2 + 0xb),
                       (uint)puParm2[10]);
  *(undefined4 *)(iParm1 + 0x10) = uVar4;
  uVar4 = FUN_800ee9e4(puParm2 + 6);
  *(undefined4 *)(iParm1 + 0x14) = uVar4;
  *(undefined4 *)(iParm1 + 0x18) = 0xe6000000;
  cVar5 = '\a';
  if (*(char *)(puParm2 + 0xc) != '\0') {
    uVar3 = puParm2[2];
    uVar1 = puParm2[3];
    uVar2 = 0;
    if ((-1 < (int)(short)uVar3) &&
       (uVar2 = DAT_801236a0 - 1, (int)(short)uVar3 <= (int)DAT_801236a0 + -1)) {
      uVar2 = uVar3;
    }
    if ((int)(short)uVar1 < 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = DAT_801236a2 - 1;
      if ((int)(short)uVar1 <= (int)DAT_801236a2 + -1) {
        uVar3 = uVar1;
      }
    }
    cVar5 = '\n';
    local_14 = CONCAT22(uVar3,uVar2);
    local_18 = CONCAT22(puParm2[1] - puParm2[5],*puParm2 - puParm2[4]);
    *(uint *)(iParm1 + 0x1c) =
         (uint)*(byte *)((int)puParm2 + 0x1b) << 0x10 |
         (uint)*(byte *)(puParm2 + 0xd) << 8 | 0x60000000 | (uint)*(byte *)((int)puParm2 + 0x19);
    *(undefined4 *)(iParm1 + 0x20) = local_18;
    *(undefined4 *)(iParm1 + 0x24) = local_14;
  }
  *(char *)(iParm1 + 3) = cVar5 + -1;
  return;


}

void FUN_800ee608(int iParm1,undefined4 *puParm2)
{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  undefined4 uVar4;
  char cVar5;
  undefined4 local_18;
  undefined4 local_14;
  
  uVar4 = FUN_800ee898((int)(short)*(ushort *)puParm2,(int)(short)*(ushort *)((int)puParm2 + 2));
  *(undefined4 *)(iParm1 + 4) = uVar4;
  uVar4 = FUN_800ee930((int)(((uint)*(ushort *)(puParm2 + 1) + (uint)*(ushort *)puParm2 + -1) *
                            0x10000) >> 0x10,
                       (int)(((uint)*(ushort *)((int)puParm2 + 2) +
                              (uint)*(ushort *)((int)puParm2 + 6) + -1) * 0x10000) >> 0x10);
  *(undefined4 *)(iParm1 + 8) = uVar4;
  uVar4 = FUN_800ee9c8((int)(short)*(ushort *)(puParm2 + 2),
                       (int)(short)*(ushort *)((int)puParm2 + 10));
  *(undefined4 *)(iParm1 + 0xc) = uVar4;
  uVar4 = FUN_800ee878((uint)*(byte *)((int)puParm2 + 0x17),(uint)*(byte *)((int)puParm2 + 0x16),
                       (uint)*(ushort *)(puParm2 + 5));
  *(undefined4 *)(iParm1 + 0x10) = uVar4;
  uVar4 = FUN_800ee9e4(puParm2 + 3);
  *(undefined4 *)(iParm1 + 0x14) = uVar4;
  *(undefined4 *)(iParm1 + 0x18) = 0xe6000000;
  cVar5 = '\a';
  if (*(char *)(puParm2 + 6) != '\0') {
    uVar4 = *puParm2;
    uVar3 = *(ushort *)(puParm2 + 1);
    uVar1 = *(ushort *)((int)puParm2 + 6);
    uVar2 = 0;
    if ((-1 < (int)(short)uVar3) &&
       (uVar2 = DAT_801236a0 - 1, (int)(short)uVar3 <= (int)DAT_801236a0 + -1)) {
      uVar2 = uVar3;
    }
    if ((int)(short)uVar1 < 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = DAT_801236a2 - 1;
      if ((int)(short)uVar1 <= (int)DAT_801236a2 + -1) {
        uVar3 = uVar1;
      }
    }
    local_14 = CONCAT22(uVar3,uVar2);
    if (((*(ushort *)puParm2 & 0x3f) == 0) && ((uVar2 & 0x3f) == 0)) {
      cVar5 = '\n';
      *(uint *)(iParm1 + 0x1c) =
           (uint)*(byte *)((int)puParm2 + 0x1b) << 0x10 |
           (uint)*(byte *)((int)puParm2 + 0x1a) << 8 | 0x2000000 |
           (uint)*(byte *)((int)puParm2 + 0x19);
      *(undefined4 *)(iParm1 + 0x20) = uVar4;
      *(undefined4 *)(iParm1 + 0x24) = local_14;
    }
    else {
      cVar5 = '\n';
      local_18 = CONCAT22(*(ushort *)((int)puParm2 + 2) - *(ushort *)((int)puParm2 + 10),
                          *(ushort *)puParm2 - *(ushort *)(puParm2 + 2));
      *(uint *)(iParm1 + 0x1c) =
           (uint)*(byte *)((int)puParm2 + 0x1b) << 0x10 |
           (uint)*(byte *)((int)puParm2 + 0x1a) << 8 | 0x60000000 |
           (uint)*(byte *)((int)puParm2 + 0x19);
      *(undefined4 *)(iParm1 + 0x20) = local_18;
      *(undefined4 *)(iParm1 + 0x24) = local_14;
    }
  }
  *(char *)(iParm1 + 3) = cVar5 + -1;
  return;


}

uint FUN_800ee878(int iParm1,int iParm2,uint uParm3)
{
  uint uVar1;
  
  uVar1 = 0xe1000000;
  if (iParm2 != 0) {
    uVar1 = 0xe1000200;
  }
  uParm3 = uParm3 & 0x9ff;
  if (iParm1 != 0) {
    uParm3 = uParm3 | 0x400;
  }
  return uVar1 | uParm3;


}

uint FUN_800ee898(uint uParm1,uint uParm2)
{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  if ((-1 < (int)(short)uParm1) &&
     (uVar1 = (uint)DAT_801236a0 - 1, (int)(short)uParm1 <= (int)(short)DAT_801236a0 + -1)) {
    uVar1 = uParm1;
  }
  if ((int)(short)uParm2 < 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = uParm2 & 0x3ff;
    if ((int)(short)uParm2 <= (int)(short)DAT_801236a2 + -1) goto LAB_800ee918;
    uVar2 = (uint)DAT_801236a2 - 1;
  }
  uVar2 = uVar2 & 0x3ff;
LAB_800ee918:
  return uVar2 << 10 | uVar1 & 0x3ff | 0xe3000000;


}

uint FUN_800ee930(uint uParm1,uint uParm2)
{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  if ((-1 < (int)(short)uParm1) &&
     (uVar1 = (uint)DAT_801236a0 - 1, (int)(short)uParm1 <= (int)(short)DAT_801236a0 + -1)) {
    uVar1 = uParm1;
  }
  if ((int)(short)uParm2 < 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = uParm2 & 0x3ff;
    if ((int)(short)uParm2 <= (int)(short)DAT_801236a2 + -1) goto LAB_800ee9b0;
    uVar2 = (uint)DAT_801236a2 - 1;
  }
  uVar2 = uVar2 & 0x3ff;
LAB_800ee9b0:
  return uVar2 << 10 | uVar1 & 0x3ff | 0xe4000000;


}

uint FUN_800ee9c8(uint uParm1,uint uParm2)
{
  return (uParm2 & 0x7ff) << 0xb | uParm1 & 0x7ff | 0xe5000000;


}

uint FUN_800ee9e4(byte *pbParm1)
{
  uint uVar1;
  
  if (pbParm1 == (byte *)0x0) {
    uVar1 = 0;
  }
  else {
    uVar1 = (uint)(pbParm1[2] >> 3) << 0xf | (uint)(*pbParm1 >> 3) << 10 | 0xe2000000 |
            ((int)(-(int)*(short *)(pbParm1 + 6) & 0xffU) >> 3) << 5 |
            (int)(-(int)*(short *)(pbParm1 + 4) & 0xffU) >> 3;
  }
  return uVar1;


}

int FUN_800eea7c(int iParm1,int iParm2)
{
  int iVar1;
  
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0x8000000;
  _DAT_1f8010e0 = iParm1 + iParm2 * 4 + -4;
  _DAT_1f8010e8 = 0x11000002;
  _DAT_1f8010e4 = iParm2;
  FUN_800efaf8();
  do {
    if ((_DAT_1f8010e8 & 0x1000000) == 0) {
      return iParm2;
    }
    iVar1 = FUN_800efb2c();
  } while (iVar1 == 0);
  return 0xffffffff;


}

undefined4 FUN_800eeb5c(undefined4 *puParm1,uint uParm2)
{
  ushort uVar1;
  
  if ((int)(short)*(ushort *)(puParm1 + 1) < 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = DAT_801236a0 - 1;
    if ((int)(short)*(ushort *)(puParm1 + 1) <= (int)DAT_801236a0 + -1) {
      uVar1 = *(ushort *)(puParm1 + 1);
    }
  }
  *(ushort *)(puParm1 + 1) = uVar1;
  if ((int)(short)*(ushort *)((int)puParm1 + 6) < 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = DAT_801236a2 - 1;
    if ((int)(short)*(ushort *)((int)puParm1 + 6) <= (int)DAT_801236a2 + -1) {
      uVar1 = *(ushort *)((int)puParm1 + 6);
    }
  }
  *(ushort *)((int)puParm1 + 6) = uVar1;
  if (((*(ushort *)puParm1 & 0x3f) == 0) && ((*(ushort *)(puParm1 + 1) & 0x3f) == 0)) {
    _DAT_8013eab0 = 0x5ffffff;
    _DAT_8013eab4 = 0xe6000000;
    _DAT_8013eabc = uParm2 & 0xffffff | 0x2000000;
    _DAT_8013eab8 = _DAT_1f801814 & 0x7ff | (uParm2 >> 0x1f) << 10 | 0xe1000000;
    _DAT_8013eac0 = *puParm1;
    _DAT_8013eac4 = puParm1[1];
  }
  else {
    _DAT_8013eab0 = 0x813ead8;
    _DAT_8013eac8 = uParm2 & 0xffffff | 0x60000000;
    _DAT_8013eac0 = 0xe6000000;
    _DAT_8013eab4 = 0xe3000000;
    _DAT_8013eab8 = 0xe4ffffff;
    _DAT_8013eabc = 0xe5000000;
    _DAT_8013eac4 = _DAT_1f801814 & 0x7ff | (uParm2 >> 0x1f) << 10 | 0xe1000000;
    _DAT_8013eacc = *puParm1;
    _DAT_8013ead0 = puParm1[1];
    _DAT_8013ead8 = 0x3ffffff;
    _DAT_8013eadc = FUN_800ef308(3);
    _DAT_8013eadc = _DAT_8013eadc | 0xe3000000;
    _DAT_8013eae0 = FUN_800ef308(4);
    _DAT_8013eae0 = _DAT_8013eae0 | 0xe4000000;
    _DAT_8013eae4 = FUN_800ef308(5);
    _DAT_8013eae4 = _DAT_8013eae4 | 0xe5000000;
  }
  FUN_800ef2c0(&DAT_8013eab0);
  return 0;


}

undefined4 FUN_800eed8c(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  short sVar4;
  short sVar5;
  int iVar6;
  
  FUN_800efaf8();
  if (*(short *)(iParm1 + 4) < 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = *(short *)(iParm1 + 4);
    if (DAT_801236a0 < *(short *)(iParm1 + 4)) {
      sVar4 = DAT_801236a0;
    }
  }
  sVar5 = *(short *)(iParm1 + 6);
  *(short *)(iParm1 + 4) = sVar4;
  if (*(short *)(iParm1 + 6) < 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = DAT_801236a2;
    if (*(short *)(iParm1 + 6) <= DAT_801236a2) goto LAB_800eee34;
  }
  sVar5 = sVar4;
LAB_800eee34:
  *(short *)(iParm1 + 6) = sVar5;
  uVar2 = (int)*(short *)(iParm1 + 4) * (int)sVar5 + 1;
  iVar3 = uVar2 + (uVar2 >> 0x1f);
  iVar6 = iVar3 >> 1;
  iVar3 = iVar3 >> 5;
  if (0 < iVar6) {
    iVar6 = iVar6 + iVar3 * -0x10;
    do {
      if ((_DAT_1f801814 & 0x4000000) != 0) {
        _DAT_1f801814 = 0x4000000;
        _DAT_1f801810 = *(undefined4 *)(iParm1 + 4);
        while (iVar6 = iVar6 + -1, iVar6 != -1) {
          _DAT_1f801810 = *puParm2;
          puParm2 = puParm2 + 1;
        }
        if (iVar3 != 0) {
          _DAT_1f801814 = 0x4000002;
          _DAT_1f8010a4 = iVar3 << 0x10 | 0x10;
          _DAT_1f8010a8 = 0x1000201;
          _DAT_1f8010a0 = puParm2;
        }
        return 0;
      }
      iVar1 = FUN_800efb2c();
    } while (iVar1 == 0);
  }
  return 0xffffffff;


}

undefined4 FUN_800eefc8(int iParm1,undefined4 *puParm2)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  short sVar4;
  short sVar5;
  int iVar6;
  
  FUN_800efaf8();
  if (*(short *)(iParm1 + 4) < 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = *(short *)(iParm1 + 4);
    if (DAT_801236a0 < *(short *)(iParm1 + 4)) {
      sVar4 = DAT_801236a0;
    }
  }
  sVar5 = *(short *)(iParm1 + 6);
  *(short *)(iParm1 + 4) = sVar4;
  if (*(short *)(iParm1 + 6) < 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = DAT_801236a2;
    if (*(short *)(iParm1 + 6) <= DAT_801236a2) goto LAB_800ef068;
  }
  sVar5 = sVar4;
LAB_800ef068:
  *(short *)(iParm1 + 6) = sVar5;
  uVar2 = (int)*(short *)(iParm1 + 4) * (int)sVar5 + 1;
  iVar3 = uVar2 + (uVar2 >> 0x1f);
  iVar6 = iVar3 >> 1;
  iVar3 = iVar3 >> 5;
  if (0 < iVar6) {
    iVar6 = iVar6 + iVar3 * -0x10;
    do {
      if ((_DAT_1f801814 & 0x4000000) != 0) {
        _DAT_1f801814 = 0x4000000;
        _DAT_1f801810 = *(undefined4 *)(iParm1 + 4);
        if (true) {
          do {
            iVar1 = FUN_800efb2c();
            if (iVar1 != 0) {
              return 0xffffffff;
            }
          } while ((_DAT_1f801814 & 0x8000000) == 0);
        }
        while (iVar6 = iVar6 + -1, iVar6 != -1) {
          *puParm2 = _DAT_1f801810;
          puParm2 = puParm2 + 1;
        }
        if (iVar3 != 0) {
          _DAT_1f801814 = 0x4000003;
          _DAT_1f8010a4 = iVar3 << 0x10 | 0x10;
          _DAT_1f8010a8 = 0x1000200;
          _DAT_1f8010a0 = puParm2;
        }
        return 0;
      }
      iVar1 = FUN_800efb2c();
    } while (iVar1 == 0);
  }
  return 0xffffffff;


}

void FUN_800ef248(uint uParm1)
{
  _DAT_1f801814 = uParm1;
  *(undefined *)((uParm1 >> 0x18) + 0x8013eaf8) = (char)uParm1;
  return;


}

void FUN_800ef2c0(undefined4 uParm1)
{
  _DAT_1f8010a0 = uParm1;
  _DAT_1f8010a4 = 0;
  _DAT_1f8010a8 = 0x1000401;
  _DAT_1f801814 = 0x4000002;
  return;


}

uint FUN_800ef308(uint uParm1)
{
  _DAT_1f801814 = uParm1 | 0x10000000;
  return _DAT_1f801810 & 0xffffff;


}

void FUN_800ef338(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  FUN_800ef35c(uParm1,uParm2,0,uParm3);
  return;


}

uint FUN_800ef35c(code *pcParm1,undefined4 *puParm2,int iParm3,undefined4 uParm4)
{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  
  FUN_800efaf8();
  while( true ) {
    if ((_qin + 1 & 0x3f) != _qout) {
      DAT_801237cc = SetIntrMask(0);
      DAT_801236a4 = 1;
      if ((DAT_8012369d == '\0') ||
         (((_qin == _qout && ((_DAT_1f8010a8 & 0x1000000) == 0)) && (true)))) {
        do {
        } while ((_DAT_1f801814 & 0x4000000) == 0);
        (*pcParm1)(puParm2,uParm4);
        SetIntrMask(DAT_801237cc);
        uVar1 = 0;
      }
      else {
        DMACallback(2,FUN_800ef60c);
        iVar5 = 0;
        if (iParm3 == 0) {
          *(undefined4 **)(_qin * 0x60 + -0x7fec13fc) = puParm2;
        }
        else {
          while( true ) {
            iVar2 = iParm3;
            if (iParm3 < 0) {
              iVar2 = iParm3 + 3;
            }
            iVar3 = iVar5 * 4;
            if (iVar2 >> 2 <= iVar5) break;
            uVar4 = *puParm2;
            puParm2 = puParm2 + 1;
            iVar5 = iVar5 + 1;
            *(undefined4 *)(iVar3 + _qin * 0x60 + -0x7fec13f4) = uVar4;
          }
          *(int *)(_qin * 0x60 + -0x7fec13fc) = _qin * 0x60 + -0x7fec13f4;
        }
        *(undefined4 *)(_qin * 0x60 + -0x7fec13f8) = uParm4;
        *(code **)(&_que + _qin * 0x60) = pcParm1;
        _qin = _qin + 1 & 0x3f;
        SetIntrMask(DAT_801237cc);
        FUN_800ef60c();
        uVar1 = _qin - _qout & 0x3f;
      }
      return uVar1;
    }
    iVar5 = FUN_800efb2c();
    if (iVar5 != 0) break;
    FUN_800ef60c();
  }
  return 0xffffffff;


}

uint FUN_800ef60c(void)
{
  uint uVar1;
  
  uVar1 = 1;
  if ((_DAT_1f8010a8 & 0x1000000) == 0) {
    DAT_801237d0 = SetIntrMask(0);
    if (_qin != _qout) {
      do {
        if ((_DAT_1f8010a8 & 0x1000000) != 0) break;
        if (((_qout + 1 & 0x3f) == _qin) && (true)) {
          DMACallback(2,0);
        }
        do {
        } while ((_DAT_1f801814 & 0x4000000) == 0);
        (**(code **)(&_que + _qout * 0x60))
                  (*(undefined4 *)(_qout * 0x60 + -0x7fec13fc),
                   *(undefined4 *)(_qout * 0x60 + -0x7fec13f8));
        _qout = _qout + 1 & 0x3f;
      } while (_qin != _qout);
    }
    SetIntrMask(DAT_801237d0);
    if ((((_qin == _qout) && ((_DAT_1f8010a8 & 0x1000000) == 0)) && (DAT_801236a4 != 0)) && (false))
    {
      DAT_801236a4 = 0;
      (*(code *)0x0)();
    }
    uVar1 = _qin - _qout & 0x3f;
  }
  return uVar1;


}

undefined4 FUN_800ef86c(uint uParm1)
{
  undefined4 uVar1;
  uint uVar2;
  
  DAT_801237d4 = SetIntrMask(0);
  _qout = 0;
  _qin = 0;
  uVar2 = uParm1 & 7;
  if (uVar2 == 1) {
LAB_800ef93c:
    _DAT_1f8010a8 = 0x401;
    _DAT_1f8010f0 = _DAT_1f8010f0 | 0x800;
    _DAT_1f801814 = 0x1000000;
  }
  else {
    if (uVar2 < 2) {
      if (uVar2 != 0) goto LAB_800ef988;
    }
    else {
      if (uVar2 == 3) goto LAB_800ef93c;
      if (uVar2 != 5) goto LAB_800ef988;
    }
    _DAT_1f8010a8 = 0x401;
    _DAT_1f8010f0 = _DAT_1f8010f0 | 0x800;
    _DAT_1f801814 = 0;
    FUN_800efe34(0x8013eaf8,0,0x100);
    FUN_800efe34(&_que,0,0x1800);
  }
LAB_800ef988:
  SetIntrMask(DAT_801237d4);
  uVar1 = 0;
  if ((uParm1 & 7) == 0) {
    uVar1 = FUN_800efc70(uParm1);
  }
  return uVar1;


}

uint FUN_800ef9bc(int iParm1)
{
  int iVar1;
  uint uVar2;
  
  if (iParm1 == 0) {
    FUN_800efaf8();
    do {
      if (_qin == _qout) {
        while (((_DAT_1f8010a8 & 0x1000000) != 0 || ((_DAT_1f801814 & 0x4000000) == 0))) {
          iVar1 = FUN_800efb2c();
          if (iVar1 != 0) {
            return 0xffffffff;
          }
        }
        return 0;
      }
      FUN_800ef60c();
      iVar1 = FUN_800efb2c();
    } while (iVar1 == 0);
    return 0xffffffff;
  }
  uVar2 = _qin - _qout & 0x3f;
  if (uVar2 != 0) {
    FUN_800ef60c();
  }
  if (((_DAT_1f8010a8 & 0x1000000) == 0) && ((_DAT_1f801814 & 0x4000000) != 0)) {
    return uVar2;
  }
  if (uVar2 != 0) {
    return uVar2;
  }
  return 1;


}

void FUN_800efaf8(void)
{
  int iVar1;
  
  iVar1 = VSync(0xffffffff);
  DAT_801237d8 = iVar1 + 0xf0;
  DAT_801237dc = 0;
  return;


}

undefined4 FUN_800efb2c(void)
{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  
  iVar2 = VSync(0xffffffff);
  if ((DAT_801237d8 < iVar2) ||
     (iVar2 = DAT_801237dc + 1, bVar1 = 0xf0000 < DAT_801237dc, DAT_801237dc = iVar2, bVar1)) {
    printf("GPU timeout:que=%d,stat=%08x,chcr=%08x,madr=%08x\n",_qin - _qout & 0x3f,_DAT_1f801814,
           _DAT_1f8010a8,_DAT_1f8010a0);
    DAT_801237d4 = SetIntrMask(0);
    _qout = 0;
    _qin = 0;
    _DAT_1f8010a8 = 0x401;
    _DAT_1f8010f0 = _DAT_1f8010f0 | 0x800;
    _DAT_1f801814 = 0x1000000;
    SetIntrMask(DAT_801237d4);
    uVar3 = 0xffffffff;
  }
  else {
    uVar3 = 0;
    DAT_801237dc = iVar2;
  }
  return uVar3;


}

undefined8 FUN_800efc70(uint uParm1)
{
  undefined4 uVar1;
  undefined *puVar2;
  
  _DAT_1f801814 = 0x10000007;
  puVar2 = (undefined *)0xe1000000;
  if (((uint)_DAT_1f801810 & 0xffffff) == 2) {
    if ((uParm1 & 8) == 0) {
      uVar1 = 1;
    }
    else {
      puVar2 = &DAT_1f801814;
      uVar1 = 2;
      _DAT_1f801814 = 0x9000001;
    }
  }
  else {
    puVar2 = (undefined *)0xe1001007;
    uVar1 = 0;
    _DAT_1f801810 = puVar2;
  }
  return CONCAT44(uVar1,puVar2);


}

void FUN_800efe0c(void)
{
  DMACallback(2,FUN_800ef60c);
  return;


}

void FUN_800efe34(undefined *puParm1,undefined uParm2,int iParm3)
{
  int iVar1;
  
  iVar1 = iParm3 + -1;
  if (iParm3 != 0) {
    do {
      *puParm1 = uParm2;
      iVar1 = iVar1 + -1;
      puParm1 = puParm1 + 1;
    } while (iVar1 != -1);
  }
  return;


}

void PadStartCom(void)
{
  _padStartCom();
  return;


}

void PadStopCom(void)
{
  _padStopCom();
  return;


}

uint PadGetState(void)
{
  byte bVar1;
  int iVar2;
  
  iVar2 = (*_padFuncPort2Info)();
  if (((*(uint *)(iVar2 + 0x34) & 0xffff0000) != 0) ||
     (((iVar2 != *(int *)(iVar2 + 0x10) && (*(char *)(iVar2 + 0x38) != '\0')) ||
      (**(char **)(iVar2 + 0x30) != '\0')))) {
    bVar1 = *(byte *)(iVar2 + 0x49);
    if (bVar1 == 3) {
      return 1;
    }
    if (bVar1 < 4) {
      if (bVar1 == 2) {
        return 1;
      }
    }
    else {
      if (bVar1 == 6) {
        return 4;
      }
    }
  }
  return (uint)*(byte *)(iVar2 + 0x49);


}

uint PadInfoMode(undefined4 uParm1,int iParm2,int iParm3)
{
  int *piVar1;
  uint uVar2;
  
  piVar1 = (int *)(*_padFuncPort2Info)();
  if (iParm2 == 3) {
    uVar2 = (uint)*(byte *)(piVar1 + 0x39);
  }
  else {
    if (iParm2 < 4) {
      if (iParm2 == 1) {
        uVar2 = (uint)*(byte *)(piVar1 + 0x3a);
      }
      else {
        uVar2 = 0;
        if (iParm2 == 2) {
          uVar2 = (uint)*(ushort *)((int)piVar1 + 0xe6);
        }
      }
    }
    else {
      if (iParm2 == 4) {
        if (iParm3 < 0) {
          uVar2 = (uint)*(byte *)((int)piVar1 + 0xe3);
        }
        else {
          if (iParm3 < (int)(uint)*(byte *)((int)piVar1 + 0xe3)) {
            uVar2 = (uint)*(ushort *)(iParm3 * 2 + *piVar1);
          }
          else {
            uVar2 = 0;
          }
        }
      }
      else {
        uVar2 = 0;
        if (iParm2 == 100) {
          uVar2 = piVar1[0x13];
        }
      }
    }
  }
  return uVar2;


}

uint PadInfoAct(undefined4 uParm1,int iParm2,undefined4 uParm3)
{
  int iVar1;
  uint uVar2;
  byte *pbVar3;
  
  iVar1 = (*_padFuncPort2Info)();
  if (iParm2 < 0) {
    uVar2 = (uint)*(byte *)(iVar1 + 0xe9);
  }
  else {
    if (iParm2 < (int)(uint)*(byte *)(iVar1 + 0xe9)) {
      pbVar3 = (byte *)(*(int *)(iVar1 + 4) + iParm2 * 5);
      switch(uParm3) {
      case 1:
        return (uint)*pbVar3;
      case 2:
        return (uint)pbVar3[1];
      case 3:
        return (uint)pbVar3[2];
      case 4:
        return (uint)pbVar3[3];
      case 5:
        return (uint)pbVar3[4];
      }
    }
    uVar2 = 0;
  }
  return uVar2;


}

void PadSetActAlign(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  
  uVar1 = (*_padFuncPort2Info)();
  _padSetActAlign(uVar1,uParm2);
  return;


}

void PadSetMainMode(undefined4 uParm1,uint uParm2,uint uParm3)
{
  undefined4 uVar1;
  
  uVar1 = (*_padFuncPort2Info)();
  _padSetMainMode(uVar1,uParm2 & 0xff,uParm3 & 0xff);
  return;


}

void PadSetAct(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  
  uVar1 = (*_padFuncPort2Info)();
  _padSetAct(uVar1,uParm2,uParm3);
  return;


}

int * addmatrix(int *piParm1,int *piParm2,int *piParm3)
{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = 0;
  piVar3 = piParm3;
  do {
    iVar2 = *piParm2;
    piParm2 = piParm2 + 1;
    iVar1 = *piParm1;
    piParm1 = piParm1 + 1;
    iVar4 = iVar4 + 1;
    *piVar3 = iVar1 + iVar2;
    piVar3 = piVar3 + 1;
  } while (iVar4 < 9);
  return piParm3;


}

int * submatrix(int *piParm1,int *piParm2,int *piParm3)
{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = 0;
  piVar3 = piParm3;
  do {
    iVar2 = *piParm2;
    piParm2 = piParm2 + 1;
    iVar1 = *piParm1;
    piParm1 = piParm1 + 1;
    iVar4 = iVar4 + 1;
    *piVar3 = iVar1 - iVar2;
    piVar3 = piVar3 + 1;
  } while (iVar4 < 9);
  return piParm3;


}

undefined4 * scalematrix(undefined4 *puParm1,undefined4 uParm2,undefined4 *puParm3)
{
  undefined4 uVar1;
  undefined4 *puVar2;
  int iVar3;
  
  iVar3 = 0;
  puVar2 = puParm3;
  do {
    uVar1 = *puParm1;
    puParm1 = puParm1 + 1;
    iVar3 = iVar3 + 1;
    uVar1 = fixedmult(uVar1,uParm2);
    *puVar2 = uVar1;
    puVar2 = puVar2 + 1;
  } while (iVar3 < 9);
  return puParm3;


}

void reorthogonalize(undefined4 *puParm1)
{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int iVar7;
  int iVar8;
  undefined auStack240 [40];
  undefined4 local_c8 [8];
  undefined4 auStack168 [2];
  undefined auStack160 [40];
  undefined4 local_78 [10];
  undefined4 local_50 [10];
  
  iVar8 = 0;
  do {
    transpose(puParm1,local_c8);
    transmult(local_c8,puParm1,auStack240);
    submatrix(auStack240,&identitymatrix,auStack160);
    puVar1 = local_78;
    puVar2 = &identitymatrix;
    do {
      uVar5 = puVar2[1];
      uVar6 = puVar2[2];
      uVar4 = puVar2[3];
      *puVar1 = *puVar2;
      puVar1[1] = uVar5;
      puVar1[2] = uVar6;
      puVar1[3] = uVar4;
      puVar2 = puVar2 + 4;
      puVar1 = puVar1 + 4;
    } while (puVar2 != &DAT_8012380c);
    *puVar1 = 0x10000;
    puVar1 = local_50;
    puVar2 = &identitymatrix;
    do {
      uVar6 = puVar2[1];
      uVar4 = puVar2[2];
      uVar5 = puVar2[3];
      *puVar1 = *puVar2;
      puVar1[1] = uVar6;
      puVar1[2] = uVar4;
      puVar1[3] = uVar5;
      puVar2 = puVar2 + 4;
      puVar1 = puVar1 + 4;
    } while (puVar2 != &DAT_8012380c);
    *puVar1 = 0x10000;
    iVar7 = 1;
    puVar2 = &DAT_80123814;
    do {
      transmult(local_78,auStack160,local_c8);
      puVar1 = local_c8;
      puVar3 = local_78;
      do {
        uVar6 = puVar1[1];
        uVar4 = puVar1[2];
        uVar5 = puVar1[3];
        *puVar3 = *puVar1;
        puVar3[1] = uVar6;
        puVar3[2] = uVar4;
        puVar3[3] = uVar5;
        puVar1 = puVar1 + 4;
        puVar3 = puVar3 + 4;
      } while (puVar1 != auStack168);
      *puVar3 = *puVar1;
      uVar4 = *puVar2;
      puVar2 = puVar2 + 1;
      iVar7 = iVar7 + 1;
      scalematrix(local_78,uVar4,auStack240);
      addmatrix(local_50,auStack240,local_50);
    } while (iVar7 < 4);
    puVar1 = local_c8;
    puVar2 = puParm1;
    do {
      uVar6 = puVar2[1];
      uVar4 = puVar2[2];
      uVar5 = puVar2[3];
      *puVar1 = *puVar2;
      puVar1[1] = uVar6;
      puVar1[2] = uVar4;
      puVar1[3] = uVar5;
      puVar2 = puVar2 + 4;
      puVar1 = puVar1 + 4;
    } while (puVar2 != puParm1 + 8);
    *puVar1 = *puVar2;
    transmult(local_c8,local_50,puParm1);
    iVar8 = iVar8 + 1;
  } while (iVar8 < 4);
  return;


}

uint __gtdf2(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  uint uVar1;
  uint uVar2;
  
  if ((uParm2 != uParm4) || (uVar1 = 0, uParm1 != uParm3)) {
    if (((uParm2 & 0x7fffffff) == 0) &&
       (((uParm1 == 0 && ((uParm4 & 0x7fffffff) == 0)) && (uParm3 == 0)))) {
      uVar1 = 0;
    }
    else {
      uVar1 = (uint)((uParm2 & 0x80000000) == 0);
      if ((uParm2 & 0x80000000) == (uParm4 & 0x80000000)) {
        uVar2 = (int)uParm2 >> 0x14 & 0x7ff;
        uVar1 = (int)uParm4 >> 0x14 & 0x7ff;
        if (uVar2 <= uVar1) {
          if (uVar2 != uVar1) {
            return (uint)((int)uParm2 < 0);
          }
          uVar1 = uParm2 & 0xfffff | 0x100000;
          uVar2 = uParm4 & 0xfffff | 0x100000;
          if (uVar1 <= uVar2) {
            if (uVar1 != uVar2) {
              return (uint)((int)uParm2 < 0);
            }
            if (uParm1 <= uParm3) {
              return (uint)((int)uParm2 < 0);
            }
          }
        }
        uVar1 = (uint)((uParm2 & 0x80000000) == 0);
      }
    }
  }
  return uVar1;


}

int initlinkmode(undefined4 uParm1,int iParm2,undefined4 uParm3)
{
  maxot = 0x10;
  maxprim = iParm2;
  if (otbuf != 0) {
    maxprim = iParm2;
    purgememadr();
  }
  otbuf = reservememadr("Draw Lists",(maxprim * 0xd + maxot) * 8,0x10);
  primbuf = otbuf + maxot * 8;
  DAT_8013de74 = otbuf + maxot * 4;
  DAT_8013de88 = primbuf + iParm2 * 0x34;
  otbl = otbuf;
  primbase = primbuf;
  ClearOTagR();
  linkmodeflag = uParm3;
  drawpending = 0;
  oti = 0;
  otp = 0;
  nextprim = otbl;
  primptr = primbuf;
  return otbuf;


}

void waitdraw(void)
{
  if (drawpending != 0) {
    DrawSync(0);
    drawpending = 0;
  }
  return;


}

int settrans(int iParm1)
{
  if (-1 < iParm1) {
    if (iParm1 == 0) {
      semitrans = 1;
    }
    else {
      semitrans = 3;
    }
  }
  return semitrans >> 1;


}

void movfxya(byte *pbParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined *puVar1;
  byte bVar2;
  short sVar3;
  uint *puVar4;
  char cVar5;
  char cVar6;
  undefined2 uVar7;
  short sVar8;
  int iVar9;
  short sVar10;
  int iVar11;
  char cVar12;
  uint uVar13;
  int iVar14;
  uint in_t6;
  int iVar15;
  int unaff_s1;
  int iVar16;
  uint uVar17;
  int iVar18;
  short local_40;
  short local_3e;
  undefined2 local_3c;
  undefined2 local_3a;
  int local_38;
  int local_34;
  int local_30;
  
  iVar9 = shapedepth();
  if ((*pbParm1 & 8) == 0) {
    local_40 = _DAT_801486e8 + (short)uParm2;
    local_3e = _DAT_801486ec + (short)uParm3;
    local_3c = *(undefined2 *)(pbParm1 + 4);
    local_3a = *(undefined2 *)(pbParm1 + 6);
    vramimage(&local_40,pbParm1 + 0x10);
  }
  else {
    if (((*pbParm1 & 3) == 2) && ((semitrans & 2) == 0)) {
      fastmovfxya(pbParm1,uParm2,uParm3);
    }
    else {
      sVar3 = *(short *)(pbParm1 + 6);
      local_34 = 0;
      if (0 < *(short *)(pbParm1 + 6)) {
        do {
          uVar13 = ((*(int *)(pbParm1 + 0xc) << 4) >> 0x14) + local_34;
          uVar17 = uVar13 & 0xff;
          local_38 = 0xff - uVar17;
          if ((int)sVar3 - local_34 < local_38) {
            local_38 = (int)sVar3 - local_34;
          }
          iVar16 = 0;
          if (0 < *(short *)(pbParm1 + 4)) {
            local_30 = (int)(uVar13 & 0x100) >> 4;
            sVar3 = (short)local_34 + (short)uParm3;
            iVar18 = 0;
            do {
              iVar15 = primptr;
              iVar14 = (*(int *)(pbParm1 + 0xc) << 0x14) >> 0x14;
              if (iVar18 < 0) {
                iVar18 = iVar18 + 0xf;
              }
              iVar11 = iVar14 << 4;
              if (iVar9 == 0) {
                trap(0x1c00);
              }
              if ((iVar9 == -1) && (iVar11 == -0x80000000)) {
                trap(0x1800);
              }
              uVar13 = iVar14 + (iVar18 >> 4);
              iVar18 = (uVar13 & 0xffffffc0) << 4;
              if (iVar9 == 0) {
                trap(0x1c00);
              }
              if ((iVar9 == -1) && (iVar18 == -0x80000000)) {
                trap(0x1800);
              }
              iVar14 = (iVar11 / iVar9 + iVar16) - iVar18 / iVar9;
              iVar18 = 0xff - iVar14;
              if ((int)*(short *)(pbParm1 + 4) - iVar16 < iVar18) {
                iVar18 = (int)*(short *)(pbParm1 + 4) - iVar16;
              }
              puVar1 = (undefined *)(primptr + 3);
              primptr = primptr + 0x28;
              *puVar1 = 9;
              *(undefined *)(iVar15 + 7) = 0x2c;
              *(byte *)(iVar15 + 7) = (byte)semitrans | 0x2c;
              uVar7 = shapetoclutid(pbParm1);
              *(undefined2 *)(iVar15 + 0xe) = uVar7;
              bVar2 = *pbParm1;
              cVar5 = (char)iVar14;
              cVar12 = cVar5 + (char)iVar18;
              *(char *)(iVar15 + 0xc) = cVar5;
              cVar6 = (char)uVar17;
              *(char *)(iVar15 + 0xd) = cVar6;
              *(char *)(iVar15 + 0x14) = cVar12;
              *(char *)(iVar15 + 0x15) = cVar6;
              *(char *)(iVar15 + 0x1c) = cVar5;
              *(char *)(iVar15 + 0x24) = cVar12;
              cVar6 = cVar6 + (char)local_38;
              *(char *)(iVar15 + 0x1d) = cVar6;
              *(char *)(iVar15 + 0x25) = cVar6;
              *(ushort *)(iVar15 + 0x16) =
                   (ushort)(((uint)bVar2 & 3) << 7) | (ushort)local_30 |
                   (ushort)((int)(uVar13 & 0x3c0) >> 6);
              if (iVar18 < 1) {
                iVar18 = 1;
              }
              unaff_s1 = local_38;
              if (local_38 < 1) {
                unaff_s1 = 1;
              }
              sVar8 = (short)iVar16 + (short)uParm2;
              sVar10 = sVar8 + (short)iVar18;
              *(short *)(iVar15 + 8) = sVar8;
              *(short *)(iVar15 + 0x18) = sVar8;
              sVar8 = sVar3 + (short)unaff_s1;
              *(short *)(iVar15 + 0x1a) = sVar8;
              *(short *)(iVar15 + 0x22) = sVar8;
              *(short *)(iVar15 + 10) = sVar3;
              *(short *)(iVar15 + 0x12) = sVar3;
              *(short *)(iVar15 + 0x10) = sVar10;
              *(short *)(iVar15 + 0x20) = sVar10;
              uVar13 = nextprim + 2U & 3;
              in_t6 = *(int *)((nextprim + 2U) - uVar13) << (3 - uVar13) * 8 |
                      in_t6 & 0xffffffffU >> (uVar13 + 1) * 8;
              uVar13 = iVar15 + 2U & 3;
              puVar4 = (uint *)((iVar15 + 2U) - uVar13);
              *puVar4 = *puVar4 & -1 << (uVar13 + 1) * 8 | in_t6 >> (3 - uVar13) * 8;
              uVar13 = nextprim + 2U & 3;
              puVar4 = (uint *)((nextprim + 2U) - uVar13);
              *puVar4 = *puVar4 & -1 << (uVar13 + 1) * 8 | (uint)(iVar15 << 8) >> (3 - uVar13) * 8;
              iVar16 = iVar16 + iVar18;
              nextprim = iVar15;
              iVar18 = iVar16 * iVar9;
            } while (iVar16 < (int)*(short *)(pbParm1 + 4));
          }
          local_34 = local_34 + unaff_s1;
          sVar3 = *(short *)(pbParm1 + 6);
        } while (local_34 < (int)*(short *)(pbParm1 + 6));
      }
    }
  }
  return;


}

undefined4 shapecount(int iParm1)
{
  return *(undefined4 *)(iParm1 + 8);


}

int shapepointer(int iParm1,uint uParm2)
{
  if (uParm2 < *(uint *)(iParm1 + 8)) {
    return iParm1 + *(int *)(iParm1 + uParm2 * 8 + 0x14);
  }
  return 0;


}

undefined4 shapename(int iParm1,uint uParm2,undefined4 *puParm3)
{
  if (uParm2 < *(uint *)(iParm1 + 8)) {
    *puParm3 = *(undefined4 *)(iParm1 + uParm2 * 8 + 0x10);
    return 0;
  }
  *puParm3 = 0;
  return 0;


}

void queueadd(int *piParm1,int iParm2)
{
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (*piParm1 == 0) {
    *piParm1 = iParm2;
  }
  else {
    *(int *)(piParm1[1] + 4) = iParm2;
  }
  piParm1[1] = iParm2;
  *(undefined4 *)(iParm2 + 4) = 0;
  setCopReg(0,Status,Status,0);
  return;


}

int queuefetch(int *piParm1)
{
  int iVar1;
  int iVar2;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar1 = *piParm1;
  iVar2 = 0;
  if (iVar1 != 0) {
    *piParm1 = *(int *)(iVar1 + 4);
    iVar2 = iVar1;
  }
  setCopReg(0,Status,Status,0);
  return iVar2;


}

void newrequestid(uint *puParm1)
{
  uGp0000196c = uGp0000196c + 0x100;
  if (uGp0000196c == 0) {
    uGp0000196c = 0x100;
  }
  *puParm1 = (uint)*(byte *)puParm1 | uGp0000196c;
  return;


}

uint * locaterequest(uint uParm1)
{
  uint *puVar1;
  uint *puVar2;
  
  if ((0xff < (int)uParm1) && ((int)(uParm1 & 0xff) < iGp00001948)) {
    puVar2 = (uint *)(iGp0000194c + (uParm1 & 0xff) * 0x2c);
    puVar1 = (uint *)0x0;
    if (*puVar2 == uParm1) {
      puVar1 = puVar2;
    }
    return puVar1;
  }
  return (uint *)0;


}

void cancelrequest(uint *puParm1)
{
  uint uVar1;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  uVar1 = puParm1[3];
  if (uVar1 == 1) {
    puParm1[3] = 2;
  }
  setCopReg(0,Status,Status,0);
  if (uVar1 == 1) {
    if (1 < puParm1[4]) {
      purgememadr();
    }
    puParm1[6] = 0;
    *puParm1 = (uint)*(byte *)puParm1;
    queueadd(&freequeue,puParm1);
  }
  return;


}

void finishrequest(int iParm1)
{
  *(undefined4 *)(iParm1 + 0x18) = 0;
  if (*(int *)(iParm1 + 0x14) != 0) {
    queueadd(&callqueue);
  }
  return;


}

void loadfileclosecallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  FILE_completeop(*(undefined4 *)(iParm3 + 0x18));
  if (*(int *)(iParm3 + 0xc) == 0) {
    finishrequest(iParm3);
  }
  else {
    cancelrequest(iParm3);
  }
  return;


}

void loadfilereadcallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  code *pcVar2;
  
  iVar1 = FILE_completeop(*(undefined4 *)(iParm3 + 0x18));
  *(int *)(iParm3 + 8) = *(int *)(iParm3 + 8) + iVar1;
  if ((iVar1 < iGp00001944) || (*(int *)(iParm3 + 0xc) != 0)) {
    iVar1 = FILE_close(*(undefined4 *)(iParm3 + 0x1c),99,iParm3);
    *(int *)(iParm3 + 0x18) = iVar1;
    if (iVar1 == 0) {
      return;
    }
    pcVar2 = loadfileclosecallback;
  }
  else {
    *(int *)(iParm3 + 0x20) = *(int *)(iParm3 + 0x20) + iVar1;
    *(int *)(iParm3 + 0x28) = *(int *)(iParm3 + 0x28) + iVar1;
    iVar1 = FILE_read(*(undefined4 *)(iParm3 + 0x1c),*(undefined4 *)(iParm3 + 0x20),
                      *(undefined4 *)(iParm3 + 0x28),iGp00001944,99,iParm3);
    *(int *)(iParm3 + 0x18) = iVar1;
    if (iVar1 == 0) {
      return;
    }
    pcVar2 = loadfilereadcallback;
  }
  FILE_callbackop(iVar1,pcVar2);
  return;


}

void loadfilesizecallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  undefined4 uVar1;
  int iVar2;
  code *pcVar3;
  
  uVar1 = FILE_completeop(*(undefined4 *)(iParm3 + 0x18));
  if (*(int *)(iParm3 + 0xc) == 0) {
    uVar1 = reservememadr("ASYNCBUF",uVar1,*(undefined4 *)(iParm3 + 0x24));
    *(undefined4 *)(iParm3 + 0x10) = uVar1;
    *(undefined4 *)(iParm3 + 0x28) = uVar1;
    iVar2 = FILE_read(*(undefined4 *)(iParm3 + 0x1c),*(undefined4 *)(iParm3 + 0x20),
                      *(undefined4 *)(iParm3 + 0x28),uGp00001944,99,iParm3);
    *(int *)(iParm3 + 0x18) = iVar2;
    if (iVar2 == 0) {
      return;
    }
    pcVar3 = loadfilereadcallback;
  }
  else {
    iVar2 = FILE_close(*(undefined4 *)(iParm3 + 0x1c),99,iParm3);
    *(int *)(iParm3 + 0x18) = iVar2;
    if (iVar2 == 0) {
      return;
    }
    pcVar3 = loadfileclosecallback;
  }
  FILE_callbackop(iVar2,pcVar3);
  return;


}

void loadfileopencallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  code *pcVar2;
  
  iVar1 = FILE_completeop(*(undefined4 *)(iParm3 + 0x18));
  *(int *)(iParm3 + 0x1c) = iVar1;
  if (iVar1 == 0) {
    if (*(int *)(iParm3 + 0xc) == 0) {
      finishrequest(iParm3);
    }
    else {
      cancelrequest(iParm3);
    }
  }
  else {
    if (*(int *)(iParm3 + 0xc) == 0) {
      if (*(int *)(iParm3 + 0x10) == 0) {
        iVar1 = FILE_read(*(undefined4 *)(iParm3 + 0x1c),*(undefined4 *)(iParm3 + 0x20),
                          *(undefined4 *)(iParm3 + 0x28),uGp00001944,99,iParm3);
        *(int *)(iParm3 + 0x18) = iVar1;
        if (iVar1 == 0) {
          return;
        }
        pcVar2 = loadfilereadcallback;
      }
      else {
        iVar1 = FILE_size(iVar1,99,iParm3);
        *(int *)(iParm3 + 0x18) = iVar1;
        if (iVar1 == 0) {
          return;
        }
        pcVar2 = loadfilesizecallback;
      }
    }
    else {
      iVar1 = FILE_close(iVar1,99,iParm3);
      *(int *)(iParm3 + 0x18) = iVar1;
      if (iVar1 == 0) {
        return;
      }
      pcVar2 = loadfileclosecallback;
    }
    FILE_callbackop(iVar1,pcVar2);
  }
  return;


}

void loadsegreadcallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  
  iVar1 = FILE_completeop(*(undefined4 *)(iParm3 + 0x18));
  *(int *)(iParm3 + 8) = *(int *)(iParm3 + 8) + iVar1;
  iGp00001968 = *(int *)(iParm3 + 0x20) + iVar1;
  *(int *)(iParm3 + 0x20) = iGp00001968;
  if (*(int *)(iParm3 + 0xc) == 0) {
    if (iVar1 < iGp00001944) {
      finishrequest(iParm3);
    }
    else {
      *(int *)(iParm3 + 0x24) = *(int *)(iParm3 + 0x24) - iVar1;
      *(int *)(iParm3 + 0x28) = *(int *)(iParm3 + 0x28) + iVar1;
      iVar1 = *(int *)(iParm3 + 0x24);
      if (iGp00001944 < *(int *)(iParm3 + 0x24)) {
        iVar1 = iGp00001944;
      }
      iVar1 = FILE_read(uGp00001964,*(undefined4 *)(iParm3 + 0x20),*(undefined4 *)(iParm3 + 0x28),
                        iVar1,99,iParm3);
      *(int *)(iParm3 + 0x18) = iVar1;
      if (iVar1 != 0) {
        FILE_callbackop(iVar1,loadsegreadcallback);
      }
    }
  }
  else {
    cancelrequest(iParm3);
  }
  return;


}

undefined4 asyncsystemtask(void)
{
  uint *puVar1;
  
  while( true ) {
    puVar1 = (uint *)queuefetch(&callqueue);
    if (puVar1 == (uint *)0x0) break;
    if (puVar1[3] == 0) {
      (*(code *)puVar1[5])(*puVar1);
      *puVar1 = (uint)*(byte *)puVar1;
      queueadd(&freequeue,puVar1);
    }
    else {
      cancelrequest(puVar1);
    }
  }
  return 0;


}

void initasync(int iParm1,undefined4 uParm2)
{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  if ((piGp0000194c == (int *)0x0) && (iParm1 < 0x101)) {
    uGp00001944 = uParm2;
    iGp00001948 = iParm1;
    piGp0000194c = (int *)reservememadr("ASYNCREQ",iParm1 * 0x2c);
    piGp00001958 = piGp0000194c + iParm1 * 0xb + -0xb;
    uGp0000195c = 0;
    uGp00001960 = 0;
    uGp00001964 = 0;
    piGp00001954 = piGp0000194c;
    uGp00001970 = allocmutex();
    iVar3 = 0;
    if (0 < iParm1) {
      iVar4 = 0x2c;
      piVar2 = piGp0000194c;
      do {
        iVar1 = (int)piGp0000194c + iVar4;
        iVar4 = iVar4 + 0x2c;
        *piVar2 = iVar3;
        piVar2[1] = iVar1;
        piVar2[6] = 0;
        iVar3 = iVar3 + 1;
        piVar2 = piVar2 + 0xb;
      } while (iVar3 < iParm1);
    }
    piGp0000194c[iParm1 * 0xb + -10] = 0;
    addsystemtask(asyncsystemtask,1,1);
  }
  return;


}

undefined4 asyncloadfilecallback(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)queuefetch(&freequeue);
  uVar2 = 0;
  if (puVar1 != (undefined4 *)0x0) {
    newrequestid(puVar1);
    puVar1[2] = 0;
    puVar1[3] = 0;
    puVar1[4] = 1;
    puVar1[5] = uParm3;
    puVar1[8] = 0;
    puVar1[9] = uParm2;
    iVar3 = FILE_open(uParm1,1,100,puVar1);
    puVar1[6] = iVar3;
    if (iVar3 == 0) {
      uVar2 = 0;
    }
    else {
      FILE_callbackop(iVar3,loadfileopencallback);
      uVar2 = *puVar1;
    }
  }
  return uVar2;


}

void asyncloadfile(undefined4 uParm1,undefined4 uParm2)
{
  asyncloadfilecallback(uParm1,uParm2,0);
  return;


}

undefined4 asyncloadfileatcallback(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)queuefetch(&freequeue);
  uVar2 = 0;
  if (puVar1 != (undefined4 *)0x0) {
    newrequestid(puVar1);
    puVar1[2] = 0;
    puVar1[3] = 0;
    puVar1[4] = 0;
    puVar1[5] = uParm3;
    puVar1[8] = 0;
    puVar1[10] = uParm2;
    iVar3 = FILE_open(uParm1,1,100,puVar1);
    puVar1[6] = iVar3;
    if (iVar3 == 0) {
      uVar2 = 0;
    }
    else {
      FILE_callbackop(iVar3,loadfileopencallback);
      uVar2 = *puVar1;
    }
  }
  return uVar2;


}

void asyncloadfileat(undefined4 uParm1,undefined4 uParm2)
{
  asyncloadfileatcallback(uParm1,uParm2,0);
  return;


}

void setasyncfile(int iParm1)
{
  if (iGp00001964 != 0) {
    FILE_closesync(iGp00001964,100);
  }
  if (iParm1 == 0) {
    iGp00001964 = 0;
  }
  else {
    FILE_opensync(iParm1,1,100,&asyncfilehandle);
    uGp00001968 = 0;
  }
  return;


}

undefined4 asyncloadsegmentcallback(undefined4 uParm1,undefined4 uParm2,int iParm3,undefined4 uParm4)
{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)queuefetch(&freequeue);
  uVar2 = 0;
  if (puVar1 != (undefined4 *)0x0) {
    newrequestid(puVar1);
    puVar1[2] = 0;
    puVar1[3] = 0;
    puVar1[4] = 0;
    puVar1[5] = uParm4;
    puVar1[8] = uParm1;
    puVar1[9] = iParm3;
    puVar1[10] = uParm2;
    if (iGp00001964 == 0) {
      finishrequest(puVar1);
    }
    else {
      if (iGp00001944 < iParm3) {
        iParm3 = iGp00001944;
      }
      iVar3 = FILE_read(iGp00001964,puVar1[8],puVar1[10],iParm3,100,puVar1);
      puVar1[6] = iVar3;
      if (iVar3 == 0) {
        return 0;
      }
      FILE_callbackop(iVar3,loadsegreadcallback);
    }
    uVar2 = *puVar1;
  }
  return uVar2;


}

void asyncloadsegment(void)
{
  asyncloadsegmentcallback();
  return;


}

void cancelasyncload(void)
{
  int iVar1;
  
  iVar1 = locaterequest();
  if ((iVar1 != 0) && (*(int *)(iVar1 + 0xc) == 0)) {
    *(undefined4 *)(iVar1 + 0xc) = 1;
    FILE_cancelop(*(undefined4 *)(iVar1 + 0x18));
    if ((*(int *)(iVar1 + 0x18) == 0) && (*(int *)(iVar1 + 0x14) == 0)) {
      cancelrequest(iVar1);
    }
  }
  return;


}

uint getasyncreadadr(void)
{
  uint *puVar1;
  uint uVar2;
  
  puVar1 = (uint *)locaterequest();
  uVar2 = 0;
  if (((puVar1 != (uint *)0x0) && (uVar2 = 0, puVar1[3] == 0)) && (uVar2 = 0, puVar1[6] == 0)) {
    uVar2 = puVar1[4];
    if (uVar2 == 1) {
      uVar2 = 0;
    }
    if ((puVar1[4] != 0) && (puVar1[5] == 0)) {
      *puVar1 = (uint)*(byte *)puVar1;
      queueadd(&freequeue);
    }
  }
  return uVar2;


}

uint getasyncreadstatus(void)
{
  uint *puVar1;
  uint uVar2;
  
  puVar1 = (uint *)locaterequest();
  uVar2 = 0xfffffffe;
  if (((puVar1 != (uint *)0x0) && (uVar2 = 0xfffffffe, puVar1[3] == 0)) &&
     (uVar2 = 0, puVar1[6] == 0)) {
    uVar2 = puVar1[2];
    if (uVar2 == 0) {
      uVar2 = 0xffffffff;
    }
    if ((puVar1[4] == 0) && (puVar1[5] == 0)) {
      *puVar1 = (uint)*(byte *)puVar1;
      queueadd(&freequeue);
    }
  }
  return uVar2;


}

undefined4 SetVideoMode(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = DAT_80134838;
  DAT_80134838 = uParm1;
  return uVar1;


}

undefined4 GetVideoMode(void)
{
  return DAT_80134838;


}

void blockclear(undefined *puParm1,int iParm2)
{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  undefined4 *puVar4;
  int iVar5;
  
  if (iParm2 < 4) {
    iVar5 = iParm2 + -2;
    if (-1 < iParm2 + -1) {
      while( true ) {
        *puParm1 = 0;
        puParm1 = puParm1 + 1;
        if (iVar5 < 0) break;
        iVar5 = iVar5 + -1;
      }
    }
    return;
  }
  uVar3 = (uint)puParm1 & 3;
  *(uint *)(puParm1 + -uVar3) =
       *(uint *)(puParm1 + -uVar3) & 0xffffffffU >> (4 - uVar3) * 8 | 0 << uVar3 * 8;
  iVar5 = 4 - ((uint)puParm1 & 3);
  puVar4 = (undefined4 *)(puParm1 + iVar5);
  iVar5 = iParm2 - iVar5;
  while (-1 < iVar5 + -0x80) {
    *puVar4 = 0;
    puVar4[1] = 0;
    puVar4[2] = 0;
    puVar4[3] = 0;
    puVar4[4] = 0;
    puVar4[5] = 0;
    puVar4[6] = 0;
    puVar4[7] = 0;
    puVar4[8] = 0;
    puVar4[9] = 0;
    puVar4[10] = 0;
    puVar4[0xb] = 0;
    puVar4[0xc] = 0;
    puVar4[0xd] = 0;
    puVar4[0xe] = 0;
    puVar4[0xf] = 0;
    puVar4[0x10] = 0;
    puVar4[0x11] = 0;
    puVar4[0x12] = 0;
    puVar4[0x13] = 0;
    puVar4[0x14] = 0;
    puVar4[0x15] = 0;
    puVar4[0x16] = 0;
    puVar4[0x17] = 0;
    puVar4[0x18] = 0;
    puVar4[0x19] = 0;
    puVar4[0x1a] = 0;
    puVar4[0x1b] = 0;
    puVar4[0x1c] = 0;
    puVar4[0x1d] = 0;
    puVar4[0x1e] = 0;
    puVar4[0x1f] = 0;
    puVar4 = puVar4 + 0x20;
    iVar5 = iVar5 + -0x80;
  }
  while (-1 < iVar5 + -0x10) {
    *puVar4 = 0;
    puVar4[1] = 0;
    puVar4[2] = 0;
    puVar4[3] = 0;
    puVar4 = puVar4 + 4;
    iVar5 = iVar5 + -0x10;
  }
  while (-1 < iVar5 + -4) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
    iVar5 = iVar5 + -4;
  }
  uVar3 = (int)puVar4 + iVar5 + -1;
  uVar1 = uVar3 & 3;
  puVar2 = (uint *)(uVar3 - uVar1);
  *puVar2 = *puVar2 & -1 << (uVar1 + 1) * 8 | 0U >> (3 - uVar1) * 8;
  return;


}

void blockfill(undefined *puParm1,int iParm2,uint uParm3)
{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  int iVar4;
  
  uParm3 = uParm3 & 0xff;
  if (iParm2 < 4) {
    iVar4 = iParm2 + -2;
    if (-1 < iParm2 + -1) {
      while( true ) {
        *puParm1 = (char)uParm3;
        puParm1 = puParm1 + 1;
        if (iVar4 < 0) break;
        iVar4 = iVar4 + -1;
      }
    }
    return;
  }
  uParm3 = uParm3 | uParm3 << 8;
  uParm3 = uParm3 | uParm3 << 0x10;
  uVar2 = (uint)puParm1 & 3;
  *(uint *)(puParm1 + -uVar2) =
       *(uint *)(puParm1 + -uVar2) & 0xffffffffU >> (4 - uVar2) * 8 | uParm3 << uVar2 * 8;
  iVar4 = 4 - ((uint)puParm1 & 3);
  puVar3 = (uint *)(puParm1 + iVar4);
  iVar4 = iParm2 - iVar4;
  while (-1 < iVar4 + -0x80) {
    *puVar3 = uParm3;
    puVar3[1] = uParm3;
    puVar3[2] = uParm3;
    puVar3[3] = uParm3;
    puVar3[4] = uParm3;
    puVar3[5] = uParm3;
    puVar3[6] = uParm3;
    puVar3[7] = uParm3;
    puVar3[8] = uParm3;
    puVar3[9] = uParm3;
    puVar3[10] = uParm3;
    puVar3[0xb] = uParm3;
    puVar3[0xc] = uParm3;
    puVar3[0xd] = uParm3;
    puVar3[0xe] = uParm3;
    puVar3[0xf] = uParm3;
    puVar3[0x10] = uParm3;
    puVar3[0x11] = uParm3;
    puVar3[0x12] = uParm3;
    puVar3[0x13] = uParm3;
    puVar3[0x14] = uParm3;
    puVar3[0x15] = uParm3;
    puVar3[0x16] = uParm3;
    puVar3[0x17] = uParm3;
    puVar3[0x18] = uParm3;
    puVar3[0x19] = uParm3;
    puVar3[0x1a] = uParm3;
    puVar3[0x1b] = uParm3;
    puVar3[0x1c] = uParm3;
    puVar3[0x1d] = uParm3;
    puVar3[0x1e] = uParm3;
    puVar3[0x1f] = uParm3;
    puVar3 = puVar3 + 0x20;
    iVar4 = iVar4 + -0x80;
  }
  while (-1 < iVar4 + -0x10) {
    *puVar3 = uParm3;
    puVar3[1] = uParm3;
    puVar3[2] = uParm3;
    puVar3[3] = uParm3;
    puVar3 = puVar3 + 4;
    iVar4 = iVar4 + -0x10;
  }
  while (-1 < iVar4 + -4) {
    *puVar3 = uParm3;
    puVar3 = puVar3 + 1;
    iVar4 = iVar4 + -4;
  }
  uVar2 = (int)puVar3 + iVar4 + -1;
  uVar1 = uVar2 & 3;
  puVar3 = (uint *)(uVar2 - uVar1);
  *puVar3 = *puVar3 & -1 << (uVar1 + 1) * 8 | uParm3 >> (3 - uVar1) * 8;
  return;


}

int fastintcos(int iParm1)
{
  uint uVar1;
  uint uVar2;
  
  uVar1 = iParm1 + 0x100;
  uVar2 = uVar1 & 0xff;
  if ((uVar1 & 0x200) != 0) {
    if ((uVar1 & 0x100) == 0) {
      return -*(int *)(&sintbl + uVar2 * 4);
    }
    return -*(int *)(&UNK_80137864 + uVar2 * -4);
  }
  if ((uVar1 & 0x100) == 0) {
    return *(undefined4 *)(&sintbl + uVar2 * 4);
  }
  return *(undefined4 *)(&UNK_80137864 + uVar2 * -4);


}

int fastintsin(uint uParm1)
{
  uint uVar1;
  
  uVar1 = uParm1 & 0xff;
  if ((uParm1 & 0x200) != 0) {
    if ((uParm1 & 0x100) == 0) {
      return -*(int *)(&sintbl + uVar1 * 4);
    }
    return -*(int *)(&UNK_80137864 + uVar1 * -4);
  }
  if ((uParm1 & 0x100) == 0) {
    return *(undefined4 *)(&sintbl + uVar1 * 4);
  }
  return *(undefined4 *)(&UNK_80137864 + uVar1 * -4);


}

int resizememadr(int iParm1,int iParm2)
{
  ushort uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  
  uVar1 = *(ushort *)(iParm1 + -0xe);
  iVar6 = *(int *)(iParm1 + -8);
  iVar7 = *(int *)(&memclass + ((uint)uVar1 & 0xf) * 4);
  if ((*(ushort *)(iVar6 + 2) & 0x4000) != 0) {
    FREE_remove(iVar7,iVar6);
    iVar6 = *(int *)(iVar6 + 8);
    *(int *)(iParm1 + -8) = iVar6;
  }
  iVar4 = iParm2;
  if (iParm2 < 8) {
    if (iParm2 == -1) {
      iVar4 = 0x40000000;
    }
    else {
      iVar4 = iParm2;
      if (-1 < iParm2) {
        iVar4 = 8;
      }
    }
  }
  uVar2 = getblockname(iParm1);
  iVar3 = MEM_tailsize(uVar2,(uint)uVar1);
  iVar4 = (iVar4 + iVar3 + *(int *)(iVar7 + 0x28) + 0xf & -*(int *)(iVar7 + 0x28)) - 0x10;
  iVar5 = (iVar6 - (iParm1 + -0x10)) + -0x10;
  if (iVar5 < iVar4) {
    iParm2 = iVar5 - iVar3;
    iVar4 = iVar5;
  }
  blockmove(iParm1 + *(int *)(iParm1 + -0xc),iParm1 + iParm2);
  *(int *)(iParm1 + -0xc) = iParm2;
  if (0x40 < iVar5 - iVar4) {
    iVar4 = iParm1 + iVar4 + 0x10;
    initmemblock(iVar4,0,0,0,0,iParm1 + -0x10,iVar6);
    FREE_add(iVar7,iVar4);
    *(int *)(iVar6 + 0xc) = iVar4;
    *(int *)(iParm1 + -8) = iVar4;
  }
  return iParm1;


}

void VectorNormalS(undefined4 *puParm1,undefined2 *puParm2)
{
  undefined2 uVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  
  uVar1 = (undefined2)*puParm1;
  uVar2 = (undefined2)puParm1[1];
  uVar3 = (undefined2)puParm1[2];
  FUN_800f1b3c();
  *puParm2 = uVar1;
  puParm2[1] = uVar2;
  puParm2[2] = uVar3;
  return;


}

void VectorNormal(undefined4 *puParm1,undefined4 *puParm2)
{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  uVar1 = *puParm1;
  uVar2 = puParm1[1];
  uVar3 = puParm1[2];
  FUN_800f1b3c();
  *puParm2 = uVar1;
  puParm2[1] = uVar2;
  puParm2[2] = uVar3;
  return;


}

void FUN_800f1b3c(void)
{
  uint uVar1;
  undefined4 in_t0;
  undefined4 in_t1;
  undefined4 in_t2;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  
  setCopReg(2,0x4800,in_t0);
  setCopReg(2,0x5000,in_t1);
  setCopReg(2,0x5800,in_t2);
  copFunction(2,0xa00428);
  iVar2 = getCopReg(2,0xc800);
  iVar4 = getCopReg(2,0xd000);
  iVar5 = getCopReg(2,0xd800);
  iVar5 = iVar2 + iVar4 + iVar5;
  setCopReg(2,0xf000,iVar5);
  uVar1 = getCopReg(2,0xf800);
  uVar3 = (uVar1 & 0xfffffffe) - 0x18;
  if ((int)uVar3 < 0) {
    iVar5 = iVar5 >> (0x18 - (uVar1 & 0xfffffffe) & 0x1f);
  }
  else {
    iVar5 = iVar5 << (uVar3 & 0x1f);
  }
  setCopReg(2,0x4000,(int)*(short *)(&DAT_8013485c + (iVar5 + -0x40) * 2));
  setCopReg(2,0x4800,in_t0);
  setCopReg(2,0x5000,in_t1);
  setCopReg(2,0x5800,in_t2);
  copFunction(2,0x190003d);
  getCopReg(2,0xc800);
  getCopReg(2,0xd000);
  getCopReg(2,0xd800);
  return;


}

uint GetTPage(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  return (uParm1 & 3) << 7 | (uParm2 & 3) << 5 | (int)(uParm4 & 0x100) >> 4 |
         (int)(uParm3 & 0x3ff) >> 6 | (uParm4 & 0x200) << 2;


}

void loadshapeadr(char *pcParm1,undefined4 uParm2)
{
  char cVar1;
  size_t sVar2;
  char *pcVar3;
  char acStack137 [129];
  
  strcpy(acStack137 + 1,pcParm1);
  sVar2 = strlen(acStack137 + 1);
  pcVar3 = acStack137 + sVar2;
  while (acStack137 + 1 < pcVar3) {
    cVar1 = *pcVar3;
    if (cVar1 == '.') goto LAB_800f1ce0;
    if (((cVar1 == ':') || (cVar1 == '/')) || (cVar1 == '\\')) break;
    pcVar3 = pcVar3 + -1;
  }
  if (*pcVar3 != '.') {
    strcat(acStack137 + 1,pcGp000017d4);
  }
LAB_800f1ce0:
  loadpackadr(acStack137 + 1,uParm2);
  return;


}

void addexit(int iParm1)
{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = &DAT_801349e8;
  do {
    iVar2 = iVar2 + 1;
    if (*piVar1 == iParm1) {
      return;
    }
    piVar1 = piVar1 + 1;
  } while (iVar2 < 0x20);
  iVar2 = 0;
  piVar1 = &DAT_801349e8;
  do {
    iVar2 = iVar2 + 1;
    if (*piVar1 == 0) {
      *piVar1 = iParm1;
      return;
    }
    piVar1 = piVar1 + 1;
  } while (iVar2 < 0x20);
  return;


}

undefined4 SNDSYS_getopts(undefined4 *puParm1)
{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  
  uVar4 = 0;
  if (DAT_80134a68 == 0) {
    uVar4 = iSNDplatformoutputcaps();
    DAT_80134a68 = 1;
  }
  puVar1 = (undefined4 *)&sndgs;
  if (_DAT_8014786c == 0) {
    _DAT_8014786c = 0x10;
    puVar1 = (undefined4 *)&sndgs;
  }
  do {
    puVar3 = puParm1;
    puVar2 = puVar1;
    uVar5 = puVar2[1];
    uVar6 = puVar2[2];
    uVar7 = puVar2[3];
    *puVar3 = *puVar2;
    puVar3[1] = uVar5;
    puVar3[2] = uVar6;
    puVar3[3] = uVar7;
    puVar1 = puVar2 + 4;
    puParm1 = puVar3 + 4;
  } while (puVar2 + 4 != (undefined4 *)0x80147890);
  uVar5 = puVar2[5];
  uVar6 = puVar2[6];
  puVar3[4] = uRam80147890;
  puVar3[5] = uVar5;
  puVar3[6] = uVar6;
  return uVar4;


}

undefined4 SNDSYS_setopts(int iParm1)
{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  
  puVar2 = (undefined4 *)&DAT_8014786c;
  puVar1 = (undefined4 *)(iParm1 + 0xc);
  if (((uint)puVar1 & 3) == 0) {
    do {
      uVar3 = puVar1[1];
      uVar4 = puVar1[2];
      uVar5 = puVar1[3];
      *puVar2 = *puVar1;
      puVar2[1] = uVar3;
      puVar2[2] = uVar4;
      puVar2[3] = uVar5;
      puVar1 = puVar1 + 4;
      puVar2 = puVar2 + 4;
    } while (puVar1 != (undefined4 *)(iParm1 + 0x2cU));
  }
  else {
    do {
      uVar3 = puVar1[1];
      uVar4 = puVar1[2];
      uVar5 = puVar1[3];
      *puVar2 = *puVar1;
      puVar2[1] = uVar3;
      puVar2[2] = uVar4;
      puVar2[3] = uVar5;
      puVar1 = puVar1 + 4;
      puVar2 = puVar2 + 4;
    } while (puVar1 != (undefined4 *)(iParm1 + 0x2cU));
  }
  uVar3 = puVar1[1];
  uVar4 = puVar1[2];
  *puVar2 = *puVar1;
  puVar2[1] = uVar3;
  puVar2[2] = uVar4;
  _DAT_80147898 = *(undefined4 *)(iParm1 + 0x38);
  iSNDplatformoutputset();
  return 0;


}

int SNDSYS_init(void)
{
  int iVar1;
  
  iVar1 = 0;
  if (DAT_8014789c == '\0') {
    iSNDmeminit();
    if (DAT_80147871 == 0) {
      SNDSYS_getopts(&sndgs);
      SNDSYS_setopts(&sndgs);
    }
    _DAT_801478f4 = (void *)iSNDmalloc((uint)DAT_80147871 * 100);
    memset(_DAT_801478f4,0,(uint)DAT_80147871 * 100);
    _DAT_801478f8 = (void *)iSNDmalloc((uint)_DAT_8014786c * 0xc);
    memset(_DAT_801478f8,0,(uint)_DAT_8014786c * 0xc);
    if (_DAT_801478a8 == (code *)0x0) {
      _DAT_801478a8 = iSND100hzserver;
    }
    SNDI_mutexalloc();
    _DAT_801478a4 = 0;
    _DAT_8014790c = 0;
    DAT_8014789d = 0x7f;
    iVar1 = iSNDinit();
    if (iVar1 < 0) {
      iSNDrestore();
    }
    else {
      DAT_8014789c = '\x01';
      iVar1 = 0;
    }
  }
  return iVar1;


}

undefined4 SNDSYS_restore(void)
{
  undefined4 uVar1;
  
  uVar1 = 0xfffffff6;
  if (DAT_8014789c != '\0') {
    if (_DAT_801478ec != (code *)0x0) {
      (*_DAT_801478ec)();
    }
    if (_DAT_801478f0 != (code *)0x0) {
      (*_DAT_801478f0)();
    }
    if (_DAT_801478e4 != (code *)0x0) {
      (*_DAT_801478e4)();
    }
    if (_DAT_801478e8 != (code *)0x0) {
      (*_DAT_801478e8)();
    }
    if (_DAT_801478e0 != (code *)0x0) {
      (*_DAT_801478e0)();
    }
    SNDstopall();
    if (_DAT_801478dc != (code *)0x0) {
      (*_DAT_801478dc)(0xffffffff);
    }
    iSNDrestore();
    DAT_8014789c = '\0';
    SNDI_mutexfree();
    uVar1 = iSNDmemrestore();
  }
  return uVar1;


}

undefined4 iSNDsystemtaskreal(void)
{
  SNDSYS_service();
  return 0;


}

undefined4 SNDSYS_vectortoreal(void)
{
  if (DAT_80134a6c == 0) {
    addsystemtask(iSNDsystemtaskreal,0,1);
    DAT_80134a6c = 1;
  }
  return 0;


}

uint InitGeom(void)
{
  undefined4 unaff_retaddr;
  
  DAT_80134a70 = unaff_retaddr;
  _patch_gte();
  setCopReg(0,Status,Status | 0x40000000,0);
  setCopControlWord(2,0xe800,0x155);
  setCopControlWord(2,0xf000,0x100);
  setCopControlWord(2,0xd000,1000);
  setCopControlWord(2,0xd800,0xffffef9e);
  setCopControlWord(2,0xe000,0x1400000);
  setCopControlWord(2,0xc000,0);
  setCopControlWord(2,0xc800,0);
  return Status | 0x40000000;


}

void SetDefDrawEnv(undefined2 *param_1,undefined2 param_2,undefined2 param_3,undefined2 param_4, int param_5)
{
  bool bVar1;
  int iVar2;
  
  iVar2 = GetVideoMode();
  *param_1 = param_2;
  param_1[1] = param_3;
  param_1[2] = param_4;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  *(undefined *)((int)param_1 + 0x19) = 0;
  *(undefined *)(param_1 + 0xd) = 0;
  *(undefined *)((int)param_1 + 0x1b) = 0;
  *(undefined *)(param_1 + 0xb) = 1;
  param_1[3] = (short)param_5;
  if (iVar2 == 0) {
    bVar1 = param_5 < 0x101;
  }
  else {
    bVar1 = param_5 < 0x121;
  }
  *(bool *)((int)param_1 + 0x17) = bVar1;
  param_1[4] = param_2;
  param_1[5] = param_3;
  param_1[10] = 10;
  *(undefined *)(param_1 + 0xc) = 0;
  return;


}

void SetDefDispEnv(undefined2 *param_1,undefined2 param_2,undefined2 param_3,undefined2 param_4, undefined2 param_5)
{
  *param_1 = param_2;
  param_1[1] = param_3;
  param_1[2] = param_4;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  *(undefined *)((int)param_1 + 0x11) = 0;
  *(undefined *)(param_1 + 8) = 0;
  *(undefined *)((int)param_1 + 0x13) = 0;
  *(undefined *)(param_1 + 9) = 0;
  param_1[3] = param_5;
  return;


}

uint VSync(int iParm1)
{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
  do {
  } while (false);
  uVar3 = _DAT_1f801110 - Hcount & 0xffff;
  uVar1 = Vcount;
  if ((-1 < iParm1) && (uVar1 = uVar3, iParm1 != 1)) {
    uVar1 = DAT_80134a94;
    if (0 < iParm1) {
      uVar1 = (DAT_80134a94 - 1) + iParm1;
    }
    iVar2 = 0;
    if (0 < iParm1) {
      iVar2 = iParm1 + -1;
    }
    FUN_800f2494(uVar1,iVar2);
    uVar1 = _DAT_1f801814;
    FUN_800f2494(Vcount + 1,1);
    if (((uVar1 & 0x400000) != 0) && (-1 < (int)(uVar1 ^ _DAT_1f801814))) {
      do {
      } while (((uVar1 ^ _DAT_1f801814) & 0x80000000) == 0);
    }
    DAT_80134a94 = Vcount;
    do {
      Hcount = _DAT_1f801110;
      uVar1 = uVar3;
    } while (false);
  }
  return uVar1;


}

void FUN_800f2494(int iParm1,int iParm2)
{
  iParm2 = iParm2 << 0xf;
  do {
    if (iParm1 <= Vcount) {
      return;
    }
    iParm2 = iParm2 + -1;
  } while (iParm2 != -1);
  puts("VSync: timeout\n");
  ChangeClearPAD(0);
  ChangeClearRCnt(3,0);
  return;


}

undefined2 * RotMatrix(short *psParm1,undefined2 *puParm2)
{
  int iVar1;
  int iVar2;
  int iVar3;
  short sVar4;
  undefined2 uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  uVar6 = SEXT24(*psParm1);
  if ((int)uVar6 < 0) {
    iVar7 = *(int *)(&rcossin_tbl + (-uVar6 & 0xfff) * 4);
    iVar1 = -(int)(short)iVar7;
  }
  else {
    iVar7 = *(int *)(&rcossin_tbl + (uVar6 & 0xfff) * 4);
    iVar1 = (int)(short)iVar7;
  }
  iVar7 = iVar7 >> 0x10;
  uVar6 = SEXT24(psParm1[1]);
  if ((int)uVar6 < 0) {
    iVar8 = *(int *)(&rcossin_tbl + (-uVar6 & 0xfff) * 4);
    iVar2 = (int)(short)iVar8;
    sVar4 = -(short)iVar8;
  }
  else {
    iVar8 = *(int *)(&rcossin_tbl + (uVar6 & 0xfff) * 4);
    sVar4 = (short)iVar8;
    iVar2 = -(int)sVar4;
  }
  iVar8 = iVar8 >> 0x10;
  uVar6 = SEXT24(psParm1[2]);
  puParm2[2] = sVar4;
  puParm2[5] = (short)(-(iVar8 * iVar1) >> 0xc);
  uVar5 = (undefined2)(iVar8 * iVar7 >> 0xc);
  if ((int)uVar6 < 0) {
    puParm2[8] = uVar5;
    iVar9 = *(int *)(&rcossin_tbl + (-uVar6 & 0xfff) * 4);
    iVar3 = -(int)(short)iVar9;
  }
  else {
    puParm2[8] = uVar5;
    iVar9 = *(int *)(&rcossin_tbl + (uVar6 & 0xfff) * 4);
    iVar3 = (int)(short)iVar9;
  }
  iVar9 = iVar9 >> 0x10;
  *puParm2 = (short)(iVar9 * iVar8 >> 0xc);
  puParm2[1] = (short)(-(iVar3 * iVar8) >> 0xc);
  iVar8 = iVar9 * iVar2 >> 0xc;
  puParm2[3] = (short)(iVar3 * iVar7 >> 0xc) - (short)(iVar8 * iVar1 >> 0xc);
  puParm2[6] = (short)(iVar3 * iVar1 >> 0xc) + (short)(iVar8 * iVar7 >> 0xc);
  iVar2 = iVar3 * iVar2 >> 0xc;
  puParm2[4] = (short)(iVar9 * iVar7 >> 0xc) + (short)(iVar2 * iVar1 >> 0xc);
  puParm2[7] = (short)(iVar9 * iVar1 >> 0xc) - (short)(iVar2 * iVar7 >> 0xc);
  return puParm2;


}

void SetFarColor(int iParm1,int iParm2,int iParm3)
{
  setCopControlWord(2,0xa800,iParm1 << 4);
  setCopControlWord(2,0xb000,iParm2 << 4);
  setCopControlWord(2,0xb800,iParm3 << 4);
  return;


}

void SetFogNear(int iParm1,int iParm2)
{
  if (iParm2 == 0) {
    trap(0x1c00);
  }
  if ((iParm2 == -1) && (iParm1 * -0x140 == -0x80000000)) {
    trap(0x1800);
  }
  SetDQA((iParm1 * -0x140) / iParm2);
  SetDQB(0x1400000);
  return;


}

void ResetCallback(void)
{
  FUN_800f2968();
  return;


}

void InterruptCallback(void)
{
  FUN_800f2c10();
  return;


}

void DMACallback(void)
{
  (*DAT_80135b64)();
  return;


}

void VSyncCallback(undefined4 uParm1)
{
  (*DAT_80135b74)(4,uParm1);
  return;


}

void VSyncCallbacks(void)
{
  (*DAT_80135b74)();
  return;


}

uint CheckCallback(void)
{
  return (uint)DAT_80134afa;


}

uint SetIntrMask(undefined2 uParm1)
{
  uint uVar1;
  
  uVar1 = (uint)_DAT_1f801074;
  _DAT_1f801074 = uParm1;
  return uVar1;


}

undefined2 * FUN_800f2968(void)
{
  undefined2 *puVar1;
  int iVar2;
  
  puVar1 = (undefined2 *)0x0;
  if (DAT_80134af8 == 0) {
    _DAT_1f801074 = 0;
    _DAT_1f801070 = 0;
    _DAT_1f8010f0 = 0x33333333;
    FUN_800f2e70(&DAT_80134af8,0x41a);
    iVar2 = setjmp((__jmp_buf_tag *)&DAT_80134b30);
    if (iVar2 != 0) {
      FUN_800f2a40();
    }
    DAT_80134b34 = &DAT_80135b10;
    HookEntryInt(&DAT_80134b30);
    DAT_80134af8 = 1;
    DAT_80135b74 = startIntrVSync();
    DAT_80135b64 = startIntrDMA();
    _96_remove();
    puVar1 = &DAT_80134af8;
    ExitCriticalSection();
  }
  return puVar1;


}

void FUN_800f2a40(void)
{
  bool bVar1;
  ushort uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  code **ppcVar6;
  
  if (DAT_80134af8 == 0) {
    printf("unexpected interrupt(%04x)\n",(uint)_DAT_1f801070);
    ReturnFromException();
  }
  DAT_80134afa = 1;
  uVar2 = _DAT_1f801074 & DAT_80134b28 & _DAT_1f801070;
  if (uVar2 != 0) {
    do {
      uVar4 = (uint)uVar2;
      uVar5 = 0;
      ppcVar6 = (code **)&DAT_80134afc;
      if (uVar2 != 0) {
        do {
          if (10 < (int)uVar5) break;
          if ((uVar4 & 1) != 0) {
            _DAT_1f801070 = ~(ushort)(1 << (uVar5 & 0x1f));
            if (*ppcVar6 != (code *)0x0) {
              (**ppcVar6)();
            }
          }
          uVar4 = uVar4 >> 1;
          uVar5 = uVar5 + 1;
          ppcVar6 = ppcVar6 + 1;
        } while (uVar4 != 0);
      }
      uVar2 = _DAT_1f801074 & DAT_80134b28 & _DAT_1f801070;
    } while (uVar2 != 0);
  }
  if ((_DAT_1f801070 & _DAT_1f801074) == 0) {
    DAT_80135b90 = 0;
  }
  else {
    iVar3 = DAT_80135b90 + 1;
    bVar1 = 0x800 < DAT_80135b90;
    DAT_80135b90 = iVar3;
    if (bVar1) {
      DAT_80135b90 = iVar3;
      printf("intr timeout(%04x:%04x)\n",(uint)_DAT_1f801070,(uint)_DAT_1f801074);
      DAT_80135b90 = 0;
      _DAT_1f801070 = 0;
    }
  }
  DAT_80134afa = 0;
  ReturnFromException();
  return;


}

int FUN_800f2c10(uint uParm1,int iParm2)
{
  ushort uVar1;
  int *piVar2;
  ushort uVar3;
  int iVar4;
  
  uVar3 = _DAT_1f801074;
  piVar2 = &DAT_80134afc + uParm1;
  iVar4 = *piVar2;
  if ((iParm2 != iVar4) && (DAT_80134af8 != 0)) {
    _DAT_1f801074 = 0;
    if (iParm2 == 0) {
      uVar1 = ~(ushort)(1 << (uParm1 & 0x1f));
      *piVar2 = 0;
      uVar3 = uVar3 & uVar1;
      DAT_80134b28 = DAT_80134b28 & uVar1;
    }
    else {
      *piVar2 = iParm2;
      uVar1 = (ushort)(1 << (uParm1 & 0x1f));
      uVar3 = uVar3 | uVar1;
      DAT_80134b28 = DAT_80134b28 | uVar1;
    }
    if (uParm1 == 0) {
      ChangeClearPAD((uint)(iParm2 == 0));
      ChangeClearRCnt(3,(uint)(iParm2 == 0));
    }
    if (uParm1 == 4) {
      ChangeClearRCnt(0,(uint)(iParm2 == 0));
    }
    if (uParm1 == 5) {
      ChangeClearRCnt(1,(uint)(iParm2 == 0));
    }
    if (uParm1 == 6) {
      ChangeClearRCnt(2,(uint)(iParm2 == 0));
    }
  }
  _DAT_1f801074 = uVar3;
  return iVar4;


}

undefined2 * FUN_800f2d58(void)
{
  undefined2 *puVar1;
  
  puVar1 = (undefined2 *)0x0;
  if (DAT_80134af8 != 0) {
    EnterCriticalSection();
    DAT_80134b2a = _DAT_1f801074;
    DAT_80134b2c = _DAT_1f8010f0;
    _DAT_1f801074 = 0;
    _DAT_1f801070 = 0;
    _DAT_1f8010f0 = _DAT_1f8010f0 & 0x77777777;
    ResetEntryInt();
    DAT_80134af8 = 0;
    puVar1 = &DAT_80134af8;
  }
  return puVar1;


}

undefined2 * FUN_800f2df8(void)
{
  undefined2 *puVar1;
  
  puVar1 = &DAT_80134af8;
  if (DAT_80134af8 == 0) {
    HookEntryInt(&DAT_80134b30);
    DAT_80134af8 = 1;
    _DAT_1f801074 = DAT_80134b2a;
    _DAT_1f8010f0 = DAT_80134b2c;
    ExitCriticalSection();
  }
  else {
    puVar1 = (undefined2 *)0x0;
  }
  return puVar1;


}

void FUN_800f2e70(undefined4 *puParm1,int iParm2)
{
  int iVar1;
  
  iVar1 = iParm2 + -1;
  if (iParm2 != 0) {
    do {
      *puParm1 = 0;
      iVar1 = iVar1 + -1;
      puParm1 = puParm1 + 1;
    } while (iVar1 != -1);
  }
  return;


}

void setfont(int iParm1)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  DAT_80135c1c = 100;
  DAT_80135bac = (int)*(char *)(iParm1 + 0x10);
  DAT_80135bb0 = (int)*(char *)(iParm1 + 0x11);
  DAT_80135bbc = (int)*(char *)(iParm1 + 0x12);
  DAT_80135bc0 = (int)*(char *)(iParm1 + 0x13);
  DAT_80135bc4 = (int)*(char *)(iParm1 + 0x13) + (int)*(char *)(iParm1 + 0x12);
  iVar3 = iParm1 + *(int *)(iParm1 + 0x1c);
  DAT_80135bc8 = (int)*(char *)(iParm1 + 0x13) + (int)*(char *)(iParm1 + 0x12);
  DAT_80135c14 = (uint)*(ushort *)(iParm1 + 10);
  DAT_80135bb8 = 1;
  DAT_80135c50 = 0;
  DAT_80135c4c = 0;
  DAT_80135c24 = iParm1 + *(int *)(iParm1 + 0x14);
  DAT_80135c20 = iParm1;
  DAT_80135c28 = iVar3;
  DAT_80135bb4 = shapedepth(iVar3);
  iVar1 = shapedepth(iVar3);
  DAT_80135c18 = (int)((int)*(short *)(iVar3 + 4) * iVar1 + 0x1fU & 0xffffffe0) >> 3;
  if ((*(ushort *)(iParm1 + 0xe) & 3) == 2) {
    DAT_80135c40 = decodeshiftjis;
  }
  else {
    if ((int)DAT_80135c14 < 0x100) {
      uVar2 = geti(iParm1 + 0x20,2);
      if (uVar2 < 0x100) {
        DAT_80135c40 = (code *)&decodeansi;
      }
      else {
        DAT_80135c40 = decodeshiftjis;
      }
    }
    else {
      DAT_80135c40 = decodeshiftjis;
    }
  }
  DAT_80135bcc = 0;
  DAT_80135bd0 = 0;
  DAT_80135c54 = 0;
  blockclear(&DAT_80135bd4,0x40);
  inittextdraw();
  DAT_80135c44 = 0;
  return;


}

uint getm(byte *pbParm1,int iParm2)
{
  byte bVar1;
  
  bVar1 = *pbParm1;
  if (iParm2 + -3 < 0) {
    if (-1 < iParm2 + -2) {
      return (uint)CONCAT11(bVar1,pbParm1[1]);
    }
    return (uint)bVar1;
  }
  if (iParm2 != 3) {
    return CONCAT22(CONCAT11(bVar1,pbParm1[1]),CONCAT11(pbParm1[2],pbParm1[3]));
  }
  return (uint)CONCAT21(CONCAT11(bVar1,pbParm1[1]),pbParm1[2]);


}

uint geti(int *piParm1,int iParm2)
{
  uint uVar1;
  
  uVar1 = iParm2 * -8 + 0x20;
  return (uint)(*piParm1 << (uVar1 & 0x1f)) >> (uVar1 & 0x1f);


}

void putm(int iParm1,uint uParm2,int iParm3)
{
  undefined *puVar1;
  
  iParm3 = iParm3 + -1;
  puVar1 = (undefined *)(iParm1 + iParm3);
  while (-1 < iParm3) {
    *puVar1 = (char)uParm2;
    uParm2 = uParm2 >> 8;
    iParm3 = iParm3 + -1;
    puVar1 = puVar1 + -1;
  }
  return;


}

void puti(undefined *puParm1,uint uParm2,int iParm3)
{
  iParm3 = iParm3 + -1;
  while (-1 < iParm3) {
    *puParm1 = (char)uParm2;
    uParm2 = uParm2 >> 8;
    iParm3 = iParm3 + -1;
    puParm1 = puParm1 + 1;
  }
  return;


}

void SetSemiTrans(int iParm1,int iParm2)
{
  byte bVar1;
  
  if (iParm2 == 0) {
    bVar1 = *(byte *)(iParm1 + 7) & 0xfd;
  }
  else {
    bVar1 = *(byte *)(iParm1 + 7) | 2;
  }
  *(byte *)(iParm1 + 7) = bVar1;
  return;


}

short * RotMatrixZ(uint uParm1,short *psParm2)
{
  short sVar1;
  short sVar2;
  short sVar3;
  int iVar4;
  int iVar5;
  
  if ((int)uParm1 < 0) {
    iVar5 = *(int *)(&rcossin_tbl + (-uParm1 & 0xfff) * 4);
    iVar4 = -(int)(short)iVar5;
  }
  else {
    iVar5 = *(int *)(&rcossin_tbl + (uParm1 & 0xfff) * 4);
    iVar4 = (int)(short)iVar5;
  }
  iVar5 = iVar5 >> 0x10;
  sVar1 = *psParm2;
  sVar2 = psParm2[1];
  sVar3 = psParm2[2];
  *psParm2 = (short)(iVar5 * (int)sVar1 - iVar4 * (int)psParm2[3] >> 0xc);
  psParm2[1] = (short)(iVar5 * (int)sVar2 - iVar4 * (int)psParm2[4] >> 0xc);
  psParm2[2] = (short)(iVar5 * (int)sVar3 - iVar4 * (int)psParm2[5] >> 0xc);
  psParm2[3] = (short)(iVar4 * (int)sVar1 + iVar5 * (int)psParm2[3] >> 0xc);
  psParm2[4] = (short)(iVar4 * (int)sVar2 + iVar5 * (int)psParm2[4] >> 0xc);
  psParm2[5] = (short)(iVar4 * (int)sVar3 + iVar5 * (int)psParm2[5] >> 0xc);
  return psParm2;


}

uint isqrt(uint uParm1)
{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  if ((uParm1 & 0xffff0000) != 0) {
    if ((uParm1 & 0xff000000) == 0) {
      uVar4 = ((uint)(byte)(&isqrttbl)[uParm1 >> 0x10] + 1) * 0x10;
      uVar1 = (uint)(byte)(&DAT_8013be0f)[uParm1 >> 0x10] << 4;
    }
    else {
      uVar1 = (uint)(byte)(&DAT_8013be0f)[uParm1 >> 0x18] << 8;
      uVar4 = ((uint)(byte)(&isqrttbl)[uParm1 >> 0x18] + 1) * 0x100;
    }
    while (uVar3 = uVar1, 1 < uVar4 - uVar3) {
      uVar2 = uVar3 + uVar4 >> 1;
      uVar1 = uVar2;
      if (uParm1 < uVar2 * uVar2) {
        uVar1 = uVar3;
        uVar4 = uVar2;
      }
    }
    return uVar3;
  }
  if ((uParm1 & 0xff00) == 0) {
    if (uParm1 == 0) {
      return 0;
    }
    uVar1 = (uint)((byte)(&DAT_8013be0f)[uParm1] >> 4);
  }
  else {
    if ((uParm1 & 0xf000) == 0) {
      if ((uParm1 & 0xc00) == 0) {
        uVar4 = (uint)((byte)(&DAT_8013be0f)[uParm1 >> 2] >> 3);
        uVar1 = (uint)((byte)(&isqrttbl)[uParm1 >> 2] >> 3);
      }
      else {
        uVar4 = (uint)((byte)(&DAT_8013be0f)[uParm1 >> 4] >> 2);
        uVar1 = (uint)((byte)(&isqrttbl)[uParm1 >> 4] >> 2);
      }
    }
    else {
      if ((uParm1 & 0xc000) == 0) {
        uVar4 = (uint)((byte)(&DAT_8013be0f)[uParm1 >> 6] >> 1);
        uVar1 = (uint)((byte)(&isqrttbl)[uParm1 >> 6] >> 1);
      }
      else {
        uVar1 = (uint)(byte)(&isqrttbl)[uParm1 >> 8];
        uVar4 = (uint)(byte)(&DAT_8013be0f)[uParm1 >> 8];
      }
    }
    if ((uVar1 + 1) - uVar4 < 2) {
      return uVar4;
    }
    uVar1 = uVar4 + uVar1 + 1 >> 1;
    if (uParm1 < uVar1 * uVar1) {
      return uVar4;
    }
  }
  return uVar1;


}

void SetPolyGT4(int iParm1)
{
  *(undefined *)(iParm1 + 3) = 0xc;
  *(undefined *)(iParm1 + 7) = 0x3c;
  return;


}

uint __mulsf3(uint uParm1,uint uParm2)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = uParm1 & 0x80000000 ^ uParm2 & 0x80000000;
  if (((uParm1 & 0x7fffffff) != 0) && ((uParm2 & 0x7fffffff) != 0)) {
    iVar3 = (int)(uParm1 & 0x7fffff | 0x800000) >> 8;
    iVar2 = (int)(uParm2 & 0x7fffff | 0x800000) >> 8;
    iVar4 = ((int)uParm1 >> 0x17 & 0xffU) + ((int)uParm2 >> 0x17 & 0xffU);
    uVar5 = iVar3 * iVar2 + ((int)((uParm1 & 0xff) * iVar2) >> 8) +
            ((int)((uParm2 & 0xff) * iVar3) >> 8);
    iVar2 = iVar4 + -0x7e;
    if ((uVar5 & 0x80000000) == 0) {
      uVar5 = uVar5 + 0x40;
      if ((uVar5 & 0x80000000) == 0) {
        uVar5 = uVar5 >> 7;
        iVar2 = iVar4 + -0x7f;
      }
      else {
        uVar5 = uVar5 >> 8;
      }
    }
    else {
      uVar5 = uVar5 + 0x80 >> 8;
    }
    if (iVar2 < 0xff) {
      uVar6 = uVar6 | iVar2 << 0x17 | uVar5 & 0xff7fffff;
    }
    else {
      _err_math(0x22,0xc);
      bVar1 = uVar6 != 0;
      uVar6 = 0x7f800000;
      if (bVar1) {
        uVar6 = 0xff800000;
      }
    }
  }
  return uVar6;


}

void SetPolyF3(int iParm1)
{
  *(undefined *)(iParm1 + 3) = 4;
  *(undefined *)(iParm1 + 7) = 0x20;
  return;


}

void SetPolyF4(int iParm1)
{
  *(undefined *)(iParm1 + 3) = 5;
  *(undefined *)(iParm1 + 7) = 0x28;
  return;


}

void SetPolyG4(int iParm1)
{
  *(undefined *)(iParm1 + 3) = 8;
  *(undefined *)(iParm1 + 7) = 0x38;
  return;


}

void SetPolyFT4(int iParm1)
{
  *(undefined *)(iParm1 + 3) = 9;
  *(undefined *)(iParm1 + 7) = 0x2c;
  return;


}

void fixedsincos(uint uParm1,int *piParm2,int *piParm3)
{
  int iVar1;
  int local_18;
  int local_14;
  
  intsincos((int)uParm1 >> 6,&local_18,&local_14);
  iVar1 = (int)((uParm1 & 0x3f) * 0x6487e) >> 9;
  *piParm2 = local_18 + ((local_14 >> 2) * iVar1 >> 0x15);
  *piParm3 = local_14 - ((local_18 >> 2) * iVar1 >> 0x15);
  return;


}

double ccos(double __z)
{
  int iVar1;
  uint uVar2;
  int in_a0;
  uint uVar3;
  double in_f0_1;
  double dVar4;
  undefined auStack16 [4];
  undefined local_c [4];
  
  if (in_a0 < 0) {
    in_a0 = -in_a0;
  }
  iVar1 = in_a0;
  if (in_a0 < 0) {
    iVar1 = in_a0 + 0xfff;
  }
  uVar2 = in_a0 + (iVar1 >> 0xc) * -0x1000;
  if (uVar2 < 0x400) {
    dVar4 = (double)csincos(uVar2,auStack16,local_c);
  }
  else {
    if (uVar2 - 0x400 < 0x400) {
      uVar3 = 0x7ff - uVar2;
    }
    else {
      uVar3 = uVar2 - 0x800;
      if (0x3ff < uVar3) {
        if (0x3ff < uVar2 - 0xc00) {
          return in_f0_1;
        }
        dVar4 = (double)csincos(0xfff - uVar2,auStack16,local_c);
        return dVar4;
      }
    }
    dVar4 = (double)csincos(uVar3,auStack16,local_c);
  }
  return dVar4;


}

double csin(double __z)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  int in_a0;
  uint uVar4;
  double in_f0_1;
  double dVar5;
  undefined local_10 [4];
  undefined auStack12 [4];
  
  if (in_a0 < 0) {
    iVar1 = -in_a0;
    iVar2 = iVar1;
    if (0 < in_a0) {
      iVar2 = iVar1 + 0xfff;
    }
    uVar3 = iVar1 + (iVar2 >> 0xc) * -0x1000;
    if (0x3ff < uVar3) {
      if (0x3ff < uVar3 - 0x400) {
        uVar4 = uVar3 - 0x800;
        if (0x3ff < uVar4) {
          if (0x3ff < uVar3 - 0xc00) {
            return in_f0_1;
          }
          uVar4 = 0xfff - uVar3;
        }
        dVar5 = (double)csincos(uVar4,local_10,auStack12);
        return dVar5;
      }
      uVar3 = 0x7ff - uVar3;
    }
    dVar5 = (double)csincos(uVar3,local_10,auStack12);
  }
  else {
    uVar3 = in_a0 + (in_a0 >> 0xc) * -0x1000;
    if (0x3ff < uVar3) {
      if (0x3ff < uVar3 - 0x400) {
        uVar4 = uVar3 - 0x800;
        if (0x3ff < uVar4) {
          if (0x3ff < uVar3 - 0xc00) {
            return in_f0_1;
          }
          uVar4 = 0xfff - uVar3;
        }
        dVar5 = (double)csincos(uVar4,local_10,auStack12);
        return dVar5;
      }
      uVar3 = 0x7ff - uVar3;
    }
    dVar5 = (double)csincos(uVar3,local_10,auStack12);
  }
  return dVar5;


}

uint __fixsfsi(uint uParm1)
{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  if ((uParm1 & 0x7fffffff) == 0) {
    uVar1 = uParm1 & 0x80000000;
  }
  else {
    uVar1 = (int)uParm1 >> 0x17 & 0xff;
    iVar3 = uVar1 - 0x9d;
    if (iVar3 < 1) {
      uVar2 = uParm1 & 0x7fffff | 0x800000;
      if ((uVar1 - 0x7e < 0x20) && (uVar2 != 0)) {
        uVar1 = (int)(uVar2 << 7) >> (-iVar3 & 0x1fU);
        if ((int)uParm1 < 0) {
          uVar1 = -uVar1;
        }
      }
      else {
        uVar1 = 0;
      }
    }
    else {
      if ((int)uParm1 < 0) {
        uVar1 = 0x80000000;
      }
      else {
        _err_math(0x22,0x12);
        uVar1 = 0x7fffffff;
      }
    }
  }
  return uVar1;


}

void initjoy(undefined4 uParm1)
{
  numjoy = uParm1;
  if (iGp000017dc == 0) {
    numjoy = uParm1;
    padinit();
    iGp000017dc = 1;
  }
  return;


}

void initfileio(void)
{
  int iVar1;
  
  if (disablecd == 0) {
    availablefilesystems = availablefilesystems | 1;
  }
  iVar1 = psxdevelopmentsystem();
  if (iVar1 == 0) {
    currentfilesystem = 1;
  }
  else {
    PCinit();
    addsystemtask(readfile_systask,0,0);
    currentfilesystem = 2;
    availablefilesystems = availablefilesystems | 2;
  }
  return;


}

void setdirectory(char *pcParm1)
{
  int iVar1;
  size_t sVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar1 = strncmp(pcParm1,pcGp000017e8,6);
  if (iVar1 == 0) {
    if ((availablefilesystems & 3) == 2) {
      return;
    }
    sVar2 = strlen(pcParm1);
    iVar3 = 6;
    if (6 < sVar2) {
      return;
    }
    currentfilesystem = 1;
  }
  else {
    iVar1 = strncmp(pcParm1,pcGp000017f4,4);
    if (iVar1 == 0) {
      iVar3 = 4;
      if ((availablefilesystems & 2) == 0) {
        return;
      }
      currentfilesystem = 2;
    }
  }
  if ((currentfilesystem == 2) && (strcpy(&currentdirectory,pcParm1 + iVar3), DAT_80140453 == '\0'))
  {
    sVar2 = strlen(&currentdirectory);
    if ((0 < (int)sVar2) && ((&currentdirectory)[sVar2] != '\\')) {
      strcat(&currentdirectory,"\\");
    }
  }
  return;


}

undefined4 openfile(char *pcParm1,uint uParm2,uint *puParm3)
{
  char *pcVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  char acStack88 [2];
  undefined auStack86 [62];
  
  memset(acStack88,0,0x40);
  iVar4 = currentfilesystem;
  pcVar1 = strchr(pcParm1,0x3a);
  if (pcVar1 != (char *)0x0) {
    iVar2 = strncmp(pcParm1,pcGp000017e8,6);
    if (iVar2 == 0) {
      iVar4 = 1;
      if ((availablefilesystems & 1) == 0) {
        return 0;
      }
      pcParm1 = pcParm1 + 6;
    }
    else {
      iVar2 = strncmp(pcParm1,pcGp000017f4,4);
      if (iVar2 == 0) {
        iVar4 = 2;
        if ((availablefilesystems & 2) == 0) {
          return 0;
        }
        pcParm1 = pcParm1 + 4;
      }
      else {
        if ((currentfilesystem == 1) || (pcParm1[1] != ':')) {
          pcVar1 = strchr(pcParm1,0x3a);
          strncpy(acStack88,pcParm1,(size_t)(pcVar1 + (1 - (int)pcParm1)));
          pcVar1 = strchr(pcParm1,0x3a);
          auStack86[(int)(pcVar1 + -(int)pcParm1)] = 0;
          iVar4 = 0;
        }
      }
    }
  }
  if (iVar4 == 1) {
    iVar4 = CD_Open(pcParm1,uParm2,puParm3);
    if (iVar4 == 0) {
      return 0;
    }
    *puParm3 = *puParm3 | 0x1000000;
    return 1;
  }
  if (iVar4 != 2) {
    return 0;
  }
  if ((*pcParm1 != '\\') && (*pcParm1 != '/')) {
    strcpy(acStack88,&currentdirectory);
  }
  strcat(acStack88,pcParm1);
  if (false) {
switchD_800f3d8c_caseD_3:
    *puParm3 = 0xffffffff;
  }
  else {
    switch(uParm2 & 7) {
    case 0:
      uVar3 = PCopen(acStack88,2,0);
      *puParm3 = uVar3;
      break;
    case 1:
      uVar3 = PCopen(acStack88,0,0);
      *puParm3 = uVar3;
      break;
    case 2:
      uVar3 = PCopen(acStack88,0,0);
      *puParm3 = uVar3;
      if ((int)uVar3 < 0) {
        uVar3 = PCcreat(acStack88,0);
        *puParm3 = uVar3;
      }
      break;
    default:
      goto switchD_800f3d8c_caseD_3;
    case 4:
      uVar3 = PCopen(acStack88,0,0);
      *puParm3 = uVar3;
      if ((int)uVar3 < 0) goto LAB_800f3e60;
      PCclose(uVar3);
      uVar3 = PCcreat(acStack88,0);
      *puParm3 = uVar3;
      break;
    case 6:
      uVar3 = PCcreat(acStack88,0);
      *puParm3 = uVar3;
    }
  }
  if (0 < (int)*puParm3) {
    *puParm3 = *puParm3 | 0x2000000;
    return 1;
  }
LAB_800f3e60:
  *puParm3 = 0;
  return 0;


}

undefined4 closefile(uint uParm1)
{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((int)uParm1 >> 0x18 == 1) {
    uVar1 = CD_Close();
  }
  else {
    if ((int)uParm1 >> 0x18 == 2) {
      uVar1 = PCclose(uParm1 & 0xffffff);
    }
  }
  return uVar1;


}

uint readfile(uint uParm1,undefined4 uParm2,undefined4 uParm3,undefined4 uParm4)
{
  bool bVar1;
  uint uVar2;
  
  uVar2 = 0;
  if ((int)uParm1 >> 0x18 == 1) {
    uVar2 = CD_Read();
  }
  else {
    if ((int)uParm1 >> 0x18 == 2) {
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      bVar1 = _readcmd == 0;
      if (bVar1) {
        _readcmd = 1;
        _DAT_80140404 = uParm1 & 0xffffff;
        _DAT_80140408 = uParm2;
        _DAT_8014040c = uParm3;
        _DAT_80140410 = uParm4;
      }
      uVar2 = (uint)bVar1;
      setCopReg(0,Status,Status,0);
    }
  }
  return uVar2;


}

undefined4 readfile_systask(void)
{
  uint uVar1;
  int iVar2;
  
  uVar1 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (_readcmd != 0) {
    PClseek(_DAT_80140404,_DAT_8014040c,0);
    iVar2 = PCread(_DAT_80140404,_DAT_80140408,_DAT_80140410);
    _readcmd = 0;
    iFILE_CommandCompleteCallback((uint)(iVar2 == _DAT_80140410));
  }
  setCopReg(0,Status,uVar1,0);
  return 0;


}

undefined4 writefile(uint uParm1,undefined4 uParm2,undefined4 uParm3,int iParm4)
{
  int iVar1;
  
  if ((int)uParm1 >> 0x18 == 2) {
    PClseek(uParm1 & 0xffffff,uParm3,0);
    iVar1 = PCwrite(uParm1 & 0xffffff,uParm2,iParm4);
    iFILE_CommandCompleteCallback((uint)(iVar1 == iParm4));
  }
  return 0;


}

undefined4 getfilesize(uint uParm1)
{
  undefined4 local_10 [2];
  
  local_10[0] = 0;
  if ((int)uParm1 >> 0x18 == 1) {
    CD_Getinfo(uParm1 & 0xffffff,0,local_10);
  }
  else {
    if ((int)uParm1 >> 0x18 == 2) {
      local_10[0] = PClseek(uParm1 & 0xffffff,0,2);
    }
  }
  return local_10[0];


}

void stopreadfile(uint uParm1)
{
  if ((int)uParm1 >> 0x18 == 1) {
    CD_Stopread();
  }
  else {
    if ((((int)uParm1 >> 0x18 == 2) && (_readcmd != 0)) && (_DAT_80140404 == (uParm1 & 0xffffff))) {
      _readcmd = 0;
      iFILE_CommandCompleteCallback(1);
    }
  }
  return;


}

void initmemadr(undefined4 uParm1,undefined4 uParm2)
{
  creatememclass(0,&DAT_8013dd48,uParm1,uParm2,8,0x20,0,0,0,0,0,&MEM_defaultevent);
  _DAT_8013e904 = _memclass;
  return;


}

void inittimer(int iParm1)
{
  if (iParm1 == 0) {
    iParm1 = 100;
  }
  EnterCriticalSection();
  if (timerflag == 0) {
    blockclear(&tmrsub,0x20);
    timerevent = OpenEvent(0xf2000002,2,0x1000,tmrint);
    EnableEvent();
    timerflag = 1;
    addexit(restoretimer);
  }
  initgp();
  if (iParm1 == 0) {
    trap(0x1c00);
  }
  if ((iParm1 == -1) && (false)) {
    trap(0x1800);
  }
  reentryflag = 0;
  timerhz = iParm1;
  SetRCnt(0xf2000002,0x409980 / iParm1 & 0xffff,0x1000);
  StartRCnt(0xf2000002);
  ExitCriticalSection();
  resettick();
  addexit(restoretimer);
  return;


}

void restoretimer(void)
{
  DisableEvent(timerevent);
  timerflag = 0;
  return;


}

undefined4 tmrint(void)
{
  code **ppcVar1;
  int iVar2;
  undefined4 local_18 [2];
  
  savegp(local_18);
  iVar2 = 0;
  ppcVar1 = (code **)&tmrsub;
  ticks = ticks + 1;
  g_currentthread = 1;
  libticks = libticks + 1;
  do {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
    iVar2 = iVar2 + 1;
    ppcVar1 = ppcVar1 + 1;
  } while (iVar2 < 8);
  g_currentthread = 0;
  restoregp(local_18[0]);
  return 0;


}

void FlushCache(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

undefined4 shapedepth(byte *pbParm1)
{
  byte bVar1;
  
  bVar1 = *pbParm1 & 0x77;
  if (bVar1 == 0x41) {
    return 8;
  }
  if (bVar1 == 0x40) {
    return 4;
  }
  if ((bVar1 == 0x42) || (bVar1 == 0x23)) {
    return 0x10;
  }
  if (bVar1 != 0x44) {
    if (bVar1 == 0x43) {
      return 0x18;
    }
    if (bVar1 == 0x72) {
      return 8;
    }
  }
  return 1;


}

uint GetClut(int iParm1,uint uParm2)
{
  return (uParm2 & 0x3ff) << 6 | iParm1 >> 4 & 0x3fU;


}

int textbsearch(int iParm1,int iParm2,int iParm3,int iParm4)
{
  int iVar1;
  int iVar2;
  
  if (iParm3 != 0) {
    iVar1 = iParm3 >> 1;
    do {
      iVar2 = iParm2 + iVar1 * iParm4;
      iVar1 = geti(iVar2,2);
      if (iParm1 == iVar1) {
        return iVar2;
      }
      if (0 < iParm1 - iVar1) {
        iParm2 = iVar2 + iParm4;
        iParm3 = iParm3 + -1;
      }
      iParm3 = iParm3 >> 1;
      iVar1 = iParm3 >> 1;
    } while (iParm3 != 0);
  }
  return 0;


}

int getcharacter(int iParm1)
{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = DAT_80135c24;
  iVar3 = DAT_80135c24 + (iParm1 + -0x20) * 0xb;
  iVar2 = geti(iVar3);
  if (iVar2 != iParm1) {
    iVar3 = textbsearch(iParm1,iVar1,DAT_80135c14,0xb);
  }
  return iVar3;


}

uint unhuff(byte *pbParm1,byte *pbParm2,int iParm3)
{
  byte bVar1;
  undefined4 *puVar2;
  char cVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint *puVar6;
  byte bVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  undefined uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  byte *pbVar16;
  uint uVar17;
  int iVar18;
  byte *pbVar19;
  int iVar20;
  int iVar21;
  int iVar22;
  byte *pbVar23;
  int *piVar24;
  int iVar25;
  ushort uVar26;
  byte *pbVar27;
  uint unaff_s8;
  int local_4ec [15];
  int aiStack1200 [16];
  uint auStack1136 [8];
  uint auStack1104 [8];
  byte local_430 [256];
  byte local_330 [256];
  undefined4 local_230 [3];
  undefined4 local_224 [61];
  undefined4 local_130 [3];
  undefined4 local_124 [61];
  uint local_30;
  
  if (pbParm1 == (byte *)0x0) {
    return 0;
  }
  pbVar16 = pbParm1 + 4;
  iVar13 = 0;
  uVar26 = CONCAT11(*pbParm1,pbParm1[1]);
  uVar15 = CONCAT31(CONCAT21(uVar26,pbParm1[2]),pbParm1[3]);
  uVar8 = uVar15 << 0x10;
  if ((*pbParm1 & 1) != 0) {
    pbVar16 = pbParm1 + 8;
    iVar13 = 8;
    uVar15 = (uint)CONCAT21(CONCAT11(pbParm1[5],pbParm1[6]),pbParm1[7]);
    uVar8 = uVar15 << 8;
  }
  uVar26 = uVar26 & 0xfeff;
  iVar14 = iVar13 + -8;
  uVar9 = uVar8 << 8;
  if (iVar14 < 0) {
    bVar7 = *pbVar16;
    pbVar19 = pbVar16 + 1;
    pbVar16 = pbVar16 + 2;
    uVar9 = -iVar14;
    iVar14 = iVar13 + 8;
    uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
    uVar9 = uVar15 << (uVar9 & 0x1f);
  }
  iVar13 = iVar14 + -0x10;
  uVar10 = uVar9 << 0x10;
  if (iVar13 < 0) {
    bVar7 = *pbVar16;
    pbVar19 = pbVar16 + 1;
    pbVar16 = pbVar16 + 2;
    uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
    uVar10 = uVar15 << (-iVar13 & 0x1fU);
    iVar13 = iVar14;
  }
  uVar8 = uVar9 >> 0x10 | (uVar8 >> 0x18) << 0x10;
  pbVar19 = pbParm2;
  if (iParm3 != 0) {
    unaff_s8 = uVar10 >> 0x18;
    iVar14 = iVar13 + -8;
    uVar10 = uVar10 << 8;
    if (iVar14 < 0) {
      bVar7 = *pbVar16;
      pbVar19 = pbVar16 + 1;
      pbVar16 = pbVar16 + 2;
      uVar9 = -iVar14;
      iVar14 = iVar13 + 8;
      uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
      uVar10 = uVar15 << (uVar9 & 0x1f);
    }
    iVar25 = 0;
    iVar21 = 0;
    piVar24 = local_4ec;
    iVar22 = 4;
    iVar20 = 1;
    do {
      iVar12 = iVar20;
      *(int *)((int)aiStack1200 + iVar22) = iVar21 * 2 - iVar25;
      if ((int)uVar10 < 0) {
        uVar17 = uVar10 >> 0x1d;
        iVar13 = iVar14 + -3;
        uVar10 = uVar10 << 3;
        if (iVar13 < 0) {
          bVar7 = *pbVar16;
          pbVar19 = pbVar16 + 1;
          pbVar16 = pbVar16 + 2;
          uVar9 = -iVar13;
          iVar13 = iVar14 + 0xd;
          uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
          uVar10 = uVar15 << (uVar9 & 0x1f);
        }
      }
      else {
        uVar9 = 2;
        if (uVar10 >> 0x10 == 0) {
          uVar17 = 3;
          do {
            uVar9 = uVar17;
            uVar5 = uVar10 >> 0x1f;
            iVar13 = iVar14 + -1;
            uVar10 = uVar10 << 1;
            if (iVar13 < 0) {
              bVar7 = *pbVar16;
              pbVar19 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar10 = -iVar13;
              iVar13 = iVar14 + 0xf;
              uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (uVar10 & 0x1f);
            }
            iVar14 = iVar13;
            uVar17 = uVar9 + 1;
          } while (uVar5 == 0);
        }
        else {
          do {
            uVar17 = uVar10;
            uVar10 = uVar17 << 1;
            uVar9 = uVar9 + 1;
          } while (-1 < (int)uVar10);
          iVar13 = (iVar14 + 1) - uVar9;
          uVar10 = uVar17 << 2;
          if (iVar13 < 0) {
            bVar7 = *pbVar16;
            pbVar19 = pbVar16 + 1;
            pbVar16 = pbVar16 + 2;
            uVar10 = -iVar13;
            iVar13 = iVar13 + 0x10;
            uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
            uVar10 = uVar15 << (uVar10 & 0x1f);
          }
        }
        if ((int)uVar9 < 0x11) {
          uVar17 = uVar10 >> (0x20 - uVar9 & 0x1f);
          iVar13 = iVar13 - uVar9;
          uVar10 = uVar10 << (uVar9 & 0x1f);
          if (iVar13 < 0) {
            bVar7 = *pbVar16;
            pbVar19 = pbVar16 + 1;
            pbVar16 = pbVar16 + 2;
            uVar10 = -iVar13;
            iVar13 = iVar13 + 0x10;
            uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
            uVar10 = uVar15 << (uVar10 & 0x1f);
          }
          uVar17 = uVar17 + (1 << (uVar9 & 0x1f));
        }
        else {
          uVar5 = uVar10 >> (0x30 - uVar9 & 0x1f);
          uVar17 = uVar10 << (uVar9 - 0x10 & 0x1f);
          iVar14 = (iVar13 + 0x10) - uVar9;
          if (iVar14 < 0) {
            bVar7 = *pbVar16;
            pbVar19 = pbVar16 + 1;
            pbVar16 = pbVar16 + 2;
            uVar10 = -iVar14;
            iVar14 = iVar14 + 0x10;
            uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
            uVar17 = uVar15 << (uVar10 & 0x1f);
          }
          iVar13 = iVar14 + -0x10;
          uVar10 = uVar17 << 0x10;
          if (iVar13 < 0) {
            bVar7 = *pbVar16;
            pbVar19 = pbVar16 + 1;
            pbVar16 = pbVar16 + 2;
            uVar15 = (uint)*pbVar19 | ((uint)bVar7 | uVar15 << 8) << 8;
            uVar10 = uVar15 << (-iVar13 & 0x1fU);
            iVar13 = iVar14;
          }
          uVar17 = (uVar17 >> 0x10 | uVar5 << 0x10) + (1 << (uVar9 & 0x1f));
        }
      }
      iVar18 = uVar17 - 4;
      *piVar24 = iVar18;
      iVar25 = iVar25 + iVar18;
      iVar21 = iVar21 * 2 + iVar18;
      uVar9 = 0;
      if (iVar18 != 0) {
        uVar9 = iVar21 << (0x10U - iVar12 & 0x1f) & 0xffff;
      }
      *(uint *)((int)auStack1136 + iVar22) = uVar9;
      piVar24 = piVar24 + 1;
      iVar22 = iVar22 + 4;
      iVar20 = iVar12 + 1;
      iVar14 = iVar13;
    } while ((iVar18 == 0) || (iVar20 = iVar12 + 1, iVar14 = iVar13, uVar9 != 0));
    auStack1136[iVar12] = 0xffffffff;
    iVar14 = 0x10;
    puVar4 = local_130;
    puVar2 = local_124;
    do {
      *puVar4 = 0;
      puVar2[-2] = 0;
      puVar2[-1] = 0;
      *puVar2 = 0;
      puVar2 = puVar2 + 4;
      iVar14 = iVar14 + -1;
      puVar4 = puVar4 + 4;
    } while (iVar14 != 0);
    bVar7 = 0xff;
    iVar20 = 0;
    iVar14 = iVar13;
    if (0 < iVar25) {
      do {
        if ((int)uVar10 < 0) {
          uVar17 = uVar10 >> 0x1d;
          iVar13 = iVar14 + -3;
          uVar10 = uVar10 << 3;
          if (iVar13 < 0) {
            bVar1 = *pbVar16;
            pbVar19 = pbVar16 + 1;
            pbVar16 = pbVar16 + 2;
            uVar9 = -iVar13;
            iVar13 = iVar14 + 0xd;
            uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
            uVar10 = uVar15 << (uVar9 & 0x1f);
          }
        }
        else {
          uVar9 = 2;
          if (uVar10 >> 0x10 == 0) {
            uVar17 = 3;
            do {
              uVar9 = uVar17;
              uVar5 = uVar10 >> 0x1f;
              iVar13 = iVar14 + -1;
              uVar10 = uVar10 << 1;
              if (iVar13 < 0) {
                bVar1 = *pbVar16;
                pbVar19 = pbVar16 + 1;
                pbVar16 = pbVar16 + 2;
                uVar10 = -iVar13;
                iVar13 = iVar14 + 0xf;
                uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
                uVar10 = uVar15 << (uVar10 & 0x1f);
              }
              iVar14 = iVar13;
              uVar17 = uVar9 + 1;
            } while (uVar5 == 0);
          }
          else {
            do {
              uVar17 = uVar10;
              uVar10 = uVar17 << 1;
              uVar9 = uVar9 + 1;
            } while (-1 < (int)uVar10);
            iVar13 = (iVar14 + 1) - uVar9;
            uVar10 = uVar17 << 2;
            if (iVar13 < 0) {
              bVar1 = *pbVar16;
              pbVar19 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar10 = -iVar13;
              iVar13 = iVar13 + 0x10;
              uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (uVar10 & 0x1f);
            }
          }
          if ((int)uVar9 < 0x11) {
            uVar17 = uVar10 >> (0x20 - uVar9 & 0x1f);
            iVar13 = iVar13 - uVar9;
            uVar10 = uVar10 << (uVar9 & 0x1f);
            if (iVar13 < 0) {
              bVar1 = *pbVar16;
              pbVar19 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar10 = -iVar13;
              iVar13 = iVar13 + 0x10;
              uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (uVar10 & 0x1f);
            }
            uVar17 = uVar17 + (1 << (uVar9 & 0x1f));
          }
          else {
            uVar5 = uVar10 >> (0x30 - uVar9 & 0x1f);
            uVar17 = uVar10 << (uVar9 - 0x10 & 0x1f);
            iVar14 = (iVar13 + 0x10) - uVar9;
            if (iVar14 < 0) {
              bVar1 = *pbVar16;
              pbVar19 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar10 = -iVar14;
              iVar14 = iVar14 + 0x10;
              uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
              uVar17 = uVar15 << (uVar10 & 0x1f);
            }
            iVar13 = iVar14 + -0x10;
            uVar10 = uVar17 << 0x10;
            if (iVar13 < 0) {
              bVar1 = *pbVar16;
              pbVar19 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar15 = (uint)*pbVar19 | ((uint)bVar1 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (-iVar13 & 0x1fU);
              iVar13 = iVar14;
            }
            uVar17 = (uVar17 >> 0x10 | uVar5 << 0x10) + (1 << (uVar9 & 0x1f));
          }
        }
        iVar14 = uVar17 - 3;
        do {
          bVar7 = bVar7 + 1;
          if (*(char *)((int)local_130 + (uint)bVar7) == '\0') {
            iVar14 = iVar14 + -1;
          }
        } while (iVar14 != 0);
        iVar21 = iVar20 + 1;
        *(char *)((int)local_130 + (uint)bVar7) = '\x01';
        local_430[iVar20] = bVar7;
        iVar14 = iVar13;
        iVar20 = iVar21;
      } while (iVar21 < iVar25);
    }
    iVar14 = 0x10;
    puVar4 = local_230;
    puVar2 = local_224;
    do {
      *puVar4 = 0x40404040;
      puVar2[-2] = 0x40404040;
      puVar2[-1] = 0x40404040;
      *puVar2 = 0x40404040;
      puVar2 = puVar2 + 4;
      iVar14 = iVar14 + -1;
      puVar4 = puVar4 + 4;
    } while (iVar14 != 0);
    pbVar27 = local_430;
    pbVar23 = local_330;
    puVar2 = local_230;
    iVar14 = 1;
    pbVar19 = pbParm2;
    if (0 < iVar12) {
      piVar24 = local_4ec;
      do {
        iVar20 = *piVar24;
        pbVar19 = pbParm2;
        if (8 < iVar14) break;
        iVar21 = 1 << (8U - iVar14 & 0x1f);
        while (iVar20 = iVar20 + -1, iVar20 != -1) {
          bVar7 = *pbVar27;
          pbVar27 = pbVar27 + 1;
          uVar11 = (char)iVar14;
          if ((uint)bVar7 == unaff_s8) {
            uVar11 = 0x60;
            local_30 = iVar14;
          }
          iVar22 = 0;
          if (0 < iVar21) {
            do {
              *pbVar23 = bVar7;
              pbVar23 = pbVar23 + 1;
              *(undefined *)puVar2 = uVar11;
              iVar22 = iVar22 + 1;
              puVar2 = (undefined4 *)((int)puVar2 + 1);
            } while (iVar22 < iVar21);
          }
        }
        iVar14 = iVar14 + 1;
        piVar24 = piVar24 + 1;
        pbVar19 = pbParm2;
      } while (iVar14 <= iVar12);
    }
  }
LAB_800f4ce0:
  do {
    uVar9 = uVar10 >> 0x18;
    uVar17 = (uint)*(byte *)((int)local_230 + uVar9);
    iVar13 = iVar13 - uVar17;
    while (pbVar23 = pbVar19, -1 < iVar13) {
      uVar10 = uVar10 << (uVar17 & 0x1f);
      uVar5 = uVar10 >> 0x18;
      *pbVar19 = local_330[uVar9];
      uVar17 = (uint)*(byte *)((int)local_230 + uVar5);
      iVar13 = iVar13 - uVar17;
      pbVar23 = pbVar19 + 1;
      if (iVar13 < 0) break;
      uVar10 = uVar10 << (uVar17 & 0x1f);
      uVar9 = uVar10 >> 0x18;
      pbVar19[1] = local_330[uVar5];
      uVar17 = (uint)*(byte *)((int)local_230 + uVar9);
      iVar13 = iVar13 - uVar17;
      pbVar23 = pbVar19 + 2;
      if (iVar13 < 0) break;
      uVar10 = uVar10 << (uVar17 & 0x1f);
      uVar5 = uVar10 >> 0x18;
      pbVar19[2] = local_330[uVar9];
      uVar17 = (uint)*(byte *)((int)local_230 + uVar5);
      iVar13 = iVar13 - uVar17;
      pbVar23 = pbVar19 + 3;
      if (iVar13 < 0) break;
      uVar10 = uVar10 << (uVar17 & 0x1f);
      uVar9 = uVar10 >> 0x18;
      pbVar19[3] = local_330[uVar5];
      uVar17 = (uint)*(byte *)((int)local_230 + uVar9);
      pbVar19 = pbVar19 + 4;
      iVar13 = iVar13 - uVar17;
    }
    pbVar19 = pbVar23;
    iVar13 = iVar13 + 0x10;
    if (iVar13 < 0) {
      uVar9 = local_30;
      if (uVar17 != 0x60) {
        uVar9 = 8;
        puVar6 = auStack1104;
        do {
          puVar6 = puVar6 + 1;
          uVar9 = uVar9 + 1;
        } while (*puVar6 <= uVar10 >> 0x10);
      }
      uVar5 = uVar10 >> (0x20 - uVar9 & 0x1f);
      uVar10 = uVar10 << (uVar9 & 0x1f);
      bVar7 = local_430[uVar5 - aiStack1200[uVar9]];
      iVar14 = (iVar13 + (uVar17 - 0x10)) - uVar9;
      if ((uint)bVar7 == unaff_s8) {
        if (iVar14 < 0) {
LAB_800f4e38:
          bVar1 = *pbVar16;
          pbVar23 = pbVar16 + 1;
          pbVar16 = pbVar16 + 2;
          uVar9 = -iVar14;
          iVar14 = iVar14 + 0x10;
          uVar15 = (uint)*pbVar23 | ((uint)bVar1 | uVar15 << 8) << 8;
          uVar10 = uVar15 << (uVar9 & 0x1f);
        }
        if ((uint)bVar7 == unaff_s8) {
          if ((int)uVar10 < 0) {
            uVar9 = uVar10 >> 0x1d;
            iVar13 = iVar14 + -3;
            uVar10 = uVar10 << 3;
            if (iVar13 < 0) {
              bVar7 = *pbVar16;
              pbVar23 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar10 = -iVar13;
              iVar13 = iVar14 + 0xd;
              uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (uVar10 & 0x1f);
            }
            iVar14 = uVar9 - 4;
          }
          else {
            uVar9 = 2;
            if (uVar10 >> 0x10 == 0) {
              uVar17 = 3;
              do {
                uVar9 = uVar17;
                uVar5 = uVar10 >> 0x1f;
                iVar13 = iVar14 + -1;
                uVar10 = uVar10 << 1;
                if (iVar13 < 0) {
                  bVar7 = *pbVar16;
                  pbVar23 = pbVar16 + 1;
                  pbVar16 = pbVar16 + 2;
                  uVar10 = -iVar13;
                  iVar13 = iVar14 + 0xf;
                  uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
                  uVar10 = uVar15 << (uVar10 & 0x1f);
                }
                uVar17 = uVar9 + 1;
                iVar14 = iVar13;
              } while (uVar5 == 0);
            }
            else {
              do {
                uVar17 = uVar10;
                uVar10 = uVar17 << 1;
                uVar9 = uVar9 + 1;
              } while (-1 < (int)uVar10);
              iVar13 = (iVar14 + 1) - uVar9;
              uVar10 = uVar17 << 2;
              if (iVar13 < 0) {
                bVar7 = *pbVar16;
                pbVar23 = pbVar16 + 1;
                pbVar16 = pbVar16 + 2;
                uVar10 = -iVar13;
                iVar13 = iVar13 + 0x10;
                uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
                uVar10 = uVar15 << (uVar10 & 0x1f);
              }
            }
            if ((int)uVar9 < 0x11) {
              uVar17 = uVar10 >> (0x20 - uVar9 & 0x1f);
              iVar13 = iVar13 - uVar9;
              uVar10 = uVar10 << (uVar9 & 0x1f);
              if (iVar13 < 0) {
                bVar7 = *pbVar16;
                pbVar23 = pbVar16 + 1;
                pbVar16 = pbVar16 + 2;
                uVar10 = -iVar13;
                iVar13 = iVar13 + 0x10;
                uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
                uVar10 = uVar15 << (uVar10 & 0x1f);
              }
              iVar14 = uVar17 + (1 << (uVar9 & 0x1f)) + -4;
            }
            else {
              uVar5 = uVar10 >> (0x30 - uVar9 & 0x1f);
              uVar17 = uVar10 << (uVar9 - 0x10 & 0x1f);
              iVar14 = (iVar13 + 0x10) - uVar9;
              if (iVar14 < 0) {
                bVar7 = *pbVar16;
                pbVar23 = pbVar16 + 1;
                pbVar16 = pbVar16 + 2;
                uVar10 = -iVar14;
                iVar14 = iVar14 + 0x10;
                uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
                uVar17 = uVar15 << (uVar10 & 0x1f);
              }
              iVar13 = iVar14 + -0x10;
              uVar10 = uVar17 << 0x10;
              if (iVar13 < 0) {
                bVar7 = *pbVar16;
                pbVar23 = pbVar16 + 1;
                pbVar16 = pbVar16 + 2;
                uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
                uVar10 = uVar15 << (-iVar13 & 0x1fU);
                iVar13 = iVar14;
              }
              iVar14 = (uVar17 >> 0x10 | uVar5 << 0x10) + (1 << (uVar9 & 0x1f)) + -4;
            }
          }
          pbVar23 = pbVar19 + iVar14;
          if (iVar14 == 0) {
            iVar20 = iVar13 + -1;
            iVar14 = uVar10 << 1;
            if (iVar20 < 0) {
              bVar7 = *pbVar16;
              pbVar23 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar9 = -iVar20;
              iVar20 = iVar13 + 0xf;
              uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
              iVar14 = uVar15 << (uVar9 & 0x1f);
            }
            if (uVar10 >> 0x1f != 0) {
              if (uVar26 == 0x32fb) {
                pbVar16 = pbParm2 + uVar8;
                bVar7 = 0;
                if (pbVar16 <= pbParm2) {
                  return uVar8;
                }
                do {
                  bVar7 = bVar7 + *pbParm2;
                  *pbParm2 = bVar7;
                  pbParm2 = pbParm2 + 1;
                } while (pbParm2 < pbVar16);
                return uVar8;
              }
              if (uVar26 != 0x34fb) {
                return uVar8;
              }
              cVar3 = '\0';
              pbVar16 = pbParm2 + uVar8;
              bVar7 = 0;
              if (pbVar16 <= pbParm2) {
                return uVar8;
              }
              do {
                cVar3 = cVar3 + *pbParm2;
                bVar7 = bVar7 + cVar3;
                *pbParm2 = bVar7;
                pbParm2 = pbParm2 + 1;
              } while (pbParm2 < pbVar16);
              return uVar8;
            }
            iVar13 = iVar20 + -8;
            uVar10 = iVar14 << 8;
            if (iVar13 < 0) {
              bVar7 = *pbVar16;
              pbVar23 = pbVar16 + 1;
              pbVar16 = pbVar16 + 2;
              uVar9 = -iVar13;
              iVar13 = iVar20 + 8;
              uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
              uVar10 = uVar15 << (uVar9 & 0x1f);
            }
            *pbVar19 = (byte)((uint)iVar14 >> 0x18);
            pbVar19 = pbVar19 + 1;
          }
          else {
            bVar7 = pbVar19[-1];
            do {
              *pbVar19 = bVar7;
              pbVar19 = pbVar19 + 1;
            } while (pbVar19 < pbVar23);
          }
          goto LAB_800f4ce0;
        }
        *pbVar19 = bVar7;
        iVar13 = iVar14;
      }
      else {
        if (iVar14 < 0) goto LAB_800f4e38;
        *pbVar19 = bVar7;
        iVar13 = iVar14;
      }
      pbVar19 = pbVar19 + 1;
      goto LAB_800f4ce0;
    }
    *pbVar19 = local_330[uVar10 >> 0x18];
    bVar7 = *pbVar16;
    pbVar23 = pbVar16 + 1;
    pbVar16 = pbVar16 + 2;
    uVar15 = (uint)*pbVar23 | ((uint)bVar7 | uVar15 << 8) << 8;
    uVar10 = uVar15 << (0x10U - iVar13 & 0x1f);
    pbVar19 = pbVar19 + 1;
  } while( true );


}

int memcpyl(int iParm1,int iParm2,int iParm3)
{
  undefined4 uVar1;
  int iVar2;
  
  iVar2 = iParm1 + iParm3;
  do {
    uVar1 = geti(iParm2,4);
    puti(iParm1,uVar1,4);
    iParm1 = iParm1 + 4;
    iParm3 = iParm3 + -4;
    iParm2 = iParm2 + 4;
  } while (0 < iParm3);
  return iVar2;


}

void memcpyb(undefined *puParm1,undefined *puParm2,int iParm3)
{
  undefined uVar1;
  
  do {
    uVar1 = *puParm2;
    puParm2 = puParm2 + 1;
    iParm3 = iParm3 + -1;
    *puParm1 = uVar1;
    puParm1 = puParm1 + 1;
  } while (iParm3 != 0);
  return;


}

int refcpy(void *pvParm1,uint uParm2,size_t sParm3)
{
  int iVar1;
  
  if (uParm2 < 4) {
    iVar1 = (int)pvParm1 + sParm3;
    if (uParm2 == 1) {
      memset(pvParm1,(uint)*(byte *)((int)pvParm1 + -1),sParm3);
    }
    else {
      memcpyb(pvParm1,(void *)((int)pvParm1 - uParm2));
    }
  }
  else {
    iVar1 = memcpyl(pvParm1,(void *)((int)pvParm1 - uParm2));
  }
  return iVar1;


}

int unrefpack(int iParm1,byte *pbParm2,int iParm3)
{
  byte bVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  byte *pbVar7;
  byte *pbVar8;
  int iVar9;
  undefined auStack32 [8];
  
  iVar9 = 0;
  if (iParm1 != 0) {
    uVar2 = geti(iParm1,4);
    pbVar7 = (byte *)(iParm1 + 2);
    if ((uVar2 & 1) != 0) {
      pbVar7 = (byte *)(iParm1 + 5);
    }
    pbVar8 = pbVar7 + 3;
    iVar9 = (uint)*pbVar7 * 0x10000 + (uint)pbVar7[1] * 0x100 + (uint)pbVar7[2];
    if (iParm3 != 0) {
      uVar3 = geti(pbParm2 + iVar9,4);
      puti(auStack32,uVar3,4);
      do {
        while( true ) {
          uVar2 = geti(pbVar8,4);
          if ((uVar2 & 0x80) != 0) break;
          uVar3 = geti(pbVar8 + 2,4);
          puti(pbParm2,uVar3,4);
          pbParm2 = pbParm2 + (uVar2 & 3);
          pbVar8 = pbVar8 + 2 + (uVar2 & 3);
          iVar4 = (uVar2 & 0x60) * 8 + (uVar2 >> 8 & 0xff) + 1;
          iVar5 = (uVar2 >> 2 & 7) + 3;
LAB_800f5488:
          pbParm2 = (byte *)refcpy(pbParm2,iVar4,iVar5);
        }
        if ((uVar2 & 0x40) == 0) {
          uVar6 = uVar2 >> 0xe & 3;
          uVar3 = geti(pbVar8 + 3,4);
          puti(pbParm2,uVar3,4);
          pbParm2 = pbParm2 + uVar6;
          pbVar8 = pbVar8 + 3 + uVar6;
          iVar4 = (uVar2 & 0x3f00) + (uVar2 >> 0x10 & 0xff) + 1;
          iVar5 = (uVar2 & 0x3f) + 4;
          goto LAB_800f5488;
        }
        if ((uVar2 & 0x20) == 0) {
          uVar3 = geti(pbVar8 + 4,4);
          puti(pbParm2,uVar3,4);
          pbParm2 = pbParm2 + (uVar2 & 3);
          pbVar8 = pbVar8 + 4 + (uVar2 & 3);
          iVar4 = (uVar2 & 0x10) * 0x1000 + (uVar2 & 0xff00) + 1 + (uVar2 >> 0x10 & 0xff);
          iVar5 = (uVar2 & 0xc) * 0x40 + (uVar2 >> 0x18) + 5;
          goto LAB_800f5488;
        }
        pbVar8 = pbVar8 + 1;
        if (0xfb < (uVar2 & 0xff)) {
          uVar2 = uVar2 & 3;
          while (uVar2 != 0) {
            bVar1 = *pbVar8;
            pbVar8 = pbVar8 + 1;
            uVar2 = uVar2 - 1;
            *pbParm2 = bVar1;
            pbParm2 = pbParm2 + 1;
          }
          uVar3 = geti(auStack32,4);
          puti(pbParm2,uVar3,4);
          return iVar9;
        }
        iVar4 = ((uVar2 & 0x1f) + 1) * 4;
        memcpyl(pbParm2,pbVar8,iVar4);
        pbParm2 = pbParm2 + iVar4;
        pbVar8 = pbVar8 + iVar4;
      } while( true );
    }
  }
  return iVar9;


}

void chase(byte bParm1)
{
  uint uVar1;
  
  uVar1 = (uint)bParm1;
  if (*(char *)(iGp0000197c + uVar1) == '\0') {
    *pbGp0000198c = bParm1;
    pbGp0000198c = pbGp0000198c + 1;
  }
  else {
    chase((uint)*(byte *)(iGp00001980 + uVar1));
    chase((uint)*(byte *)(iGp00001984 + uVar1));
  }
  return;


}

int unbtree(byte *pbParm1,byte *pbParm2)
{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  bool bVar4;
  undefined *puVar5;
  byte *pbVar6;
  int iVar7;
  byte bVar8;
  uint uVar9;
  undefined auStack784 [256];
  byte abStack528 [256];
  byte abStack272 [256];
  
  puGp0000197c = auStack784;
  pbGp00001980 = abStack528;
  pbGp00001984 = abStack272;
  if (pbParm1 == (byte *)0x0) {
    pbGp00001988 = pbParm1;
    pbGp0000198c = pbParm2;
    return 0;
  }
  pbGp00001988 = pbParm1 + 2;
  if ((uint)*pbParm1 * 0x100 + (uint)pbParm1[1] == 0x47fb) {
    pbGp00001988 = pbParm1 + 5;
  }
  iVar7 = 0;
  bVar1 = *pbGp00001988;
  bVar2 = pbGp00001988[1];
  bVar3 = pbGp00001988[2];
  do {
    puVar5 = puGp0000197c + iVar7;
    iVar7 = iVar7 + 1;
    *puVar5 = 0;
  } while (iVar7 < 0x100);
  puGp0000197c[(uint)pbGp00001988[3]] = 1;
  bVar8 = pbGp00001988[4];
  pbGp00001988 = pbGp00001988 + 5;
  pbGp0000198c = pbParm2;
  if (bVar8 != 0) {
    iVar7 = 1;
    do {
      uVar9 = (uint)*pbGp00001988;
      pbGp00001980[uVar9] = pbGp00001988[1];
      pbGp00001984[uVar9] = pbGp00001988[2];
      pbGp00001988 = pbGp00001988 + 3;
      puGp0000197c[uVar9] = 0xff;
      bVar4 = iVar7 < (int)(uint)bVar8;
      iVar7 = iVar7 + 1;
      pbGp0000198c = pbParm2;
    } while (bVar4);
  }
  do {
    while( true ) {
      bVar8 = *pbGp00001988;
      uVar9 = (uint)bVar8;
      pbVar6 = pbGp00001988 + 1;
      if (puGp0000197c[uVar9] != '\0') break;
LAB_800f5790:
      pbGp00001988 = pbVar6;
      *pbGp0000198c = bVar8;
      pbGp0000198c = pbGp0000198c + 1;
    }
    if (-1 < (char)puGp0000197c[uVar9]) {
      bVar8 = *pbVar6;
      pbVar6 = pbGp00001988 + 2;
      if (bVar8 == 0) {
        pbGp00001988 = pbGp00001988 + 2;
        return ((uint)bVar1 * 0x100 + (uint)bVar2) * 0x100 + (uint)bVar3;
      }
      goto LAB_800f5790;
    }
    pbGp00001988 = pbVar6;
    chase((uint)pbGp00001980[uVar9]);
    chase((uint)pbGp00001984[uVar9]);
  } while( true );


}

undefined8 __extendsfdf2(uint uParm1)
{
  uint uVar1;
  int iVar2;
  undefined4 local_30;
  uint local_2c;
  
  if ((uParm1 & 0x7fffffff) == 0) {
    uParm1 = uParm1 & 0x80000000;
    local_30 = 0;
  }
  else {
    local_2c = uParm1 & 0x7fffff;
    uVar1 = (int)uParm1 >> 0x17 & 0xff;
    local_30 = 0;
    if (uVar1 == 0) {
      uVar1 = uParm1 & 0x600000;
      iVar2 = 0x37e;
      while (uVar1 != 0) {
        _dbl_shift(&local_30,1,local_30,local_2c,1);
        uVar1 = local_2c & 0xffe00000;
        iVar2 = iVar2 + 1;
      }
      while ((local_2c & 0x100000) == 0) {
        local_2c = local_2c << 1;
        iVar2 = iVar2 + -1;
      }
      local_2c = local_2c & 0xffefffff;
    }
    else {
      iVar2 = uVar1 + 0x380;
      _dbl_shift(&local_30,1,0,local_2c,3);
    }
    uParm1 = uParm1 & 0x80000000 | iVar2 << 0x14 | local_2c;
  }
  return CONCAT44(local_30,uParm1);


}

uint __truncdfsf2(int iParm1,uint uParm2)
{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined auStack32 [4];
  int local_1c;
  
  if (((uParm2 & 0x7fffffff) == 0) && (iParm1 == 0)) {
    uVar1 = uParm2 & 0x80000000;
  }
  else {
    uVar1 = (int)uParm2 >> 0x14 & 0x7ff;
    iVar3 = uVar1 - 0x380;
    _dbl_shift(auStack32,0,iParm1,uParm2 & 0xfffff | 0x100000,4);
    if (iVar3 < 1) {
      uVar2 = (uint)(local_1c + (1 << (-iVar3 + 1U & 0x1f))) >> (-iVar3 + 2U & 0x1f);
      iVar3 = 0;
    }
    else {
      uVar2 = local_1c + 1U >> 1;
      if ((uVar2 & 0xff000000) != 0) {
        uVar2 = local_1c + 1U >> 2;
        iVar3 = uVar1 - 0x37f;
      }
    }
    if (iVar3 < 0xff) {
      uVar1 = uParm2 & 0x80000000 | iVar3 << 0x17 | uVar2 & 0xff7fffff;
    }
    else {
      _err_math(0x22,0x10);
      uVar1 = 0x7f800000;
      if ((int)uParm2 < 0) {
        uVar1 = 0xff800000;
      }
    }
  }
  return uVar1;


}

undefined8 __adddf3(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  int local_50;
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint local_48;
  uint local_44;
  uint local_40;
  uint local_3c;
  undefined4 local_38;
  undefined4 local_34;
  uint local_30;
  uint local_2c;
  
  local_30 = 0;
  uVar6 = 0;
  local_2c = 0;
  if ((((uParm2 & 0x7fffffff) != 0) || (uVar3 = uParm3, uVar1 = uParm4, uParm1 != 0)) &&
     (((uParm4 & 0x7fffffff) != 0 || (uVar3 = uParm1, uVar1 = uParm2, uParm3 != 0)))) {
    uVar4 = (int)uParm2 >> 0x14 & 0x7ff;
    uVar5 = (int)uParm4 >> 0x14 & 0x7ff;
    uVar3 = uParm1;
    uVar1 = uParm2;
    if ((uVar4 <= uVar5 + 0x36) && (uVar3 = uParm3, uVar1 = uParm4, uVar5 <= uVar4 + 0x36)) {
      local_44 = uParm2 & 0xfffff | 0x100000;
      local_3c = uParm4 & 0xfffff | 0x100000;
      local_48 = uParm1;
      local_40 = uParm3;
      if ((int)uParm2 < 0) {
        local_48 = uParm1;
        local_40 = uParm3;
        _mainasu(&local_48,uParm1);
      }
      if ((uParm4 & 0x80000000) != 0) {
        _mainasu(&local_40,local_40,local_3c);
      }
      _dbl_shift(&local_48,0,local_48,local_44,9);
      puVar2 = &local_40;
      _dbl_shift(puVar2,0,local_40,local_3c,9);
      local_50 = uVar4 - uVar5;
      uVar3 = local_40;
      uVar1 = local_3c;
      if (uVar4 <= uVar5) {
        puVar2 = &local_48;
        local_50 = uVar5 - uVar4;
        uVar3 = local_48;
        uVar1 = local_44;
        uVar4 = uVar5;
      }
      _dbl_shift(puVar2,1,uVar3,uVar1,local_50);
      _add_mant_d(&local_48,local_48,local_44,local_40,local_3c);
      if ((int)local_44 < 0) {
        uVar6 = 0x80000000;
        _mainasu(&local_48,local_48);
      }
      else {
        if ((local_44 == 0) && (uVar3 = local_30, uVar1 = local_2c, local_48 == 0))
        goto LAB_800f5d9c;
      }
      while ((local_44 & 0xe0000000) == 0) {
        _dbl_shift(&local_48,0,local_48,local_44,1);
        uVar4 = uVar4 - 1;
      }
      if ((local_44 & 0x40000000) != 0) {
        uVar4 = uVar4 + 1;
        _dbl_shift(&local_48,1,local_48,local_44,1);
      }
      local_38 = 0xff;
      local_34 = 0;
      if ((local_48 & 0x200) != 0) {
        local_38 = 0x100;
      }
      _add_mant_d(&local_48,local_48,local_44,local_38,0);
      if ((local_44 & 0x40000000) != 0) {
        uVar4 = uVar4 + 1;
        _dbl_shift(&local_48,1,local_48,local_44,1);
      }
      _dbl_shift(&local_48,1,local_48,local_44,9);
      local_44 = local_44 & 0xffefffff;
      if ((int)uVar4 < 0x7ff) {
        uVar1 = uVar6 | uVar4 << 0x14 | local_44;
        uVar3 = local_48;
      }
      else {
        _err_math(0x22,0xb);
        uVar1 = 0x7ff00000;
        if (uVar6 != 0) {
          uVar1 = 0xfff00000;
        }
        uVar3 = 0;
      }
    }
  }
LAB_800f5d9c:
  return CONCAT44(uVar3,uVar1);


}

undefined8 __divdf3(int iParm1,uint uParm2,int iParm3,uint uParm4)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  int local_40;
  undefined4 local_3c;
  int local_38;
  uint local_34;
  int local_30;
  uint local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  iVar3 = ((int)uParm2 >> 0x14 & 0x7ffU) - ((int)uParm4 >> 0x14 & 0x7ffU);
  iVar4 = iVar3 + 0x3fe;
  uVar5 = uParm2 & 0x80000000 ^ uParm4 & 0x80000000;
  if (((uParm4 & 0x7fffffff) == 0) && (iParm3 == 0)) {
    bVar1 = uVar5 == 0;
    uVar5 = 0xffffffff;
    if (bVar1) {
      uVar5 = 0x7fffffff;
    }
    local_50 = 0xffffffff;
  }
  else {
    if (((uParm2 & 0x7fffffff) == 0) && (iParm1 == 0)) {
      local_50 = 0;
    }
    else {
      local_34 = uParm2 & 0xfffff | 0x100000;
      local_2c = uParm4 & 0xfffff | 0x100000;
      local_38 = iParm1;
      local_30 = iParm3;
      iVar2 = _comp_mant(iParm1,local_34,iParm3);
      if (iVar2 < 0) {
        iVar4 = iVar3 + 0x3fd;
        _dbl_shift(&local_38,0,local_38,local_34,1);
      }
      local_44 = 0x200000;
      local_48 = 0;
      local_50 = 0;
      local_4c = 0;
      do {
        iVar3 = _comp_mant(local_38,local_34,local_30,local_2c);
        if (-1 < iVar3) {
          local_4c = local_4c | local_44;
          local_50 = local_50 | local_48;
          _mainasu(&local_28,local_30,local_2c);
          _add_mant_d(&local_38,local_38,local_34,local_28,local_24);
        }
        _dbl_shift(&local_38,0,local_38,local_34,1);
        _dbl_shift_us(&local_48,1,local_48,local_44,1);
      } while ((local_44 != 0) || (local_48 != 0));
      if (iVar4 < 0) {
        local_40 = 1 << (-iVar4 & 0x1fU);
        local_3c = 0;
        iVar2 = 0;
        _add_mant_d(&local_50,local_50,local_4c,local_40,0);
        iVar3 = -iVar4 + 1;
      }
      else {
        iVar3 = 1;
        local_3c = 0;
        local_40 = 1;
        iVar2 = iVar4 + 1;
        _add_mant_d(&local_50,local_50,local_4c,1,0);
      }
      _dbl_shift_us(&local_50,1,local_50,local_4c,iVar3);
      local_4c = local_4c & 0xffefffff;
      if (iVar2 < 0x7ff) {
        uVar5 = uVar5 | iVar2 << 0x14 | local_4c;
      }
      else {
        _err_math(0x22,0xf);
        bVar1 = uVar5 != 0;
        uVar5 = 0x7ff00000;
        if (bVar1) {
          uVar5 = 0xfff00000;
        }
        local_50 = 0;
      }
    }
  }
  return CONCAT44(local_50,uVar5);


}

undefined4 _comp_mant(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  undefined4 uVar1;
  
  if (uParm4 < uParm2) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0xffffffff;
    if (((uParm4 <= uParm2) && (uVar1 = 1, uParm1 <= uParm3)) &&
       (uVar1 = 0xffffffff, uParm3 <= uParm1)) {
      uVar1 = 0;
    }
  }
  return uVar1;


}

char * strncpy(char *__dest,char *__src,size_t __n)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

undefined4 asyncidle(void)
{
  return 0;


}

char * strchr(char *__s,int __c)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

undefined8 __muldf3(uint uParm1,uint uParm2,uint uParm3,uint uParm4)
{
  bool bVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 local_70;
  undefined4 local_68;
  uint local_64;
  undefined4 local_60;
  undefined4 local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  uint local_34;
  int local_30;
  
  local_34 = uParm2 & 0x80000000 ^ uParm4 & 0x80000000;
  if ((((uParm2 & 0x7fffffff) == 0) && (uParm1 == 0)) ||
     (((uParm4 & 0x7fffffff) == 0 && (uParm3 == 0)))) {
    local_38 = 0;
  }
  else {
    local_30 = ((int)uParm2 >> 0x14 & 0x7ffU) + ((int)uParm4 >> 0x14 & 0x7ffU);
    iVar5 = local_30 + -0x3fe;
    local_54 = uParm2 & 0xfffff | 0x100000;
    local_4c = uParm4 & 0xfffff | 0x100000;
    local_58 = uParm1;
    local_50 = uParm3;
    _dbl_shift_us(&local_48,1,uParm1,local_54,0x15);
    local_70 = local_48;
    _dbl_shift_us(&local_48,1,local_50,local_4c,0x15);
    uVar2 = local_48;
    uVar3 = local_58 & 0x1fffff;
    uVar4 = local_50 & 0x1fffff;
    _mul_mant_d(&local_68,local_70,local_48);
    _mul_mant_d(&local_40,uVar3,uVar2);
    _dbl_shift_us(&local_48,1,local_40,local_3c,0x15);
    _add_mant_d(&local_68,local_68,local_64,local_48,local_44);
    _mul_mant_d(&local_40,uVar4,local_70);
    _dbl_shift_us(&local_48,1,local_40,local_3c,0x15);
    _add_mant_d(&local_68,local_68,local_64,local_48,local_44);
    if ((int)local_64 < 0) {
      local_5c = 0;
      local_60 = 0x400;
      _add_mant_d(&local_68,local_68,local_64,0x400,0);
      local_70 = 0xb;
    }
    else {
      local_5c = 0;
      local_60 = 0x200;
      _add_mant_d(&local_68,local_68,local_64,0x200,0);
      if ((local_64 & 0x80000000) == 0) {
        local_70 = 10;
        iVar5 = local_30 + -0x3ff;
      }
      else {
        local_70 = 0xb;
      }
    }
    _dbl_shift_us(&local_68,1,local_68,local_64,local_70);
    local_64 = local_64 & 0xffefffff;
    if (iVar5 < 0x7ff) {
      local_34 = local_34 | iVar5 << 0x14 | local_64;
      local_38 = local_68;
    }
    else {
      _err_math(0x22,0xd);
      bVar1 = local_34 != 0;
      local_34 = 0x7ff00000;
      if (bVar1) {
        local_34 = 0xfff00000;
      }
      local_38 = 0;
    }
  }
  return CONCAT44(local_38,local_34);


}

int * _mul_mant_d(int *piParm1,uint uParm2,uint uParm3)
{
  uint uVar1;
  int local_28;
  int local_24;
  int local_20;
  uint local_1c;
  
  local_28 = (uParm2 & 0xffff) * (uParm3 & 0xffff);
  uVar1 = (uParm2 >> 0x10) * (uParm3 & 0xffff);
  local_24 = 0;
  local_1c = uVar1 >> 0x10;
  local_20 = uVar1 * 0x10000;
  _add_mant_d(&local_28,local_28,0,local_20,local_1c);
  uVar1 = (uParm2 & 0xffff) * (uParm3 >> 0x10);
  local_1c = uVar1 >> 0x10;
  local_20 = uVar1 * 0x10000;
  _add_mant_d(&local_28,local_28,local_24,local_20,local_1c);
  *piParm1 = local_28;
  piParm1[1] = local_24 + (uParm2 >> 0x10) * (uParm3 >> 0x10);
  return piParm1;


}

uint __divsf3(uint uParm1,uint uParm2)
{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  
  iVar7 = ((int)uParm1 >> 0x17 & 0xffU) - ((int)uParm2 >> 0x17 & 0xffU);
  iVar6 = iVar7 + 0x7e;
  uVar8 = uParm1 & 0x80000000 ^ uParm2 & 0x80000000;
  if ((uParm2 & 0x7fffffff) == 0) {
    bVar1 = uVar8 != 0;
    uVar8 = 0x4f000000;
    if (bVar1) {
      uVar8 = 0x4f800000;
    }
  }
  else {
    if ((uParm1 & 0x7fffffff) != 0) {
      uVar5 = uParm1 & 0x7fffff | 0x800000;
      uVar4 = uParm2 & 0x7fffff | 0x800000;
      uVar2 = 0x1000000;
      if (uVar5 < uVar4) {
        uVar5 = uVar5 << 1;
        iVar6 = iVar7 + 0x7d;
      }
      uVar3 = 0;
      do {
        if ((int)uVar4 <= (int)uVar5) {
          uVar3 = uVar3 | uVar2;
          uVar5 = uVar5 - uVar4;
        }
        uVar2 = (int)uVar2 >> 1;
        uVar5 = uVar5 << 1;
      } while (uVar2 != 0);
      if (iVar6 < 0) {
        uVar2 = (int)(uVar3 + (1 << (-iVar6 & 0x1fU))) >> (-iVar6 + 1U & 0x1f);
        iVar6 = 0;
      }
      else {
        iVar6 = iVar6 + 1;
        uVar2 = (int)(uVar3 + 1) >> 1;
      }
      if (iVar6 < 0xff) {
        uVar8 = uVar8 | iVar6 << 0x17 | uVar2 & 0xff7fffff;
      }
      else {
        _err_math(0x22,0xe);
        bVar1 = uVar8 != 0;
        uVar8 = 0x7f800000;
        if (bVar1) {
          uVar8 = 0xff800000;
        }
      }
    }
  }
  return uVar8;


}

uint __fixdfsi(int iParm1,uint uParm2)
{
  uint uVar1;
  int iVar2;
  int local_20;
  uint local_1c;
  
  if (((uParm2 & 0x7fffffff) == 0) && (iParm1 == 0)) {
    local_1c = uParm2 & 0x80000000;
  }
  else {
    uVar1 = (int)uParm2 >> 0x14 & 0x7ff;
    iVar2 = uVar1 - 0x41d;
    if (iVar2 < 1) {
      local_1c = uParm2 & 0xfffff | 0x100000;
      local_20 = iParm1;
      _dbl_shift(&local_20,0,iParm1,local_1c,10);
      if ((uVar1 - 0x3fe < 0x20) && (local_1c != 0)) {
        local_1c = (int)local_1c >> (-iVar2 & 0x1fU);
        if ((int)uParm2 < 0) {
          local_1c = -local_1c;
        }
      }
      else {
        local_1c = 0;
      }
    }
    else {
      _err_math(0x22,0x11);
      local_1c = 0x7fffffff;
      if ((int)uParm2 < 0) {
        local_1c = 0x80000000;
      }
    }
  }
  return local_1c;


}

void checkrect(int iParm1)
{
  if ((*(ushort *)(iParm1 + 4) & 1) != 0) {
    *(ushort *)(iParm1 + 6) = *(ushort *)(iParm1 + 6) | 1;
  }
  return;


}

void vramimage(undefined4 uParm1,undefined4 uParm2)
{
  checkrect();
  LoadImage(uParm1,uParm2);
  drawpending = 1;
  return;


}

void vramfxya(uint *param_1,uint param_2,ushort param_3,uint param_4,ushort param_5)
{
  byte *pbVar1;
  byte *pbVar2;
  uint *puVar3;
  int iVar4;
  int iVar5;
  uint *puVar6;
  uint *puVar7;
  undefined2 local_440;
  ushort local_43e;
  undefined2 local_43c;
  undefined2 local_43a;
  uint auStack1080 [128];
  uint local_238 [131];
  uint *local_2c;
  
  if (param_1 != (uint *)0x0) {
    local_2c = auStack1080;
    do {
      if (true) {
        switch((uint)*(byte *)param_1 & 0xf7) {
        case 0x22:
          iVar4 = 0;
          puVar6 = param_1;
          puVar7 = local_2c;
          if (0 < *(short *)(param_1 + 1)) {
            do {
              iVar4 = iVar4 + 1;
              *(ushort *)puVar7 =
                   (ushort)(*(byte *)(puVar6 + 4) >> 1) |
                   (ushort)(*(byte *)((int)puVar6 + 0x12) >> 1) << 10 |
                   (ushort)(*(byte *)((int)puVar6 + 0x11) >> 1) << 5;
              puVar6 = (uint *)((int)puVar6 + 3);
              puVar7 = (uint *)((int)puVar7 + 2);
            } while (iVar4 < (int)*(short *)(param_1 + 1));
          }
          puVar6 = auStack1080;
          break;
        case 0x23:
          puVar6 = param_1 + 4;
          break;
        case 0x24:
          iVar4 = 0;
          if (0 < *(short *)(param_1 + 1)) {
            puVar7 = local_238;
            puVar6 = param_1;
            do {
              pbVar1 = (byte *)((int)puVar6 + 0x12);
              pbVar2 = (byte *)((int)puVar6 + 0x11);
              puVar3 = puVar6 + 4;
              puVar6 = (uint *)((int)puVar6 + 3);
              iVar4 = iVar4 + 1;
              *(ushort *)puVar7 =
                   (ushort)(*(byte *)puVar3 >> 3) |
                   (ushort)(*pbVar1 >> 3) << 10 | (ushort)(*pbVar2 >> 3) << 5;
              puVar7 = (uint *)((int)puVar7 + 2);
            } while (iVar4 < (int)*(short *)(param_1 + 1));
          }
          puVar6 = local_238;
          break;
        default:
          goto switchD_800f6a3c_caseD_25;
        case 0x40:
        case 0x41:
        case 0x42:
        case 0x43:
          param_1[3] = param_1[3] & 0xf000f000 | param_2 & 0xfff | (uint)(param_3 & 0xfff) << 0x10;
          *(byte *)param_1 = *(byte *)param_1 | 8;
          local_440 = (undefined2)param_2;
          local_43e = param_3;
          iVar4 = shapedepth(param_1);
          iVar5 = (int)*(short *)(param_1 + 1) * iVar4 + 0xf;
          if (iVar5 < 0) {
            iVar5 = (int)*(short *)(param_1 + 1) * iVar4 + 0x1e;
          }
          local_43c = (undefined2)(iVar5 >> 4);
          local_43a = *(undefined2 *)((int)param_1 + 6);
          puVar6 = param_1 + 4;
          goto LAB_800f6bd8;
        }
        param_1[3] = param_1[3] & 0xf000f000 | param_4 & 0xfff | (uint)(param_5 & 0xfff) << 0x10;
        *(byte *)param_1 = *(byte *)param_1 | 8;
        local_440 = (undefined2)param_4;
        local_43e = param_5;
        local_43c = *(undefined2 *)(param_1 + 1);
        local_43a = 1;
LAB_800f6bd8:
        vramimage(&local_440,puVar6);
      }
switchD_800f6a3c_caseD_25:
      if ((*param_1 & 0xffffff00) == 0) {
        param_1 = (uint *)0x0;
      }
      else {
        param_1 = (uint *)((int)param_1 + ((int)*param_1 >> 8));
      }
    } while (param_1 != (uint *)0x0);
  }
  return;


}

int shapetoclutid(uint *puParm1)
{
  short sVar1;
  
  if (puParm1 != (uint *)0x0) {
    do {
      if ((*(byte *)puParm1 & 0xf7) == 0x23) {
        sVar1 = GetClut((int)(puParm1[3] << 0x14) >> 0x14,(int)(puParm1[3] << 4) >> 0x14);
        return (int)sVar1;
      }
      if ((*puParm1 & 0xffffff00) == 0) {
        puParm1 = (uint *)0x0;
      }
      else {
        puParm1 = (uint *)((int)puParm1 + ((int)*puParm1 >> 8));
      }
    } while (puParm1 != (uint *)0x0);
  }
  return 0;


}

undefined * FntFlush(int iParm1)
{
  byte bVar1;
  bool bVar2;
  char cVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  char cVar8;
  int iVar9;
  int iVar10;
  undefined *puVar11;
  byte *pbVar12;
  byte *pbVar13;
  int iVar14;
  short sVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  int local_3c;
  
  cVar3 = -0x80;
  cVar8 = -0x80;
  local_3c = 0;
  cVar4 = -0x80;
  if ((iParm1 < 0) || (iVar5 = iParm1 << 1, -1 < iParm1)) {
    iParm1 = 0;
    iVar5 = 0;
    if (true) {
      return (undefined *)0;
    }
  }
  iVar6 = (iVar5 + iParm1) * 0x10;
  puVar11 = &UNK_80135e68 + iVar6;
  pbVar12 = *(byte **)(&DAT_80135e7c + iVar6);
  iVar19 = *(int *)(&DAT_80135e74 + iVar6);
  iVar14 = (int)*(short *)(&DAT_80135e60 + iVar6);
  iVar16 = (int)*(short *)(&DAT_80135e62 + iVar6);
  iVar9 = iVar16 + (int)*(short *)(&DAT_80135e66 + iVar6);
  iVar5 = *(int *)(&DAT_80135e78 + iVar6);
  iVar17 = *(int *)(&DAT_80135e84 + iVar6);
  iVar18 = iVar14 + (int)*(short *)(&DAT_80135e64 + iVar6);
  TermPrim(puVar11);
  while( true ) {
    sVar15 = (short)iVar16;
    bVar1 = *pbVar12;
    if ((*pbVar12 == 0) || (iVar19 == 0)) break;
    bVar2 = false;
    iVar10 = iVar5;
    if (bVar1 == 0x20) {
LAB_800f6f38:
      iVar14 = iVar14 + 8;
      iVar5 = iVar10;
LAB_800f6f3c:
      pbVar13 = pbVar12;
      if ((iVar18 <= iVar14) && (pbVar13 = pbVar12, iVar17 == 0)) {
LAB_800f6f50:
        bVar2 = true;
        pbVar13 = pbVar12;
      }
    }
    else {
      if ((char)bVar1 < '!') {
        if (bVar1 == 9) {
          iVar14 = iVar14 + 0x20;
          goto LAB_800f6f3c;
        }
        if (bVar1 != 10) goto LAB_800f6eac;
        goto LAB_800f6f50;
      }
      if (bVar1 != 0x7e) {
LAB_800f6eac:
        bVar1 = *pbVar12;
        if ((uint)bVar1 - 0x61 < 0x1a) {
          iVar10 = (int)(char)bVar1 + -0x40;
        }
        else {
          iVar10 = (int)(char)bVar1 + -0x20;
        }
        iVar7 = iVar10;
        if (iVar10 < 0) {
          iVar7 = iVar10 + 0xf;
        }
        *(char *)(iVar5 + 0xc) = ((char)iVar10 + (char)(iVar7 >> 4) * -0x10) * '\b';
        *(undefined *)(iVar5 + 0xd) = (char)((iVar7 >> 4) << 3);
        *(undefined2 *)(iVar5 + 8) = (short)iVar14;
        *(short *)(iVar5 + 10) = sVar15;
        *(char *)(iVar5 + 4) = cVar3;
        *(char *)(iVar5 + 5) = cVar8;
        *(char *)(iVar5 + 6) = cVar4;
        iVar10 = iVar5 + 0x10;
        AddPrim(puVar11,iVar5);
        goto LAB_800f6f38;
      }
      pbVar13 = pbVar12 + 1;
      if (*pbVar13 == 99) {
        pbVar13 = pbVar12 + 4;
        cVar3 = pbVar12[2] * '\x10';
        cVar8 = pbVar12[3] * '\x10';
        cVar4 = *pbVar13 * '\x10';
      }
    }
    if (bVar2) {
      if (local_3c < iVar14) {
        local_3c = iVar14;
      }
      iVar16 = iVar16 + 8;
      sVar15 = (short)iVar16;
      iVar14 = (int)*(short *)(&DAT_80135e60 + iVar6);
      if (iVar9 <= iVar16) break;
    }
    pbVar12 = pbVar13 + 1;
    iVar19 = iVar19 + -1;
  }
  if (((&DAT_80135e5f)[iVar6] != '\0') && (AddPrim(puVar11,&Font + iVar6), iVar17 != 0)) {
    *(short *)(&DAT_80135e64 + iVar6) = (short)local_3c - *(short *)(&DAT_80135e60 + iVar6);
    *(short *)(&DAT_80135e66 + iVar6) = sVar15 - (*(short *)(&DAT_80135e62 + iVar6) + -8);
  }
  DrawOTag(puVar11);
  *(undefined4 *)(&DAT_80135e80 + iVar6) = 0;
  **(undefined **)(&DAT_80135e7c + iVar6) = 0;
  return puVar11;


}

uint CdStatus(void)
{
  return (uint)CD_status;


}

uint CdMode(void)
{
  return (uint)CD_mode;


}

undefined1 * CdLastPos(void)
{
  return &CD_pos;


}

undefined4 CdReset(int iParm1)
{
  undefined4 uVar1;
  int iVar2;
  
  if (iParm1 == 2) {
    CD_initintr();
    uVar1 = 1;
  }
  else {
    iVar2 = CD_init();
    uVar1 = 0;
    if ((iVar2 == 0) && (uVar1 = 1, iParm1 == 1)) {
      iVar2 = CD_initvol();
      uVar1 = 0;
      if (iVar2 == 0) {
        uVar1 = 1;
      }
    }
  }
  return uVar1;


}

void CdFlush(void)
{
  CD_flush();
  return;


}

undefined4 CdSetDebug(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = CD_debug;
  CD_debug = uParm1;
  return uVar1;


}

void CdSync(void)
{
  CD_sync();
  return;


}

void CdReady(void)
{
  CD_ready();
  return;


}

undefined4 CdSyncCallback(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = CD_cbsync;
  CD_cbsync = uParm1;
  return uVar1;


}

undefined4 CdReadyCallback(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = CD_cbready;
  CD_cbready = uParm1;
  return uVar1;


}

undefined4 CdControl(uint uParm1,int iParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  
  uVar1 = CD_cbsync;
  iVar3 = 3;
  while( true ) {
    CD_cbsync = 0;
    if (((uParm1 & 0xff) != 1) && ((CD_status & 0x10) != 0)) {
      CD_cw(1,0,0,0);
    }
    if ((((iParm2 == 0) || (*(int *)(&DAT_80136a18 + (uParm1 & 0xff) * 4) == 0)) ||
        (iVar2 = CD_cw(2,iParm2,uParm3,0), iVar2 == 0)) &&
       (CD_cbsync = uVar1, iVar2 = CD_cw(uParm1 & 0xff,iParm2,uParm3,0), iVar2 == 0)) break;
    iVar3 = iVar3 + -1;
    if (iVar3 == -1) {
      CD_cbsync = uVar1;
      return 0;
    }
  }
  return 1;


}

undefined4 CdControlF(uint uParm1,int iParm2)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  
  uVar1 = CD_cbsync;
  iVar3 = 3;
  while( true ) {
    CD_cbsync = 0;
    if (((uParm1 & 0xff) != 1) && ((CD_status & 0x10) != 0)) {
      CD_cw(1,0,0,0);
    }
    if ((((iParm2 == 0) || (*(int *)(&DAT_80136a18 + (uParm1 & 0xff) * 4) == 0)) ||
        (iVar2 = CD_cw(2,iParm2,0,0), iVar2 == 0)) &&
       (CD_cbsync = uVar1, iVar2 = CD_cw(uParm1 & 0xff,iParm2,0,1), iVar2 == 0)) break;
    iVar3 = iVar3 + -1;
    if (iVar3 == -1) {
      CD_cbsync = uVar1;
      return 0;
    }
  }
  return 1;


}

uint CdControlB(uint uParm1,int iParm2,undefined4 uParm3)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  
  uVar1 = CD_cbsync;
  iVar5 = 3;
  do {
    CD_cbsync = 0;
    if (((uParm1 & 0xff) != 1) && ((CD_status & 0x10) != 0)) {
      CD_cw(1,0,0,0);
    }
    if (((iParm2 == 0) || (*(int *)(&DAT_80136a18 + (uParm1 & 0xff) * 4) == 0)) ||
       (iVar2 = CD_cw(2,iParm2,uParm3,0), iVar2 == 0)) {
      CD_cbsync = uVar1;
      iVar2 = CD_cw(uParm1 & 0xff,iParm2,uParm3,0);
      iVar3 = 0;
      if (iVar2 == 0) break;
    }
    iVar5 = iVar5 + -1;
    iVar3 = -1;
    CD_cbsync = uVar1;
  } while (iVar5 != -1);
  if (iVar3 == 0) {
    iVar5 = CD_sync(0,uParm3);
    uVar4 = (uint)(iVar5 == 2);
  }
  else {
    uVar4 = 0;
  }
  return uVar4;


}

uint CdGetSector(void)
{
  int iVar1;
  
  iVar1 = CD_getsector();
  return (uint)(iVar1 == 0);


}

uint CdGetSector2(void)
{
  int iVar1;
  
  iVar1 = CD_getsector2();
  return (uint)(iVar1 == 0);


}

void CdDataCallback(undefined4 uParm1)
{
  DMACallback(3,uParm1);
  return;


}

void CdDataSync(void)
{
  CD_datasync();
  return;


}

void CdIntToPos(int iParm1,char *pcParm2)
{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = (iParm1 + 0x96) / 0x4b;
  iVar2 = (iParm1 + 0x96) % 0x4b;
  iVar1 = iVar3 / 0x3c;
  iVar3 = iVar3 % 0x3c;
  pcParm2[2] = (char)iVar2 + (char)(iVar2 / 10) * '\x06';
  pcParm2[1] = (char)iVar3 + (char)(iVar3 / 10) * '\x06';
  *pcParm2 = (char)iVar1 + (char)(iVar1 / 10) * '\x06';
  return;


}

int CdPosToInt(byte *pbParm1)
{
  return (((uint)(*pbParm1 >> 4) * 10 + ((uint)*pbParm1 & 0xf)) * 0x3c +
         (uint)(pbParm1[1] >> 4) * 10 + ((uint)pbParm1[1] & 0xf)) * 0x4b +
         (uint)(pbParm1[2] >> 4) * 10 + ((uint)pbParm1[2] & 0xf) + -0x96;


}

void StCdInterrupt(void)
{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 local_18 [2];
  byte local_10 [8];
  
  if (_StFinalSector != 1) {
    if ((_StRgb24 == 0) || ((_DAT_1f801098 & 0x1000000) == 0)) {
      iVar1 = CdReady(1,local_10);
      if (iVar1 != 5) {
        if ((local_10[0] & 4) == 0) {
          _DAT_80144864 = _StRingAddr + _StRingIdx1 * 8;
          if (*(short *)_DAT_80144864 == 0) {
            DAT_1f801800 = 0;
            DAT_1f801803 = 0x80;
            _DAT_1f801018 = 0x20943;
            _DAT_1f801020 = 0x1323;
            uVar4 = 0;
            if (_StMode == 0) {
              do {
                puVar3 = (undefined *)((int)local_18 + uVar4);
                uVar4 = uVar4 + 1;
                *puVar3 = DAT_1f801802;
              } while (uVar4 < 4);
              uVar4 = 0;
              do {
                uVar4 = uVar4 + 1;
              } while (uVar4 < 8);
            }
            if (_StEmu_Addr == 0) {
              FUN_800f87c0(3,_DAT_80144864,0,8,0x11000000,0,0);
            }
            else {
              FUN_800f8794(_DAT_80144864,_StEmu_Addr + _StEmu_Idx * 0x800,8,0);
            }
            do {
            } while ((_DAT_1f8010b8 & 0x1000000) != 0);
            _DAT_80144864[7] = local_18[0];
            _DAT_1f801018 = 0x20843;
            _DAT_1f801020 = 0x1325;
            if ((_StSTART_FLAG == 1) && (_StStartFrame != 0)) {
              if (_StStartFrame != (uint)*(ushort *)(_DAT_80144864 + 2)) {
                *(short *)_DAT_80144864 = 0;
                if (_StEmu_Addr == 0) {
                  return;
                }
                _StEmu_Idx = _StEmu_Idx + 1;
                return;
              }
              _StSTART_FLAG = 0;
            }
            if ((*(short *)_DAT_80144864 == 0x160) &&
               (((uint)(*(ushort *)((int)_DAT_80144864 + 2) >> 10) & 0x1f) == _CChannel)) {
              if (((int)_Stsector_offset == (uint)*(ushort *)(_DAT_80144864 + 1)) &&
                 ((_Stframe_no == 0 || (_Stframe_no == (uint)*(ushort *)(_DAT_80144864 + 2))))) {
                if (*(short *)(_DAT_80144864 + 1) == 0) {
                  _Stframe_no = (uint)*(ushort *)(_DAT_80144864 + 2);
                  _Stsector_offset = 0;
                  if ((_StEndFrame != 0) && (_StEndFrame <= _Stframe_no)) {
                    _Stframe_no = 0;
                    _Stsector_offset = 0;
                    init_ring_status(_StRingIdx2,_StRingIdx1 - _StRingIdx2);
                    _StRingIdx1 = _StRingIdx2;
                    *(short *)_DAT_80144864 = 0;
                    _StSTART_FLAG = 1;
                    if (_StFunc2 != (code *)0x0) {
                      (*_StFunc2)();
                    }
                    if (_StEmu_Addr != 0) {
                      _StEmu_Idx = _StEmu_Idx + 1;
                    }
                    debug_cause = 7;
                    return;
                  }
                  if ((_StRingSize - _StRingIdx1) - 1U < (uint)*(ushort *)((int)_DAT_80144864 + 6))
                  {
                    if (_StEndFrame == 0) {
                      *(short *)_DAT_80144864 = 1;
                      _StSTART_FLAG = 1;
                      if (_StFunc2 != (code *)0x0) {
                        (*_StFunc2)();
                      }
                      if (_StEmu_Addr != 0) {
                        _StEmu_Idx = _StEmu_Idx + 1;
                      }
                      debug_cause = 8;
                      return;
                    }
                    if (*(short *)_StRingAddr != 0) {
                      *(short *)_DAT_80144864 = 0;
                      if (_StEmu_Addr != 0) {
                        _StEmu_Idx = _StEmu_Idx + 1;
                      }
                      debug_cause = 9;
                      return;
                    }
                    *(short *)_DAT_80144864 = 1;
                    uVar4 = 0;
                    _StRingIdx1 = 0;
                    puVar5 = _StRingAddr;
                    do {
                      uVar2 = *_DAT_80144864;
                      _DAT_80144864 = _DAT_80144864 + 1;
                      uVar4 = uVar4 + 1;
                      *puVar5 = uVar2;
                      puVar5 = puVar5 + 1;
                    } while (uVar4 < 8);
                    _DAT_80144864 = _StRingAddr;
                  }
                  _StRingIdx2 = _StRingIdx1;
                }
                debug_cause = 10;
                _Stsector_offset = _Stsector_offset + 1;
                _StRingBase = _StRingAddr + _StRingSize * 8 + _StRingIdx1 * 0x1f8;
                uVar2 = 0x11000000;
                if (_StRgb24 == 0) {
                  uVar2 = 0x11400100;
                  _DAT_1f801018 = 0x21020843;
                }
                else {
                  _DAT_1f801018 = 0x20943;
                  _DAT_1f801020 = 0x1323;
                }
                if ((uint)*(ushort *)((int)_DAT_80144864 + 6) - 1 ==
                    (uint)*(ushort *)(_DAT_80144864 + 1)) {
                  _StFinalSector = 1;
                  if (_StEmu_Addr == 0) {
                    FUN_800f87c0(3,_StRingBase,0,0x1f8,uVar2,1,0);
                  }
                  else {
                    FUN_800f8794(_StRingBase,_StEmu_Addr + _StEmu_Idx * 0x800 + 0x20,0x1f8,1);
                    _StEmu_Idx = _StEmu_Idx + 1;
                  }
                  _Stsector_offset = 0;
                  _Stframe_no = 0;
                  _CChannel = _StCHANNEL;
                }
                else {
                  if (_StEmu_Addr == 0) {
                    FUN_800f87c0(3,_StRingBase,0,0x1f8,uVar2,0,0);
                  }
                  else {
                    FUN_800f8794(_StRingBase,_StEmu_Addr + _StEmu_Idx * 0x800 + 0x20,0x1f8,0);
                    _StEmu_Idx = _StEmu_Idx + 1;
                  }
                }
                _DAT_1f801020 = 0x1325;
                *(short *)_DAT_80144864 = 3;
                _StRingIdx1 = _StRingIdx1 + 1;
                if ((_StEmu_Addr != 0) && (_StFinalSector != 0)) {
                  data_ready_callback();
                }
              }
              else {
                _Stframe_no = 0;
                _Stsector_offset = 0;
                init_ring_status(_StRingIdx2,_StRingIdx1 - _StRingIdx2);
                _StRingIdx1 = _StRingIdx2;
                *(short *)_DAT_80144864 = 0;
                if (_StEmu_Addr != 0) {
                  _StEmu_Idx = _StEmu_Idx + 1;
                }
                debug_cause = 6;
              }
            }
            else {
              if (_StEmu_Addr != 0) {
                _StEmu_Idx = 0;
              }
              debug_cause = 5;
              *(short *)_DAT_80144864 = 0;
            }
          }
          else {
            if (_StEmu_Addr != 0) {
              _StEmu_Idx = _StEmu_Idx + 1;
            }
            debug_cause = 4;
          }
        }
        else {
          debug_cause = 3;
        }
      }
    }
    else {
      _StCdIntrFlag = 1;
      if (_StEmu_Addr != 0) {
        _StEmu_Idx = _StEmu_Idx + 1;
      }
      debug_cause = 1;
    }
  }
  return;


}

void FUN_800f8794(undefined4 *puParm1,undefined4 *puParm2,uint uParm3)
{
  undefined4 uVar1;
  uint uVar2;
  
  uVar2 = 0;
  if (uParm3 != 0) {
    do {
      uVar1 = *puParm2;
      puParm2 = puParm2 + 1;
      uVar2 = uVar2 + 1;
      *puParm1 = uVar1;
      puParm1 = puParm1 + 1;
    } while (uVar2 < uParm3);
  }
  return;


}

void FUN_800f87c0(uint param_1,undefined4 param_2,int param_3,uint param_4,undefined4 param_5, char param_6)
{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar3 = param_1 * 0x10;
  uVar1 = *(uint *)(&DAT_1f801088 + iVar3);
  do {
    if ((uVar1 & 0x1000000) == 0) {
LAB_800f883c:
      if (param_6 == '\x01') {
        DAT_1f8010f6 = DAT_1f8010f6 | (byte)(1 << (param_1 & 0x1f));
      }
      else {
        DAT_1f8010f6 = DAT_1f8010f6 & ~(byte)(1 << (param_1 & 0x1f));
      }
      iVar2 = param_1 * 0x10;
      _DAT_1f8010f0 = _DAT_1f8010f0 | 1 << (param_1 * 4 + 3 & 0x1f);
      *(undefined4 *)(&DAT_1f801080 + iVar2) = param_2;
      *(uint *)(&DAT_1f801084 + iVar2) = param_3 << 0x10 | param_4;
      do {
      } while ((DAT_1f801800 & 0x40) == 0);
      *(undefined4 *)(&DAT_1f801088 + iVar2) = param_5;
      return;
    }
    if (iVar2 == 0x10000) {
      printf("DMA STATUS ERROR %x\n",*(undefined4 *)(&DAT_1f801088 + iVar3));
      goto LAB_800f883c;
    }
    uVar1 = *(uint *)(&DAT_1f801088 + iVar3);
    iVar2 = iVar2 + 1;
  } while( true );


}

void StClearRing(void)
{
  _StRingIdx3 = 0;
  _StRingIdx2 = 0;
  _StRingIdx1 = 0;
  _StFinalSector = 0;
  init_ring_status(0,_StRingSize);
  _StCdIntrFlag = 0;
  _Stframe_no = 0;
  _Stsector_offset = 0;
  return;


}

void DecDCTReset(int iParm1)
{
  if (iParm1 == 0) {
    ResetCallback();
  }
  FUN_800f8af8(iParm1);
  return;


}

void DecDCTin(uint *puParm1,uint uParm2)
{
  uint uVar1;
  
  if ((uParm2 & 1) == 0) {
    uVar1 = *puParm1 | 0x8000000;
  }
  else {
    uVar1 = *puParm1 & 0xf7ffffff;
  }
  *puParm1 = uVar1;
  if ((uParm2 & 2) == 0) {
    uVar1 = *puParm1 & 0xfdffffff;
  }
  else {
    uVar1 = *puParm1 | 0x2000000;
  }
  *puParm1 = uVar1;
  FUN_800f8be8(puParm1,(uint)*(ushort *)puParm1);
  return;


}

void DecDCTout(void)
{
  FUN_800f8c78();
  return;


}

uint DecDCTinSync(int iParm1)
{
  uint uVar1;
  
  if (iParm1 == 0) {
    uVar1 = FUN_800f8d04();
  }
  else {
    uVar1 = FUN_800f8e2c();
    uVar1 = uVar1 >> 0x1d & 1;
  }
  return uVar1;


}

void DecDCToutCallback(undefined4 uParm1)
{
  DMACallback(1,uParm1);
  return;


}

void FUN_800f8af8(int iParm1)
{
  if (iParm1 == 0) {
    _DAT_1f801088 = 0;
    _DAT_1f801098 = 0;
    _DAT_1f801824 = 0x60000000;
    FUN_800f8be8(&DAT_80136af8,0x20);
    FUN_800f8be8(&DAT_80136b7c,0x20);
  }
  else {
    if (iParm1 == 1) {
      _DAT_1f801088 = 0;
      _DAT_1f801098 = 0;
      _DAT_1f801824 = 0x60000000;
    }
    else {
      printf("MDEC_rest:bad option(%d)\n");
    }
  }
  return;


}

void FUN_800f8be8(undefined4 *puParm1,uint uParm2)
{
  FUN_800f8d04();
  _DAT_1f801080 = puParm1 + 1;
  _DAT_1f801084 = (uParm2 >> 5) << 0x10 | 0x20;
  _DAT_1f801088 = 0x1000201;
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0x88;
  _DAT_1f801820 = *puParm1;
  return;


}

void FUN_800f8c78(undefined4 uParm1,uint uParm2)
{
  FUN_800f8d98();
  _DAT_1f801090 = uParm1;
  _DAT_1f801094 = (uParm2 >> 5) << 0x10 | 0x20;
  _DAT_1f801098 = 0x1000200;
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0x88;
  return;


}

undefined4 FUN_800f8d04(void)
{
  int local_10;
  
  local_10 = 0x100000;
  do {
    if ((_DAT_1f801824 & 0x20000000) == 0) {
      return 0;
    }
    local_10 = local_10 + -1;
  } while (local_10 != -1);
  FUN_800f8e44("MDEC_in_sync");
  return 0xffffffff;


}

undefined4 FUN_800f8d98(void)
{
  int local_10;
  
  local_10 = 0x100000;
  do {
    if ((_DAT_1f801098 & 0x1000000) == 0) {
      return 0;
    }
    local_10 = local_10 + -1;
  } while (local_10 != -1);
  FUN_800f8e44("MDEC_out_sync");
  return 0xffffffff;


}

undefined4 FUN_800f8e2c(void)
{
  return _DAT_1f801824;


}

undefined4 FUN_800f8e44(undefined4 uParm1)
{
  printf("%s timeout:\n",uParm1);
  _DAT_1f801088 = 0;
  _DAT_1f801098 = 0;
  _DAT_1f801824 = 0x60000000;
  return 0;


}

void StUnSetRing(void)
{
  EnterCriticalSection();
  if (true) {
    CdDataCallback(0);
    CdReadyCallback(0);
  }
  else {
    DsDataCallback(0);
    DsReadyCallback(0);
  }
  DAT_1f801800 = 0;
  DAT_1f801803 = 0;
  ExitCriticalSection();
  return;


}

void CdRead2(uint uParm1)
{
  undefined local_10 [8];
  
  local_10[0] = (undefined)uParm1;
  CdControl(0xe,local_10,0);
  if ((uParm1 & 0x100) != 0) {
    _StMode = (uint)((uParm1 & 0x20) == 0);
    CdDataCallback(data_ready_callback);
    CdReadyCallback(FUN_800f8fcc);
  }
  CdControl(0x1b,0,0);
  return;


}

void FUN_800f8fcc(void)
{
  StCdInterrupt();
  return;


}

void StSetStream(uint param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4, undefined4 param_5)
{
  StSetMask(1);
  _StFunc1 = param_4;
  _StFunc2 = param_5;
  _StEmu_Addr = 0;
  _CChannel = 0;
  _StCHANNEL = 0;
  _Stframe_no = 0;
  _StRgb24 = param_1 & 1;
  _Stsector_offset = 0;
  return;


}

uint FUN_800f9360(char *pcParm1,char *pcParm2)
{
  int iVar1;
  
  iVar1 = strncmp(pcParm1,pcParm2,0xc);
  return (uint)(iVar1 == 0);


}

undefined4 FUN_800f9380(void)
{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  byte *pbVar6;
  void *__dest;
  
  pbVar6 = &DAT_8014647c;
  iVar3 = FUN_800f9984(1,0x10,&DAT_8014647c);
  if (iVar3 == 1) {
    iVar3 = strncmp((char *)0x8014647d,"CD001",5);
    uVar2 = _DAT_80146508;
    if (iVar3 == 0) {
      iVar3 = FUN_800f9984(1,_DAT_80146508,&DAT_8014647c);
      if (iVar3 == 1) {
        if (1 < CD_debug) {
          printf("CD_newmedia: sarching dir..\n");
        }
        iVar3 = 0;
        if (true) {
          do {
            if (*pbVar6 == 0) break;
            iVar5 = iVar3 * 0x2c;
            *(undefined4 *)(&DAT_80144e84 + iVar5) = *(undefined4 *)(pbVar6 + 2);
            __dest = (void *)(iVar5 + -0x7febb178);
            bVar1 = pbVar6[6];
            iVar3 = iVar3 + 1;
            *(int *)(&DAT_80144e7c + iVar5) = iVar3;
            *(uint *)(&DAT_80144e80 + iVar5) = (uint)bVar1;
            memcpy(__dest,pbVar6 + 8,(uint)*pbVar6);
            *(undefined *)((int)__dest + (uint)*pbVar6) = 0;
            pbVar6 = pbVar6 + (uint)*pbVar6 + ((uint)*pbVar6 & 1) + 8;
            if (1 < CD_debug) {
              printf("\t%08x,%04x,%04x,%s\n",*(undefined4 *)(&DAT_80144e84 + iVar5),
                     *(undefined4 *)(&DAT_80144e7c + iVar5),*(undefined4 *)(&DAT_80144e80 + iVar5),
                     __dest);
            }
            if (0x7f < iVar3) goto LAB_800f95ec;
          } while (pbVar6 < &StEmu_Addr);
        }
        if (iVar3 < 0x80) {
          *(undefined4 *)(&DAT_80144e80 + iVar3 * 0x2c) = 0;
        }
LAB_800f95ec:
        DAT_80136c68 = 0;
        uVar4 = 1;
        if (1 < CD_debug) {
          printf("CD_newmedia: %d dir entries found\n",iVar3);
          uVar4 = 1;
        }
      }
      else {
        uVar4 = 0;
        if (0 < CD_debug) {
          printf("CD_newmedia: Read error (PT:%08x)\n",uVar2);
          uVar4 = 0;
        }
      }
    }
    else {
      uVar4 = 0;
      if (0 < CD_debug) {
        printf("CD_newmedia: Disc format error in cd_read(PVD)\n");
        uVar4 = 0;
      }
    }
  }
  else {
    uVar4 = 0;
    if (0 < CD_debug) {
      printf("CD_newmedia: Read error in cd_read(PVD)\n");
      uVar4 = 0;
    }
  }
  return uVar4;


}

int FUN_800f9644(int iParm1,char *pcParm2)
{
  int iVar1;
  int iVar2;
  int iVar3;
  char *__s2;
  
  iVar2 = 0;
  __s2 = (char *)0x80144e88;
  iVar3 = 0;
  while( true ) {
    if (*(int *)(&DAT_80144e80 + iVar3) == 0) {
      return 0xffffffff;
    }
    if ((*(int *)(&DAT_80144e80 + iVar3) == iParm1) && (iVar1 = strcmp(pcParm2,__s2), iVar1 == 0))
    break;
    __s2 = __s2 + 0x2c;
    iVar2 = iVar2 + 1;
    iVar3 = iVar3 + 0x2c;
    if (0x7f < iVar2) {
      return 0xffffffff;
    }
  }
  return iVar2 + 1;


}

undefined4 FUN_800f96e8(int iParm1)
{
  int iVar1;
  byte *pbVar2;
  int iVar3;
  undefined *__dest;
  undefined *puVar4;
  
  if (iParm1 != DAT_80136c68) {
    pbVar2 = &DAT_8014647c;
    iVar1 = FUN_800f9984(1,*(undefined4 *)(iParm1 * 0x2c + -0x7febb1a8),&DAT_8014647c);
    if (iVar1 != 1) {
      if (CD_debug < 1) {
        return 0xffffffff;
      }
      printf("CD_cachefile: dir not found\n");
      return 0xffffffff;
    }
    if (1 < CD_debug) {
      printf("CD_cachefile: searching...\n");
    }
    iVar1 = 0;
    if (true) {
      puVar4 = &DAT_8014487c;
      __dest = &DAT_80144884;
      iVar3 = 0;
      while (*pbVar2 != 0) {
        CdIntToPos(*(undefined4 *)(pbVar2 + 2),puVar4);
        *(undefined4 *)(&DAT_80144880 + iVar3) = *(undefined4 *)(pbVar2 + 10);
        if (iVar1 == 0) {
          _DAT_80144884 = 0x2e;
        }
        else {
          if (iVar1 == 1) {
            _DAT_8014489c = 0x2e2e;
            DAT_8014489e = 0;
          }
          else {
            memcpy(__dest,pbVar2 + 0x21,(uint)pbVar2[0x20]);
            __dest[(uint)pbVar2[0x20]] = 0;
          }
        }
        if (1 < CD_debug) {
          printf("\t(%02x:%02x:%02x) %8d %s\n",(uint)(byte)(&DAT_8014487c)[iVar3],
                 (uint)(byte)(&DAT_8014487d)[iVar3],(uint)(byte)(&DAT_8014487e)[iVar3],
                 *(undefined4 *)(&DAT_80144880 + iVar3),__dest);
        }
        __dest = __dest + 0x18;
        iVar3 = iVar3 + 0x18;
        iVar1 = iVar1 + 1;
        pbVar2 = pbVar2 + (uint)*pbVar2;
        puVar4 = puVar4 + 0x18;
        if ((0x3f < iVar1) || ((byte *)0x80146c7b < pbVar2)) break;
      }
    }
    DAT_80136c68 = iParm1;
    if (iVar1 < 0x40) {
      DAT_80136c68 = iParm1;
      (&DAT_80144884)[iVar1 * 0x18] = 0;
    }
    if (CD_debug < 2) {
      return 1;
    }
    printf("CD_cachefile: %d files found\n",iVar1);
  }
  return 1;


}

uint FUN_800f9984(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  int iVar1;
  undefined auStack24 [8];
  
  CdIntToPos(uParm2,auStack24);
  CdControl(2,auStack24,0);
  CdRead(uParm1,uParm3,0x80);
  iVar1 = CdReadSync(0,0);
  return (uint)(iVar1 == 0);


}

void StSetRing(undefined4 uParm1,undefined4 uParm2)
{
  _StRingAddr = uParm1;
  _StRingSize = uParm2;
  StClearRing();
  return;


}

undefined4 CD_systaskfunc(void)
{
  bool bVar1;
  bool bVar2;
  int iVar3;
  undefined auStack40 [8];
  undefined auStack32 [8];
  undefined local_18 [8];
  
  bVar2 = false;
  iVar3 = CdDiskReady(1);
  if (iVar3 == 5) {
    bVar1 = _DAT_80146cdc == 0;
    _DAT_80146cdc = _DAT_80146cdc + -1;
    if (bVar1) {
      _DAT_80146cdc = timerhz * 5;
    }
    else {
      if (_DAT_80146cdc == 0) {
        bVar2 = true;
      }
    }
  }
  else {
    if ((iVar3 < 6) && (iVar3 == 2)) {
      iVar3 = CdGetDiskType();
      bVar2 = iVar3 - 1U < 2;
    }
  }
  if (bVar2) {
    delsystemtask(CD_systaskfunc);
    CdReset(0);
    local_18[0] = 0xa0;
    CdControlB(0xe,local_18,auStack40);
    VSync(3);
    CdFlush();
    CdSync(0,0);
    CdIntToPos(_DAT_80146cd0,auStack32);
    CdControl(0x1b,auStack32,auStack40);
    CdReadyCallback(CdReadyHandler);
    if (0 < _DAT_80146ce8) {
      _DAT_80146ce0 = 0;
      _DAT_80146cdc = timerhz * 6;
      addtimer(CD_timerfunc);
    }
  }
  return 0;


}

void CD_timerfunc(void)
{
  int iVar1;
  
  iVar1 = _DAT_80146cdc + -1;
  if ((_DAT_80146cdc != 0) && (_DAT_80146cdc = iVar1, iVar1 == 0)) {
    _DAT_80146cdc = iVar1;
    addsystemtask(CD_systaskfunc,0,0);
    _DAT_80146cdc = 0;
    deltimer(CD_timerfunc);
  }
  return;


}

void CdReadyHandler(byte bParm1,byte *pbParm2)
{
  bool bVar1;
  undefined4 uVar2;
  undefined *puVar3;
  int iVar4;
  undefined auStack336 [12];
  undefined auStack324 [284];
  undefined auStack40 [8];
  undefined4 local_20 [2];
  
  CdReadyCallback(0);
  bVar1 = false;
  if ((*pbParm2 & 0x10) != 0) {
    deltimer(CD_timerfunc);
    addsystemtask(CD_systaskfunc,0,0);
    return;
  }
  if (bParm1 == 2) {
    if (_DAT_80146ce0 == -1) {
      _DAT_80146ce0 = 0;
code_r0x800fa020:
      _Cdinfo = _Cdinfo | 2;
    }
LAB_800fa030:
    _DAT_80146cd0 = _DAT_80146cd0 + 1;
    if (((_Cdinfo & 2) != 0) && (_Cdinfo = _Cdinfo & 0xffffffed | 1, _DAT_80146cd0 != _DAT_80146cd8)
       ) {
      CdFlush();
      CdSync(0,0);
      _DAT_80146cd0 = _DAT_80146cd8;
      CdIntToPos(_DAT_80146cd8,auStack40);
      CdControl(0x1b,auStack40,pbParm2);
    }
    if (((_Cdinfo & 1) != 0) || (_DAT_80146cd0 - _DAT_80146cd4 < 0x15)) goto LAB_800fa12c;
    _DAT_80146cd0 = _DAT_80146cd4;
    puVar3 = auStack40;
    CdIntToPos(_DAT_80146cd4,puVar3);
    uVar2 = 0x1b;
  }
  else {
    if (bParm1 < 3) {
      if (bParm1 != 1) goto LAB_800fa030;
      if ((_Cdinfo & 1) == 0) {
LAB_800f9f34:
        CdFlush();
        CdSync(0,0);
      }
      else {
        if ((_Cdinfo & 4) != 0) {
          bVar1 = true;
          _Cdinfo = _Cdinfo & 0xfffffffb;
          goto LAB_800f9f34;
        }
        iVar4 = -0x7feb9300;
        if ((_Cdinfo & 8) == 0) {
          iVar4 = _DAT_80146cf0;
        }
        CdGetSector(auStack336,3);
        CdGetSector(iVar4,0x200);
        CdGetSector(auStack324,0x46);
        CdDataSync(0);
        iVar4 = CdPosToInt(auStack336);
        if (iVar4 == _DAT_80146cd0) {
          _DAT_80146cdc = timerhz * 6;
          if ((_Cdinfo & 8) != 0) {
            _Cdinfo = _Cdinfo & 0xfffffff7 | 0x10;
            blockmove(_DAT_80146cec + -0x7feb9300,_DAT_80146cf0,_DAT_80146ce4);
            _DAT_80146cec = 0;
          }
          if (_DAT_80146ce8 < 1) {
            bVar1 = true;
          }
          else {
            _DAT_80146cf0 = _DAT_80146cf0 + _DAT_80146ce4;
            if (_DAT_80146ce8 < 0x800) {
              _DAT_80146ce4 = _DAT_80146ce8;
              _Cdinfo = _Cdinfo | 8;
            }
            else {
              _DAT_80146ce4 = 0x800;
            }
            _DAT_80146ce8 = _DAT_80146ce8 - _DAT_80146ce4;
          }
        }
        else {
          _DAT_80146ce0 = _DAT_80146ce0 + 1;
          _DAT_80146cd8 = _DAT_80146cd0;
          if (3 < _DAT_80146ce0) {
            _DAT_80146ce0 = -1;
            uVar2 = 9;
            puVar3 = (undefined *)0x0;
            pbParm2 = (byte *)0x0;
            goto LAB_800fa124;
          }
          _Cdinfo = _Cdinfo | 2;
        }
      }
      if (bVar1) {
        _Cdinfo = _Cdinfo & 0xfffffffe;
        _DAT_80146cdc = 0;
        _DAT_80146cd4 = _DAT_80146cd0;
        deltimer(CD_timerfunc);
        if (_DAT_80146cf4 != (code *)0x0) {
          g_currentthread = 2;
          savegp(local_20);
          (*_DAT_80146cf4)(1);
          restoregp(local_20[0]);
          g_currentthread = 0;
        }
      }
      goto LAB_800fa030;
    }
    if ((bParm1 != 5) || ((_Cdinfo & 1) == 0)) goto LAB_800fa030;
    CdControl(1,0,auStack336);
    _DAT_80146ce0 = _DAT_80146ce0 + 1;
    _DAT_80146cd8 = _DAT_80146cd0;
    if (_DAT_80146ce0 < 4) goto code_r0x800fa020;
    _DAT_80146ce0 = -1;
    uVar2 = 9;
    puVar3 = (undefined *)0x0;
    pbParm2 = (byte *)0x0;
  }
LAB_800fa124:
  CdControl(uVar2,puVar3,pbParm2);
LAB_800fa12c:
  CdReadyCallback(CdReadyHandler);
  return;


}

undefined4 readsectorB(void)
{
  if (true) {
    do {
    } while (true);
  }
  _Cdinfo = 10;
  _DAT_80146ce0 = 0;
  _DAT_80146ce4 = 0x800;
  _DAT_80146cf0 = 0x80146d00;
  return 0x80146d00;


}

void loaddirinfo(int iParm1,int iParm2,int iParm3)
{
  undefined4 uVar1;
  byte *pbVar2;
  
  uVar1 = _DAT_80146cd8;
  _DAT_80146cd8 = iParm1;
  pbVar2 = (byte *)readsectorB();
  iParm2 = iParm2 + -1;
  pbVar2 = pbVar2 + (uint)*pbVar2;
  do {
    pbVar2 = pbVar2 + (uint)*pbVar2;
    if (iParm3 <= _DAT_80146ccc) {
      _DAT_80146cd8 = uVar1;
      return;
    }
    if (*pbVar2 == 0) {
      if (iParm2 == 0) {
        _DAT_80146cd8 = uVar1;
        return;
      }
      _DAT_80146cd8 = _DAT_80146cd8 + 1;
      pbVar2 = (byte *)readsectorB();
      iParm2 = iParm2 + -1;
    }
    if ((pbVar2[0x19] & 2) == 0) {
      memcpy((void *)(_DAT_80146ccc * 0x14 + _DAT_80146cfc),pbVar2 + 0x21,(uint)pbVar2[0x20] - 2);
      *(undefined *)((uint)pbVar2[0x20] + _DAT_80146ccc * 0x14 + _DAT_80146cfc + -2) = 0;
      *(undefined4 *)(_DAT_80146ccc * 0x14 + _DAT_80146cfc + 0xc) = *(undefined4 *)(pbVar2 + 2);
      *(undefined4 *)(_DAT_80146ccc * 0x14 + _DAT_80146cfc + 0x10) = *(undefined4 *)(pbVar2 + 10);
      _DAT_80146ccc = _DAT_80146ccc + 1;
    }
    else {
      loaddirinfo(*(undefined4 *)(pbVar2 + 2),*(uint *)(pbVar2 + 10) >> 0xb,iParm3);
      readsectorB();
    }
  } while( true );


}

void dircompare(char *pcParm1,char *pcParm2)
{
  strncmp(pcParm1,pcParm2,0xc);
  return;


}

void CD_Restore(void)
{
  CdReset(0);
  blockclear(&Cdinfo,0x83c);
  return;


}

size_t CD_Init(int iParm1,int iParm2,int iParm3,undefined4 uParm4)
{
  int iVar1;
  undefined auStack32 [8];
  
  if (_DAT_80146ccc == 0) {
    iVar1 = CdInit();
    if (iVar1 == 0) {
      return 0;
    }
    CdSetDebug(0);
    iVar1 = CdGetToc(auStack32);
    if (iVar1 != 0) {
      _DAT_80146cfc = (void *)(iParm3 + iParm1 * 4);
      _DAT_80146cc8 = iParm1;
      _DAT_80146cf8 = iParm3;
      blockclear(iParm3,iParm1 * 4 + iParm2 * 0x14);
      CD_Restart(0x10);
      iVar1 = readsectorB();
      loaddirinfo(*(undefined4 *)(iVar1 + 0x9e),*(uint *)(iVar1 + 0xa6) >> 0xb,iParm2);
      qsort(_DAT_80146cfc,_DAT_80146ccc,0x14,dircompare);
      _DAT_80146cf4 = uParm4;
      addexit(CD_Restore);
      return _DAT_80146ccc;
    }
  }
  return 0;


}

void CD_Restart(int iParm1)
{
  int iVar1;
  undefined auStack32 [8];
  undefined local_18 [8];
  
  local_18[0] = 0xa0;
  do {
    iVar1 = CdControlB(0xe,local_18,0);
  } while (iVar1 == 0);
  VSync(3);
  CdFlush();
  CdSync(0,0);
  if (iParm1 == 0) {
    iParm1 = 0x10;
  }
  _DAT_80146cd0 = iParm1;
  _DAT_80146cd8 = iParm1;
  CdReadyCallback(CdReadyHandler);
  CdIntToPos(_DAT_80146cd8,auStack32);
  CdControl(0x1b,auStack32,0);
  return;


}

uint CD_Open(byte *pbParm1,undefined4 uParm2,int *piParm3)
{
  byte bVar1;
  uint uVar2;
  void *pvVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  undefined *puVar7;
  undefined local_28 [16];
  
  puVar7 = local_28;
  iVar6 = 0;
  piVar5 = _DAT_80146cf8;
  if (0 < _DAT_80146cc8) {
    do {
      if (*piVar5 == 0) break;
      iVar6 = iVar6 + 1;
      piVar5 = piVar5 + 1;
    } while (iVar6 < _DAT_80146cc8);
  }
  do {
    bVar1 = *pbParm1;
    pbParm1 = pbParm1 + 1;
    uVar2 = toupper((uint)bVar1);
    *puVar7 = (char)uVar2;
    puVar7 = puVar7 + 1;
  } while ((uVar2 & 0xff) != 0);
  pvVar3 = bsearch(local_28,_DAT_80146cfc,_DAT_80146ccc,0x14,dircompare);
  *(void **)(_DAT_80146cf8 + iVar6) = pvVar3;
  iVar4 = _DAT_80146cf8[iVar6];
  if (iVar4 == 0) {
    *piParm3 = 0;
  }
  else {
    *piParm3 = iVar6 + 1;
  }
  return (uint)(iVar4 != 0);


}

undefined4 CD_Close(int iParm1)
{
  *(undefined4 *)(iParm1 * 4 + _DAT_80146cf8 + -4) = 0;
  return 0;


}

int CD_Read(int iParm1,int iParm2,int iParm3,int iParm4)
{
  int iVar1;
  int *piVar2;
  undefined4 local_20 [2];
  
  piVar2 = (int *)(_DAT_80146cf8 + iParm1 * 4 + -4);
  if ((_Cdinfo & 3) == 0) {
    iVar1 = *(int *)(*piVar2 + 0x10) - iParm3;
    if (iVar1 < iParm4) {
      iParm4 = iVar1;
    }
    iVar1 = iParm3;
    if (iParm3 < 0) {
      iVar1 = iParm3 + 0x7ff;
    }
    _DAT_80146cec = iParm3 + (iVar1 >> 0xb) * -0x800;
    if ((_DAT_80146cec != 0) || (iParm4 < 0x800)) {
      _Cdinfo = _Cdinfo | 8;
    }
    _DAT_80146ce4 = iParm4;
    if (0x800 < _DAT_80146cec + iParm4) {
      _DAT_80146ce4 = 0x800 - _DAT_80146cec;
    }
    _DAT_80146ce8 = iParm4 - _DAT_80146ce4;
    if (iParm3 < 0) {
      iParm3 = iParm3 + 0x7ff;
    }
    _DAT_80146ce0 = 0;
    _DAT_80146cd8 = *(int *)(*piVar2 + 0xc) + (iParm3 >> 0xb);
    _Cdinfo = _Cdinfo | 2;
    _DAT_80146cdc = timerhz * 6;
    _DAT_80146cf0 = iParm2;
    addtimer(CD_timerfunc);
    if (((_DAT_80146cd0 == _DAT_80146cd8) && ((_Cdinfo & 0x10) != 0)) && (g_currentthread == 2)) {
      blockmove(_DAT_80146cec + -0x7feb9300,_DAT_80146cf0,_DAT_80146ce4);
      if (_DAT_80146ce8 < 1) {
        _DAT_80146cdc = 0;
        _Cdinfo = _Cdinfo & 0xfffffffd;
        deltimer(CD_timerfunc);
        if (_DAT_80146cf4 != (code *)0x0) {
          savegp(local_20);
          (*_DAT_80146cf4)(1);
          restoregp(local_20[0]);
        }
      }
      else {
        _DAT_80146cec = 0;
        _DAT_80146cf0 = _DAT_80146cf0 + _DAT_80146ce4;
        if (_DAT_80146ce8 < 0x800) {
          _DAT_80146ce4 = _DAT_80146ce8;
          _Cdinfo = _Cdinfo | 8;
        }
        else {
          _DAT_80146ce4 = 0x800;
          _Cdinfo = _Cdinfo & 0xfffffff7;
        }
        _DAT_80146ce8 = _DAT_80146ce8 - _DAT_80146ce4;
        _DAT_80146cd8 = _DAT_80146cd8 + 1;
      }
    }
  }
  else {
    iParm4 = 0;
  }
  return iParm4;


}

void CD_Stopread(void)
{
  _Cdinfo = _Cdinfo | 4;
  return;


}

undefined4 CD_Getinfo(int iParm1,char *pcParm2,undefined4 *puParm3)
{
  char **ppcVar1;
  
  ppcVar1 = (char **)(_DAT_80146cf8 + iParm1 * 4 + -4);
  if (pcParm2 != (char *)0x0) {
    strncpy(pcParm2,*ppcVar1,0xc);
  }
  if (puParm3 != (undefined4 *)0x0) {
    *puParm3 = *(undefined4 *)(*ppcVar1 + 0x10);
  }
  return *(undefined4 *)(*ppcVar1 + 0x10);


}

void MemCardInit(void)
{
  _DAT_80147514 = 0;
  _DAT_80147558 = 0;
  _card_open();
  return;


}

void MemCardEnd(void)
{
  _card_close();
  return;


}

void MemCardStart(void)
{
  UserFuncInit();
  _DAT_80147518 = 0;
  _DAT_8014751c = 0;
  _DAT_80147520 = 0;
  _DAT_80147528 = 0xffffffff;
  _card_start();
  VSyncCallbacks(7,FUN_800fc170);
  return;


}

void MemCardStop(void)
{
  do {
  } while (_DAT_80147518 != 0);
  VSyncCallbacks(7,0);
  _card_stop();
  return;


}

uint MemCardExist(undefined4 uParm1)
{
  bool bVar1;
  
  bVar1 = 0 < _DAT_80147518;
  if (bVar1) {
    printf("Access Denied. : event multiple open\n");
  }
  else {
    _DAT_80147518 = 1;
    _DAT_8014751c = 0;
    _DAT_80147520 = 0;
    _DAT_80147524 = uParm1;
    UserFuncOpen(FUN_800fabf0);
  }
  return (uint)!bVar1;


}

undefined4 FUN_800fabf0(int *piParm1)
{
  int iVar1;
  
  iVar1 = *piParm1;
  if (iVar1 == 0) {
    _DAT_80147504 = 0;
    _DAT_80147500 = 0;
    *piParm1 = 10;
  }
  else {
    if (iVar1 < 0) {
      return 0;
    }
    if (iVar1 != 10) {
      if (iVar1 != 0xb) {
        return 0;
      }
      iVar1 = _chk_card_event();
      if (iVar1 != 0) {
        _DAT_80147504 = _get_card_event();
        if (_DAT_80147504 < 3) {
          if (_DAT_80147504 < 1) {
            if (_DAT_80147504 == 0) {
              if ((_DAT_80147514 & 1 << (_DAT_80147524 & 0x1f)) == 0) {
                _DAT_80147504 = 4;
              }
              _DAT_8014751c = FUN_800fc11c(_DAT_80147504);
              return 1;
            }
          }
          else {
            _DAT_80147500 = _DAT_80147500 + 1;
            if (_DAT_80147500 < 5) {
              *piParm1 = 10;
              return 0;
            }
          }
        }
        else {
          if (_DAT_80147504 == 4) {
            _DAT_8014751c = FUN_800fc11c(4);
            return 1;
          }
        }
        _DAT_80147514 = _DAT_80147514 & ~(1 << (_DAT_80147524 & 0x1f));
        _DAT_8014751c = FUN_800fc11c(_DAT_80147504);
        return 1;
      }
      return 0;
    }
  }
  _clr_card_event();
  _card_info(_DAT_80147524);
  *piParm1 = *piParm1 + 1;
  return 0;


}

uint MemCardAccept(undefined4 uParm1)
{
  bool bVar1;
  
  bVar1 = 0 < _DAT_80147518;
  if (bVar1) {
    printf("Access Denied. : event multiple open\n");
  }
  else {
    _DAT_80147518 = 2;
    _DAT_8014751c = 0;
    _DAT_80147520 = 0;
    _DAT_80147524 = uParm1;
    UserFuncOpen(FUN_800fae2c);
  }
  return (uint)!bVar1;


}

undefined4 FUN_800fae2c(int *piParm1)
{
  int iVar1;
  
  if (false) {
    return 0;
  }
  switch(*piParm1) {
  case 0:
    _DAT_80147510 = 0;
    _DAT_8014750c = 0;
    _DAT_80147508 = 0;
    UserFuncOpen(FUN_800fabf0);
    *piParm1 = 10;
    return 0;
  default:
    goto switchD_800fae64_caseD_1;
  case 10:
    if (_DAT_8014751c != 0) {
      if (_DAT_8014751c == 3) {
        _DAT_80147510 = 1;
        _DAT_80147514 = _DAT_80147514 | 1 << (_DAT_80147524 & 0x1f);
        _clr_card_event();
        _card_clear(_DAT_80147524);
        *piParm1 = 0x15;
        return 0;
      }
      return 1;
    }
    break;
  case 0x15:
    iVar1 = _chk_card_event_x();
    if (iVar1 == 0) {
      return 0;
    }
    _get_card_event_x();
    *piParm1 = 0x1e;
  case 0x1e:
    _clr_card_event();
    _card_load(_DAT_80147524);
    *piParm1 = *piParm1 + 1;
    return 0;
  case 0x1f:
    iVar1 = _chk_card_event();
    if (iVar1 == 0) {
      return 0;
    }
    _DAT_8014750c = _get_card_event();
    if (_DAT_8014750c < 3) {
      if (_DAT_8014750c < 1) {
        if (_DAT_8014750c == 0) {
          _DAT_8014751c = 0;
          if (_DAT_80147510 != 0) {
            _DAT_8014751c = 3;
          }
          return 1;
        }
        goto LAB_800fb004;
      }
    }
    else {
      if (_DAT_8014750c != 4) goto LAB_800fb004;
    }
    _DAT_80147508 = _DAT_80147508 + 1;
    if (4 < _DAT_80147508) {
LAB_800fb004:
      if (_DAT_8014750c != 4) {
        _DAT_8014751c = FUN_800fc11c();
        return 1;
      }
      _DAT_8014751c = _DAT_8014750c;
      return 1;
    }
  }
  *piParm1 = 0x1e;
switchD_800fae64_caseD_1:
  return 0;


}

undefined4 MemCardReadData(undefined4 uParm1,uint uParm2,uint uParm3)
{
  char *__format;
  
  if (_DAT_80147528 < 0) {
    __format = "Access Denied. : file not open.\n";
  }
  else {
    if (_DAT_80147518 < 1) {
      if ((uParm3 & 0x7f) == 0) {
        if ((uParm2 & 0x7f) == 0) {
          _DAT_80147518 = 5;
          _DAT_8014751c = 0;
          _DAT_80147520 = 0;
          _DAT_8014752c = uParm2;
          _DAT_80147530 = uParm3;
          _DAT_80147534 = uParm1;
          UserFuncOpen(FUN_800fb118);
          return 1;
        }
        __format = "Access Denied. : invalid offset value align\n";
      }
      else {
        __format = "Access Denied. : invalid data size align\n";
      }
    }
    else {
      __format = "Access Denied. : event multiple open\n";
    }
  }
  printf(__format);
  return 0;


}

undefined4 FUN_800fb118(int *piParm1)
{
  __off_t _Var1;
  ssize_t sVar2;
  int iVar3;
  
  iVar3 = *piParm1;
  if (iVar3 != 10) {
    if (10 < iVar3) {
      if (iVar3 != 0x1e) {
        return 0;
      }
      iVar3 = _chk_card_event();
      if (iVar3 != 0) {
        iVar3 = _get_card_event();
        if (iVar3 == 0) {
          iVar3 = 0;
        }
        else {
          DAT_80136cb8 = DAT_80136cb8 + 1;
          if (DAT_80136cb8 < 4) {
            *piParm1 = 10;
            return 0;
          }
        }
        _DAT_8014751c = FUN_800fc11c(iVar3);
        return 1;
      }
      return 0;
    }
    if (iVar3 != 0) {
      return 0;
    }
    DAT_80136cb8 = 0;
    *piParm1 = 10;
  }
  do {
    _Var1 = lseek(_DAT_80147528,_DAT_8014752c,0);
  } while (_Var1 != _DAT_8014752c);
  _clr_card_event();
  do {
    sVar2 = read(_DAT_80147528,_DAT_80147534,_DAT_80147530);
  } while (sVar2 != 0);
  *piParm1 = 0x1e;
  return 0;


}

undefined4 MemCardWriteData(undefined4 uParm1,uint uParm2,uint uParm3)
{
  char *__format;
  
  if (_DAT_80147528 < 0) {
    __format = "Access Denied. : file not open.\n";
  }
  else {
    if (_DAT_80147518 < 1) {
      if ((uParm3 & 0x7f) == 0) {
        if ((uParm2 & 0x7f) == 0) {
          _DAT_80147518 = 6;
          _DAT_8014751c = 0;
          _DAT_80147520 = 0;
          _DAT_8014752c = uParm2;
          _DAT_80147530 = uParm3;
          _DAT_80147534 = uParm1;
          UserFuncOpen(FUN_800fb30c);
          return 1;
        }
        __format = "Access Denied. : invalid offset value align\n";
      }
      else {
        __format = "Access Denied. : invalid data size align\n";
      }
    }
    else {
      __format = "Access Denied. : event multiple open\n";
    }
  }
  printf(__format);
  return 0;


}

undefined4 FUN_800fb30c(int *piParm1)
{
  __off_t _Var1;
  ssize_t sVar2;
  int iVar3;
  
  iVar3 = *piParm1;
  if (iVar3 == 10) {
    do {
      _Var1 = lseek(_DAT_80147528,_DAT_8014752c,0);
    } while (_Var1 != _DAT_8014752c);
    _clr_card_event();
    do {
      sVar2 = write(_DAT_80147528,_DAT_80147534,_DAT_80147530);
    } while (sVar2 != 0);
    *piParm1 = 0x1e;
  }
  else {
    if (10 < iVar3) {
      if (iVar3 != 0x1e) {
        return 0;
      }
      iVar3 = _chk_card_event();
      if (iVar3 != 0) {
        iVar3 = _get_card_event();
        if (iVar3 == 0) {
          iVar3 = 0;
        }
        else {
          DAT_80136cbc = DAT_80136cbc + 1;
          if (DAT_80136cbc < 4) {
            *piParm1 = 10;
            return 0;
          }
        }
        _DAT_8014751c = FUN_800fc11c(iVar3);
        return 1;
      }
      return 0;
    }
    if (iVar3 != 0) {
      return 0;
    }
    DAT_80136cbc = 0;
    *piParm1 = 10;
  }
  return 0;


}

undefined4 MemCardReadFile(undefined4 param_1,char *param_2,undefined4 param_3,uint param_4,uint param_5)
{
  char *__format;
  
  if (_DAT_80147518 < 1) {
    if (_DAT_80147528 < 0) {
      if ((param_5 & 0x7f) == 0) {
        if ((param_4 & 0x7f) == 0) {
          FUN_800fc1f4(param_1,0x80147538);
          strcat((char *)0x80147538,param_2);
          _DAT_80147518 = 3;
          _DAT_8014751c = 0;
          _DAT_80147520 = 0;
          _DAT_80147530 = param_5;
          _DAT_80147524 = param_1;
          _DAT_8014752c = param_4;
          _DAT_80147534 = param_3;
          UserFuncOpen(FUN_800fb560);
          return 1;
        }
        __format = "Access Denied. : invalid offset value align\n";
      }
      else {
        __format = "Access Denied. : invalid data size align\n";
      }
    }
    else {
      __format = "Access Denied. : file already open.\n";
    }
  }
  else {
    __format = "Access Denied. : system busy\n";
  }
  printf(__format);
  return 0;


}

undefined4 FUN_800fb560(int *piParm1)
{
  int iVar1;
  
  iVar1 = *piParm1;
  if (iVar1 == 10) {
    if (_DAT_8014751c != 0) {
      return 1;
    }
    _DAT_80147528 = open((char *)0x80147538,0x8001);
    if (_DAT_80147528 < 0) {
      _DAT_8014751c = 5;
      return 1;
    }
  }
  else {
    if (iVar1 < 0xb) {
      if (iVar1 != 0) {
        return 0;
      }
      DAT_80136cc0 = 0;
      UserFuncOpen(FUN_800fabf0);
      *piParm1 = 10;
      return 0;
    }
    if (iVar1 != 0xb) {
      if (iVar1 != 0x14) {
        return 0;
      }
      close(_DAT_80147528);
      _DAT_80147528 = 0xffffffff;
      return 1;
    }
  }
  *piParm1 = 0x14;
  UserFuncOpen(FUN_800fb118);
  return 0;


}

undefined4 MemCardWriteFile(undefined4 param_1,char *param_2,undefined4 param_3,uint param_4,uint param_5)
{
  char *__format;
  
  if (_DAT_80147518 < 1) {
    if (_DAT_80147528 < 0) {
      if ((param_5 & 0x7f) == 0) {
        if ((param_4 & 0x7f) == 0) {
          FUN_800fc1f4(param_1,0x80147538);
          strcat((char *)0x80147538,param_2);
          _DAT_80147518 = 4;
          _DAT_8014751c = 0;
          _DAT_80147520 = 0;
          _DAT_80147530 = param_5;
          _DAT_80147524 = param_1;
          _DAT_8014752c = param_4;
          _DAT_80147534 = param_3;
          UserFuncOpen(FUN_800fb780);
          return 1;
        }
        __format = "Access Denied. : invalid offset value align\n";
      }
      else {
        __format = "Access Denied. : invalid data size align\n";
      }
    }
    else {
      __format = "Access Denied. : file already open.\n";
    }
  }
  else {
    __format = "Access Denied. : system busy\n";
  }
  printf(__format);
  return 0;


}

undefined4 FUN_800fb780(int *piParm1)
{
  int iVar1;
  
  iVar1 = *piParm1;
  if (iVar1 == 10) {
    if (_DAT_8014751c != 0) {
      return 1;
    }
    _DAT_80147528 = open((char *)0x80147538,0x8001);
    if (_DAT_80147528 < 0) {
      _DAT_8014751c = 5;
      return 1;
    }
  }
  else {
    if (iVar1 < 0xb) {
      if (iVar1 != 0) {
        return 0;
      }
      DAT_80136cc4 = 0;
      UserFuncOpen(FUN_800fabf0);
      *piParm1 = 10;
      return 0;
    }
    if (iVar1 != 0xb) {
      if (iVar1 != 0x14) {
        return 0;
      }
      close(_DAT_80147528);
      _DAT_80147528 = 0xffffffff;
      return 1;
    }
  }
  *piParm1 = 0x14;
  UserFuncOpen(FUN_800fb30c);
  return 0;


}

int MemCardGetDirentry(uint param_1,char *param_2,int param_3,int *param_4,int param_5,int param_6)
{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  char acStack128 [32];
  undefined4 local_60 [8];
  undefined4 auStack64 [2];
  int local_38;
  int *local_34;
  undefined4 *local_30;
  
  if (_DAT_80147518 == 0) {
    local_34 = param_4;
    FUN_800fc1f4(param_1,acStack128);
    strcat(acStack128,param_2);
    iVar10 = 0;
    iVar9 = 0;
    local_38 = 0;
    _DAT_80147514 = _DAT_80147514 | 1 << (_DAT_80147524 & 0x1f);
    iVar12 = 0;
    if (0 < param_5 + param_6) {
      local_30 = auStack64;
      iVar11 = 0;
      do {
        if (iVar9 == 0) {
          while( true ) {
            _clr_card_event();
            iVar3 = firstfile(acStack128,local_60);
            if (iVar3 != 0) break;
            uVar2 = _get_card_event_x();
            local_38 = FUN_800fc11c(uVar2);
            if (local_38 == 0) goto LAB_800fba24;
            iVar10 = iVar10 + 1;
            if (3 < iVar10) {
              _DAT_8014756c = MemCardCallback(0);
              if (_DAT_80147518 < 1) {
                _DAT_80147518 = 2;
                _DAT_8014751c = 0;
                _DAT_80147520 = 0;
                _DAT_80147524 = param_1;
                UserFuncOpen(FUN_800fae2c);
              }
              else {
                printf("Access Denied. : event multiple open\n");
              }
              MemCardSync(0,0,&local_38);
              MemCardCallback(_DAT_8014756c);
              return local_38;
            }
          }
        }
        else {
          iVar3 = nextfile(local_60);
LAB_800fba24:
          if (iVar3 == 0) break;
        }
        if ((param_5 <= iVar9) && (param_3 != 0)) {
          puVar7 = local_60;
          puVar1 = (undefined4 *)(iVar11 + param_3);
          do {
            puVar8 = puVar1;
            puVar6 = puVar7;
            uVar2 = puVar6[1];
            uVar4 = puVar6[2];
            uVar5 = puVar6[3];
            *puVar8 = *puVar6;
            puVar8[1] = uVar2;
            puVar8[2] = uVar4;
            puVar8[3] = uVar5;
            puVar7 = puVar6 + 4;
            puVar1 = puVar8 + 4;
          } while (puVar7 != local_30);
          uVar2 = puVar6[5];
          puVar8[4] = *puVar7;
          puVar8[5] = uVar2;
          iVar11 = iVar11 + 0x28;
          iVar12 = iVar12 + 1;
        }
        iVar9 = iVar9 + 1;
      } while (iVar9 < param_5 + param_6);
    }
    uVar2 = 0;
    if (local_34 != (int *)0x0) {
      *local_34 = iVar12;
    }
  }
  else {
    local_34 = param_4;
    printf("Access Denied. : system busy\n");
    uVar2 = 0xffffffff;
  }
  return uVar2;


}

undefined4 MemCardCallback(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = _DAT_80147558;
  _DAT_80147558 = uParm1;
  return uVar1;


}

undefined4 MemCardSync(int iParm1,int *piParm2,undefined4 *puParm3)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = _DAT_80147518;
  if ((_DAT_80147518 != 0) || (uVar2 = 0xffffffff, _DAT_80147520 != 0)) {
    if (iParm1 == 0) {
      if (_DAT_80147520 == 0) {
        do {
        } while (true);
      }
      if (puParm3 != (undefined4 *)0x0) {
        *puParm3 = _DAT_80147564;
      }
      if (piParm2 != (int *)0x0) {
        *piParm2 = _DAT_80147560;
      }
      _DAT_80147520 = 0;
      uVar2 = 1;
    }
    else {
      if (_DAT_80147520 == 0) {
        if (puParm3 != (undefined4 *)0x0) {
          *puParm3 = _DAT_8014751c;
        }
        uVar2 = 0;
        if (piParm2 != (int *)0x0) {
          *piParm2 = iVar1;
        }
      }
      else {
        if (puParm3 != (undefined4 *)0x0) {
          *puParm3 = _DAT_80147564;
        }
        if (piParm2 != (int *)0x0) {
          *piParm2 = _DAT_80147560;
        }
        _DAT_80147520 = 0;
        uVar2 = 1;
      }
    }
  }
  return uVar2;


}

int MemCardCreateFile(uint uParm1,char *pcParm2,int iParm3)
{
  int __fd;
  int iVar1;
  char acStack64 [32];
  int local_20;
  
  iVar1 = 0;
  if (_DAT_80147518 == 0) {
    FUN_800fc1f4(uParm1,acStack64);
    strcat(acStack64,pcParm2);
    _DAT_80147514 = _DAT_80147514 | 1 << (_DAT_80147524 & 0x1f);
    __fd = open(acStack64,1);
    if (__fd < 0) {
      do {
        __fd = open(acStack64,iParm3 << 0x10 | 0x200);
        if (-1 < __fd) {
          close(__fd);
          return 0;
        }
        _DAT_8014756c = MemCardCallback(0);
        if (_DAT_80147518 < 1) {
          _DAT_80147518 = 2;
          _DAT_8014751c = 0;
          _DAT_80147520 = 0;
          _DAT_80147524 = uParm1;
          UserFuncOpen(FUN_800fae2c);
        }
        else {
          printf("Access Denied. : event multiple open\n");
        }
        if ((_DAT_80147518 != 0) || (_DAT_80147520 != 0)) {
          if (_DAT_80147520 == 0) {
            do {
            } while (true);
          }
          _DAT_80147520 = 0;
          local_20 = _DAT_80147564;
        }
        MemCardCallback(_DAT_8014756c);
        if (local_20 == 0) {
          return 7;
        }
      } while ((local_20 == 3) || ((local_20 == 2 && (iVar1 = iVar1 + 1, iVar1 < 4))));
      if (local_20 == 0) {
        local_20 = 5;
      }
    }
    else {
      close(__fd);
      local_20 = 6;
    }
  }
  else {
    printf("Access Denied. : system busy\n");
    local_20 = -1;
  }
  return local_20;


}

int MemCardDeleteFile(uint uParm1,char *pcParm2)
{
  int iVar1;
  char acStack64 [32];
  int local_20;
  
  iVar1 = 0;
  if (_DAT_80147518 == 0) {
    FUN_800fc1f4(uParm1,acStack64);
    strcat(acStack64,pcParm2);
    _DAT_80147514 = _DAT_80147514 | 1 << (_DAT_80147524 & 0x1f);
    do {
      local_20 = erase(acStack64);
      if (local_20 != 0) {
        return 0;
      }
      _DAT_8014756c = MemCardCallback(0);
      if (_DAT_80147518 < 1) {
        _DAT_80147518 = 2;
        _DAT_8014751c = 0;
        _DAT_80147520 = 0;
        _DAT_80147524 = uParm1;
        UserFuncOpen(FUN_800fae2c);
      }
      else {
        printf("Access Denied. : event multiple open\n");
      }
      if ((_DAT_80147518 != 0) || (_DAT_80147520 != 0)) {
        if (_DAT_80147520 == 0) {
          do {
          } while (true);
        }
        _DAT_80147520 = 0;
        local_20 = _DAT_80147564;
      }
      MemCardCallback(_DAT_8014756c);
    } while ((local_20 == 3) || ((local_20 == 2 && (iVar1 = iVar1 + 1, iVar1 < 4))));
    if (local_20 == 0) {
      local_20 = 5;
    }
  }
  else {
    printf("Access Denied. : system busy\n");
    local_20 = -1;
  }
  return local_20;


}

undefined4 MemCardFormat(undefined4 uParm1)
{
  undefined4 uVar1;
  undefined auStack72 [64];
  
  if (_DAT_80147518 == 0) {
    _DAT_80147514 = _DAT_80147514 | 1 << (_DAT_80147524 & 0x1f);
    FUN_800fc1f4(uParm1,auStack72);
    _clr_card_event();
    format(auStack72);
    uVar1 = _get_card_event_x();
    uVar1 = FUN_800fc11c(uVar1);
  }
  else {
    printf("Access Denied. : system busy\n");
    uVar1 = 0xffffffff;
  }
  return uVar1;


}

undefined4 MemCardUnformat(undefined4 uParm1)
{
  undefined4 uVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  undefined auStack144 [127];
  undefined local_11;
  
  if (_DAT_80147518 == 0) {
    iVar4 = 0x7f;
    puVar2 = &local_11;
    do {
      *puVar2 = 0xff;
      iVar4 = iVar4 + -1;
      puVar2 = puVar2 + -1;
    } while (-1 < iVar4);
    iVar4 = 0;
    do {
      _clr_card_event();
      _new_card();
      _card_write(uParm1,iVar4,auStack144);
      iVar3 = _get_card_event_x();
      iVar4 = iVar4 + 1;
      if (iVar3 != 0) {
        return 0;
      }
      uVar1 = 1;
    } while (iVar4 < 0xf);
  }
  else {
    printf("Access Denied. : system busy\n");
    uVar1 = 0xffffffff;
  }
  return uVar1;


}

uint FUN_800fc11c(uint uParm1)
{
  uint uVar1;
  
  uVar1 = 0;
  if (uParm1 == 1) {
    uVar1 = 2;
  }
  else {
    if ((int)uParm1 < 2) {
      if (uParm1 != 0) {
        uVar1 = uParm1 | 0x8000;
      }
    }
    else {
      uVar1 = 1;
      if ((uParm1 != 2) && (uVar1 = uParm1 | 0x8000, uParm1 == 4)) {
        uVar1 = 3;
      }
    }
  }
  return uVar1;


}

void FUN_800fc170(void)
{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar3 = UserFuncComplete();
  if (iVar3 == 0) {
    UserFuncExecute();
    iVar3 = UserFuncComplete();
    uVar2 = _DAT_8014751c;
    uVar1 = _DAT_80147518;
    if (iVar3 != 0) {
      _DAT_80147520 = 1;
      _DAT_80147560 = _DAT_80147518;
      _DAT_80147564 = _DAT_8014751c;
      _DAT_80147518 = 0;
      _DAT_8014751c = 0;
      if (_DAT_80147558 != (code *)0x0) {
        (*_DAT_80147558)(uVar1,uVar2);
      }
    }
  }
  return;


}

void FUN_800fc1f4(int iParm1,undefined4 *puParm2)
{
  char cVar1;
  int iVar2;
  
  *puParm2 = 0x30307562;
  *(undefined *)(puParm2 + 1) = 0x3a;
  *(undefined *)((int)puParm2 + 5) = 0;
  iVar2 = iParm1;
  if (iParm1 < 0) {
    iVar2 = iParm1 + 0xf;
  }
  cVar1 = (char)(iVar2 >> 4);
  *(char *)((int)puParm2 + 2) = cVar1 + '0';
  *(char *)((int)puParm2 + 3) = (char)iParm1 + cVar1 * -0x10 + '0';
  return;


}

undefined4 validatehandle(int **ppiParm1,int **ppiParm2,int **ppiParm3)
{
  int *piVar1;
  
  if (ppiParm1 == (int **)0x0) {
    return 1;
  }
  piVar1 = *ppiParm1;
  if (*piVar1 == 0x4d525453) {
    *(int ***)ppiParm3 = ppiParm1;
    *ppiParm2 = piVar1;
    return 0;
  }
  return 1;


}

uint inbetween(uint uParm1,uint uParm2,uint uParm3)
{
  uint uVar1;
  undefined4 uVar2;
  
  if (uParm1 <= uParm2) {
    uVar1 = 0;
    if (uParm1 <= uParm3) {
      uVar1 = (uint)(uParm3 < uParm2);
    }
    return uVar1;
  }
  uVar2 = 0;
  if ((uParm1 <= uParm3) || (uParm3 < uParm2)) {
    uVar2 = 1;
  }
  return uVar2;


}

void decbufferusage(int iParm1,int iParm2)
{
  int iVar1;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar1 = *(int *)(iParm1 + 0x3c);
  iParm2 = iVar1 - iParm2;
  *(int *)(iParm1 + 0x3c) = iParm2;
  setCopReg(0,Status,Status,0);
  if (((*(int *)(iParm1 + 0x34) <= iVar1) && (iParm2 < *(int *)(iParm1 + 0x34))) &&
     (*(undefined4 *)(iParm1 + 0x38) = 1, *(int *)(iParm1 + 0x28) == 1)) {
    FILE_priorityop(*(undefined4 *)(iParm1 + 0xa4),*(undefined4 *)(iParm1 + 0x30));
  }
  return;


}

uint * getfreerequest(int iParm1)
{
  uint *puVar1;
  uint *puVar2;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  puVar1 = *(uint **)(iParm1 + 0x58);
  puVar2 = (uint *)0x0;
  if (puVar1 != (uint *)0x0) {
    requestidcounter = requestidcounter + 0x100;
    *(uint *)(iParm1 + 0x58) = puVar1[3];
    if (requestidcounter == 0) {
      requestidcounter = 0x100;
    }
    *puVar1 = (uint)*(byte *)puVar1 | requestidcounter;
    puVar2 = puVar1;
  }
  setCopReg(0,Status,Status,0);
  return puVar2;


}

void queuerequest(int iParm1,int iParm2)
{
  *(undefined4 *)(iParm2 + 4) = 1;
  *(undefined4 *)(iParm2 + 0xc) = 0;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (*(int *)(iParm1 + 0x54) == 0) {
    *(undefined4 *)(iParm2 + 8) = 0;
    *(int *)(iParm1 + 0x4c) = iParm2;
    *(int *)(iParm1 + 0x50) = iParm2;
  }
  else {
    *(int *)(iParm2 + 8) = *(int *)(iParm1 + 0x54);
    *(int *)(*(int *)(iParm1 + 0x54) + 0xc) = iParm2;
  }
  *(int *)(iParm1 + 0x54) = iParm2;
  setCopReg(0,Status,Status,0);
  return;


}

uint * locaterequest(int iParm1,uint uParm2)
{
  uint *puVar1;
  
  if (*(int *)(iParm1 + 0xc) <= (int)(uParm2 & 0xff)) {
    return (uint *)0;
  }
  puVar1 = (uint *)(*(int *)(iParm1 + 8) + (uParm2 & 0xff) * 100);
  if ((uParm2 == *puVar1) && (puVar1[1] != 0)) {
    return puVar1;
  }
  return (uint *)0;


}

void freerequest(int iParm1,int iParm2)
{
  int iVar1;
  
  if (iParm2 == *(int *)(iParm1 + 0x4c)) {
    *(undefined4 *)(iParm1 + 0x4c) = *(undefined4 *)(iParm2 + 0xc);
  }
  else {
    *(undefined4 *)(*(int *)(iParm2 + 8) + 0xc) = *(undefined4 *)(iParm2 + 0xc);
  }
  if (iParm2 == *(int *)(iParm1 + 0x54)) {
    *(undefined4 *)(iParm1 + 0x54) = *(undefined4 *)(iParm2 + 8);
  }
  else {
    *(undefined4 *)(*(int *)(iParm2 + 0xc) + 8) = *(undefined4 *)(iParm2 + 8);
  }
  if (iParm2 == *(int *)(iParm1 + 0x50)) {
    iVar1 = *(int *)(iParm2 + 0xc);
    if (iVar1 == 0) {
      iVar1 = *(int *)(iParm2 + 8);
    }
    *(int *)(iParm1 + 0x50) = iVar1;
  }
  *(undefined4 *)(iParm2 + 4) = 0;
  *(undefined4 *)(iParm2 + 0xc) = *(undefined4 *)(iParm1 + 0x58);
  *(int *)(iParm1 + 0x58) = iParm2;
  return;


}

uint filterchunk(int iParm1,uint *puParm2)
{
  uint *puVar1;
  int iVar2;
  
  iVar2 = 0;
  if (0 < *(int *)(iParm1 + 0x14)) {
    puVar1 = *(uint **)(iParm1 + 0x10);
    do {
      iVar2 = iVar2 + 1;
      if ((*puParm2 & *puVar1) == puVar1[1]) {
        return puVar1[2];
      }
      puVar1 = puVar1 + 3;
    } while (iVar2 < *(int *)(iParm1 + 0x14));
  }
  return 0xfffffffe;


}

undefined4 parsechunks(int iParm1,undefined4 uParm2,uint uParm3)
{
  bool bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  uint uVar6;
  int iVar7;
  
  uVar3 = *(uint *)(iParm1 + 0x48);
  piVar5 = *(int **)(iParm1 + 0x44);
  iVar7 = *(int *)(iParm1 + 0x50);
  iVar2 = uVar3 - (int)piVar5;
  while( true ) {
    if (((iVar2 < 8) || (uVar6 = piVar5[1], (uVar6 & 0xff000000) != 0)) ||
       (uVar3 < (int)piVar5 + uVar6)) {
      return 0;
    }
    iVar2 = filterchunk(iParm1,piVar5,uParm3);
    if (iVar2 < 0) {
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      bVar1 = *(int *)(iVar7 + 4) == 4;
      if (!bVar1) {
        *piVar5 = -2;
        *(int *)(iParm1 + 0x44) = *(int *)(iParm1 + 0x44) + uVar6;
      }
      setCopReg(0,Status,Status,0);
    }
    else {
      piVar5[1] = piVar5[1] | iVar2 << 0x18;
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      bVar1 = *(int *)(iVar7 + 4) == 4;
      if (!bVar1) {
        iVar2 = *(int *)(iParm1 + 0x18) + iVar2 * 0x10 + -0x10;
        uVar3 = *(int *)(iVar2 + 8) + uVar6;
        *(uint *)(iVar2 + 8) = uVar3;
        if (uVar3 == uVar6) {
          *(int **)(iVar2 + 0xc) = piVar5;
        }
        *(int *)(iParm1 + 0x44) = *(int *)(iParm1 + 0x44) + uVar6;
        iVar2 = *(int *)(iParm1 + 0x3c);
        iVar4 = iVar2 + uVar6;
        *(int *)(iParm1 + 0x3c) = iVar4;
        if ((iVar2 < *(int *)(iParm1 + 0x34)) && (*(int *)(iParm1 + 0x34) <= iVar4)) {
          *(undefined4 *)(iParm1 + 0x38) = 0;
        }
      }
      setCopReg(0,Status,Status,0);
    }
    if (bVar1) break;
    if (*piVar5 == *(int *)(iVar7 + 0x5c)) {
      return 1;
    }
    uVar3 = *(uint *)(iParm1 + 0x48);
    piVar5 = *(int **)(iParm1 + 0x44);
    iVar2 = uVar3 - (int)piVar5;
    uParm3 = Status;
  }
  return 0;


}

void opencallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  
  iVar1 = FILE_completeop(*(undefined4 *)(iParm3 + 0xa4));
  *(int *)(iParm3 + 0x9c) = iVar1;
  if (iVar1 != 0) {
    restartstream(iParm3,*(undefined4 *)(iParm3 + 0x30));
  }
  return;


}

void closecallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  
  FILE_completeop(*(undefined4 *)(iParm3 + 0xa4));
  iVar1 = FILE_open(iParm3 + 0x5c,1,*(undefined4 *)(iParm3 + 0x30),iParm3);
  *(int *)(iParm3 + 0xa4) = iVar1;
  if (iVar1 != 0) {
    FILE_callbackop(iVar1,opencallback);
  }
  return;


}

void readcallback(undefined4 uParm1,undefined4 uParm2,int iParm3)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(iParm3 + 0x50);
  if (*(int *)(iVar3 + 0x10) == 1) {
    iVar2 = *(int *)(iParm3 + 0xa8);
    bVar1 = *(int *)(iVar3 + 0x58) <= *(int *)(iParm3 + 0xa0) + iVar2;
  }
  else {
    iVar2 = FILE_completeop(*(undefined4 *)(iParm3 + 0xa4));
    bVar1 = iVar2 < *(int *)(iParm3 + 0xa8);
  }
  *(int *)(iParm3 + 0xa0) = *(int *)(iParm3 + 0xa0) + iVar2;
  *(int *)(iParm3 + 0x48) = *(int *)(iParm3 + 0x48) + iVar2;
  iVar2 = parsechunks(iParm3);
  if (*(int *)(iVar3 + 4) != 4) {
    if ((!bVar1) && (iVar2 == 0)) {
      restartstream(iParm3,*(undefined4 *)(iParm3 + 0x30));
      return;
    }
    setCopReg(0,Status,Status & 0xfffffbfe,0);
    *(undefined4 *)(iVar3 + 4) = 3;
    setCopReg(0,Status,Status,0);
  }
  startnextrequest(iParm3,*(undefined4 *)(iParm3 + 0x30));
  return;


}

void startnextrequest(int iParm1,undefined4 uParm2,int iParm3)
{
  bool bVar1;
  int iVar2;
  char *__s2;
  
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar2 = *(int *)(iParm1 + 0x50);
  bVar1 = true;
  if ((iVar2 != 0) && (bVar1 = false, *(int *)(iVar2 + 4) != 1)) {
    if (*(int *)(iVar2 + 0xc) == 0) {
      bVar1 = true;
    }
    else {
      *(int *)(iParm1 + 0x50) = *(int *)(iVar2 + 0xc);
    }
  }
  if (bVar1) {
    *(undefined4 *)(iParm1 + 0x28) = 0;
  }
  else {
    iParm3 = *(int *)(iParm1 + 0x50);
    *(undefined4 *)(iParm3 + 0x60) = *(undefined4 *)(iParm1 + 0x44);
    *(undefined4 *)(iParm3 + 4) = 2;
  }
  setCopReg(0,Status,Status,0);
  if (!bVar1) {
    *(undefined4 *)(iParm1 + 0x48) = *(undefined4 *)(iParm1 + 0x44);
    if (*(int *)(iParm3 + 0x10) == 1) {
      *(undefined4 *)(iParm1 + 0xa0) = 0;
    }
    else {
      __s2 = (char *)(iParm1 + 0x5c);
      *(undefined4 *)(iParm1 + 0xa0) = *(undefined4 *)(iParm3 + 0x58);
      iVar2 = strcmp((char *)(iParm3 + 0x14),__s2);
      if (iVar2 != 0) {
        strcpy(__s2,(char *)(iParm3 + 0x14));
        if (*(int *)(iParm1 + 0x9c) != 0) {
          iVar2 = FILE_close(*(int *)(iParm1 + 0x9c),uParm2,iParm1);
          *(int *)(iParm1 + 0xa4) = iVar2;
          if (iVar2 == 0) {
            return;
          }
          FILE_callbackop(iVar2,closecallback);
          return;
        }
        iVar2 = FILE_open(__s2,1,uParm2,iParm1);
        *(int *)(iParm1 + 0xa4) = iVar2;
        if (iVar2 == 0) {
          return;
        }
        FILE_callbackop(iVar2,opencallback);
        return;
      }
    }
    restartstream(iParm1,uParm2);
  }
  return;


}

void restartstream(int iParm1,undefined4 uParm2)
{
  int iVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  undefined4 *puVar5;
  uint uVar6;
  size_t __n;
  
  uVar4 = Status;
  iVar1 = *(int *)(iParm1 + 0x40);
  while (iVar1 != *(int *)(iParm1 + 0x44)) {
    piVar3 = *(int **)(iParm1 + 0x40);
    if (*piVar3 == -1) {
      *(undefined4 *)(iParm1 + 0x40) = *(undefined4 *)(iParm1 + 0x20);
    }
    else {
      if (*piVar3 != -2) break;
      *(int *)(iParm1 + 0x40) = (int)piVar3 + piVar3[1];
    }
    iVar1 = *(int *)(iParm1 + 0x40);
  }
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar1 = *(int *)(iParm1 + 0x4c);
  iVar2 = *(int *)(iVar1 + 0xc);
  while (((iVar2 != 0 && (*(int *)(*(int *)(iVar1 + 0xc) + 4) != 1)) &&
         (iVar2 = inbetween(*(undefined4 *)(iParm1 + 0x40),*(undefined4 *)(iParm1 + 0x48),
                            *(int *)(*(int *)(iVar1 + 0xc) + 0x60) + -1), iVar2 == 0))) {
    freerequest(iParm1,iVar1);
    iVar1 = *(int *)(iParm1 + 0x4c);
    iVar2 = *(int *)(iVar1 + 0xc);
  }
  setCopReg(0,Status,uVar4,0);
  uVar6 = *(uint *)(iParm1 + 0x40);
  uVar4 = *(uint *)(iParm1 + 0x48);
  iVar1 = uVar6 - uVar4;
  if (uVar6 <= uVar4) {
    iVar1 = (*(int *)(iParm1 + 0x24) - uVar4) + -8;
    if (0x1fff < iVar1) goto LAB_800fcd0c;
    __n = uVar4 - (int)*(void **)(iParm1 + 0x44);
    if ((int)(uVar6 - (int)*(void **)(iParm1 + 0x20)) < (int)(__n + 1)) goto LAB_800fcd04;
    memcpy(*(void **)(iParm1 + 0x20),*(void **)(iParm1 + 0x44),__n);
    puVar5 = *(undefined4 **)(iParm1 + 0x44);
    *puVar5 = 0xffffffff;
    puVar5[1] = 8;
    iVar2 = *(int *)(iParm1 + 0x20) + __n;
    iVar1 = *(int *)(iParm1 + 0x40) - iVar2;
    *(int *)(iParm1 + 0x44) = *(int *)(iParm1 + 0x20);
    *(int *)(iParm1 + 0x48) = iVar2;
  }
  iVar1 = iVar1 + -1;
  if (iVar1 < 0x2000) {
LAB_800fcd04:
    *(undefined4 *)(iParm1 + 0x28) = 2;
    return;
  }
LAB_800fcd0c:
  iVar2 = *(int *)(iParm1 + 0x50);
  if (*(int *)(iVar2 + 0x10) == 1) {
    if (*(int *)(iVar2 + 0x58) < *(int *)(iParm1 + 0xa0) + iVar1) {
      *(int *)(iParm1 + 0xa8) = *(int *)(iVar2 + 0x58) - *(int *)(iParm1 + 0xa0);
    }
    else {
      *(int *)(iParm1 + 0xa8) = iVar1;
    }
    memcpy(*(void **)(iParm1 + 0x48),*(void **)(iVar2 + 0x54),*(size_t *)(iParm1 + 0xa8));
    *(int *)(iVar2 + 0x54) = *(int *)(iVar2 + 0x54) + *(int *)(iParm1 + 0xa8);
    readcallback(0,0,iParm1);
    return;
  }
  *(undefined4 *)(iParm1 + 0xa8) = 0x2000;
  iVar1 = FILE_read(*(undefined4 *)(iParm1 + 0x9c),*(undefined4 *)(iParm1 + 0xa0),
                    *(undefined4 *)(iParm1 + 0x48),*(undefined4 *)(iParm1 + 0xa8),uParm2,iParm1);
  *(int *)(iParm1 + 0xa4) = iVar1;
  if (iVar1 == 0) {
    return;
  }
  FILE_callbackop(iVar1,readcallback);
  return;


}

int STREAM_overhead(int iParm1,int iParm2,int iParm3)
{
  return iParm1 * 100 + iParm2 * 0xc + 0xac + iParm3 * 0x10;


}

undefined4 STREAM_create(int param_1,int param_2,int param_3,undefined4 *param_4,int param_5)
{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  
  iVar1 = STREAM_overhead();
  if (param_5 - iVar1 < 0x6000) {
    return 0;
  }
  if ((1 < param_1) && (param_1 < 0x101)) {
    if (0xf < param_2 - 1U) {
      return 0;
    }
    if (0 < param_3) {
      if (param_2 < param_3) {
        return 0;
      }
      *param_4 = 0x4d525453;
      uVar2 = allocmutex();
      param_4[1] = uVar2;
      *(undefined4 **)(param_4 + 2) = param_4 + 0x2b;
      param_4[9] = (int)param_4 + param_5;
      param_4[0xb] = 0x96;
      param_4[3] = param_1;
      param_4[5] = param_2;
      param_4[7] = param_3;
      param_4[10] = 0;
      param_4[0xd] = 0;
      param_4[0xe] = 0;
      param_4[0xf] = 0;
      param_4[0x13] = 0;
      param_4[0x14] = 0;
      param_4[0x15] = 0;
      iVar1 = param_4[2] + param_1 * 100;
      param_4[4] = iVar1;
      iVar1 = iVar1 + param_2 * 0xc;
      param_4[6] = iVar1;
      iVar1 = iVar1 + param_3 * 0x10;
      param_4[8] = iVar1;
      param_4[0xc] = 0x32;
      param_4[0x10] = iVar1;
      param_4[0x11] = iVar1;
      param_4[0x12] = iVar1;
      param_4[0x16] = param_4[2];
      memset(param_4 + 0x17,0,0x40);
      iVar1 = 0;
      param_4[0x27] = 0;
      if (0 < param_1) {
        iVar6 = 100;
        iVar5 = 0;
        do {
          piVar4 = (int *)(param_4[2] + iVar5);
          iVar5 = iVar5 + 100;
          *piVar4 = iVar1;
          piVar4[1] = 0;
          iVar1 = iVar1 + 1;
          piVar4[3] = param_4[2] + iVar6;
          iVar6 = iVar6 + 100;
        } while (iVar1 < param_1);
      }
      iVar1 = 0;
      *(undefined4 *)(param_1 * 100 + param_4[2] + -0x58) = 0;
      if (0 < param_2) {
        iVar5 = 0;
        do {
          iVar1 = iVar1 + 1;
          puVar3 = (undefined4 *)(param_4[4] + iVar5);
          *puVar3 = 0;
          puVar3[1] = 0;
          puVar3[2] = 1;
          iVar5 = iVar5 + 0xc;
        } while (iVar1 < param_2);
      }
      iVar1 = 0;
      if (0 < param_3) {
        iVar5 = 0;
        do {
          iVar1 = iVar1 + 1;
          puVar3 = (undefined4 *)(param_4[6] + iVar5);
          *(undefined4 **)puVar3 = param_4;
          puVar3[1] = iVar1;
          puVar3[2] = 0;
          iVar5 = iVar1 * 0x10;
        } while (iVar1 < param_3);
      }
      return param_4[6];
    }
  }
  return 0;


}

void STREAM_setfilter(undefined4 param_1,int param_2,uint param_3,uint param_4,uint param_5)
{
  int iVar1;
  uint *puVar2;
  int local_20;
  undefined auStack28 [4];
  
  iVar1 = validatehandle(param_1,&local_20,auStack28);
  if ((((((iVar1 == 0) && (0 < param_2)) && (param_2 <= *(int *)(local_20 + 0x14))) &&
       ((param_2 != *(int *)(local_20 + 0x14) || ((param_3 | param_4) == 0)))) &&
      ((0 < (int)param_5 || ((param_5 == 0xffffffff || (param_5 == 0xfffffffe)))))) &&
     (((int)param_5 <= *(int *)(local_20 + 0x1c) && (*(int *)(local_20 + 0x28) == 0)))) {
    puVar2 = (uint *)(*(int *)(local_20 + 0x10) + param_2 * 0xc + -0xc);
    *puVar2 = param_3;
    puVar2[1] = param_4;
    puVar2[2] = param_5;
  }
  return;


}

void STREAM_destroy(undefined4 uParm1)
{
  int iVar1;
  undefined4 *local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  if (iVar1 == 0) {
    STREAM_kill(uParm1);
    iVar1 = local_10[10];
    while (iVar1 == 1) {
      iVar1 = iscurrentthread(0);
      if (iVar1 != 0) {
        systemtask(0);
      }
      yieldthread(0);
      iVar1 = local_10[10];
    }
    *local_10 = 0;
    freemutex(local_10[1]);
    FILE_closesync(local_10[0x27],100);
  }
  return;


}

void STREAM_setpriority(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  int iVar1;
  int local_18;
  undefined auStack20 [4];
  
  iVar1 = validatehandle(uParm1,&local_18,auStack20);
  if (iVar1 == 0) {
    *(undefined4 *)(local_18 + 0x2c) = uParm2;
    *(undefined4 *)(local_18 + 0x30) = uParm3;
  }
  return;


}

void STREAM_setgreedylevel(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int local_18;
  undefined auStack20 [4];
  
  iVar1 = validatehandle(uParm1,&local_18,auStack20);
  if (iVar1 == 0) {
    iVar1 = *(int *)(local_18 + 0x34);
    *(int *)(local_18 + 0x34) = iParm2;
    if (*(int *)(local_18 + 0x3c) < iVar1 != *(int *)(local_18 + 0x3c) < iParm2) {
      STREAM_setgreedystate(uParm1);
    }
  }
  return;


}

void STREAM_setgreedystate(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  if (iVar1 == 0) {
    *(int *)(local_10 + 0x38) = iParm2;
    if ((iParm2 != 0) && (*(int *)(local_10 + 0x28) == 1)) {
      FILE_priorityop(*(undefined4 *)(local_10 + 0xa4),*(undefined4 *)(local_10 + 0x30));
    }
  }
  return;


}

undefined4 STREAM_queuefile(undefined4 uParm1,char *pcParm2,undefined4 uParm3,undefined4 uParm4)
{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int local_20;
  undefined auStack28 [4];
  
  iVar1 = validatehandle(uParm1,&local_20,auStack28);
  uVar2 = 0;
  if (iVar1 == 0) {
    puVar3 = (undefined4 *)getfreerequest(local_20);
    if (puVar3 == (undefined4 *)0x0) {
      uVar2 = 0;
    }
    else {
      puVar3[4] = 0;
      strncpy((char *)(puVar3 + 5),pcParm2,0x3f);
      puVar3[0x16] = uParm3;
      puVar3[0x17] = uParm4;
      queuerequest(local_20,puVar3);
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      iVar1 = *(int *)(local_20 + 0x28);
      if (iVar1 == 0) {
        *(undefined4 *)(local_20 + 0x28) = 1;
      }
      setCopReg(0,Status,Status,0);
      if (iVar1 == 0) {
        if (*(int *)(local_20 + 0x38) == 0) {
          uVar2 = *(undefined4 *)(local_20 + 0x2c);
        }
        else {
          uVar2 = *(undefined4 *)(local_20 + 0x30);
        }
        startnextrequest(local_20,uVar2);
      }
      uVar2 = *puVar3;
    }
  }
  return uVar2;


}

undefined4 STREAM_queuemem(undefined4 uParm1,int *piParm2,int iParm3,int iParm4)
{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int *piVar5;
  int local_20;
  undefined auStack28 [4];
  
  iVar2 = validatehandle(uParm1,&local_20,auStack28);
  uVar3 = 0;
  if (iVar2 == 0) {
    puVar4 = (undefined4 *)getfreerequest(local_20);
    uVar3 = 0;
    if (puVar4 != (undefined4 *)0x0) {
      if (iParm3 == 0) {
        iVar2 = *piParm2;
        piVar5 = piParm2;
        while (iVar2 != iParm4) {
          piVar1 = piVar5 + 1;
          piVar5 = (int *)((int)piVar5 + *piVar1);
          iVar2 = *piVar5;
          iParm3 = iParm3 + *piVar1;
        }
        iParm3 = iParm3 + piVar5[1];
      }
      puVar4[4] = 1;
      *(int **)(puVar4 + 0x15) = piParm2;
      puVar4[0x16] = iParm3;
      puVar4[0x17] = iParm4;
      queuerequest(local_20,puVar4);
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      iVar2 = *(int *)(local_20 + 0x28);
      if (iVar2 == 0) {
        *(undefined4 *)(local_20 + 0x28) = 1;
      }
      setCopReg(0,Status,Status,0);
      if (iVar2 == 0) {
        startnextrequest(local_20,0);
      }
      uVar3 = *puVar4;
    }
  }
  return uVar3;


}

void STREAM_cancelrequest(undefined4 uParm1,undefined4 uParm2)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  uint uVar6;
  int *unaff_s4;
  int *unaff_s6;
  int *unaff_s7;
  int local_30;
  int local_2c;
  
  iVar2 = validatehandle(uParm1,&local_30,&local_2c);
  uVar6 = Status;
  if (iVar2 != 0) {
    return;
  }
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iVar2 = locaterequest(local_30,uParm2);
  if ((iVar2 != 0) && (*(int *)(iVar2 + 4) != 4)) {
    if (*(int *)(iVar2 + 4) != 1) {
      *(undefined4 *)(iVar2 + 4) = 4;
      unaff_s7 = *(int **)(local_30 + 0x40);
      unaff_s4 = unaff_s7;
      if (iVar2 != *(int *)(local_30 + 0x4c)) {
        unaff_s4 = *(int **)(iVar2 + 0x60);
      }
      iVar2 = *(int *)(iVar2 + 0xc);
      if ((iVar2 == 0) || (bVar1 = false, *(int *)(iVar2 + 4) == 1)) {
        unaff_s6 = *(int **)(local_30 + 0x44);
        bVar1 = false;
      }
      else {
        unaff_s6 = *(int **)(iVar2 + 0x60);
      }
      goto LAB_800fd64c;
    }
    freerequest(local_30);
  }
  bVar1 = true;
LAB_800fd64c:
  setCopReg(0,Status,uVar6,0);
  if ((!bVar1) && (iVar2 = 0, 0 < *(int *)(local_30 + 0x1c))) {
    do {
      local_2c = *(int *)(local_30 + 0x18) + iVar2 * 0x10;
      if (0 < *(int *)(local_2c + 8)) {
        iVar3 = inbetween(unaff_s7,unaff_s4,*(undefined4 *)(local_2c + 0xc));
        if (iVar3 == 0) {
          uVar4 = *(undefined4 *)(local_2c + 0xc);
          while (iVar3 = inbetween(unaff_s4,unaff_s6,uVar4), iVar3 != 0) {
            uVar4 = STREAM_get(local_2c);
            STREAM_release(local_2c,uVar4);
            if (*(int *)(local_2c + 8) < 1) break;
            uVar4 = *(undefined4 *)(local_2c + 0xc);
          }
        }
        else {
          iVar3 = *(int *)(local_2c + 4);
          piVar5 = unaff_s4;
          while (piVar5 != unaff_s6) {
            if (*piVar5 == -1) {
              piVar5 = *(int **)(local_30 + 0x20);
            }
            else {
              uVar6 = piVar5[1] & 0xffffff;
              if ((piVar5[1] & 0xff000000U) == iVar3 << 0x18) {
                setCopReg(0,Status,Status & 0xfffffbfe,0);
                *(int *)(local_2c + 8) = *(int *)(local_2c + 8) - uVar6;
                setCopReg(0,Status,Status,0);
                decbufferusage(local_30,uVar6);
                *piVar5 = -2;
                piVar5[1] = uVar6;
              }
              piVar5 = (int *)((int)piVar5 + uVar6);
            }
          }
        }
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < *(int *)(local_30 + 0x1c));
  }
  return;


}

void STREAM_kill(undefined4 uParm1)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  undefined4 *puVar5;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  if ((iVar1 == 0) && (puVar5 = *(undefined4 **)(local_10 + 0x54), puVar5 != (undefined4 *)0x0)) {
    while (puVar5[1] - 1 < 2) {
      STREAM_cancelrequest(uParm1,*puVar5);
      puVar5 = *(undefined4 **)(local_10 + 0x54);
    }
    while (*(int *)(local_10 + 0x4c) != *(int *)(local_10 + 0x50)) {
      freerequest(local_10,*(undefined4 *)(local_10 + 0x4c));
    }
    *(undefined4 *)(*(int *)(local_10 + 0x50) + 4) = 4;
    iVar1 = 0;
    if (0 < *(int *)(local_10 + 0x1c)) {
      iVar3 = 0;
      do {
        *(undefined4 *)(iVar3 + *(int *)(local_10 + 0x18) + 8) = 0;
        iVar1 = iVar1 + 1;
        iVar3 = iVar1 * 0x10;
      } while (iVar1 < *(int *)(local_10 + 0x1c));
    }
    decbufferusage(local_10,*(undefined4 *)(local_10 + 0x3c));
    piVar4 = *(int **)(local_10 + 0x40);
    if (piVar4 != *(int **)(local_10 + 0x44)) {
      do {
        if (*piVar4 == -1) {
          piVar4 = *(int **)(local_10 + 0x20);
        }
        else {
          uVar2 = piVar4[1];
          *piVar4 = -2;
          piVar4[1] = uVar2 & 0xffffff;
          piVar4 = (int *)((int)piVar4 + (uVar2 & 0xffffff));
        }
      } while (piVar4 != *(int **)(local_10 + 0x44));
    }
    if (*(int *)(local_10 + 0x28) == 2) {
      *(undefined4 *)(local_10 + 0x28) = 0;
    }
  }
  return;


}

int STREAM_get(undefined4 uParm1)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int local_10;
  int local_c;
  
  iVar1 = validatehandle(uParm1,&local_10,&local_c);
  iVar2 = 0;
  if (iVar1 == 0) {
    if (*(int *)(local_c + 8) == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = *(int *)(local_c + 0xc);
      uVar3 = *(uint *)(iVar2 + 4) & 0xffffff;
      *(uint *)(iVar2 + 4) = uVar3;
      setCopReg(0,Status,Status & 0xfffffbfe,0);
      iVar1 = *(int *)(local_c + 8) - uVar3;
      *(int *)(local_c + 8) = iVar1;
      setCopReg(0,Status,Status,0);
      if (0 < iVar1) {
        piVar4 = (int *)(iVar2 + uVar3);
        uVar3 = piVar4[1];
        while ((uVar3 & 0xff000000) != *(int *)(local_c + 4) << 0x18) {
          if (*piVar4 == -1) {
            piVar4 = *(int **)(local_10 + 0x20);
          }
          else {
            piVar4 = (int *)((int)piVar4 + (piVar4[1] & 0xffffffU));
          }
          uVar3 = piVar4[1];
        }
        *(int **)(local_c + 0xc) = piVar4;
      }
    }
  }
  return iVar2;


}

void STREAM_release(undefined4 uParm1,int *piParm2)
{
  int iVar1;
  undefined4 uVar2;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  if ((((iVar1 == 0) && (*(int **)(local_10 + 0x20) <= piParm2)) &&
      (piParm2 <= (int *)(*(int *)(local_10 + 0x24) + -8))) && (*piParm2 != -2)) {
    *piParm2 = -2;
    decbufferusage(local_10,piParm2[1]);
    setCopReg(0,Status,Status & 0xfffffbfe,0);
    iVar1 = *(int *)(local_10 + 0x28);
    if (iVar1 == 2) {
      *(undefined4 *)(local_10 + 0x28) = 1;
    }
    setCopReg(0,Status,Status,0);
    if (iVar1 == 2) {
      if (*(int *)(local_10 + 0x38) == 0) {
        uVar2 = *(undefined4 *)(local_10 + 0x2c);
      }
      else {
        uVar2 = *(undefined4 *)(local_10 + 0x30);
      }
      restartstream(local_10,uVar2);
    }
  }
  return;


}

undefined4 STREAM_gettable(undefined4 uParm1)
{
  int iVar1;
  undefined4 uVar2;
  undefined auStack16 [4];
  int local_c;
  
  iVar1 = validatehandle(uParm1,auStack16,&local_c);
  uVar2 = 0;
  if (iVar1 == 0) {
    uVar2 = *(undefined4 *)(local_c + 8);
  }
  return uVar2;


}

undefined4 STREAM_state(undefined4 uParm1)
{
  int iVar1;
  undefined4 uVar2;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  uVar2 = 0;
  if (iVar1 == 0) {
    uVar2 = *(undefined4 *)(local_10 + 0x28);
  }
  return uVar2;


}

uint STREAM_isendofstream(undefined4 uParm1)
{
  int iVar1;
  uint uVar2;
  int local_10;
  int local_c;
  
  iVar1 = validatehandle(uParm1,&local_10,&local_c);
  uVar2 = 0;
  if ((iVar1 == 0) && (uVar2 = 0, *(int *)(local_10 + 0x28) == 0)) {
    uVar2 = (uint)(*(int *)(local_c + 8) == 0);
  }
  return uVar2;


}

int STREAM_buffersize(undefined4 uParm1)
{
  int iVar1;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  if (iVar1 == 0) {
    iVar1 = *(int *)(local_10 + 0x24) - *(int *)(local_10 + 0x20);
  }
  else {
    iVar1 = 0;
  }
  return iVar1;


}

undefined4 STREAM_bufferusage(undefined4 uParm1)
{
  int iVar1;
  undefined4 uVar2;
  int local_10;
  undefined auStack12 [4];
  
  iVar1 = validatehandle(uParm1,&local_10,auStack12);
  uVar2 = 0;
  if (iVar1 == 0) {
    uVar2 = *(undefined4 *)(local_10 + 0x3c);
  }
  return uVar2;


}

void InitHeap(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void PadInitDirect(undefined4 uParm1,undefined4 uParm2)
{
  int iVar1;
  int *piVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  
  _padIntExec = 0;
  _padModeMtap = 0;
  _padInitDirSeq();
  iVar7 = -0x7feb8a00;
  _padFuncNextPort = FUN_800fdef0;
  _padFuncClrInfo = &LAB_800fde88;
  _padFuncGetTxd = &LAB_800fdff4;
  _padFuncCurrLimit = FUN_800fe0b0;
  _padFuncPtr2Port = &LAB_800fe32c;
  _padFuncPort2Info = &LAB_800fe364;
  _padInfoDir = 0x80147600;
  _padFuncClrCmdNo = FUN_800fdfe4;
  bzero((void *)0x80147600,0x1e0);
  iVar6 = 0;
  piVar2 = (int *)&DAT_80147640;
  iVar5 = -0x7feb8a48;
  iVar4 = -0x7feb8a90;
  _DAT_80147630 = uParm1;
  _DAT_80147720 = uParm2;
  do {
    puVar3 = (undefined *)(iVar7 + 0x5d);
    piVar2[-0xd] = 0;
    piVar2[-0xc] = iVar7;
    *(undefined *)piVar2[-4] = 0xff;
    iVar1 = 5;
    *(undefined *)(piVar2[-4] + 1) = 0;
    piVar2[-1] = iVar4;
    *piVar2 = iVar5;
    do {
      *puVar3 = 0xff;
      iVar1 = iVar1 + -1;
      puVar3 = puVar3 + 1;
    } while (-1 < iVar1);
    iVar5 = iVar5 + 0x23;
    iVar4 = iVar4 + 0x23;
    iVar6 = iVar6 + 1;
    piVar2 = piVar2 + 0x3c;
    iVar7 = iVar7 + 0xf0;
  } while (iVar6 < 2);
  _padSetVsyncParam();
  _padIntExec = 1;
  return;


}

void FUN_800fdef0(int iParm1)
{
  int iVar1;
  
  do {
    iVar1 = _padSioChan * 0xf0 + -0x7feb8a00;
    if (iParm1 != -9) {
      if (iParm1 == 0) {
        *(undefined4 *)(&_padFixResult + _padSioChan * 4) = 0;
      }
      else {
        _dirFailAuto(iVar1);
        FUN_800fdfe4(iVar1);
      }
    }
    _padSioState = 0;
    _DAT_1f80104a = 0;
    _padSioChan = _padSioChan + 1;
    iVar1 = 1;
    if (_padSioChan < 2) {
      iVar1 = _padInitSioMode(_padSioChan * 0xf0 + -0x7feb8a00);
    }
    iParm1 = 0xffff;
  } while (iVar1 == 0);
  return;


}

void FUN_800fdfe4(int iParm1)
{
  undefined uVar1;
  
  uVar1 = *(undefined *)(iParm1 + 0x36);
  *(undefined *)(iParm1 + 0x36) = 0;
  *(undefined *)(iParm1 + 0x37) = uVar1;
  return;


}

void FUN_800fe0b0(int iParm1)
{
  bool bVar1;
  int iVar2;
  byte *pbVar3;
  undefined *puVar4;
  byte *pbVar5;
  byte bVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  
  bzero((void *)(iParm1 + 0x57),6);
  if ((*(short *)(iParm1 + 0xe6) == 0) || (*(int *)(iParm1 + 0x28) == 0)) {
    if ((((uint)*(byte *)(iParm1 + 0xe8) - 4 < 2) || (*(byte *)(iParm1 + 0xe8) == 7)) &&
       ((*(short *)(iParm1 + 0xe6) == 0 && (1 < *(byte *)(iParm1 + 0x34))))) {
      if ((((**(byte **)(iParm1 + 0x28) & 0xc0) == 0x40) &&
          (((*(byte **)(iParm1 + 0x28))[1] & 1) != 0)) && (_padTotalCurr + 10 < 0x3d)) {
        *(undefined *)(iParm1 + 0x58) = 1;
        *(undefined *)(iParm1 + 0x57) = 1;
        _padTotalCurr = _padTotalCurr + 10;
      }
    }
    else {
      if (*(char *)(iParm1 + 0xe8) == '\x03') {
        *(undefined *)(iParm1 + 0x57) = 1;
      }
      else {
        if (*(short *)(iParm1 + 0xe6) == 0) {
          iVar9 = 5;
          iParm1 = iParm1 + 5;
          do {
            *(undefined *)(iParm1 + 0x57) = 1;
            iVar9 = iVar9 + -1;
            iParm1 = iParm1 + -1;
          } while (-1 < iVar9);
        }
      }
    }
  }
  else {
    uVar8 = 6;
    if (*(byte *)(iParm1 + 0x34) < 7) {
      uVar8 = (uint)*(byte *)(iParm1 + 0x34);
    }
    uVar7 = 0;
    if (*(char *)(iParm1 + 0xe9) != '\0') {
      iVar9 = 0;
      do {
        bVar1 = false;
        bVar6 = 1;
        if (*(char *)(iVar9 + *(int *)(iParm1 + 4) + 2) != '\0') {
          bVar6 = 0xff;
        }
        pbVar5 = (byte *)(iParm1 + 0x5d);
        pbVar3 = *(byte **)(iParm1 + 0x28);
        iVar2 = 0;
        if (uVar8 != 0) {
          do {
            if (((uint)*pbVar5 == uVar7) && ((*pbVar3 & bVar6) != 0)) {
              bVar1 = true;
              break;
            }
            pbVar5 = pbVar5 + 1;
            iVar2 = iVar2 + 1;
            pbVar3 = pbVar3 + 1;
          } while (iVar2 < (int)uVar8);
        }
        if (bVar1) {
          iVar2 = _padTotalCurr + (uint)*(byte *)(iVar9 + *(int *)(iParm1 + 4) + 3);
          if (0x3c < iVar2) {
            bVar1 = false;
            iVar2 = _padTotalCurr;
          }
          _padTotalCurr = iVar2;
          if (bVar1) {
            pbVar3 = (byte *)(iParm1 + 0x5d);
            puVar4 = (undefined *)(iParm1 + 0x57);
            iVar2 = 0;
            if (uVar8 != 0) {
              do {
                bVar6 = *pbVar3;
                pbVar3 = pbVar3 + 1;
                if ((uint)bVar6 == uVar7) {
                  *puVar4 = 1;
                }
                iVar2 = iVar2 + 1;
                puVar4 = puVar4 + 1;
              } while (iVar2 < (int)uVar8);
            }
          }
        }
        uVar7 = uVar7 + 1;
        iVar9 = iVar9 + 5;
      } while ((int)uVar7 < (int)(uint)*(byte *)(iParm1 + 0xe9));
    }
  }
  return;


}

void * memchr(void *__s,int __c,size_t __n)
{
  void *pvVar1;
  
                    
  pvVar1 = (void *)(*(code *)&LAB_000000a0)();
  return pvVar1;


}

void * memmove(void *__dest,void *__src,size_t __n)
{
  bool bVar1;
  undefined uVar2;
  int iVar3;
  
  if (__dest < __src) {
    iVar3 = __n - 1;
    if (0 < (int)__n) {
      do {
        uVar2 = *(undefined *)__src;
        __src = (undefined *)__src + 1;
        *(undefined *)__dest = uVar2;
        bVar1 = 0 < iVar3;
        __dest = (undefined *)__dest + 1;
        iVar3 = iVar3 + -1;
      } while (bVar1);
    }
  }
  else {
    iVar3 = __n - 1;
    if (0 < (int)__n) {
      do {
        bVar1 = 0 < iVar3;
        *(undefined *)((int)__dest + iVar3) = *(undefined *)((int)__src + iVar3);
        iVar3 = iVar3 + -1;
      } while (bVar1);
    }
  }
  return __dest;


}

uint iscurrentthread(int iParm1)
{
  return (uint)(g_currentthread == iParm1);


}

void yieldthread(void)
{
  return;


}

undefined * allocmutex(void)
{
  int iVar1;
  short *psVar2;
  
  iVar1 = 0;
  psVar2 = (short *)&mutexbuf;
  do {
    if (*psVar2 == 0) {
      *psVar2 = 1;
      break;
    }
    iVar1 = iVar1 + 1;
    psVar2 = psVar2 + 2;
  } while (iVar1 < 0x20);
  if (iVar1 != 0x20) {
    return &mutexbuf + iVar1 * 4;
  }
  return (undefined *)0;


}

void freemutex(undefined4 *puParm1)
{
  *puParm1 = 0;
  return;


}

void make64(int *piParm1,int iParm2,uint uParm3)
{
  if (0x1f < (int)uParm3) {
    *piParm1 = 0;
    piParm1[1] = iParm2 << (uParm3 - 0x20 & 0x1f);
    return;
  }
  if (0 < (int)uParm3) {
    *piParm1 = iParm2 << (uParm3 & 0x1f);
    piParm1[1] = iParm2 >> (0x20 - uParm3 & 0x1f);
    return;
  }
  *piParm1 = iParm2;
  piParm1[1] = iParm2 >> 0x1f;
  return;


}

int divu64(uint uParm1,uint uParm2,uint uParm3)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar3 = 0x1f;
  do {
    iVar2 = iVar2 * 2;
    uParm2 = uParm2 * 2 + (uParm1 >> 0x1f);
    uParm1 = uParm1 << 1;
    if (uParm3 <= uParm2) {
      uParm2 = uParm2 - uParm3;
      iVar2 = iVar2 + 1;
    }
    bVar1 = iVar3 != 0;
    iVar3 = iVar3 + -1;
  } while (bVar1);
  return iVar2;


}

int stricmp(byte *pbParm1,byte *pbParm2)
{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  
  uVar3 = (uint)*pbParm1;
  if (uVar3 - 0x41 < 0x1a) {
    uVar3 = uVar3 + 0x20;
  }
  if ((uint)*pbParm2 - 0x41 < 0x1a) {
    iVar2 = (uVar3 - 0x20) - (uint)*pbParm2;
  }
  else {
    iVar2 = uVar3 - (uint)*pbParm2;
  }
  if ((iVar2 == 0) && (*pbParm1 != 0)) {
    uVar1 = stricmp(pbParm1 + 1,pbParm2 + 1);
    return uVar1;
  }
  return iVar2;


}

void iSNDplatformfree(void)
{
  iSNDpsxfree();
  return;


}

undefined4 iSNDbankremovepat(int iParm1,int iParm2,undefined4 uParm3)
{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = *(int *)(iParm1 * 0xc + _DAT_801478f8);
  iVar4 = 0;
  if (*(char *)(iVar3 + 4) == '\x04') {
    iVar4 = iVar3;
  }
  iVar1 = iSNDvalidbank();
  uVar2 = 0xfffffff8;
  if (((iVar1 == 0) && (-1 < iParm2)) &&
     (uVar2 = 0xfffffff8, iParm2 < (int)(uint)*(ushort *)(iVar3 + 6))) {
    if (*(char *)(iVar3 + 4) == '\x04') {
      iVar1 = *(int *)(iVar4 + iParm2 * 4 + 0x14);
    }
    else {
      iVar1 = *(int *)(iVar3 + iParm2 * 4 + 0xc);
    }
    uVar2 = 0xfffffff8;
    if (iVar1 != 0) {
      iSNDremovetaggedpatch(iVar1,uParm3);
      if (*(char *)(iVar3 + 4) == '\x04') {
        *(undefined4 *)(iVar4 + iParm2 * 4 + 0x14) = 0;
      }
      else {
        *(undefined4 *)(iVar3 + iParm2 * 4 + 0xc) = 0;
      }
      uVar2 = 0;
    }
  }
  return uVar2;


}

undefined4 iSNDvalidbank(int iParm1)
{
  undefined4 uVar1;
  int *piVar2;
  
  if ((iParm1 < 0) || ((int)(uint)_DAT_8014786c <= iParm1)) {
    return 0xfffffff8;
  }
  piVar2 = (int *)(iParm1 * 0xc + _DAT_801478f8);
  uVar1 = 0xfffffff8;
  if ((*piVar2 != 0) && (uVar1 = 0xffffffee, *(char *)(piVar2 + 2) == '\0')) {
    return 0;
  }
  return uVar1;


}

undefined4 iSNDischanreserved(int iParm1,int iParm2)
{
  char *pcVar1;
  int iVar2;
  int iVar3;
  
  if (0 < iParm2) {
    pcVar1 = &sndchanreserved;
    iVar2 = 0;
    do {
      iVar3 = iVar2 + 1;
      if ((int)*pcVar1 == iParm1) {
        return 1;
      }
      pcVar1 = &DAT_80147915 + iVar2;
      iVar2 = iVar3;
    } while (iVar3 < iParm2);
  }
  return 0;


}

int iSNDallocchan(uint uParm1,int iParm2,undefined uParm3,uint *puParm4)
{
  byte bVar1;
  undefined *puVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int *piVar6;
  uint uVar7;
  uint uVar8;
  char *pcVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  byte bVar13;
  int iVar14;
  int local_38;
  
  iVar14 = 0;
  local_38 = -9;
  if (0 < iParm2) {
    puVar2 = &sndchanreserved;
    iVar11 = 0;
    do {
      *puVar2 = 0xff;
      iVar10 = iVar11 + 1;
      puVar2 = &DAT_80147915 + iVar11;
      iVar11 = iVar10;
    } while (iVar10 < iParm2);
  }
  DAT_80136dec = DAT_80136dec + 0x20;
  if ((int)DAT_80136dec < 0) {
    DAT_80136dec = 0;
  }
  iVar11 = 0;
  if (0 < iParm2) {
    do {
      uVar12 = 0xffffffff;
      uVar7 = 0;
      if (DAT_80147871 != 0) {
        iVar10 = 0;
        uVar8 = uVar12;
        do {
          if (((((uParm1 & 1 << (uVar7 & 0x1f)) != 0) &&
               (iVar5 = _DAT_801478f4 + iVar10, *(char *)(iVar5 + 0xb) == '\0')) &&
              (iVar3 = iSNDischanreserved(uVar7,iVar14), iVar3 == 0)) &&
             (uVar4 = *(uint *)(iVar5 + 0x10), uVar4 < uVar8)) {
            uVar12 = uVar7;
            uVar8 = uVar4;
          }
          uVar7 = uVar7 + 1;
          iVar10 = iVar10 + 100;
        } while ((int)uVar7 < (int)(uint)DAT_80147871);
      }
      if (-1 < (int)uVar12) {
        (&sndchanreserved)[iVar14] = (char)uVar12;
        iVar14 = iVar14 + 1;
      }
      iVar11 = iVar11 + 1;
      iVar10 = iVar14;
    } while (iVar11 < iParm2);
    while (iVar10 < iParm2) {
      bVar13 = 0x66;
      uVar12 = 0xffffffff;
      uVar7 = 0xffffffff;
      uVar8 = 0;
      if (DAT_80147871 != 0) {
        iVar11 = 0;
        do {
          if ((((uParm1 & 1 << (uVar8 & 0x1f)) != 0) &&
              (iVar5 = iSNDischanreserved(uVar8,iVar14), iVar5 == 0)) &&
             (iVar5 = _DAT_801478f4 + iVar11, *(byte *)(iVar5 + 0xc) < 0x65)) {
            bVar1 = *(byte *)(iVar5 + 0xc);
            if (bVar1 < bVar13) {
              uVar4 = *(uint *)(iVar5 + 0x10);
              bVar13 = bVar1;
            }
            else {
              if ((bVar1 != bVar13) || (uVar4 = *(uint *)(iVar5 + 0x10), uVar7 <= uVar4))
              goto LAB_800fe990;
            }
            uVar12 = uVar8;
            uVar7 = uVar4;
          }
LAB_800fe990:
          uVar8 = uVar8 + 1;
          iVar11 = iVar11 + 100;
        } while ((int)uVar8 < (int)(uint)DAT_80147871);
      }
      if (-1 < (int)uVar12) {
        (&sndchanreserved)[iVar14] = (char)uVar12;
        iVar14 = iVar14 + 1;
        if (iParm2 <= iVar14) break;
      }
      iVar10 = iVar10 + 1;
    }
  }
  if (iVar14 == iParm2) {
    *puParm4 = DAT_80136dec | (int)sndchanreserved;
    local_38 = (int)sndchanreserved;
    iVar11 = 0;
    if (0 < iVar14) {
      pcVar9 = &sndchanreserved;
      do {
        piVar6 = (int *)(_DAT_801478f4 + (int)*pcVar9 * 100);
        iVar10 = *piVar6;
        if (*(char *)((int)piVar6 + 0xb) == '\x01') {
          if (iVar10 < 0) {
            iVar10 = *(int *)((int)*(char *)(piVar6 + 0xf) * 100 + _DAT_801478f4);
          }
          SNDstop(iVar10);
          iVar10 = SNDover(iVar10);
          if (iVar10 != 1) {
            while (iVar11 = iVar11 + -1, -1 < iVar11) {
              pcVar9 = pcVar9 + -1;
              *(undefined *)(_DAT_801478f4 + (int)*pcVar9 * 100 + 0xb) = 0;
            }
            return 0xfffffff7;
          }
        }
        pcVar9 = pcVar9 + 1;
        iVar11 = iVar11 + 1;
        *(undefined *)((int)piVar6 + 0xb) = 1;
        piVar6[4] = _DAT_801478a4;
        *(undefined *)(piVar6 + 3) = uParm3;
      } while (iVar11 < iVar14);
    }
    iVar11 = 1;
    *(uint *)((int)sndchanreserved * 100 + _DAT_801478f4) = *puParm4;
    if (1 < iVar14) {
      do {
        pcVar9 = &sndchanreserved + iVar11;
        *(char *)(iVar11 + (int)sndchanreserved * 100 + _DAT_801478f4 + 3) = *pcVar9;
        iVar11 = iVar11 + 1;
        *(undefined4 *)((int)*pcVar9 * 100 + _DAT_801478f4) = 0xffffffff;
        *(char *)((int)*pcVar9 * 100 + _DAT_801478f4 + 0x3c) = sndchanreserved;
      } while (iVar11 < iVar14);
    }
  }
  return local_38;


}

void iSNDfreechan(int iParm1)
{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = 0;
  piVar2 = _DAT_801478f4 + iParm1 * 0x19;
  iVar4 = -1;
  if (*(char *)((int)piVar2 + 0x37) == '\0') {
    *(undefined *)((int)piVar2 + 0xb) = 0;
    piVar2[4] = _DAT_801478a4;
    return;
  }
  iVar3 = 0;
  piVar1 = _DAT_801478f4;
  if (DAT_80147871 != 0) {
    do {
      if ((((*(char *)((int)piVar1 + 0x37) == *(char *)((int)piVar2 + 0x37)) && (-1 < *piVar1)) &&
          (*(char *)((int)piVar1 + 0xb) != '\0')) &&
         (iVar5 = iVar5 + 1, *(char *)((int)piVar1 + 0x36) != '\0')) {
        iVar4 = iVar3;
      }
      iVar3 = iVar3 + 1;
      piVar1 = piVar1 + 0x19;
    } while (iVar3 < (int)(uint)DAT_80147871);
  }
  piVar2 = _DAT_801478f4 + iParm1 * 0x19;
  if (iVar5 != 1) {
    if (((*(char *)((int)_DAT_801478f4 + iVar4 * 100 + 0xb) == '\x02') && (iParm1 != iVar4)) &&
       (iVar5 == 2)) {
      *(undefined *)((int)piVar2 + 0xb) = 0;
      piVar2[4] = _DAT_801478a4;
      *(undefined *)((int)_DAT_801478f4 + iVar4 * 100 + 0xb) = 0;
      _DAT_801478f4[iVar4 * 0x19 + 4] = _DAT_801478a4;
      return;
    }
    if ((*(char *)((int)(_DAT_801478f4 + iVar4 * 0x19) + 0xb) == '\x01') && (iParm1 == iVar4)) {
      *(undefined *)((int)(_DAT_801478f4 + iVar4 * 0x19) + 0xb) = 2;
      return;
    }
    *(undefined *)((int)piVar2 + 0xb) = 0;
    piVar2[4] = _DAT_801478a4;
    return;
  }
  *(undefined *)((int)piVar2 + 0xb) = 0;
  piVar2[4] = _DAT_801478a4;
  return;


}

uint iSNDgetchan(uint uParm1)
{
  uint *puVar1;
  uint uVar2;
  
  if ((-1 < (int)uParm1) && (uVar2 = uParm1 & 0x1f, uVar2 < (uint)DAT_80147871)) {
    puVar1 = (uint *)(_DAT_801478f4 + uVar2 * 100);
    if ((*(char *)((int)puVar1 + 0xb) == '\0') || (*puVar1 != uParm1)) {
      uVar2 = 0xfffffff8;
    }
    return uVar2;
  }
  return 0xfffffff8;


}

undefined4 iSNDplatform3dpos(int iParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 local_18;
  undefined4 local_14;
  
  iVar1 = iParm1 * 0x2c;
  *(undefined2 *)(iVar1 + -0x7feb85f8) = (short)uParm2;
  if ((&DAT_80147a0c)[iVar1] == '\x02') {
    if (*(char *)(iVar1 + -0x7feb85f2) == '\x01') {
      iSNDatodlrv(uParm2,(int)*(char *)(iParm1 * 100 + _DAT_801478f4 + 0x2d),&local_18,&local_14,
                  (int)(char)(&DAT_80147a14)[iVar1],(int)(char)(&DAT_80147a15)[iVar1]);
    }
    else {
      if (*(char *)(iVar1 + -0x7feb85f2) == '\0') {
        iSNDatolrv(uParm2,(int)*(char *)(iParm1 * 100 + _DAT_801478f4 + 0x2d),&local_18,&local_14);
      }
    }
    (&DAT_80147a14)[iVar1] = (undefined)local_18;
    (&DAT_80147a15)[iVar1] = (undefined)local_14;
    iSNDsetvol(iParm1,local_18,local_14);
  }
  return 0;


}

undefined4 iSNDpatchkey(int iParm1,int *piParm2)
{
  char cVar1;
  int iVar2;
  int *piVar3;
  
  cVar1 = *(char *)(_DAT_801478f4 + iParm1 * 100 + 0x37);
  if (cVar1 == '\0') {
    if (*piParm2 < 0) {
      *piParm2 = iParm1;
      return 1;
    }
  }
  else {
    iVar2 = *piParm2;
    *piParm2 = iVar2 + 1;
    if (iVar2 + 1 < (int)(uint)DAT_80147871) {
      do {
        piVar3 = (int *)(_DAT_801478f4 + *piParm2 * 100);
        if (((*(char *)((int)piVar3 + 0x37) == cVar1) && (*(char *)((int)piVar3 + 0xb) == '\x01'))
           && (-1 < *piVar3)) {
          return 1;
        }
        iVar2 = *piParm2;
        *piParm2 = iVar2 + 1;
      } while (iVar2 + 1 < (int)(uint)DAT_80147871);
    }
  }
  return 0;


}

void iSNDcalcvol(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = _DAT_801478f4 + iParm1 * 100;
  iVar1 = ((int)*(char *)(iVar2 + 0x2c) * (int)*(short *)(iVar2 + 0x1e) *
           (int)*(short *)(iVar2 + 0x26) * (int)DAT_8014789d) / 0x1f417f;
  *(undefined *)(iVar2 + 0x2d) = (char)iVar1;
  if (*(int *)(iVar2 + 0x50) != 0) {
    *(undefined *)(iVar2 + 0x2d) =
         (char)(((iVar1 * 0x1000000 >> 0x18) *
                (int)*(char *)(*(int *)(iVar2 + 0x50) + (uint)*(byte *)(iVar2 + 0x3a))) / 0x7f);
  }
  if (*(int *)(iVar2 + 0x44) != 0) {
    *(undefined *)(iVar2 + 0x2d) =
         *(undefined *)(*(int *)(iVar2 + 0x44) + (int)*(char *)(iVar2 + 0x2d));
  }
  return;


}

void iSNDpsxkeyon(undefined4 uParm1)
{
  *(undefined2 *)(_DAT_80147e2c + 0x188) = (short)uParm1;
  *(undefined2 *)(_DAT_80147e2c + 0x18a) = (short)((uint)uParm1 >> 0x10);
  return;


}

void iSNDpsxkeyoff(undefined4 uParm1)
{
  *(undefined2 *)(_DAT_80147e2c + 0x18c) = (short)uParm1;
  *(undefined2 *)(_DAT_80147e2c + 0x18e) = (short)((uint)uParm1 >> 0x10);
  return;


}

void iSNDpsxeffecton(undefined4 uParm1)
{
  *(ushort *)(_DAT_80147e2c + 0x198) = *(ushort *)(_DAT_80147e2c + 0x198) | (ushort)uParm1;
  *(ushort *)(_DAT_80147e2c + 0x19a) =
       *(ushort *)(_DAT_80147e2c + 0x19a) | (ushort)((uint)uParm1 >> 0x10);
  return;


}

void iSNDpsxeffectoff(undefined4 uParm1)
{
  *(ushort *)(_DAT_80147e2c + 0x198) = *(ushort *)(_DAT_80147e2c + 0x198) & ~(ushort)uParm1;
  *(ushort *)(_DAT_80147e2c + 0x19a) =
       *(ushort *)(_DAT_80147e2c + 0x19a) & ~(ushort)((uint)uParm1 >> 0x10);
  return;


}

void iSNDpsxeffectvol(undefined2 uParm1,undefined2 uParm2)
{
  *(undefined2 *)(_DAT_80147e2c + 0x184) = uParm1;
  *(undefined2 *)(_DAT_80147e2c + 0x186) = uParm2;
  return;


}

void iSNDsetvol(int iParm1,int iParm2,int iParm3)
{
  int iVar1;
  int iVar2;
  ushort uVar3;
  undefined2 *puVar4;
  ushort *puVar5;
  
  iVar1 = iParm1 * 0x2c;
  puVar5 = (ushort *)(_DAT_80147e28 + iParm1 * 0x10);
  if ((&DAT_80147a0f)[iVar1] == '\x01') {
    if (DAT_80147870 == '\x02') {
      *puVar5 = (short)iParm2 * 0x81 & 0x7fff;
      puVar5[1] = (short)iParm3 * 0x81 & 0x7fff;
      return;
    }
    iVar2 = iParm2 + iParm3;
    if (*(char *)(iVar1 + -0x7feb85f2) == '\x01') {
      if (iParm2 < 0) {
        iParm2 = -iParm2;
      }
      if (iParm3 < 0) {
        iParm3 = -iParm3;
      }
      if (0x7f < iParm2) {
        iParm2 = 0x7f;
      }
      iVar2 = iParm2 + iParm3;
      if (0x7f < iParm3) {
        iVar2 = iParm2 + 0x7f;
      }
    }
    uVar3 = (ushort)(iVar2 * 0x81 >> 1);
  }
  else {
    if (DAT_80147870 == '\x02') {
      *puVar5 = (short)iParm2 * 0x81 & 0x7fff;
      puVar5[1] = 0;
      puVar4 = (undefined2 *)
               (_DAT_80147e28 + ((int)((uint)(byte)(&DAT_80147a10)[iVar1] << 0x18) >> 0x14));
      *puVar4 = 0;
      puVar4[1] = (short)iParm3 * 0x81 & 0x7fff;
      return;
    }
    uVar3 = (ushort)(iParm2 * 0x81 >> 1) & 0x7fff;
    *puVar5 = uVar3;
    puVar5[1] = uVar3;
    uVar3 = (ushort)(iParm3 * 0x81 >> 1);
    puVar5 = (ushort *)(_DAT_80147e28 + ((int)((uint)(byte)(&DAT_80147a10)[iVar1] << 0x18) >> 0x14))
    ;
  }
  *puVar5 = uVar3 & 0x7fff;
  puVar5[1] = uVar3 & 0x7fff;
  return;


}

void iSNDsetslot(int iParm1,int iParm2,undefined2 uParm3)
{
  int iVar1;
  
  iVar1 = _DAT_80147e28 + iParm1 * 0x10;
  *(undefined2 *)(iVar1 + 8) = 0xf;
  *(undefined2 *)(iVar1 + 10) = 5;
  *(undefined2 *)(iVar1 + 4) = uParm3;
  *(undefined2 *)(iVar1 + 6) = (short)(iParm2 >> 3);
  *(undefined2 *)(iVar1 + 0xe) = 0x200;
  return;


}

uint iSNDstartvoice(uint uParm1)
{
  char cVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  
  iVar2 = uParm1 * 0x2c;
  (&DAT_80147a14)[iVar2] = 0;
  (&DAT_80147a15)[iVar2] = 0;
  uVar3 = *(uint *)(&DAT_801479f8 + iVar2);
  iSNDsetslot(uParm1,*(int *)(iVar2 + -0x7feb8610),uVar3 / 0x1b9);
  uVar6 = 1 << (uParm1 & 0x1f);
  (&DAT_80147a0c)[iVar2] = 2;
  (&DAT_80147a0d)[iVar2] = 2;
  (&DAT_80147a16)[iVar2] = 0;
  if ((&DAT_80147a0f)[iVar2] == '\x02') {
    iVar4 = (int)(char)(&DAT_80147a10)[iVar2] * 0x2c;
    if ((int)((uint)(byte)(&DAT_80147a17)[iVar2] << 0x18) < 0) {
      iVar5 = (int)((ulonglong)(*(uint *)(iVar2 + -0x7feb860c) >> 2) * 0x24924925 >> 0x20);
      if (*(uint *)(iVar2 + -0x7feb860c) !=
          (int)((ulonglong)(*(uint *)(iVar2 + -0x7feb860c) >> 2) * 0x24924925 >> 0x20) * 0x1c) {
        iVar5 = iVar5 + 1;
      }
      iVar5 = iVar5 << 4;
    }
    else {
      iVar5 = *(int *)(*(int *)(&DAT_80147e10 +
                               ((int)((uint)(byte)(&DAT_80147a17)[iVar2] << 0x18) >> 0x16)) + 8);
    }
    iSNDsetslot((int)(char)(&DAT_80147a10)[iVar2],*(int *)(iVar2 + -0x7feb8610) + iVar5,
                uVar3 / 0x1b9);
    cVar1 = (&DAT_80147a10)[iVar2];
    (&DAT_80147a0c)[iVar4] = 2;
    (&DAT_80147a0d)[iVar4] = 2;
    (&DAT_80147a16)[iVar4] = 0;
    uVar6 = uVar6 | 1 << ((int)cVar1 & 0x1fU);
  }
  iSNDvol(uParm1,(int)*(char *)(iVar2 + -0x7feb85ee));
  iSNDplatformfxlevel(uParm1,0,(int)*(char *)(iVar2 + -0x7feb85ed));
  return uVar6;


}

undefined4 iSNDplatformoutputcaps(void)
{
  _sndgs = 0xac44;
  _DAT_80147862 = 0xac44;
  DAT_80147864 = 1;
  DAT_80147865 = 2;
  DAT_80147866 = 0x18;
  DAT_80147867 = 0;
  DAT_80147868 = 0;
  DAT_80147869 = 0;
  _DAT_8014786e = 0xac44;
  DAT_80147870 = 2;
  DAT_80147871 = 0x18;
  DAT_80147872 = 0;
  DAT_80147873 = 0;
  DAT_80147874 = 0;
  return 0;


}

undefined4 iSNDplatformoutputset(void)
{
  int iVar1;
  int iVar2;
  
  DAT_80147871 = 0x18;
  if (DAT_80147870 < DAT_80147864) {
    DAT_80147870 = DAT_80147864;
  }
  if (DAT_80147865 < DAT_80147870) {
    DAT_80147870 = DAT_80147865;
  }
  if ((DAT_8014789c != '\0') && (iVar2 = 0, DAT_8014791a != DAT_80147870)) {
    iVar1 = -0x7feb8610;
    do {
      if ((*(char *)(iVar1 + 0x1c) == '\x02') && (*(char *)(iVar1 + 0x21) == '\0')) {
        iSNDsetvol(iVar2,(int)*(char *)(iVar1 + 0x24),(int)*(char *)(iVar1 + 0x25));
      }
      iVar2 = iVar2 + 1;
      iVar1 = iVar1 + 0x2c;
    } while (iVar2 < (int)(uint)DAT_80147871);
  }
  DAT_8014791a = DAT_80147870;
  return 0;


}

undefined4 iSNDinit(void)
{
  uint uVar1;
  int iVar2;
  undefined2 *puVar3;
  int iVar4;
  undefined *puVar5;
  
  uVar1 = Status;
  _DAT_80147e32 = 0x41;
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0xb0000;
  _DAT_1f801d80 = 0;
  _DAT_1f801d82 = 0;
  _DAT_80147e34 = 0x2000;
  _DAT_80147e14 = 0x1f801014;
  _DAT_80147e18 = 0x1f8010c0;
  _DAT_80147e1c = 0x1f8010c4;
  _DAT_80147e20 = 0x1f8010c8;
  _DAT_80147e24 = &DAT_1f8010f0;
  _DAT_80147e28 = &DAT_1f801c00;
  _DAT_80147e2c = &DAT_1f801c00;
  do {
  } while ((_DAT_1f801dae & 0x7ff) != 0);
  puVar5 = &sndpd;
  _DAT_1f801dac = 4;
  _DAT_1f801d90 = 0;
  _DAT_1f801d92 = 0;
  _DAT_1f801d94 = 0;
  _DAT_1f801d96 = 0;
  _DAT_1f801db0 = 0;
  _DAT_1f801db2 = 0;
  _DAT_1f801db4 = 0;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  _DAT_1f801db6 = 0;
  _DAT_1f801daa = 0xc000;
  DMACallback(4,iSNDdmcallback);
  setCopReg(0,Status,uVar1,0);
  iSNDdmqueue(&sndpdsafeloop,0x1000,0x10,1,0);
  iVar4 = 0;
  if (DAT_80147871 != 0) {
    do {
      iVar2 = iVar4 * 0x10;
      iVar4 = iVar4 + 1;
      puVar3 = (undefined2 *)(_DAT_80147e28 + iVar2);
      *puVar3 = 0;
      puVar3[1] = 0;
      puVar3[2] = 0;
      puVar3[3] = 0x200;
      puVar3[7] = 0x200;
      puVar3[4] = 0;
      puVar3[5] = 0;
      puVar5[0xff] = 0xff;
      puVar5 = puVar5 + 0x2c;
    } while (iVar4 < (int)(uint)DAT_80147871);
  }
  iSNDpsxkeyon(0xffffff);
  *(undefined2 *)(_DAT_80147e2c + 0x1a2) = 0xfffe;
  *(undefined2 *)(_DAT_80147e2c + 0x180) = 0x3fff;
  *(undefined2 *)(_DAT_80147e2c + 0x182) = 0x3fff;
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) | 1;
  iSNDpsxfxinit(_DAT_8014791c);
  DAT_80147919 = 0;
  addtimer(iSNDserver);
  if (sndpd == '\0') {
    addexit(SNDSYS_restore);
    sndpd = '\x01';
  }
  return 0;


}

undefined4 iSNDrestore(void)
{
  bool bVar1;
  int iVar2;
  undefined *puVar3;
  uint uVar4;
  
  if (DAT_8014789f != '\0') {
    do {
      iSNDleaveaudio();
    } while (DAT_8014789f != '\0');
  }
  uVar4 = _DAT_801478a4 + 100;
  do {
    bVar1 = true;
    iVar2 = 0;
    puVar3 = &sndpd;
    if (DAT_80147871 != 0) {
      do {
        if ((puVar3[0xf5] != '\0') && (bVar1 = false, uVar4 < _DAT_801478a4)) {
          iSNDpsxkeyoff(0xffffff);
          puVar3[0xf5] = 0;
          iSNDfreechan(iVar2);
          bVar1 = false;
        }
        iVar2 = iVar2 + 1;
        puVar3 = puVar3 + 0x2c;
      } while (iVar2 < (int)(uint)DAT_80147871);
    }
    SNDSYS_service();
  } while (!bVar1);
  deltimer(iSNDserver);
  iSNDpsxfxinit(0);
  uVar4 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  DMACallback(4,0);
  setCopReg(0,Status,uVar4,0);
  return 0;


}

void iSNDserve(void)
{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined2 *puVar6;
  uint uVar7;
  int iVar8;
  uint local_30;
  
  local_30 = 0;
  uVar5 = 0;
  if (_DAT_80148038 != (code *)0x0) {
    (*_DAT_80148038)();
  }
  uVar7 = 0;
  if (DAT_80147871 != 0) {
    iVar8 = 0;
    do {
      iVar3 = iVar8 + -0x7feb8610;
      puVar6 = (undefined2 *)(_DAT_80147e28 + uVar7 * 0x10);
      if ((&DAT_80147a0d)[iVar8] == '\x02') {
        if (puVar6[6] == 0) {
          if ((((&DAT_80147a16)[iVar8] != '\0') && ((&DAT_80147a11)[iVar8] == '\0')) &&
             ((int)((uint)(byte)(&DAT_80147a17)[iVar8] << 0x18) < 0)) {
            uVar1 = (uint)(byte)(&DAT_80147a0f)[iVar8];
            do {
              uVar4 = uVar7;
              iVar2 = iVar8;
              if (uVar1 == 2) {
                uVar4 = (int)*(char *)(iVar3 + 0x20);
                iVar2 = (int)*(char *)(iVar3 + 0x20) * 0x2c;
              }
              iVar3 = iVar2 + -0x7feb8610;
              (&DAT_80147a0d)[iVar2] = 0;
              (&DAT_80147a0c)[iVar2] = 0;
              uVar1 = uVar1 - 1;
              iSNDfreechan(uVar4);
              iVar2 = uVar4 * 0x10;
              *(undefined2 *)(iVar2 + _DAT_80147e28 + 6) = 0x200;
              uVar5 = uVar5 | 1 << (uVar4 & 0x1f);
              *(undefined2 *)(iVar2 + _DAT_80147e28) = 0;
              *(undefined2 *)(iVar2 + _DAT_80147e28 + 2) = 0;
            } while (0 < (int)uVar1);
          }
        }
        else {
          (&DAT_80147a16)[iVar8] = 1;
        }
        if (*(char *)(iVar3 + 0x28) != '\0') {
          puVar6[2] = (short)(*(uint *)(iVar3 + 8) / 0x1b9);
          *(undefined *)(iVar3 + 0x28) = 0;
        }
        if (*(int *)(iVar3 + 0x10) < 1) {
          *(int *)(iVar3 + 0xc) = *(int *)(iVar3 + 0xc) + *(int *)(iVar3 + 8);
          if (*(uint *)(iVar3 + 0x14) <= *(uint *)(iVar3 + 0xc)) {
            if ((int)((uint)*(byte *)(iVar3 + 0x27) << 0x18) < 0) {
              *(undefined4 *)(iVar3 + 0xc) = *(undefined4 *)(iVar3 + 0x14);
            }
            else {
              *(int *)(iVar3 + 0xc) = *(int *)(iVar3 + 0xc) - *(int *)(iVar3 + 0x14);
            }
          }
        }
        else {
          *(int *)(iVar3 + 0x10) = *(int *)(iVar3 + 0x10) - *(int *)(iVar3 + 8);
        }
      }
      else {
        if ((&DAT_80147a0d)[iVar8] == '\x03') {
          if (puVar6[6] == 0) {
            uVar5 = uVar5 | 1 << (uVar7 & 0x1f);
            (&DAT_80147a0d)[iVar8] = 0;
            puVar6[3] = 0x200;
            *puVar6 = 0;
            puVar6[1] = 0;
          }
          else {
            local_30 = local_30 | 1 << (uVar7 & 0x1f);
          }
        }
      }
      if (((*(char *)(iVar3 + 0x1c) == '\x01') && (*(char *)(iVar3 + 0x1d) == '\0')) &&
         ((*(byte *)(iVar3 + 0x1f) < 2 ||
          ((&DAT_80147a0d)[(int)*(char *)(iVar3 + 0x20) * 0x2c] == '\0')))) {
        uVar1 = iSNDstartvoice(uVar7);
        uVar5 = uVar5 | uVar1;
      }
      uVar7 = uVar7 + 1;
      iVar8 = iVar8 + 0x2c;
    } while ((int)uVar7 < (int)(uint)DAT_80147871);
  }
  if (local_30 != 0) {
    iSNDpsxkeyoff(local_30);
  }
  if (uVar5 != 0) {
    iSNDpsxkeyon(uVar5);
  }
  return;


}

undefined4 iSNDstop(uint uParm1)
{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  iVar1 = uParm1 * 0x2c;
  if (-1 < (int)((uint)(byte)(&DAT_80147a17)[iVar1] << 0x18)) {
    (*_DAT_8014803c)(iVar1 + -0x7feb8610);
  }
  iSNDfreechan(uParm1);
  (&DAT_80147a0d)[iVar1] = 3;
  (&DAT_80147a0c)[iVar1] = 0;
  uVar3 = 1 << (uParm1 & 0x1f);
  if (1 < (byte)(&DAT_80147a0f)[iVar1]) {
    uVar2 = SEXT14((char)(&DAT_80147a10)[iVar1]);
    iSNDfreechan(uVar2);
    uVar3 = uVar3 | 1 << (uVar2 & 0x1f);
    (&DAT_80147a0d)[uVar2 * 0x2c] = 3;
    (&DAT_80147a0c)[uVar2 * 0x2c] = 0;
  }
  iSNDpsxkeyoff(uVar3);
  return 0;


}

undefined4 iSNDplatformpitch(int iParm1,int iParm2)
{
  iParm1 = iParm1 * 0x2c;
  *(int *)(&DAT_801479f8 + iParm1) =
       ((int)((uint)*(ushort *)(iParm1 + -0x7feb85f6) * iParm2) >> 0xc) * 0x1b9;
  (&DAT_80147a18)[iParm1] = 1;
  if ((&DAT_80147a0f)[iParm1] == '\x02') {
    *(undefined4 *)(&DAT_801479f8 + (int)(char)(&DAT_80147a10)[iParm1] * 0x2c) =
         *(undefined4 *)(&DAT_801479f8 + iParm1);
    (&DAT_80147a18)[(int)(char)(&DAT_80147a10)[iParm1] * 0x2c] = 1;
  }
  return 0;


}

undefined4 iSNDplatformfxlevel(uint uParm1,undefined4 uParm2,int iParm3)
{
  int iVar1;
  uint uVar2;
  
  iVar1 = uParm1 * 0x2c;
  if ((&DAT_80147a0c)[iVar1] == '\x02') {
    uVar2 = 1 << (uParm1 & 0x1f);
    if ((&DAT_80147a0f)[iVar1] == '\x02') {
      uVar2 = uVar2 | 1 << ((uint)(byte)(&DAT_80147a10)[iVar1] & 0x1f);
    }
    if (iParm3 == 0) {
      iSNDpsxeffectoff(uVar2);
    }
    else {
      iSNDpsxeffecton();
    }
  }
  else {
    *(undefined *)(iVar1 + -0x7feb85ed) = (char)iParm3;
  }
  return 0;


}

undefined4 iSNDvol(int iParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 local_18;
  undefined4 local_14;
  
  iVar1 = iParm1 * 0x2c;
  if ((&DAT_80147a0c)[iVar1] == '\x02') {
    if (*(char *)(iVar1 + -0x7feb85f2) == '\0') {
      iSNDatolrv((uint)*(ushort *)(iVar1 + -0x7feb85f8),uParm2,&local_18,&local_14);
    }
    else {
      if (*(char *)(iVar1 + -0x7feb85f2) == '\x01') {
        iSNDatodlrv((uint)*(ushort *)(iVar1 + -0x7feb85f8),uParm2,&local_18,&local_14,
                    (int)(char)(&DAT_80147a14)[iVar1],(int)(char)(&DAT_80147a15)[iVar1]);
      }
    }
    (&DAT_80147a14)[iVar1] = (undefined)local_18;
    (&DAT_80147a15)[iVar1] = (undefined)local_14;
    iSNDsetvol(iParm1,local_18,local_14);
  }
  else {
    *(undefined *)(iVar1 + -0x7feb85ee) = (char)uParm2;
  }
  return 0;


}

void SNDI_mutexalloc(void)
{
  return;


}

void SNDI_mutexfree(void)
{
  return;


}

void SNDI_mutexlock(void)
{
  return;


}

void SNDI_mutexunlock(void)
{
  return;


}

void iSNDpsxfxinit(int iParm1)
{
  ushort *puVar1;
  int iVar2;
  undefined4 uVar3;
  ushort *puVar4;
  int iVar5;
  undefined auStack352 [256];
  ushort local_60;
  short local_5e;
  short local_5c;
  undefined2 local_50;
  short local_4a;
  short local_48;
  short local_46;
  short local_44;
  short local_3e;
  short local_3c;
  short local_2a;
  short local_28;
  short local_26;
  short local_24;
  
  if (iParm1 != 0) {
    if (iParm1 == 5) {
      iParm1 = 1;
    }
    else {
      if (iParm1 == 10) {
        iParm1 = 2;
      }
      else {
        if (iParm1 == 0x14) {
          iParm1 = 3;
        }
        else {
          if (iParm1 == 0x1e) {
            iParm1 = 4;
          }
          else {
            if (iParm1 == 0x28) {
              iParm1 = 5;
            }
            else {
              if (iParm1 == 0x32) {
                iParm1 = 6;
              }
              else {
                if (iParm1 == 100) {
                  iParm1 = 9;
                }
                else {
                  if (iParm1 == 0x6e) {
                    iParm1 = 8;
                  }
                  else {
                    if (iParm1 == 0x78) {
                      iParm1 = 7;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  _DAT_80147e36 = (undefined2)((int)(0x10000 - (uint)*(ushort *)(&sndpe + iParm1 * 0x42)) >> 3);
  iSNDpsxeffectoff(0xffffff);
  iSNDpsxeffectvol(0,0);
  puVar4 = &local_60;
  blockmove(&sndpe + iParm1 * 0x42,puVar4,0x42);
  if (iParm1 - 7U < 2) {
    local_4a = (short)((_DAT_80147904 * 0x2000) / 0x7f) - local_5e;
    local_48 = (short)((_DAT_80147904 * 0x1000) / 0x7f) - local_5c;
    local_46 = local_44 + (short)((_DAT_80147904 * 0x1000) / 0x7f);
    local_3e = local_3c + (short)((_DAT_80147904 * 0x1000) / 0x7f);
    local_2a = local_26 + (short)((_DAT_80147904 * 0x1000) / 0x7f);
    local_28 = local_24 + (short)((_DAT_80147904 * 0x1000) / 0x7f);
    local_50 = (undefined2)((_DAT_80147908 * 0x8100) / 0x7f);
  }
  iVar5 = 0;
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) & 0xff7f;
  do {
    puVar1 = puVar4 + 1;
    puVar4 = puVar4 + 1;
    iVar2 = iVar5 * 2;
    iVar5 = iVar5 + 1;
    *(ushort *)(iVar2 + _DAT_80147e2c + 0x1c0) = *puVar1;
  } while (iVar5 < 0x20);
  iVar5 = 0x10000 - (uint)local_60;
  *(undefined2 *)(_DAT_80147e2c + 0x1a2) = (short)iVar5;
  blockclear(auStack352,0x100);
  while (iVar5 < 0x10000) {
    iVar2 = 0x10000 - iVar5;
    if (0x20 < iVar2) {
      iVar2 = 0x20;
    }
    uVar3 = iSNDdmqueue(auStack352,iVar5 << 3,iVar2 << 3,1,0);
    iVar5 = iVar5 + 0x20;
    do {
      iVar2 = iSNDdmcomplete(uVar3);
    } while (iVar2 == 0);
  }
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) | 0x80;
  return;


}

undefined4 iSNDplatformfxinit(undefined4 uParm1,undefined4 uParm2)
{
  _DAT_8014791c = uParm2;
  if (DAT_8014789c != '\0') {
    _DAT_8014791c = uParm2;
    iSNDpsxfxinit();
  }
  return 0;


}

undefined4 iSNDplatformfxmasterlevel(undefined4 uParm1,int iParm2)
{
  iSNDpsxeffectvol(iParm2 * 0x102,iParm2 * 0x102);
  return 0;


}

int SNDfxlevel(undefined4 uParm1,int iParm2,int iParm3)
{
  int iVar1;
  int iVar2;
  int local_20 [2];
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (-1 < iVar1) {
      local_20[0] = -1;
      while (iVar2 = iSNDpatchkey(iVar1,local_20), iVar2 != 0) {
        iVar2 = _DAT_801478f4 + local_20[0] * 100 + iParm2;
        *(undefined *)(iVar2 + 0x35) = (char)iParm3;
        iSNDplatformfxlevel(local_20[0],iParm2,
                            (iParm3 * (int)*(char *)(iVar2 + 0x34) *
                            *(int *)(&DAT_80147900 + iParm2 * 0x10)) / 0x3f01);
      }
    }
    iSNDleaveaudio();
  }
  return iVar1;


}

undefined4 iSPCH_GetMatchValue(int iParm1,int iParm2)
{
  return *(undefined4 *)(iParm1 + iParm2 * 4 + 8);


}

uint VoxSentence_GetShortRule(int iParm1)
{
  return (uint)*(byte *)(iParm1 + 3) & 3;


}

uint VoxSentence_GetNumPhrases(int iParm1)
{
  return (uint)(*(byte *)(iParm1 + 3) >> 2);


}

uint VoxEvent_GetFilterLengthFlag(int iParm1)
{
  return (uint)*(byte *)(iParm1 + 10) & 1;


}

int iSPCH_GetOffset8(int iParm1,int iParm2,int iParm3)
{
  return iParm1 + (uint)*(byte *)(iParm2 + iParm3) * 4;


}

int iSPCH_GetOffset16(int iParm1,int iParm2,int iParm3)
{
  return iParm1 + (uint)*(ushort *)(iParm3 * 2 + iParm2) * 4;


}

int iSPCH_MatchSample(undefined4 uParm1,int iParm2,int iParm3,int iParm4)
{
  byte bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  
  iVar7 = (int)*(char *)(iParm3 + 3);
  iVar6 = 1;
  if (iVar7 < 5) {
    iVar4 = 0;
    iVar2 = iParm2;
    if (0 < iVar7) {
      while( true ) {
        iVar6 = 0;
        if (0x1f < *(byte *)(iVar2 + 0xc)) break;
        bVar1 = *(byte *)(iParm3 + iVar4 + 4);
        uVar5 = 1 << ((uint)*(byte *)(iVar2 + 0xc) & 0x1f);
        uVar3 = iSPCH_GetMatchValue(iParm3,iVar4);
        if (((uVar5 & uVar3) != 0) &&
           (((bVar1 & 0xf) == 0 || ((uVar5 & *(uint *)(((uint)bVar1 & 0xf) * 4 + iParm4)) != 0)))) {
          iVar6 = 1;
        }
        iVar4 = iVar4 + 1;
        if (iVar6 == 0) {
          return 0;
        }
        iVar2 = iParm2 + iVar4;
        if (iVar7 <= iVar4) {
          return iVar6;
        }
      }
    }
  }
  else {
    iVar6 = 0;
  }
  return iVar6;


}

uint iSPCH_GetPhraseBank(ushort *puParm1,int iParm2,short *psParm3)
{
  byte bVar1;
  byte bVar2;
  short sVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  undefined4 *puVar8;
  
  uVar6 = (uint)*puParm1;
  bVar1 = *(byte *)(puParm1 + 1);
  psParm3[1] = -1;
  *psParm3 = -1;
  bVar2 = bVar1 >> 4;
  uVar7 = (uint)bVar1 & 0xf;
  if (bVar2 == 1) {
    iVar5 = *(int *)(uVar7 * 4 + iParm2);
    sVar3 = (short)iVar5;
    if ((-1 < iVar5) && ((uint)**(ushort **)(iVar5 * 4 + gVoxBanks) != uVar6)) {
      sVar3 = -1;
    }
  }
  else {
    if (bVar2 == 0) {
      sVar3 = iSPCH_FindBank(uVar6);
      *psParm3 = sVar3;
      goto LAB_8010096c;
    }
    if (bVar2 != 2) goto LAB_8010096c;
    uVar4 = iSPCH_FindBank(uVar6);
    sVar3 = (short)uVar4;
    puVar8 = (undefined4 *)(uVar7 * 4 + iParm2);
    iVar5 = iSPCH_TestSubBankBounds(uVar4,*puVar8);
    if (iVar5 == 0) {
      sVar3 = -1;
    }
    else {
      psParm3[1] = *(short *)puVar8;
    }
  }
  *psParm3 = sVar3;
LAB_8010096c:
  return (uint)~(int)*psParm3 >> 0x1f;


}

int iSPCH_GetBankBits(int iParm1)
{
  return iParm1 + 8 + (uint)*(byte *)(iParm1 + 3) * (((uint)*(byte *)(iParm1 + 2) & 0xf) + 2);


}

void iSPCH_ClearCycleBit(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  
  iVar1 = iParm2;
  if (iParm2 < 0) {
    iVar1 = iParm2 + 7;
  }
  iVar2 = iSPCH_GetBankBits();
  pbVar3 = (byte *)(iVar2 + (iVar1 >> 3) + 1);
  *pbVar3 = *pbVar3 & ~(byte)(1 << (iParm2 + (iVar1 >> 3) * -8 & 0x1fU));
  return;


}

uint iSPCH_CheckBankBit(undefined4 uParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  
  iVar2 = iParm2;
  if (iParm2 < 0) {
    iVar2 = iParm2 + 7;
  }
  iVar1 = iSPCH_GetBankBits();
  return (uint)*(byte *)(iVar1 + (iVar2 >> 3)) & 1 << (iParm2 + (iVar2 >> 3) * -8 & 0x1fU);


}

undefined4 iSPCH_CheckTemplateSample(int iParm1,int iParm2,int iParm3)
{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((int)*(short *)(iParm1 + 2) < (int)(uint)*(ushort *)(iParm2 + 6)) {
    uVar1 = iSPCH_CheckBankBit(iParm2,iParm3 + (uint)*(byte *)(iParm2 + 3) *
                                               (int)*(short *)(iParm1 + 2));
  }
  return uVar1;


}

undefined4 iSPCH_SampleExists(int iParm1,int iParm2,int iParm3)
{
  undefined4 uVar1;
  
  uVar1 = 1;
  if ((int)(uint)*(byte *)(iParm2 + 3) < iParm3) {
    uVar1 = 0;
  }
  else {
    if (*(short *)(iParm1 + 2) != -1) {
      uVar1 = iSPCH_CheckTemplateSample(iParm1,iParm2,iParm3);
    }
    if ((*(byte *)(iParm2 + 2) & 0xf0) != 0) {
      uVar1 = iSPCH_CheckBankBit(iParm2,iParm3 + 8);
    }
  }
  return uVar1;


}

int iSPCH_ChooseSamples(short *psParm1,int iParm2,undefined4 uParm3,undefined4 uParm4)
{
  byte bVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined auStack56 [16];
  
  iVar4 = 0;
  sVar2 = *psParm1;
  iVar7 = *(int *)((int)sVar2 * 4 + gVoxBanks);
  bVar1 = *(byte *)(iVar7 + 3);
  iVar6 = (int)psParm1[3];
  iVar5 = 0;
  if (bVar1 != 0) {
    do {
      iVar3 = iSPCH_UnPackSample(iVar7,iVar4,auStack56);
      if ((iVar3 != 0) &&
         (iVar3 = iSPCH_MatchSample((int)sVar2,auStack56,uParm3,uParm4), iVar3 != 0)) {
        iVar3 = iSPCH_SampleExists(psParm1,iVar7,iVar4);
        if (iVar3 != 0) {
          (&ispch_gPickSamples)[iVar6] = (char)iVar4;
          iVar5 = iVar5 + 1;
          iVar6 = iVar6 + 1;
          if (iParm2 <= iVar5) {
            return iVar5;
          }
        }
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < (int)(uint)bVar1);
  }
  return iVar5;


}

undefined4 iSPCH_SampleLength(short *psParm1)
{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_18 [4];
  
  iVar1 = iSPCH_UnPackSample(*(undefined4 *)((int)*psParm1 * 4 + gVoxBanks),
                             (uint)(byte)(&ispch_gPickSamples)[(int)psParm1[4]],local_18);
  uVar2 = 0;
  if (iVar1 != 0) {
    uVar2 = local_18[0];
  }
  return uVar2;


}

int iSPCH_ConvertTime(int iParm1)
{
  int iVar1;
  
  iVar1 = 0;
  if (_gDataRate != 0) {
    iVar1 = (iParm1 * 100) / _gDataRate;
    if (_gDataRate == 0) {
      trap(0x1c00);
    }
    if ((_gDataRate == -1) && (iParm1 * 100 == -0x80000000)) {
      trap(0x1800);
    }
  }
  return iVar1;


}

void iSPCH_SentenceLength(void)
{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = 0;
  iVar1 = VoxSentence_GetNumPhrases();
  iVar4 = 0;
  if (0 < iVar1) {
    puVar3 = &ispch_gChoice;
    do {
      iVar2 = iSPCH_SampleLength(puVar3);
      iVar5 = iVar5 + iVar2;
      iVar4 = iVar4 + 1;
      puVar3 = puVar3 + 0xc;
    } while (iVar4 < iVar1);
  }
  iSPCH_ConvertTime(iVar5);
  return;


}

void iSPCH_OrderSentences(int iParm1,int iParm2)
{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  byte local_88 [104];
  
  iVar7 = 0;
  bVar1 = *(byte *)(iParm1 + 6);
  uVar8 = (uint)bVar1;
  iVar5 = 0;
  if (bVar1 != 0) {
    do {
      pbVar3 = (byte *)iSPCH_GetOffset16(iParm1,iParm1 + 0xc,iVar5);
      local_88[iVar5] = *pbVar3;
      iVar5 = iVar5 + 1;
      iVar7 = iVar7 + (uint)*pbVar3;
    } while (iVar5 < (int)uVar8);
  }
  iVar5 = 0;
  if (0 < iVar7) {
    do {
      iVar2 = iSPCH_Rand(iVar7);
      iVar6 = 0;
      pbVar3 = local_88;
      if (bVar1 != 0) {
        do {
          iVar2 = iVar2 - (uint)*pbVar3;
          if (iVar2 < 0) break;
          iVar6 = iVar6 + 1;
          pbVar3 = local_88 + iVar6;
        } while (iVar6 < (int)uVar8);
      }
      *(undefined *)(iParm2 + iVar5) = (char)iVar6;
      pbVar3 = local_88 + iVar6;
      iVar5 = iVar5 + 1;
      iVar7 = iVar7 - (uint)*pbVar3;
      *pbVar3 = 0;
    } while (0 < iVar7);
  }
  iVar7 = 0;
  if (bVar1 != 0) {
    do {
      pcVar4 = (char *)iSPCH_GetOffset16(iParm1,iParm1 + 0xc,iVar7);
      if (*pcVar4 == '\0') {
        *(undefined *)(iParm2 + iVar5) = (char)iVar7;
        iVar5 = iVar5 + 1;
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 < (int)uVar8);
  }
  return;


}

uint iSPCH_RepeatEvent(ushort *puParm1)
{
  uint uVar1;
  
  uVar1 = 1;
  if (((uint)*puParm1 == _gVoxInGame) && (0 < (int)*(char *)(puParm1 + 4))) {
    uVar1 = (uint)(_DAT_8014805c < (int)*(char *)(puParm1 + 4));
  }
  return uVar1;


}

undefined4 iSPCH_ShortRuleStatus(undefined4 uParm1,int iParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = VoxSentence_GetShortRule();
  if ((((iVar1 == 1) && (iParm2 == 2)) || ((iVar1 == 2 && (iParm2 != 2)))) ||
     (uVar2 = 0, iVar1 == 0)) {
    uVar2 = 1;
  }
  return uVar2;


}

undefined4 iSPCH_SentenceGetChoices( (int param_1,undefined4 param_2,uint param_3,uint param_4,undefined4 param_5)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  short *psVar5;
  int iVar6;
  
  iVar6 = 0;
  iVar1 = VoxSentence_GetNumPhrases();
  uVar3 = 1;
  if (iVar1 < 0xd) {
    iVar2 = iSPCH_ShortRuleStatus(param_1,param_5);
    if ((iVar2 == 0) ||
       (iVar2 = iSPCH_CheckSentenceRules(param_3 & 0xff,param_4 & 0xff,param_1), iVar2 == 0)) {
LAB_80101008:
      uVar3 = 0;
    }
    else {
      iVar2 = 0;
      uVar3 = 1;
      if (0 < iVar1) {
        psVar5 = (short *)&ispch_gChoice;
        do {
          psVar5[3] = (short)iVar6;
          uVar3 = iSPCH_GetOffset8(param_1,param_1 + 4,iVar2);
          iVar4 = iSPCH_GetPhraseBank(uVar3,param_2,psVar5);
          if (iVar4 == 0) {
            if (*psVar5 != -2) {
              return 0;
            }
            *psVar5 = -1;
            return 0xffffffff;
          }
          iVar4 = iSPCH_ChooseSamples(psVar5,100 - iVar6,uVar3,param_2);
          iVar6 = iVar6 + iVar4;
          if (iVar4 == 0) goto LAB_80101008;
          psVar5[2] = (short)iVar4;
          iVar2 = iVar2 + 1;
          psVar5 = psVar5 + 6;
          uVar3 = 1;
        } while (iVar2 < iVar1);
      }
    }
  }
  return uVar3;


}

void iSPCH_RandomizeSentencePicks(void)
{
  undefined uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  int iVar6;
  undefined *puVar7;
  undefined *puVar8;
  int iVar9;
  int iVar10;
  
  iVar2 = VoxSentence_GetNumPhrases();
  iVar10 = 0;
  if (0 < iVar2) {
    puVar8 = &ispch_gChoice;
    do {
      iVar6 = 0;
      iVar9 = (int)((uint)*(ushort *)(puVar8 + 4) << 0x10) >> 0x10;
      iVar3 = (int)(iVar9 + (((uint)*(ushort *)(puVar8 + 4) << 0x10) >> 0x1f)) >> 1;
      puVar7 = &ispch_gPickSamples + (int)*(short *)(puVar8 + 6);
      if (0 < iVar3) {
        do {
          iVar4 = iSPCH_Rand(iVar9);
          puVar5 = puVar7 + iVar6;
          uVar1 = *puVar5;
          iVar6 = iVar6 + 1;
          *puVar5 = puVar7[iVar4];
          puVar7[iVar4] = uVar1;
        } while (iVar6 < iVar3);
      }
      iVar10 = iVar10 + 1;
      puVar8 = puVar8 + 0xc;
    } while (iVar10 < iVar2);
  }
  return;


}

undefined4 iSPCH_IterateChoice(void)
{
  short sVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  undefined *puVar6;
  int iVar7;
  undefined4 uVar8;
  
  uVar8 = 0;
  iVar3 = VoxSentence_GetNumPhrases();
  iVar3 = iVar3 + -1;
  iVar4 = iVar3 * 0xc;
  bVar2 = false;
  iVar7 = (int)*(short *)(&DAT_801484ea + iVar4) + (int)*(short *)(&DAT_801484e8 + iVar4);
  puVar5 = &ispch_gChoice + iVar4;
  do {
    sVar1 = *(short *)(puVar5 + 8);
    *(short *)(puVar5 + 8) = sVar1 + 1;
    if ((int)(short)(sVar1 + 1) < iVar7) {
      bVar2 = true;
      puVar6 = puVar5;
    }
    else {
      iVar3 = iVar3 + -1;
      *(undefined2 *)(puVar5 + 8) = *(undefined2 *)(puVar5 + 6);
      puVar6 = puVar5 + -0xc;
      if (iVar3 < 0) {
        bVar2 = true;
        uVar8 = 1;
      }
      iVar7 = (int)*(short *)(puVar5 + -6) + (int)*(short *)(puVar5 + -8);
    }
    puVar5 = puVar6;
  } while (!bVar2);
  return uVar8;


}

int iSPCH_ChooseShortSentence(undefined4 uParm1)
{
  int iVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = 0;
  iVar1 = VoxSentence_GetNumPhrases();
  iVar3 = 0;
  iVar5 = 0;
  if (0 < iVar1) {
    puVar2 = &ispch_gChoice;
    do {
      iVar3 = iVar3 + 1;
      *(undefined2 *)(puVar2 + 8) = *(undefined2 *)(puVar2 + 6);
      puVar2 = puVar2 + 0xc;
    } while (iVar3 < iVar1);
  }
  while ((iVar4 == 0 && (iVar5 == 0))) {
    iVar1 = iSPCH_SentenceLength(uParm1);
    iVar4 = GetFilterLength();
    if (iVar1 < iVar4) {
      iVar5 = 1;
      iVar4 = 1;
    }
    else {
      iVar4 = iSPCH_IterateChoice(uParm1);
    }
  }
  return iVar5;


}

undefined4 iSPCH_SentenceMakeChoice(undefined4 uParm1,int iParm2)
{
  short sVar1;
  int iVar2;
  undefined *puVar3;
  int iVar4;
  undefined4 uVar5;
  
  uVar5 = 0;
  if (iParm2 == 1) {
    iSPCH_RandomizeSentencePicks();
    uVar5 = iSPCH_ChooseShortSentence(uParm1);
  }
  else {
    iVar2 = VoxSentence_GetNumPhrases(uParm1);
    iVar4 = 0;
    if (0 < iVar2) {
      uVar5 = 1;
      puVar3 = &ispch_gChoice;
      do {
        iVar4 = iVar4 + 1;
        sVar1 = iSPCH_Rand((int)*(short *)(puVar3 + 4));
        *(short *)(puVar3 + 8) = *(short *)(puVar3 + 6) + sVar1;
        puVar3 = puVar3 + 0xc;
      } while (iVar4 < iVar2);
    }
  }
  return uVar5;


}

void iSPCH_ConstantRuleSet(ushort *puParm1,int iParm2)
{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  short *psVar6;
  int iVar7;
  undefined auStack56 [12];
  byte local_2c [4];
  
  if (gSentenceRuleSet != (code *)0x0) {
    iVar1 = VoxSentence_GetNumPhrases(iParm2);
    iVar7 = 0;
    if (0 < iVar1) {
      psVar6 = (short *)&ispch_gChoice;
      do {
        iVar2 = iSPCH_GetOffset8(iParm2,iParm2 + 4,iVar7);
        iVar5 = 0;
        iVar4 = iVar2;
        do {
          if (*(byte *)(iVar4 + 4) >> 4 != 0xf) {
            uVar3 = iSPCH_GetRuleID(puParm1);
            iVar4 = iSPCH_UnPackSample(*(undefined4 *)((int)*psVar6 * 4 + gVoxBanks),
                                       (uint)(byte)(&ispch_gPickSamples)[(int)psVar6[4]],auStack56);
            if (iVar4 != 0) {
              (*gSentenceRuleSet)((uint)*puParm1,uVar3,1 << ((uint)local_2c[iVar5] & 0x1f));
            }
          }
          iVar5 = iVar5 + 1;
          iVar4 = iVar2 + iVar5;
        } while (iVar5 < 4);
        iVar7 = iVar7 + 1;
        psVar6 = psVar6 + 6;
      } while (iVar7 < iVar1);
    }
  }
  return;


}

void iSPCH_MakeSampleRequests(undefined4 uParm1,undefined4 uParm2)
{
  byte bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  short *psVar5;
  int iVar6;
  int iVar7;
  int local_38;
  int local_34;
  
  iVar7 = 0;
  iVar2 = VoxSentence_GetNumPhrases();
  iVar6 = 0;
  if (0 < iVar2) {
    psVar5 = (short *)&ispch_gChoice;
    do {
      iVar4 = *(int *)((int)*psVar5 * 4 + gVoxBanks);
      bVar1 = (&ispch_gPickSamples)[(int)psVar5[4]];
      if (((*(byte *)(iVar4 + 2) & 0xf0) != 0) && (true)) {
        iSPCH_ClearCycleBit(iVar4,(uint)bVar1);
      }
      iVar3 = iSPCH_UnPackSample(iVar4,(uint)bVar1,&local_38);
      if (iVar3 != 0) {
        iVar3 = local_34;
        if ((int)psVar5[1] != -1) {
          iVar3 = local_34 + (int)psVar5[1] * (uint)*(ushort *)(iVar4 + 4) * 0x100;
        }
        iVar7 = iVar7 + local_38;
        (*gSampleRequest)((int)*psVar5,iVar3,local_38,uParm2);
      }
      iVar6 = iVar6 + 1;
      psVar5 = psVar5 + 6;
    } while (iVar6 < iVar2);
  }
  iSPCH_ConvertTime(iVar7);
  return;


}

void iSPCH_ClearChosen(void)
{
  _DAT_80148448 = 0;
  return;


}

void iSPCH_SaveChosenSentence( (undefined4 uParm1,undefined4 uParm2,undefined4 uParm3,undefined4 *puParm4)
{
  undefined4 uVar1;
  undefined *puVar2;
  int iVar3;
  
  iVar3 = 0;
  puVar2 = &gSentenceChoice;
  _gSentenceChoice = uParm1;
  _DAT_80148440 = uParm2;
  _DAT_80148444 = uParm3;
  do {
    uVar1 = *puParm4;
    puParm4 = puParm4 + 1;
    iVar3 = iVar3 + 1;
    *(undefined4 *)(puVar2 + 0x10) = uVar1;
    puVar2 = puVar2 + 4;
  } while (iVar3 < 0xc);
  _DAT_80148448 = 1;
  return;


}

undefined4 iSPCH_OneChosen(void)
{
  return _DAT_80148448;


}

void iSPCH_PlayChosen(void)
{
  int iVar1;
  int iVar2;
  
  iVar2 = iSPCH_OneChosen();
  iVar1 = _DAT_8014844c;
  if (iVar2 != 0) {
    iSPCH_RuleSet(_gSentenceChoice,_DAT_80148444,&DAT_8014844c);
    iSPCH_ConstantRuleSet(_gSentenceChoice,_DAT_80148440);
    iSPCH_MakeSampleRequests(_DAT_80148440,iVar1);
    if (iVar1 == _gVoxInGame) {
      _DAT_8014805c = _DAT_8014805c + 1;
    }
    else {
      _DAT_8014805c = 1;
      _gVoxInGame = iVar1;
    }
  }
  iSPCH_ClearChosen();
  return;


}

int iSPCH_ChooseSentence(undefined4 *puParm1)
{
  byte bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  byte local_98 [104];
  byte local_30 [8];
  
  iVar9 = 0;
  local_30[0] = 0;
  iVar2 = iSPCH_FindEvent(*puParm1);
  iVar3 = 0;
  if (iVar2 != 0) {
    iVar4 = iSPCH_RepeatEvent(iVar2);
    iVar3 = 0;
    if (iVar4 != 0) {
      iSPCH_ClearChosen();
      iVar4 = _gFilterSetting;
      if ((_DAT_80148064 == 1) && (iVar4 = _gFilterSetting + 1, 2 < iVar4)) {
        iVar4 = 2;
      }
      uVar5 = VoxEvent_GetFilterLengthFlag(iVar2);
      if (((uVar5 & 0xff) != 0) && (iVar4 == 1)) {
        iVar4 = 0;
      }
      uVar5 = iSPCH_GetRuleSettings(iVar2,puParm1,local_30);
      iSPCH_OrderSentences(iVar2,local_98);
      bVar1 = *(byte *)(iVar2 + 6);
      iVar3 = -1;
      if (bVar1 != 0) {
        iVar3 = 0;
        while (iVar9 < (int)(uint)bVar1) {
          uVar8 = (uint)local_98[iVar9];
          if (false) {
            return iVar3;
          }
          if ((uint)bVar1 <= uVar8) {
            return iVar3;
          }
          uVar6 = iSPCH_GetOffset16(iVar2,iVar2 + 0xc,uVar8);
          iVar7 = iSPCH_SentenceGetChoices(uVar6,puParm1,uVar5 & 0xff,(uint)local_30[0],iVar4);
          if ((0 < iVar7) && (iVar3 = iSPCH_SentenceMakeChoice(uVar6,iVar4), iVar3 != 0)) {
            iSPCH_SaveChosenSentence(iVar2,uVar6,uVar8,puParm1);
          }
          iVar9 = iVar9 + 1;
          if (iVar3 != 0) {
            return iVar3;
          }
        }
      }
    }
  }
  return iVar3;


}

void SPCH_SetPreLoadTicks(undefined4 uParm1)
{
  _gPreLoadTicks = uParm1;
  return;


}

int iSNDdetunetolinear(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 0x1000;
  if (0x4af < iParm1) {
    do {
      iParm1 = iParm1 + -0x4b0;
      iVar2 = iVar2 << 1;
    } while (0x4af < iParm1);
  }
  while (iParm1 < -0x4af) {
    iVar2 = iVar2 >> 1;
    iParm1 = iParm1 + 0x4b0;
  }
  iVar1 = iParm1 * 0x369d >> 0x10;
  if (iVar1 < -0xff) {
    iVar1 = -0xff;
  }
  if (iVar1 < 0) {
    iVar2 = (int)(iVar2 * ((uint)(byte)(&snddefaultenvelope)[iVar1] + 0x100)) >> 9;
  }
  else {
    iVar2 = (int)(iVar2 * ((uint)(byte)(&sndcents)[iVar1] + 0x100)) >> 8;
  }
  return iVar2;


}

void iSNDcalcpitch(int iParm1)
{
  char cVar1;
  undefined2 uVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = _DAT_801478f4 + iParm1 * 100;
  if (*(short *)(iVar4 + 0x5e) == 0) {
    iVar3 = (int)*(short *)(iVar4 + 0x5c);
    if (*(short *)(iVar4 + 0x5a) != 0) {
      if (*(int *)(iVar4 + 0x4c) == 0) {
        cVar1 = *(char *)(iVar4 + 0x2f);
      }
      else {
        cVar1 = *(char *)(*(int *)(iVar4 + 0x4c) + (int)*(char *)(iVar4 + 0x2f));
      }
      iVar3 = iVar3 + (((int)cVar1 + -0x40) * (int)*(short *)(iVar4 + 0x5a) >> 6);
    }
    if (*(int *)(iVar4 + 0x54) != 0) {
      iVar3 = iVar3 + (((int)*(char *)(*(int *)(iVar4 + 0x54) + (uint)*(byte *)(iVar4 + 0x3b)) +
                       -0x40) * (int)*(short *)(iVar4 + 0x58) >> 6);
    }
    uVar2 = iSNDdetunetolinear(iVar3);
    *(undefined2 *)(iVar4 + 0x5e) = uVar2;
  }
  *(undefined2 *)(iVar4 + 0x62) =
       (short)((int)((uint)*(ushort *)(iVar4 + 0x5e) * (uint)*(ushort *)(iVar4 + 0x60)) >> 0xc);
  return;


}

void iSNDresetpatch(int iParm1)
{
  *(undefined4 *)(iParm1 + 0x90) = 0;
  return;


}

void iSNDresettimbre(int iParm1,int iParm2)
{
  int iVar1;
  undefined4 *puVar2;
  
  iVar1 = 0x25;
  puVar2 = (undefined4 *)(iParm2 + 0x94);
  do {
    *puVar2 = 0;
    iVar1 = iVar1 + -1;
    puVar2 = puVar2 + -1;
  } while (-1 < iVar1);
  *(undefined4 *)(iParm1 + 0x14) = 0xffffffff;
  *(undefined4 *)(iParm1 + 0x20) = 0xffffffff;
  *(undefined4 *)(iParm1 + 0x1c) = 0x3c;
  *(undefined4 *)(iParm1 + 0x30) = 0x40;
  *(undefined4 *)(iParm1 + 4) = 0;
  *(undefined4 *)(iParm1 + 8) = 0x7f;
  *(undefined4 *)(iParm1 + 0xc) = 0;
  *(undefined4 *)(iParm1 + 0x10) = 0x7f;
  *(undefined4 *)(iParm1 + 0x18) = 0;
  *(undefined4 *)(iParm1 + 0x24) = 1;
  *(undefined4 *)(iParm1 + 0x28) = 0;
  *(undefined4 *)(iParm1 + 0x2c) = 1;
  *(undefined4 *)(iParm1 + 0x34) = 0;
  *(undefined4 *)(iParm1 + 0x38) = 0x7f;
  *(undefined4 *)(iParm1 + 0x3c) = 0;
  *(undefined4 *)(iParm1 + 0x40) = 0;
  *(undefined4 *)(iParm1 + 0x44) = 0;
  *(undefined4 *)(iParm1 + 0x48) = 0;
  *(undefined4 *)(iParm1 + 0x4c) = 0;
  *(undefined4 *)(iParm1 + 0x54) = 0;
  *(undefined4 *)(iParm1 + 0x5c) = 0;
  *(undefined4 *)(iParm1 + 0x70) = 0x7f;
  *(undefined4 *)(iParm1 + 0x74) = 0;
  *(undefined4 *)(iParm1 + 0x78) = 0;
  *(undefined4 *)(iParm1 + 0x7c) = 0;
  *(undefined4 *)(iParm1 + 0x80) = 0;
  *(undefined4 *)(iParm1 + 0x84) = 0;
  *(undefined4 *)(iParm1 + 0x8c) = 0;
  *(undefined4 *)(iParm1 + 0x88) = 0;
  *(undefined4 *)(iParm1 + 0x94) = 1;
  *(undefined4 *)(iParm1 + 100) = 0x801371c4;
  return;


}

void iSNDresolveheader(int iParm1,int iParm2)
{
  *(int *)(iParm1 + 0x48) = *(int *)(iParm2 + 0x48) + *(int *)(iParm1 + 0x48);
  *(int *)(iParm1 + 0x54) = *(int *)(iParm2 + 0x54) + *(int *)(iParm1 + 0x54);
  *(int *)(iParm1 + 0x5c) = *(int *)(iParm2 + 0x5c) + *(int *)(iParm1 + 0x5c);
  *(int *)(iParm1 + 0x74) = *(int *)(iParm2 + 0x74) + *(int *)(iParm1 + 0x74);
  *(int *)(iParm1 + 0x80) = *(int *)(iParm2 + 0x80) + *(int *)(iParm1 + 0x80);
  if (*(int *)(iParm1 + 100) != 0) {
    *(int *)(iParm1 + 100) = *(int *)(iParm2 + 100) + *(int *)(iParm1 + 100);
  }
  return;


}

uint iSNDfindfreekey(void)
{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  while( true ) {
    bVar1 = DAT_801371cc + 1;
    if ((byte)(DAT_801371cc + 1) == 0) {
      bVar1 = DAT_801371cc + 2;
    }
    DAT_801371cc = bVar1;
    iVar3 = 0;
    iVar2 = _DAT_801478f4;
    if (DAT_80147871 == 0) break;
    while ((*(char *)(iVar2 + 0xb) == '\0' || (*(byte *)(iVar2 + 0x37) != DAT_801371cc))) {
      iVar3 = iVar3 + 1;
      iVar2 = iVar2 + 100;
      if ((int)(uint)DAT_80147871 <= iVar3) goto LAB_80101c7c;
    }
  }
LAB_80101c7c:
  return (uint)DAT_801371cc;


}

int iSNDplaytaggedtimbre( (undefined4 param_1,undefined2 *param_2,int param_3,undefined4 param_4,short param_5, int param_6,short param_7)
{
  char cVar1;
  char cVar2;
  undefined uVar3;
  undefined uVar4;
  undefined2 uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  undefined4 uVar10;
  short sVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int local_30 [2];
  
  cVar1 = *(char *)((int)param_2 + 7);
  iVar14 = (int)cVar1;
  cVar2 = *(char *)(param_2 + 4);
  uVar3 = *(undefined *)((int)param_2 + 9);
  uVar4 = *(undefined *)(param_2 + 5);
  iSNDresolveheader(param_3,param_4);
  iVar13 = *(int *)(param_3 + 0x30);
  if (*(int *)(param_3 + 0x34) != 0) {
    iVar6 = randrange();
    iVar13 = iVar13 + iVar6;
  }
  if (iVar13 < 0x80) {
    if (iVar13 < 0) {
      iVar13 = 0;
    }
  }
  else {
    iVar13 = 0x7f;
  }
  iVar7 = iSNDallocchan(*(undefined4 *)(param_3 + 0x14),*(undefined4 *)(param_3 + 0x2c),
                        *(undefined4 *)(param_3 + 0x18),local_30);
  iVar6 = iVar7;
  if (-1 < iVar7) {
    iVar6 = _DAT_801478f4 + iVar7 * 100;
    *(undefined *)(iVar6 + 0x33) = *(undefined *)(param_3 + 0x94);
    sVar11 = *(short *)(param_3 + 0x40);
    *(short *)(iVar6 + 0x5c) = sVar11;
    sVar11 = sVar11 + ((short)*(undefined4 *)(param_3 + 0x1c) - param_5) * -100;
    *(short *)(iVar6 + 0x5c) = sVar11;
    if (*(int *)(param_3 + 0x90) != 0) {
      *(short *)(iVar6 + 0x5c) = sVar11 + param_7;
    }
    if (*(int *)(param_3 + 0x44) != 0) {
      sVar11 = randrange();
      *(short *)(iVar6 + 0x5c) = *(short *)(iVar6 + 0x5c) + sVar11;
    }
    *(undefined4 *)(iVar6 + 0x44) = *(undefined4 *)(param_3 + 0x48);
    *(undefined4 *)(iVar6 + 0x48) = *(undefined4 *)(param_3 + 0x54);
    uVar10 = *(undefined4 *)(param_3 + 0x5c);
    *(int *)(iVar6 + 0x1c) = (int)cVar2 << 0x10;
    *(undefined4 *)(iVar6 + 0x4c) = uVar10;
    *(undefined4 *)(iVar6 + 0x14) = 0;
    *(char *)(iVar6 + 0x3d) = cVar1;
    if ((int)*(char *)(iVar6 + 0x33) != 1) {
      iVar14 = (iVar14 + -0x40) * (int)*(char *)(iVar6 + 0x33) + 0x40;
    }
    iVar14 = iVar13 + iVar14 + -0x40;
    if (iVar14 < 0) {
      iVar14 = 0;
    }
    else {
      if (0x7f < iVar14) {
        iVar14 = 0x7f;
      }
    }
    if (*(int *)(iVar6 + 0x48) != 0) {
      iVar14 = (int)*(char *)(*(int *)(iVar6 + 0x48) + iVar14);
    }
    iVar12 = *(int *)(param_3 + 0x38);
    if (*(int *)(param_3 + 0x3c) != 0) {
      iVar8 = randrange();
      iVar12 = iVar12 + iVar8;
    }
    iVar8 = iVar12;
    if (0x7f < iVar12) {
      iVar8 = 0x7f;
    }
    if (iVar12 < -0x80) {
      iVar8 = -0x80;
    }
    *(undefined *)(iVar6 + 0x2e) = (char)iVar13;
    *(undefined *)(iVar6 + 0x2c) = (char)((iVar8 * param_6) / 0x7f);
    uVar10 = *(undefined4 *)(param_3 + 0x28);
    *(undefined *)(iVar6 + 0x2f) = uVar3;
    *(short *)(iVar6 + 0x5a) = (short)uVar10 * 100;
    *(undefined4 *)(iVar6 + 0x40) = *(undefined4 *)(param_3 + 100);
    iVar13 = *(int *)(param_3 + 0x70);
    *(undefined *)(iVar6 + 0x31) = 0;
    *(int *)(iVar6 + 0x24) = iVar13 << 0x10;
    *(undefined *)(iVar6 + 0x30) = *(undefined *)(param_3 + 0x24);
    *(undefined *)(iVar6 + 0x32) = *(undefined *)(param_3 + 0x20);
    iVar13 = **(int **)(iVar6 + 0x40);
    *(int *)(iVar6 + 0x28) = iVar13;
    if (iVar13 < 0) {
      *(undefined4 *)(iVar6 + 0x28) = 0x7fffffff;
    }
    iVar12 = *(int *)(iVar6 + 0x28);
    iVar13 = *(int *)(*(int *)(iVar6 + 0x40) + 4) * 0x10000 - *(int *)(iVar6 + 0x24);
    if (iVar12 == 0) {
      trap(0x1c00);
    }
    if ((iVar12 == -1) && (iVar13 == -0x80000000)) {
      trap(0x1800);
    }
    *(int *)(iVar6 + 0x20) = iVar13 / iVar12;
    *(undefined4 *)(iVar6 + 0x50) = *(undefined4 *)(param_3 + 0x74);
    *(undefined4 *)(iVar6 + 0x54) = *(undefined4 *)(param_3 + 0x80);
    *(undefined *)(iVar6 + 0x38) = *(undefined *)(param_3 + 0x78);
    *(undefined *)(iVar6 + 0x39) = *(undefined *)(param_3 + 0x84);
    *(ushort *)(iVar6 + 0x58) = (ushort)*(byte *)(param_3 + 0x88);
    if (*(int *)(param_3 + 0x7c) == 0) {
      *(undefined *)(iVar6 + 0x3a) = 0;
    }
    else {
      uVar9 = iSNDrandom();
      if (*(uint *)(param_3 + 0x78) == 0) {
        trap(0x1c00);
      }
      *(undefined *)(iVar6 + 0x3a) = (char)(uVar9 % *(uint *)(param_3 + 0x78));
    }
    if (*(int *)(param_3 + 0x8c) == 0) {
      *(undefined *)(iVar6 + 0x3b) = 0;
    }
    else {
      uVar9 = iSNDrandom();
      if (*(uint *)(param_3 + 0x84) == 0) {
        trap(0x1c00);
      }
      *(undefined *)(iVar6 + 0x3b) = (char)(uVar9 % *(uint *)(param_3 + 0x84));
    }
    *(undefined2 *)(iVar6 + 0x3e) = param_2[7];
    uVar5 = param_2[6];
    *(undefined2 *)(iVar6 + 0x5e) = 0;
    *(undefined2 *)(iVar6 + 0x60) = uVar5;
    iSNDcalcpitch(iVar7);
    uVar3 = *(undefined *)(param_3 + 0x4c);
    *(undefined *)(iVar6 + 0x35) = uVar4;
    *(undefined *)(iVar6 + 0x34) = uVar3;
    *(undefined *)(iVar6 + 10) = *(undefined *)(param_2 + 2);
    *(undefined2 *)(iVar6 + 8) = *param_2;
    iSNDcalcvol(iVar7);
    if (*(char *)((int)param_2 + 0xb) == '\0') {
      uVar9 = (iVar14 + -0x40) * 0x100 & 0xffff;
      iVar13 = 0;
    }
    else {
      uVar9 = (uint)(ushort)param_2[8];
      iVar13 = (int)(short)param_2[9];
    }
    iVar13 = iSNDplatformplay(param_1,iVar7,(int)*(char *)(iVar6 + 0x2d),
                              (uint)*(ushort *)(iVar6 + 0x62),(uint)(ushort)param_2[7],
                              (_DAT_80147900 * (int)*(char *)(iVar6 + 0x34) *
                              (int)*(char *)(iVar6 + 0x35)) / 0x3f01,uVar9,iVar13);
    iVar6 = local_30[0];
    if (iVar13 < 0) {
      iSNDfreechan(iVar7);
      iVar6 = iVar13;
    }
  }
  return iVar6;


}

int iSNDplaytaggedpatch(int iParm1,int iParm2)
{
  undefined uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  int aiStack408 [4];
  int local_188;
  undefined4 auStack256 [38];
  int local_68 [12];
  int local_38;
  int local_34;
  int local_30;
  undefined4 local_2c;
  
  iVar8 = 0xfffffff7;
  iVar6 = 0;
  iVar7 = 0;
  uVar10 = 0;
  if (iParm1 == 0) {
    return 0xfffffff8;
  }
  iVar4 = (int)*(char *)(iParm2 + 5);
  iVar3 = (int)*(char *)(iParm2 + 6);
  local_38 = iParm1 + 8;
  if ((*(byte *)(iParm1 + 3) & 2) == 0) {
    local_38 = iParm1 + 4;
  }
  iSNDresetpatch(aiStack408);
  iSNDresettimbre(aiStack408,auStack256);
  iSNDenteraudio();
  uVar1 = iSNDfindfreekey();
  iVar2 = 0;
  while (iVar9 = iVar2, iVar2 = iSNDgettag(&local_38,&local_34,&local_30,&local_2c), iVar2 != 0) {
    iVar2 = local_38;
    if (local_34 != 0xfd) {
      if (local_34 == 0xfe) {
        if ((((aiStack408[1] <= iVar3) && (iVar3 <= aiStack408[2])) && (aiStack408[3] <= iVar4)) &&
           (iVar4 <= local_188)) {
          iVar8 = iSNDplaytaggedtimbre(iVar9,iParm2,aiStack408,auStack256,iVar4,iVar3,uVar10);
          if (iVar8 < 0) goto LAB_8010248c;
          local_68[iVar6] = iVar8;
          iVar6 = iVar6 + 1;
        }
        iSNDresettimbre(aiStack408,auStack256);
        iVar2 = iVar9;
      }
      else {
        iVar2 = iVar9;
        if (local_34 < 0x26) {
          aiStack408[local_34] = local_30;
          auStack256[local_34] = local_2c;
          iVar2 = iVar9;
          if (local_34 == 0x24) {
            uVar10 = randrange(local_30);
            iVar2 = iVar9;
          }
        }
      }
    }
  }
  if (((aiStack408[1] <= iVar3) && (iVar3 <= aiStack408[2])) &&
     ((aiStack408[3] <= iVar4 && (iVar4 <= local_188)))) {
    iVar8 = iSNDplaytaggedtimbre(iVar9,iParm2,aiStack408,auStack256,iVar4,iVar3,uVar10);
    if (iVar8 < 0) goto LAB_8010248c;
    local_68[iVar6] = iVar8;
    iVar6 = iVar6 + 1;
  }
  if (iVar6 != 0) {
    if (iVar6 == 1) {
      iVar6 = iSNDgetchan(local_68[0]);
      if (-1 < iVar6) {
        iVar6 = _DAT_801478f4 + iVar6 * 100;
        *(undefined *)(iVar6 + 0x37) = 0;
        *(undefined *)(iVar6 + 0x36) = 0;
      }
    }
    else {
      iVar3 = 0;
      if (0 < iVar6) {
        piVar5 = local_68;
        do {
          iVar4 = iSNDgetchan(*piVar5);
          if (-1 < iVar4) {
            iVar7 = _DAT_801478f4 + iVar4 * 100;
            *(undefined *)(iVar7 + 0x37) = uVar1;
            *(undefined *)(iVar7 + 0x36) = 0;
          }
          iVar3 = iVar3 + 1;
          piVar5 = piVar5 + 1;
        } while (iVar3 < iVar6);
      }
      *(undefined *)(iVar7 + 0x36) = 1;
    }
    iSNDleaveaudio();
    return iVar8;
  }
LAB_8010248c:
  iVar7 = 0;
  iSNDleaveaudio();
  piVar5 = local_68;
  if (0 < iVar6) {
    do {
      iVar3 = *piVar5;
      piVar5 = piVar5 + 1;
      iVar7 = iVar7 + 1;
      SNDstop(iVar3);
    } while (iVar7 < iVar6);
  }
  return iVar8;


}

int iSNDresolvetaggedpatch(int iParm1,undefined4 uParm2,undefined4 uParm3)
{
  int iVar1;
  int iVar2;
  int local_28;
  int local_24;
  undefined auStack32 [4];
  undefined auStack28 [4];
  
  iVar2 = -1;
  if ((*(byte *)(iParm1 + 3) & 2) == 0) {
    local_28 = iParm1 + 4;
  }
  else {
    local_28 = iParm1 + 8;
  }
  while (iVar1 = iSNDgettag(&local_28,&local_24,auStack32,auStack28), iVar1 != 0) {
    if (local_24 == 0xfd) {
      iVar2 = iSNDplatformresolve(local_28,uParm2,uParm3);
    }
  }
  if (-1 < iVar2) {
    *(byte *)(iParm1 + 3) = *(byte *)(iParm1 + 3) | 1;
  }
  return iVar2;


}

undefined4 iSNDremovetaggedpatch(int iParm1,undefined4 uParm2)
{
  int iVar1;
  int local_20;
  int local_1c;
  undefined auStack24 [4];
  undefined auStack20 [4];
  
  if ((*(byte *)(iParm1 + 3) & 2) == 0) {
    local_20 = iParm1 + 4;
  }
  else {
    local_20 = iParm1 + 8;
  }
  while( true ) {
    iVar1 = iSNDgettag(&local_20,&local_1c,auStack24,auStack20);
    if (iVar1 == 0) break;
    if (local_1c == 0xfd) {
      iSNDplatformremove(local_20,uParm2);
    }
  }
  *(byte *)(iParm1 + 3) = *(byte *)(iParm1 + 3) & 0xfe;
  return 0;


}

undefined4 iSNDdownloadbank(int iParm1,undefined4 uParm2)
{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  undefined auStack2088 [2040];
  undefined4 local_30 [2];
  
  uVar8 = 7;
  iVar3 = 0xff;
  puVar1 = local_30;
  do {
    *puVar1 = 0xffffffff;
    iVar3 = iVar3 + -1;
    puVar1 = puVar1 + -2;
  } while (-1 < iVar3);
  iVar3 = 0;
  if (*(short *)(iParm1 + 6) != 0) {
    iVar7 = 0xc;
    iVar6 = 0x14;
    iVar4 = iParm1;
    iVar5 = iParm1;
    do {
      if (*(char *)(iParm1 + 4) == '\x04') {
        iVar2 = *(int *)(iVar4 + 0x14);
      }
      else {
        iVar2 = *(int *)(iVar5 + 0xc);
      }
      if (iVar2 != 0) {
        if (*(char *)(iParm1 + 4) == '\x04') {
          iVar2 = iParm1 + iVar6 + *(int *)(iVar4 + 0x14);
          *(int *)(iVar4 + 0x14) = iVar2;
        }
        else {
          iVar2 = iParm1 + iVar7 + *(int *)(iVar5 + 0xc);
          *(int *)(iVar5 + 0xc) = iVar2;
        }
        iVar2 = iSNDresolvetaggedpatch(iVar2,uParm2,auStack2088);
        if (iVar2 != 7) {
          uVar8 = 8;
        }
      }
      iVar7 = iVar7 + 4;
      iVar5 = iVar5 + 4;
      iVar6 = iVar6 + 4;
      iVar3 = iVar3 + 1;
      iVar4 = iVar4 + 4;
    } while (iVar3 < (int)(uint)*(ushort *)(iParm1 + 6));
  }
  return uVar8;


}

int iSNDbankalloc(void)
{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = _DAT_801478f8;
  if (_DAT_8014786c != 0) {
    do {
      if (*piVar2 == 0) {
        return iVar1;
      }
      iVar1 = iVar1 + 1;
      piVar2 = piVar2 + 3;
    } while (iVar1 < (int)(uint)_DAT_8014786c);
  }
  return 0xfffffff7;


}

int SNDgetvol(undefined4 uParm1)
{
  int iVar1;
  
  if (DAT_8014789c == '\0') {
    iVar1 = -10;
  }
  else {
    iSNDenteraudio();
    iVar1 = iSNDgetchan(uParm1);
    if (iVar1 < 0) {
      iSNDleaveaudio();
      iVar1 = -8;
    }
    else {
      iSNDleaveaudio();
      iVar1 = (int)*(char *)(iVar1 * 100 + _DAT_801478f4 + 0x2d);
    }
  }
  return iVar1;


}

int printf(char *__format,...)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

int iSNDpacketplayoverhead(int iParm1)
{
  return iParm1 * 0x18 + 0x40;


}

int SNDPKTPLAY_overhead(void)
{
  int iVar1;
  int iVar2;
  
  iVar1 = iSNDpacketplayoverhead();
  iVar2 = iSNDplatformpacketoverhead();
  return iVar1 + iVar2;


}

int SNDPKTPLAY_create(int iParm1,int iParm2,undefined4 uParm3,undefined4 uParm4)
{
  undefined4 uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  undefined4 *puVar5;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar4 = 0;
    piVar3 = (int *)&sndpps;
    do {
      if (*piVar3 == 0) {
        iVar2 = iSNDplatformpacketplaycreate(iVar4,iParm1);
        if (-1 < iVar2) {
          iVar2 = iSNDplatformpacketoverhead();
          puVar5 = (undefined4 *)(iParm1 + iVar2);
          iVar2 = iSNDplatformpacketoverhead();
          *(undefined4 **)(&sndpps + iVar4 * 4) = puVar5;
          puVar5[6] = iParm1;
          puVar5[7] = uParm3;
          puVar5[8] = uParm4;
          *(short *)(puVar5 + 2) = (short)(((iParm2 - iVar2) - 0x40U) / 0x18);
          *puVar5 = 0xffffffff;
          return iVar4;
        }
        return 0xfffffffa;
      }
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < 1);
    uVar1 = 0xfffffff7;
  }
  return uVar1;


}

int SNDPKTPLAY_start(int iParm1,int *piParm2,undefined4 *puParm3,int iParm4)
{
  char cVar1;
  byte bVar2;
  undefined uVar3;
  undefined2 uVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  uint uVar8;
  int local_30 [2];
  
  if (DAT_8014789c == '\0') {
    iVar5 = -10;
  }
  else {
    bVar2 = *(byte *)((int)piParm2 + 2);
    piVar7 = *(int **)(&sndpps + iParm1 * 4);
    iSNDenteraudio();
    iVar6 = iSNDallocchan(*puParm3,(uint)bVar2,(int)*(char *)((int)puParm3 + 6),local_30);
    if (iVar6 < 0) {
      iSNDleaveaudio();
      iVar5 = -9;
    }
    else {
      *piVar7 = local_30[0];
      *(undefined2 *)((int)piVar7 + 10) = 0;
      *(undefined2 *)((int)piVar7 + 0xe) = 0;
      piVar7[4] = 0;
      piVar7[1] = 0;
      piVar7[5] = 0;
      *(undefined2 *)(piVar7 + 3) = 0xffff;
      piVar7[9] = *piParm2;
      iVar5 = _DAT_801478f4 + iVar6 * 100;
      if (*(char *)(iParm4 + 0xb) == '\0') {
        uVar8 = ((int)*(char *)(iParm4 + 7) + -0x40) * 0x100 & 0xffff;
      }
      else {
        uVar8 = (uint)*(ushort *)(iParm4 + 0x10);
      }
      *(undefined *)(iVar5 + 10) = 0xff;
      *(undefined2 *)(iVar5 + 0x5c) = *(undefined2 *)(puParm3 + 1);
      uVar4 = *(undefined2 *)(iParm4 + 0xc);
      *(undefined4 *)(iVar5 + 0x14) = 0;
      *(undefined2 *)(iVar5 + 0x60) = uVar4;
      cVar1 = *(char *)(iParm4 + 8);
      *(undefined4 *)(iVar5 + 0x20) = 0;
      *(undefined4 *)(iVar5 + 0x28) = 0x7fffffff;
      *(undefined4 *)(iVar5 + 0x24) = 0x7f0000;
      *(int *)(iVar5 + 0x1c) = (int)cVar1 << 0x10;
      *(undefined *)(iVar5 + 0x2c) = *(undefined *)((int)puParm3 + 7);
      *(undefined *)(iVar5 + 0x2e) = *(undefined *)(puParm3 + 2);
      uVar3 = *(undefined *)(iParm4 + 9);
      *(undefined *)(iVar5 + 0x30) = 1;
      *(undefined *)(iVar5 + 0x31) = 0;
      *(undefined *)(iVar5 + 0x32) = 0;
      *(undefined *)(iVar5 + 0x33) = 1;
      *(undefined *)(iVar5 + 0x2f) = uVar3;
      *(undefined *)(iVar5 + 0x34) = *(undefined *)((int)puParm3 + 9);
      *(undefined *)(iVar5 + 0x35) = *(undefined *)(iParm4 + 10);
      cVar1 = *(char *)((int)puParm3 + 10);
      *(undefined *)(iVar5 + 0x37) = 0;
      *(undefined *)(iVar5 + 0x36) = 0;
      *(short *)(iVar5 + 0x5a) = (short)cVar1 * 100;
      uVar3 = *(undefined *)(iParm4 + 7);
      *(undefined4 *)(iVar5 + 0x40) = 0;
      *(undefined4 *)(iVar5 + 0x44) = 0;
      *(undefined *)(iVar5 + 0x3d) = uVar3;
      *(undefined4 *)(iVar5 + 0x48) = 0;
      *(undefined4 *)(iVar5 + 0x4c) = 0;
      *(undefined4 *)(iVar5 + 0x50) = 0;
      *(undefined4 *)(iVar5 + 0x54) = 0;
      *(undefined2 *)(iVar5 + 0x5e) = 0;
      iSNDcalcpitch(iVar6);
      iSNDcalcvol(iVar6);
      iVar5 = iSNDplatformpacketplay
                        (iParm1,iVar6,uVar8,(int)*(char *)(iVar5 + 0x2d),
                         (uint)*(ushort *)(iVar5 + 0x62),(uint)*(ushort *)(iParm4 + 0xe),
                         (_DAT_80147900 * (int)*(char *)(iVar5 + 0x34) *
                         (int)*(char *)(iVar5 + 0x35)) / 0x3f01,piParm2,puParm3 + 3);
      if (iVar5 < 0) {
        iSNDfreechan(iVar6);
        iSNDleaveaudio();
      }
      else {
        iSNDleaveaudio();
        iVar5 = *piVar7;
      }
    }
  }
  return iVar5;


}

undefined4 SNDPKTPLAY_submit(int iParm1,int iParm2)
{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iVar5 = *(int *)(&sndpps + iParm1 * 4);
    iSNDenteraudio();
    if ((int)*(short *)(iVar5 + 0xe) < (int)*(short *)(iVar5 + 8) + -1) {
      iVar3 = (int)*(short *)(iVar5 + 10) + (int)*(short *)(iVar5 + 0xe);
      if ((int)*(short *)(iVar5 + 8) <= iVar3) {
        iVar3 = iVar3 - (int)*(short *)(iVar5 + 8);
      }
      puVar4 = (undefined4 *)(iVar5 + iVar3 * 0x18 + 0x28);
      puVar4[1] = *(undefined4 *)(iParm2 + 4);
      *puVar4 = *(undefined4 *)(iVar5 + 4);
      iVar2 = 0;
      iVar3 = iParm2;
      if (*(char *)(iVar5 + 0x26) != '\0') {
        do {
          iVar2 = iVar2 + 1;
          puVar4[2] = *(undefined4 *)(iVar3 + 0xc);
          puVar4 = puVar4 + 1;
          iVar3 = iVar3 + 4;
        } while (iVar2 < (int)(uint)*(byte *)(iVar5 + 0x26));
      }
      *(short *)(iVar5 + 0xe) = *(short *)(iVar5 + 0xe) + 1;
      *(int *)(iVar5 + 0x10) = *(int *)(iVar5 + 0x10) + *(int *)(iParm2 + 4);
      uVar1 = *(undefined4 *)(iVar5 + 4);
      *(int *)(iVar5 + 4) = *(int *)(iVar5 + 4) + 1;
    }
    else {
      uVar1 = 0xfffffff3;
    }
    iSNDleaveaudio();
  }
  return uVar1;


}

int SNDPKTPLAY_submitspace(int iParm1)
{
  if (DAT_8014789c != '\0') {
    return ((int)*(short *)(*(int *)(&sndpps + iParm1 * 4) + 8) -
           (int)*(short *)(*(int *)(&sndpps + iParm1 * 4) + 0xe)) + -1;
  }
  return 0xfffffff6;


}

int SNDPKTPLAY_unsafeframesoutstanding(int iParm1)
{
  return *(int *)(*(int *)(&sndpps + iParm1 * 4) + 0x10) +
         *(int *)(*(int *)(&sndpps + iParm1 * 4) + 0x14);


}

undefined4 SNDPKTPLAY_framesoutstanding(undefined4 uParm1)
{
  undefined4 uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iSNDenteraudio();
    uVar1 = SNDPKTPLAY_unsafeframesoutstanding(uParm1);
    iSNDleaveaudio();
  }
  return uVar1;


}

undefined4 SNDPKTPLAY_purge(int iParm1,int iParm2,int iParm3)
{
  short sVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  
  if (DAT_8014789c == '\0') {
    uVar2 = 0xfffffff6;
  }
  else {
    iVar7 = *(int *)(&sndpps + iParm1 * 4);
    iVar12 = 0;
    iSNDenteraudio();
    iVar10 = (int)*(short *)(iVar7 + 10);
    sVar1 = *(short *)(iVar7 + 0xe);
    iVar9 = (int)*(short *)(iVar7 + 10);
    if (0 < (int)sVar1) {
      iVar11 = iVar9 * 0x18 + 0x28;
      iVar8 = iVar10 * 0x18 + iVar7;
      do {
        piVar3 = (int *)(iVar7 + iVar11);
        if ((*piVar3 < iParm2) || (iParm3 < *piVar3)) {
          iVar4 = piVar3[1];
          iVar5 = piVar3[2];
          iVar6 = piVar3[3];
          *(int *)(iVar8 + 0x28) = *piVar3;
          *(int *)(iVar8 + 0x2c) = iVar4;
          *(int *)(iVar8 + 0x30) = iVar5;
          *(int *)(iVar8 + 0x34) = iVar6;
          iVar4 = piVar3[5];
          *(int *)(iVar8 + 0x38) = piVar3[4];
          *(int *)(iVar8 + 0x3c) = iVar4;
          iVar10 = iVar10 + 1;
          iVar8 = iVar8 + 0x18;
          if ((int)*(short *)(iVar7 + 8) <= iVar10) {
            iVar10 = 0;
            iVar8 = iVar7;
          }
        }
        else {
          *(short *)(iVar7 + 0xe) = *(short *)(iVar7 + 0xe) + -1;
          *(int *)(iVar7 + 0x10) = *(int *)(iVar7 + 0x10) - piVar3[1];
          if (*(code **)(iVar7 + 0x1c) != (code *)0x0) {
            (**(code **)(iVar7 + 0x1c))(piVar3[2]);
          }
        }
        iVar11 = iVar11 + 0x18;
        iVar9 = iVar9 + 1;
        if ((int)*(short *)(iVar7 + 8) <= iVar9) {
          iVar11 = 0x28;
          iVar9 = 0;
        }
        iVar12 = iVar12 + 1;
      } while (iVar12 < (int)sVar1);
    }
    iSNDleaveaudio();
    uVar2 = 0;
  }
  return uVar2;


}

undefined4 SNDPKTPLAY_stop(int iParm1)
{
  undefined4 uVar1;
  undefined4 *puVar2;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    puVar2 = *(undefined4 **)(&sndpps + iParm1 * 4);
    iSNDenteraudio();
    SNDstop(*puVar2);
    SNDPKTPLAY_purge(iParm1,0,0x7fffffff);
    if (((code *)puVar2[7] != (code *)0x0) && (-1 < (int)((uint)*(ushort *)(puVar2 + 3) << 0x10))) {
      (*(code *)puVar2[7])(puVar2[(int)*(short *)(puVar2 + 3) * 6 + 0xc]);
    }
    *puVar2 = 0xffffffff;
    iSNDleaveaudio();
    uVar1 = 0;
  }
  return uVar1;


}

undefined4 SNDPKTPLAY_destroy(int iParm1)
{
  undefined4 uVar1;
  
  if (DAT_8014789c == '\0') {
    uVar1 = 0xfffffff6;
  }
  else {
    iSNDplatformpacketplaydestroy();
    *(undefined4 *)(&sndpps + iParm1 * 4) = 0;
    uVar1 = 0;
  }
  return uVar1;


}

undefined4 iSNDpacketget(int iParm1,int iParm2,undefined4 *puParm3)
{
  short sVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = *(int *)(&sndpps + iParm1 * 4);
  if ((iParm2 + 1U == (uint)*(byte *)(iVar4 + 0x26)) &&
     (-1 < (int)((uint)*(ushort *)(iVar4 + 0xc) << 0x10))) {
    sVar1 = *(short *)(iVar4 + 0xc);
    *(undefined2 *)(iVar4 + 0xc) = 0xffff;
    if (*(code **)(iVar4 + 0x1c) != (code *)0x0) {
      (**(code **)(iVar4 + 0x1c))(*(undefined4 *)(iVar4 + (int)sVar1 * 0x18 + 0x30));
    }
  }
  uVar2 = 0;
  if (*(short *)(iVar4 + 0xe) != 0) {
    iVar3 = iVar4 + (int)*(short *)(iVar4 + 10) * 0x18 + 0x28;
    *puParm3 = *(undefined4 *)(iVar3 + 4);
    if (iParm2 + 1U == (uint)*(byte *)(iVar4 + 0x26)) {
      *(undefined2 *)(iVar4 + 0xc) = *(undefined2 *)(iVar4 + 10);
      *(short *)(iVar4 + 0xe) = *(short *)(iVar4 + 0xe) + -1;
      *(short *)(iVar4 + 10) = *(short *)(iVar4 + 10) + 1;
      *(int *)(iVar4 + 0x14) = *(int *)(iVar4 + 0x14) + *(int *)(iVar3 + 4);
      *(int *)(iVar4 + 0x10) = *(int *)(iVar4 + 0x10) - *(int *)(iVar3 + 4);
      if ((int)((uint)*(ushort *)(iVar4 + 8) << 0x10) <=
          (int)((uint)*(ushort *)(iVar4 + 10) << 0x10)) {
        *(undefined2 *)(iVar4 + 10) = 0;
      }
    }
    uVar2 = *(undefined4 *)(iVar3 + iParm2 * 4 + 8);
  }
  return uVar2;


}

void iSNDpacketfreeframes(int iParm1,int iParm2,int iParm3)
{
  int iVar1;
  
  iVar1 = *(int *)(&sndpps + iParm1 * 4);
  if (iParm2 + 1U == (uint)*(byte *)(iVar1 + 0x26)) {
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) - iParm3;
    if (*(code **)(iVar1 + 0x20) != (code *)0x0) {
      (**(code **)(iVar1 + 0x20))(iParm1,iParm3);
    }
  }
  return;


}

void iSNDmulu64(int *piParm1,uint uParm2,uint uParm3)
{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = (uParm2 & 0xffff) * (uParm3 & 0xffff);
  uVar2 = (uParm2 & 0xffff) * (uParm3 >> 0x10);
  uVar3 = (uParm2 >> 0x10) * (uParm3 & 0xffff);
  *piParm1 = uVar1 + uVar2 * 0x10000 + uVar3 * 0x10000;
  piParm1[1] = (uVar2 >> 0x10) + (uVar3 >> 0x10) + (uParm2 >> 0x10) * (uParm3 >> 0x10) +
               ((uVar1 >> 0x10) + (uVar2 & 0xffff) + (uVar3 & 0xffff) >> 0x10);
  return;


}

int iSNDdivu64(uint uParm1,uint uParm2,uint uParm3)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = 0;
  iVar3 = 0x1f;
  do {
    iVar2 = iVar2 * 2;
    uParm2 = uParm2 * 2 + (uParm1 >> 0x1f);
    uParm1 = uParm1 << 1;
    if (uParm3 <= uParm2) {
      uParm2 = uParm2 - uParm3;
      iVar2 = iVar2 + 1;
    }
    bVar1 = iVar3 != 0;
    iVar3 = iVar3 + -1;
  } while (bVar1);
  return iVar2;


}

int iSNDstreamgetrequestptr(uint uParm1)
{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  if (-1 < (int)uParm1) {
    piVar1 = (int *)iSNDstreamgetstreamptr(uParm1 & 0xff);
    if (piVar1 == (int *)0x0) {
      return 0;
    }
    iVar3 = 0;
    if (0 < (int)((uint)*(byte *)((int)piVar1 + 0x16) << 0x18)) {
      iVar2 = *piVar1;
      do {
        if (*(uint *)(iVar2 + 4) == uParm1) {
          return iVar2;
        }
        iVar2 = iVar2 + 0x2c;
        iVar3 = iVar3 + 1;
      } while (iVar3 < (int)*(char *)((int)piVar1 + 0x16));
    }
  }
  return 0;


}

char * strrchr(char *__s,int __c)
{
  char *pcVar1;
  
                    
  pcVar1 = (char *)(*(code *)&LAB_000000a0)();
  return pcVar1;


}

int tolower(int __c)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

undefined4 SNDattributessetdef(undefined4 *puParm1)
{
  *puParm1 = 0xffffffff;
  *(undefined *)((int)puParm1 + 7) = 0x7f;
  *(undefined *)(puParm1 + 2) = 0x40;
  *(undefined *)((int)puParm1 + 6) = 0;
  *(undefined2 *)(puParm1 + 1) = 0;
  *(undefined *)((int)puParm1 + 9) = 0;
  *(undefined *)((int)puParm1 + 10) = 0;
  *(undefined *)((int)puParm1 + 0xb) = 0;
  return 0;


}

undefined4 iSNDpatchtohdr(int iParm1,undefined2 *puParm2,undefined4 *puParm3,undefined4 *puParm4)
{
  int iVar1;
  int local_28;
  int local_24;
  undefined4 local_20;
  undefined auStack28 [4];
  
  SNDattributessetdef(puParm3);
  local_28 = iParm1 + 8;
  if ((*(byte *)(iParm1 + 3) & 2) == 0) {
    local_28 = iParm1 + 4;
  }
  *puParm2 = 0x5622;
  *(undefined *)(puParm2 + 1) = 1;
  *(undefined *)((int)puParm2 + 3) = 5;
  *puParm4 = 0;
  while (iVar1 = iSNDgettag(&local_28,&local_24,&local_20,auStack28), iVar1 != 0) {
    if (local_24 == 0x80) {
      *(undefined *)((int)puParm3 + 0xb) = (undefined)local_20;
    }
    else {
      if (local_24 == 0x82) {
        *(undefined *)(puParm2 + 1) = (undefined)local_20;
      }
      else {
        if (local_24 == 0x84) {
          *puParm2 = (undefined2)local_20;
        }
        else {
          if (local_24 == 0x85) {
            *puParm4 = local_20;
          }
          else {
            if (local_24 == 0x13) {
              *(undefined *)((int)puParm3 + 9) = (undefined)local_20;
            }
            else {
              if (local_24 == 10) {
                *(undefined *)((int)puParm3 + 10) = (undefined)local_20;
              }
              else {
                if (local_24 == 5) {
                  *puParm3 = local_20;
                }
                else {
                  if (local_24 == 6) {
                    *(undefined *)((int)puParm3 + 6) = (undefined)local_20;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;


}

int memcmp(byte *pbParm1,byte *pbParm2,int iParm3)
{
  do {
    if (*pbParm1 != *pbParm2) {
      return (uint)*pbParm1 - (uint)*pbParm2;
    }
    iParm3 = iParm3 + -1;
    pbParm2 = pbParm2 + 1;
    pbParm1 = pbParm1 + 1;
  } while (0 < iParm3);
  return 0;


}

int FUN_80103750(byte *pbParm1,byte *pbParm2,int iParm3)
{
  do {
    if (*pbParm1 != *pbParm2) {
      return (uint)*pbParm1 - (uint)*pbParm2;
    }
    iParm3 = iParm3 + -1;
    pbParm2 = pbParm2 + 1;
    pbParm1 = pbParm1 + 1;
  } while (0 < iParm3);
  return 0;


}

void iSNDpacketgetirq(void)
{
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)(&DAT_80147e10 + _sndpp * 4);
  if ((int)*(char *)(iVar2 + 0x42) < 0) {
    return;
  }
  iVar1 = (int)*(char *)(iVar2 + 0x42) * 0x2c;
  if ((*(uint *)(&DAT_801479fc + iVar1) >> 0xc <= (uint)*(ushort *)(iVar2 + 0x40)) ||
     (*(int *)(iVar2 + 0xc) - (uint)*(ushort *)(iVar2 + 0x40) <=
      *(uint *)(&DAT_801479fc + iVar1) >> 0xc)) {
    if (*(uint *)(&DAT_801479fc + iVar1) >> 0xb < *(uint *)(iVar2 + 0xc)) {
      *(undefined4 *)(&DAT_80147a00 + iVar1) = *(undefined4 *)(&DAT_801479fc + iVar1);
      if (-1 < (int)((uint)(byte)(&DAT_80147a10)[iVar1] << 0x18)) {
        *(undefined4 *)(&DAT_80147a00 + (int)(char)(&DAT_80147a10)[iVar1] * 0x2c) =
             *(undefined4 *)(&DAT_801479fc + iVar1);
        return;
      }
    }
    else {
      *(undefined4 *)(&DAT_801479fc + iVar1) = 0;
      if (-1 < (int)((uint)(byte)(&DAT_80147a10)[iVar1] << 0x18)) {
        *(undefined4 *)(&DAT_801479fc + (int)(char)(&DAT_80147a10)[iVar1] * 0x2c) = 0;
      }
    }
  }
  return;


}

void iSNDpacketsetirq(void)
{
  int *piVar1;
  int iVar2;
  
  iSNDpsxdisablespuirq();
  iVar2 = 0;
  if (DAT_80147919 == '\0') {
    do {
      _sndpp = _sndpp + 1;
      if (0 < _sndpp) {
        _sndpp = 0;
      }
      piVar1 = *(int **)(&DAT_80147e10 + _sndpp * 4);
      if ((piVar1 != (int *)0x0) && (-1 < *(char *)((int)piVar1 + 0x42))) {
        *(undefined2 *)(_DAT_80147e2c + 0x1a4) = (short)(*piVar1 + 8 >> 3);
        InterruptCallback(9,iSNDpacketirqcallback);
        iSNDpsxenablespuirq();
        return;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 2);
  }
  return;


}

void iSNDpacketirqcallback(void)
{
  iSNDpacketgetirq();
  iSNDpacketsetirq();
  return;


}

void iSNDpsxzerospu(undefined4 *puParm1,int iParm2)
{
  int iVar1;
  
  iVar1 = 0;
  if (0 < iParm2 >> 2) {
    do {
      *puParm1 = 0x200;
      puParm1[1] = 0;
      puParm1[2] = 0;
      puParm1[3] = 0;
      iVar1 = iVar1 + 4;
      puParm1 = puParm1 + 4;
    } while (iVar1 < iParm2 >> 2);
  }
  return;


}

void iSNDpacketpurgeframes(int iParm1,uint uParm2,uint uParm3)
{
  ushort uVar1;
  int iVar2;
  ushort *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  
  iVar6 = *(int *)(&DAT_80147e10 + iParm1 * 4);
  iVar2 = (int)*(char *)(iVar6 + 0x42) * 0x2c;
  do {
    uVar1 = *(ushort *)(iVar6 + 0x46);
    uVar7 = uParm2 / (uint)uVar1;
    if (uVar1 == 0) {
      trap(0x1c00);
    }
    uVar5 = (uVar7 + 1) * (uint)uVar1 - uParm2;
    if ((int)uParm3 < (int)uVar5) {
      uVar5 = uParm3;
    }
    puVar3 = (ushort *)(uVar7 * 2 + *(int *)(iVar6 + 0x2c));
    uVar1 = *puVar3;
    uVar7 = uVar5;
    if ((int)(uint)uVar1 < (int)uVar5) {
      uVar7 = (uint)uVar1;
    }
    *puVar3 = uVar1 - (short)uVar7;
    if ((uVar7 != 0) && (iVar4 = 0, (&DAT_80147a0f)[iVar2] != '\0')) {
      do {
        iSNDpacketfreeframes(iParm1,iVar4,uVar7);
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)(uint)(byte)(&DAT_80147a0f)[iVar2]);
    }
    uParm2 = uParm2 + uVar5;
    uParm3 = uParm3 - uVar5;
    if (*(uint *)(iVar6 + 0xc) <= uParm2) {
      uParm2 = 0;
    }
  } while (0 < (int)uParm3);
  return;


}

void iSNDfillspuwithpackets(int iParm1,int iParm2)
{
  int *piVar1;
  short sVar2;
  ushort uVar3;
  undefined2 uVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  short *psVar8;
  uint uVar9;
  int iVar10;
  int *piVar11;
  int local_30 [2];
  
  piVar11 = *(int **)(&DAT_80147e10 + iParm1 * 4);
  iVar5 = (int)*(char *)((int)piVar11 + 0x42) * 0x2c;
  if (*(short *)(piVar11 + 0xf) == 0) {
    *(undefined2 *)((int)piVar11 + 0x3e) = 0;
    *(undefined2 *)(piVar11 + 0xf) = *(undefined2 *)(piVar11 + 0x11);
    *(undefined2 *)(iParm2 * 2 + piVar11[0xb]) = 0;
  }
  if (piVar11[5] == 0) {
    iVar10 = 0;
    piVar7 = piVar11;
    if ((&DAT_80147a0f)[iVar5] != '\0') {
      do {
        iSNDpsxzerospu(piVar7[0x12],0x10);
        iVar10 = iVar10 + 1;
        piVar7 = piVar7 + 1;
      } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
    }
    *(short *)((int)piVar11 + 0x3e) = *(short *)((int)piVar11 + 0x3e) + 0x10;
    *(short *)(piVar11 + 0xf) = *(short *)(piVar11 + 0xf) + -0x10;
  }
  sVar2 = *(short *)(piVar11 + 0xf);
  do {
    if (sVar2 == 0) goto LAB_80103ec0;
    uVar3 = *(ushort *)(piVar11 + 0xd);
    if (uVar3 == 0) {
      iVar10 = 0;
      piVar7 = piVar11;
      if ((&DAT_80147a0f)[iVar5] != '\0') {
        do {
          iVar6 = iSNDpacketget(iParm1,iVar10,local_30);
          piVar7[9] = iVar6;
          iVar10 = iVar10 + 1;
          piVar7 = piVar7 + 1;
        } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
      }
      if (piVar11[9] == 0) {
        if ((int)(uint)*(ushort *)(piVar11 + 0x10) < piVar11[5] - piVar11[6]) {
          return;
        }
        if (*(ushort *)(piVar11 + 0xe) < *(ushort *)((int)piVar11 + 0x36)) goto LAB_80103fe4;
        if (*(ushort *)((int)piVar11 + 0x36) < 2) {
          iVar10 = 0;
          piVar7 = piVar11;
          if ((&DAT_80147a0f)[iVar5] != '\0') {
            do {
              piVar1 = piVar7 + 0x12;
              piVar7 = piVar7 + 1;
              iSNDpsxzerospu(*piVar1 + (uint)*(ushort *)((int)piVar11 + 0x3e),
                             (uint)*(ushort *)(piVar11 + 0xf));
              iVar10 = iVar10 + 1;
            } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
          }
        }
        else {
          iVar10 = 0;
          piVar7 = piVar11;
          if ((&DAT_80147a0f)[iVar5] != '\0') {
            do {
              *(undefined *)(piVar7[0x12] + 1) = 2;
              iVar10 = iVar10 + 1;
              *(undefined *)((uint)*(ushort *)(piVar11 + 0x11) + piVar7[0x12] + -0xf) = 2;
              piVar7 = piVar7 + 1;
            } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
          }
        }
        if (*(short *)((int)piVar11 + 0x3e) == 0) {
          *(short *)((int)piVar11 + 0x36) = *(short *)((int)piVar11 + 0x36) + 1;
        }
        *(undefined2 *)(piVar11 + 0xf) = 0;
LAB_80103ec0:
        if (iParm2 == 0) {
          iVar10 = 0;
          piVar7 = piVar11;
          if ((&DAT_80147a0f)[iVar5] != '\0') {
            do {
              piVar1 = piVar7 + 0x12;
              piVar7 = piVar7 + 1;
              *(byte *)(*piVar1 + 1) = *(byte *)(*piVar1 + 1) | 4;
              iVar10 = iVar10 + 1;
            } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
          }
        }
        else {
          if ((iParm2 == (uint)*(ushort *)(piVar11 + 0xe) - 1) &&
             (iVar10 = 0, piVar7 = piVar11, (&DAT_80147a0f)[iVar5] != '\0')) {
            do {
              *(byte *)((uint)*(ushort *)(piVar11 + 0x11) + piVar7[0x12] + -0xf) =
                   *(byte *)((uint)*(ushort *)(piVar11 + 0x11) + piVar7[0x12] + -0xf) | 1;
              iVar10 = iVar10 + 1;
              piVar7 = piVar7 + 1;
            } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
          }
        }
        iVar10 = 0;
        piVar7 = piVar11;
        if ((&DAT_80147a0f)[iVar5] != '\0') {
          do {
            uVar9 = 0;
            if (iParm2 == 0) {
              uVar9 = (uint)(iVar10 == 0);
            }
            iVar6 = iSNDdmqueue(piVar7[0x12],
                                *piVar11 + (iParm2 << ((uint)*(byte *)((int)piVar11 + 0x43) & 0x1f))
                                + piVar11[2] * iVar10,(uint)*(ushort *)(piVar11 + 0x11),2,uVar9);
            piVar11[8] = iVar6;
            iVar10 = iVar10 + 1;
            piVar7 = piVar7 + 1;
          } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
        }
LAB_80103fe4:
        *(undefined2 *)((int)piVar11 + 0x3a) = (short)iParm2;
        piVar11[5] = piVar11[5] + (uint)*(ushort *)((int)piVar11 + 0x46);
        return;
      }
      *(undefined2 *)((int)piVar11 + 0x36) = 0;
      *(undefined2 *)((int)piVar11 + 0x32) = 0;
      uVar4 = (undefined2)((local_30[0] * 4) / 7);
      *(undefined2 *)(piVar11 + 0xd) = uVar4;
      *(undefined2 *)(piVar11 + 0xc) = uVar4;
      uVar3 = *(ushort *)(piVar11 + 0xd);
    }
    if (uVar3 < *(ushort *)(piVar11 + 0xf)) {
      uVar3 = *(ushort *)(piVar11 + 0xd);
    }
    else {
      uVar3 = *(ushort *)(piVar11 + 0xf);
    }
    psVar8 = (short *)(iParm2 * 2 + piVar11[0xb]);
    *psVar8 = *psVar8 + (short)((int)((uint)uVar3 * 7) >> 2);
    iVar10 = 0;
    piVar7 = piVar11;
    if ((&DAT_80147a0f)[iVar5] != '\0') {
      do {
        blockmove(piVar11[9] + (uint)*(ushort *)((int)piVar11 + 0x32) +
                  (uint)*(ushort *)(piVar11 + 0xc) * iVar10,
                  piVar7[0x12] + (uint)*(ushort *)((int)piVar11 + 0x3e),(uint)uVar3);
        iVar10 = iVar10 + 1;
        piVar7 = piVar7 + 1;
      } while (iVar10 < (int)(uint)(byte)(&DAT_80147a0f)[iVar5]);
    }
    *(short *)((int)piVar11 + 0x3e) = *(short *)((int)piVar11 + 0x3e) + uVar3;
    *(short *)((int)piVar11 + 0x32) = *(short *)((int)piVar11 + 0x32) + uVar3;
    *(ushort *)(piVar11 + 0xf) = *(short *)(piVar11 + 0xf) - uVar3;
    sVar2 = *(short *)(piVar11 + 0xf);
    *(ushort *)(piVar11 + 0xd) = *(short *)(piVar11 + 0xd) - uVar3;
  } while( true );


}

void iSNDpacketserve(void)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iSNDstreamhotroddatachunks();
  iVar5 = 0;
  iVar1 = 0;
  do {
    iVar1 = *(int *)(&DAT_80147e10 + iVar1);
    if ((iVar1 != 0) && (-1 < (int)*(char *)(iVar1 + 0x42))) {
      iVar3 = *(int *)(iVar1 + 0x1c);
      iVar4 = ((int)(*(uint *)(&DAT_801479fc + (int)*(char *)(iVar1 + 0x42) * 0x2c) >> 0xc) / 0x1c)
              * 0x1c;
      if (iVar4 < iVar3) {
        iVar3 = (iVar4 + *(int *)(iVar1 + 0xc)) - iVar3;
      }
      else {
        iVar3 = iVar4 - iVar3;
      }
      if (0x70ffffff < *(int *)(iVar1 + 0x18)) {
        *(int *)(iVar1 + 0x18) = *(int *)(iVar1 + 0x18) + -0x70000000;
        *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + -0x70000000;
      }
      *(int *)(iVar1 + 0x18) = *(int *)(iVar1 + 0x18) + iVar3;
      iSNDpacketpurgeframes(iVar5,*(undefined4 *)(iVar1 + 0x1c));
      *(int *)(iVar1 + 0x1c) = iVar4;
      if ((*(int *)(iVar1 + 0x14) - *(int *)(iVar1 + 0x18) < *(int *)(iVar1 + 0x10)) &&
         (iVar3 = iSNDdmcomplete(*(undefined4 *)(iVar1 + 0x20)), iVar3 != 0)) {
        uVar2 = (uint)*(ushort *)(iVar1 + 0x3a) + 1;
        if ((uint)*(ushort *)(iVar1 + 0x38) <= uVar2) {
          uVar2 = uVar2 - (uint)*(ushort *)(iVar1 + 0x38);
        }
        iSNDfillspuwithpackets(iVar5,uVar2);
      }
    }
    iVar5 = iVar5 + 1;
    iVar1 = iVar5 * 4;
  } while (iVar5 < 1);
  return;


}

int iSNDplatformpacketoverhead(void)
{
  int iVar1;
  
  iVar1 = DAT_801234e4;
  if (DAT_801234e4 < 0) {
    iVar1 = DAT_801234e4 + 0xfff;
  }
  return ((iVar1 >> 0xc) + 3U & 0xfffffffc) * 2 + 0x1050;


}

int iSNDplatformcalcdatarate(ushort *puParm1)
{
  return (int)((uint)*puParm1 * (uint)*(byte *)(puParm1 + 1) * 0x92) >> 8;


}

undefined4 iSNDplatformpacketplaycreate(int iParm1,int *piParm2)
{
  int iVar1;
  undefined4 uVar2;
  
  _DAT_8014803c = iSNDpsxpacketstop;
  *(undefined *)((int)piParm2 + 0x42) = 0xff;
  *(int **)(piParm2 + 0xb) = piParm2 + 0x414;
  iVar1 = iSNDpsxmalloc(DAT_801234e4);
  *piParm2 = iVar1;
  piParm2[1] = DAT_801234e4;
  if (*piParm2 == 0) {
    uVar2 = 0xfffffff7;
  }
  else {
    *(int **)(&DAT_80147e10 + iParm1 * 4) = piParm2;
    uVar2 = 0;
  }
  return uVar2;


}

void iSNDplatformpacketplaydestroy(int iParm1)
{
  iSNDpsxfree(**(undefined4 **)(&DAT_80147e10 + iParm1 * 4));
  *(undefined4 *)(&DAT_80147e10 + iParm1 * 4) = 0;
  return;


}

undefined4 iSNDplatformpacketplay( (int param_1,int param_2,undefined2 param_3,undefined param_4,undefined4 param_5, undefined4 param_6,undefined param_7,ushort *param_8)
{
  byte bVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  iVar2 = param_2 * 0x2c;
  puVar4 = *(undefined4 **)(&DAT_80147e10 + param_1 * 4);
  (&DAT_80147a11)[iVar2] = 0;
  (&DAT_80147a10)[iVar2] = 0xff;
  *(undefined *)(iVar2 + -0x7feb85f2) = 0;
  (&DAT_80147a0f)[iVar2] = *(undefined *)(param_8 + 1);
  *(undefined4 *)(iVar2 + -0x7feb860c) = 0;
  *(undefined2 *)(iVar2 + -0x7feb85f8) = param_3;
  *(undefined *)(iVar2 + -0x7feb85ee) = param_4;
  *(undefined *)(iVar2 + -0x7feb85ed) = param_7;
  *(undefined4 *)(iVar2 + -0x7feb8610) = *puVar4;
  (&DAT_80147a17)[iVar2] = (char)param_1;
  bVar1 = (&DAT_80147a0f)[iVar2];
  uVar5 = 0x1000 / (int)(uint)bVar1;
  if (bVar1 == 0) {
    trap(0x1c00);
  }
  if (((uint)bVar1 == 0xffffffff) && (false)) {
    trap(0x1800);
  }
  *(short *)(puVar4 + 0x11) = (short)uVar5;
  iVar3 = (uVar5 & 0xffff) * 0x1c;
  if (false) {
    iVar3 = iVar3 + 0xf;
  }
  *(undefined2 *)((int)puVar4 + 0x46) = (short)(iVar3 >> 4);
  bVar1 = (&DAT_80147a0f)[iVar2];
  *(undefined4 **)(puVar4 + 0x12) = puVar4 + 0x14;
  *(undefined *)((int)puVar4 + 0x43) = (char)(0xd - (uint)bVar1);
  puVar4[0x13] = (int)puVar4 + (uint)*(ushort *)(puVar4 + 0x11) + 0x50;
  uVar5 = (int)puVar4[1] >> (0xd - (uint)bVar1 & 0x1f);
  *(short *)(puVar4 + 0xe) = (short)uVar5;
  uVar5 = uVar5 & 0xffff;
  bVar1 = (&DAT_80147a0f)[iVar2];
  uVar6 = (int)uVar5 / (int)(uint)bVar1;
  if (bVar1 == 0) {
    trap(0x1c00);
  }
  if (((uint)bVar1 == 0xffffffff) && (uVar5 == 0x80000000)) {
    trap(0x1800);
  }
  *(short *)(puVar4 + 0xe) = (short)uVar6;
  iVar7 = (uVar6 & 0xffff) * (uint)*(ushort *)((int)puVar4 + 0x46);
  *(undefined2 *)(puVar4 + 0x10) = *(undefined2 *)((int)puVar4 + 0x46);
  iVar3 = 0;
  *(undefined *)((int)puVar4 + 0x42) = (char)param_2;
  *(undefined2 *)((int)puVar4 + 0x36) = 0;
  *(undefined2 *)(puVar4 + 0xc) = 0;
  *(undefined2 *)(puVar4 + 0xd) = 0;
  *(undefined2 *)((int)puVar4 + 0x32) = 0;
  *(undefined2 *)(puVar4 + 0xf) = 0;
  puVar4[9] = 0;
  puVar4[8] = 0;
  puVar4[7] = 0;
  puVar4[6] = 0;
  puVar4[5] = 0;
  puVar4[2] = (uint)*(ushort *)(puVar4 + 0xe) << ((uint)*(byte *)((int)puVar4 + 0x43) & 0x1f);
  puVar4[3] = iVar7;
  puVar4[4] = iVar7 - (uint)*(ushort *)((int)puVar4 + 0x46);
  do {
    do {
      iVar7 = iSNDdmcomplete(puVar4[8]);
    } while (iVar7 == 0);
    iSNDfillspuwithpackets(param_1,iVar3);
    iVar3 = iVar3 + 1;
  } while (iVar3 < 2);
  _DAT_80148038 = iSNDpacketserve;
  _DAT_80148040 = iSNDpacketsetirq;
  *(undefined4 *)(&DAT_801479fc + iVar2) = 0;
  *(undefined4 *)(&DAT_80147a00 + iVar2) = 0;
  *(undefined4 *)(&DAT_80147a04 + iVar2) = puVar4[3] << 0xc;
  *(undefined2 *)(iVar2 + -0x7feb85f6) = (short)((uint)*param_8 * 0x17c7 >> 0x10);
  if (1 < (byte)(&DAT_80147a0f)[iVar2]) {
    (&DAT_80147a10)[iVar2] = *(undefined *)(param_2 * 100 + _DAT_801478f4 + 4);
    (&DAT_80147a11)[(int)(char)(&DAT_80147a10)[iVar2] * 0x2c] = 1;
    *(undefined4 *)(&DAT_801479fc + (int)(char)(&DAT_80147a10)[iVar2] * 0x2c) = 0;
    *(undefined4 *)(&DAT_80147a00 + (int)(char)(&DAT_80147a10)[iVar2] * 0x2c) = 0;
    *(undefined4 *)(&DAT_80147a04 + (int)(char)(&DAT_80147a10)[iVar2] * 0x2c) =
         *(undefined4 *)(&DAT_80147a04 + iVar2);
  }
  iSNDplatformpitch(param_2,param_5);
  uVar5 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iSNDpacketsetirq();
  setCopReg(0,Status,uVar5,0);
  (&DAT_80147a0c)[iVar2] = 1;
  return 0;


}

void iSNDpsxpacketstop(int iParm1)
{
  uint uVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  
  uVar1 = Status;
  iVar4 = 0;
  puVar2 = &sndpd;
  *(undefined *)
   (*(int *)(&DAT_80147e10 + ((int)((uint)*(byte *)(iParm1 + 0x27) << 0x18) >> 0x16)) + 0x42) = 0xff
  ;
  *(undefined *)(iParm1 + 0x27) = 0xff;
  iVar3 = 0;
  if (DAT_80147871 != 0) {
    do {
      if (-1 < (int)((uint)(byte)puVar2[0xff] << 0x18)) {
        iVar3 = iVar3 + 1;
      }
      iVar4 = iVar4 + 1;
      puVar2 = puVar2 + 0x2c;
    } while (iVar4 < (int)(uint)DAT_80147871);
  }
  if (iVar3 == 0) {
    _DAT_80148038 = 0;
    _DAT_80148040 = iSNDpacketsetirq;
  }
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  iSNDpacketsetirq();
  setCopReg(0,Status,uVar1,0);
  return;


}

void iSNDserveraddclient(undefined4 uParm1)
{
  *(undefined4 *)(&DAT_801478c4 + (int)DAT_801478a1 * 4) = uParm1;
  DAT_801478a1 = DAT_801478a1 + '\x01';
  return;


}

void iSNDserverremoveclient(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  if ('\0' < DAT_801478a1) {
    iVar1 = 0;
    while (*(int *)(&DAT_801478c4 + iVar1) != iParm1) {
      iVar2 = iVar2 + 1;
      iVar1 = iVar2 * 4;
      if ((int)DAT_801478a1 <= iVar2) {
        return;
      }
    }
    DAT_801478a1 = DAT_801478a1 + -1;
    if (iVar2 < (int)DAT_801478a1) {
      do {
        iVar1 = iVar2 * 4;
        iVar2 = iVar2 + 1;
        *(undefined4 *)(&DAT_801478c4 + iVar1) = *(undefined4 *)(&DAT_801478c4 + iVar2 * 4);
      } while (iVar2 < (int)DAT_801478a1);
    }
  }
  return;


}

void SNDSYS_service(void)
{
  code **ppcVar1;
  int iVar2;
  undefined *puVar3;
  
  puVar3 = &sndgs;
  iVar2 = 0;
  if ('\0' < DAT_801478a1) {
    do {
      ppcVar1 = (code **)(puVar3 + 100);
      puVar3 = puVar3 + 4;
      (**ppcVar1)();
      iVar2 = iVar2 + 1;
    } while (iVar2 < (int)DAT_801478a1);
  }
  return;


}

uint * _dbl_shift_us(uint *param_1,int param_2,uint param_3,uint param_4,int param_5)
{
  int iVar1;
  uint local_res8;
  uint local_resc;
  
  if (param_2 == 0) {
    iVar1 = 0;
    local_res8 = param_3;
    local_resc = param_4;
    if (0 < param_5) {
      do {
        local_resc = local_resc << 1;
        if ((local_res8 & 0x80000000) != 0) {
          local_resc = local_resc | 1;
        }
        local_res8 = local_res8 << 1;
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_5);
    }
  }
  else {
    iVar1 = 0;
    local_res8 = param_3;
    local_resc = param_4;
    if (0 < param_5) {
      do {
        local_res8 = local_res8 >> 1;
        if ((local_resc & 1) != 0) {
          local_res8 = local_res8 | 0x80000000;
        }
        local_resc = local_resc >> 1;
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_5);
    }
  }
  *param_1 = local_res8;
  param_1[1] = local_resc;
  return param_1;


}

uint iSNDtimeremaining(int iParm1)
{
  iParm1 = iParm1 * 0x2c;
  if (*(int *)(&DAT_801479f8 + iParm1) != 0) {
    if (*(uint *)(&DAT_801479f8 + iParm1) == 0) {
      trap(0x1c00);
    }
    return (uint)(*(int *)(&DAT_80147a04 + iParm1) - *(int *)(&DAT_801479fc + iParm1)) /
           *(uint *)(&DAT_801479f8 + iParm1);
  }
  return 0x7fffffff;


}

void GPU_cw(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void _padSetVsyncParam(void)
{
  _DAT_8014857c = 0;
  _DAT_80148580 = FUN_80104ab0;
  _DAT_80148584 = FUN_80104a48;
  _DAT_80148588 = 0;
  return;


}

undefined4 FUN_80104a48(void)
{
  undefined4 uVar1;
  
  uVar1 = 0;
  if (((_DAT_1f801074 & 1) != 0) && (uVar1 = 0, (_DAT_1f801070 & 1) != 0)) {
    if (false) {
      (*(code *)0x0)();
    }
    uVar1 = 1;
  }
  return uVar1;


}

undefined4 FUN_80104ab0(void)
{
  int iVar1;
  
  DAT_80137ce0 = 1;
  if ((false) && (_DAT_8014858c < 0x96)) {
    _DAT_8014858c = _DAT_8014858c + 1;
  }
  if ((false) && (_DAT_80148590 < 0x96)) {
    _DAT_80148590 = _DAT_80148590 + 1;
  }
  if ((_padIntExec != 0) && (true)) {
    _padSioState = 0;
    _padSioChan = 0;
    iVar1 = _padInitSioMode(_padInfoDir);
    if (iVar1 == 0) {
      (*_padFuncNextPort)(0xffff);
    }
    _padTotalCurr = 0;
    while (_padSioChan < 2) {
      FUN_80105060(_padInfoDir + _padSioChan * 0xf0);
    }
    _DAT_1f80104e = 0x88;
  }
  return 0;


}

void _padStartCom(void)
{
  _padIntExec = 0;
  EnterCriticalSection();
  SysDeqIntRP(2,&DAT_8014857c);
  SysEnqIntRP(2,&DAT_8014857c);
  _DAT_1f801070 = 0xfffffffe;
  _DAT_1f801074 = _DAT_1f801074 | 1;
  ChangeClearRCnt(3,0);
  ExitCriticalSection();
  (*_padFuncClrInfo)(_padInfoDir);
  (*_padFuncClrInfo)(_padInfoDir + 0xf0);
  _padIntExec = 1;
  _DAT_8014858c = 0;
  _DAT_80148590 = 0;
  return;


}

void _padStopCom(void)
{
  EnterCriticalSection();
  ChangeClearRCnt(3,1);
  SysDeqIntRP(2,&DAT_8014857c);
  ExitCriticalSection();
  return;


}

undefined4 _padInitSioMode(int iParm1)
{
  code *pcVar1;
  int iVar2;
  undefined4 uVar3;
  
  _DAT_1f80104a = 0;
  _DAT_1f801048 = 0xd;
  _DAT_1f80104e = 0x88;
  uVar3 = 0x91;
  if (*(char *)(iParm1 + 0xe8) == '\b') {
    uVar3 = 0x50;
  }
  setRC2wait(uVar3);
  _DAT_1f80104a = 0x1003;
  if (_padSioChan != 0) {
    _DAT_1f80104a = 0x3003;
  }
  iVar2 = *(int *)(&_padFixResult + _padSioChan * 4);
  pcVar1 = _padFuncRecvAuto;
  if (-1 < iVar2) {
    while (0 < iVar2) {
      iVar2 = *(int *)(&_padFixResult + _padSioChan * 4) + -1;
      _padFuncRecvAuto = pcVar1;
      *(int *)(&_padFixResult + _padSioChan * 4) = iVar2;
      (*_padFuncRecvAuto)(*(int *)(iParm1 + 0xc) + iVar2 * 0xf0);
      iVar2 = *(int *)(&_padFixResult + _padSioChan * 4);
      pcVar1 = _padFuncRecvAuto;
    }
    _padFuncRecvAuto = pcVar1;
    if (*(int *)(&_padFixResult + _padSioChan * 4) == 0) {
      _padFuncRecvAuto = pcVar1;
      *(int *)(&_padFixResult + _padSioChan * 4) = -1;
      (*pcVar1)(iParm1);
      (*_padFuncClrCmdNo)(iParm1);
    }
  }
  if ((_DAT_1f801044 & 0x200) != 0) {
    _DAT_1f80104a = _DAT_1f80104a | 0x10;
    if ((_DAT_1f801044 & 0x200) != 0) {
      do {
        iVar2 = chkRC2wait();
      } while (iVar2 == 0);
      DAT_1f801040 = 1;
      setRC2wait(100);
      iVar2 = _padClrIntSio0();
      if (iVar2 == 0) {
        return 0;
      }
      _padWaitRXready();
      setRC2wait(0x1ae);
      do {
        if ((_DAT_1f801070 & 0x80) != 0) {
          DAT_1f801040 = 0x42;
          setRC2wait();
          iVar2 = _padClrIntSio0();
          if (iVar2 == 0) {
            return 0;
          }
          _padWaitRXready();
          setRC2wait(0x1ae);
          do {
            if ((_DAT_1f801070 & 0x80) != 0) {
              DAT_1f801040 = 1;
              setRC2wait();
              iVar2 = _padClrIntSio0();
              if (iVar2 == 0) {
                return 0;
              }
              _padWaitRXready();
              return 0;
            }
            iVar2 = chkRC2wait(0x3c);
          } while (iVar2 == 0);
          return 0;
        }
        iVar2 = chkRC2wait(0x3c);
      } while (iVar2 == 0);
      return 0;
    }
    _DAT_1f801070 = 0xffffff7f;
  }
  if (*(char *)(iParm1 + 0x50) == '\0') {
    return 1;
  }
  if (*(char *)(iParm1 + 0x36) != '\0') {
    return 0;
  }
  return 1;


}

void FUN_80105060(void)
{
  code **ppcVar1;
  int iVar2;
  
  ppcVar1 = (code **)(&padIntFunc + _padSioState);
  _padSioState = _padSioState + 1;
  iVar2 = (**ppcVar1)();
  if (iVar2 < 0) {
    (*_padFuncNextPort)();
  }
  else {
    if (_padSioState != 0) {
      setRC2wait(0x3c);
      iVar2 = _padClrIntSio0();
      if (iVar2 == 0) {
        (*_padFuncNextPort)(0xfffffffd);
      }
    }
    if (4 < _padSioState) {
      _padSioState = _padSioState + -1;
    }
  }
  return;


}

uint _padSioRW(int iParm1,int iParm2)
{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  uint uVar5;
  
  bVar2 = DAT_1f801040;
  bVar1 = (byte)iParm2;
  if (iParm2 < 0) {
    *(undefined *)(iParm1 + 0x44) = 0xff;
    *(undefined *)(iParm1 + 0x45) = 1;
    **(byte **)(iParm1 + 0x40) = ~bVar1;
    do {
    } while ((_DAT_1f801044 & 1) == 0);
    do {
      iVar4 = chkRC2wait();
      bVar3 = ~bVar1;
    } while (iVar4 == 0);
  }
  else {
    _DAT_1f80104e = 0x88;
    if (((int)(uint)**(byte **)(iParm1 + 0x3c) >> 4 == 8) &&
       (_DAT_1f80104e = 0x88, 8 < *(byte *)(iParm1 + 0x44))) {
      _DAT_1f80104e = 0x22;
    }
    __startTime = (uint)_DAT_1f801120;
    __waitTime = 0x1ae;
    do {
    } while ((_DAT_1f801044 & 2) == 0);
    uVar5 = _DAT_1f801070 & 0x80;
    while (uVar5 == 0) {
      iVar4 = chkRC2wait();
      if (iVar4 != 0) {
        return 0xffffffec;
      }
      uVar5 = _DAT_1f801070 & 0x80;
    }
    DAT_1f801040 = bVar1;
    *(char *)(iParm1 + 0x45) = *(char *)(iParm1 + 0x45) + '\x01';
    *(byte *)(*(int *)(iParm1 + 0x3c) + (uint)*(byte *)(iParm1 + 0x44)) = bVar2;
    *(char *)(iParm1 + 0x44) = *(char *)(iParm1 + 0x44) + '\x01';
    bVar3 = DAT_1f801040;
  }
  DAT_1f801040 = bVar3;
  return (uint)bVar2;


}

uint _padSioRW2(int iParm1,undefined uParm2)
{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined2 uVar5;
  
  uVar5 = 0x88;
  if (((int)(uint)**(byte **)(iParm1 + 0x3c) >> 4 == 8) && (8 < *(byte *)(iParm1 + 0x44))) {
    uVar5 = 0x22;
  }
  do {
  } while ((_DAT_1f801044 & 2) == 0);
  setRC2wait(400);
  bVar1 = DAT_1f801040;
  uVar2 = (uint)DAT_1f801040;
  _DAT_1f80104e = uVar5;
  if ((*(char *)(iParm1 + 0x44) == '\0') && (_DAT_1f80104e = uVar5, (int)uVar2 >> 4 == 8)) {
    _DAT_1f80104e = 0x22;
  }
  do {
    if ((_DAT_1f801070 & 0x80) != 0) {
      if ((*(char *)(iParm1 + 0xe8) != '\b') && (_padSioState == 2)) {
        setRC2wait(0x3c);
        do {
          iVar4 = chkRC2wait();
        } while (iVar4 == 0);
      }
      DAT_1f801040 = uParm2;
      *(char *)(iParm1 + 0x45) = *(char *)(iParm1 + 0x45) + '\x01';
      if (*(char *)(iParm1 + 0x44) != -1) {
        *(byte *)(*(int *)(iParm1 + 0x3c) + (uint)*(byte *)(iParm1 + 0x44)) = bVar1;
      }
      *(char *)(iParm1 + 0x44) = *(char *)(iParm1 + 0x44) + '\x01';
      return uVar2;
    }
    uVar3 = (uint)_DAT_1f801120;
    if (uVar3 < __startTime) {
      if (_DAT_1f801128 == 0) {
        uVar3 = uVar3 + 0x10000;
      }
      else {
        uVar3 = (uint)_DAT_1f801128 + uVar3;
      }
    }
    uVar3 = uVar3 - __startTime;
    if ((_DAT_1f801124 & 0x200) == 0) {
      uVar3 = uVar3 >> 3;
    }
  } while (uVar3 < __waitTime);
  return 0xfffffffe;


}

undefined4 _padClrIntSio0(void)
{
  ushort uVar1;
  int iVar2;
  
  _DAT_1f801070 = 0xffffff7f;
  uVar1 = _DAT_1f801044 & 0x80;
  while( true ) {
    if (uVar1 == 0) {
      _DAT_1f80104a = _DAT_1f80104a | 0x10;
      return 1;
    }
    iVar2 = chkRC2wait();
    if (iVar2 != 0) break;
    uVar1 = _DAT_1f801044 & 0x80;
  }
  return 0;


}

void _padWaitRXready(void)
{
  do {
  } while ((_DAT_1f801044 & 2) == 0);
  return;


}

void _padSetAct(int iParm1,undefined4 uParm2,undefined uParm3)
{
  *(undefined4 *)(iParm1 + 0x28) = uParm2;
  *(undefined *)(iParm1 + 0x34) = uParm3;
  return;


}

void _padSendAtLoadInfo(int iParm1)
{
  byte bVar1;
  
  bVar1 = *(byte *)(iParm1 + 0x46);
  if (bVar1 == 3) {
    FUN_80105ec0(iParm1,(uint)*(byte *)(iParm1 + 0xe4));
  }
  else {
    if (bVar1 < 4) {
      if (bVar1 == 2) {
        FUN_80105eac();
      }
    }
    else {
      if (bVar1 == 4) {
        FUN_80105f00(iParm1,(uint)*(byte *)(iParm1 + 0x47));
      }
    }
  }
  return;


}

undefined4 _padRecvAtLoadInfo(int iParm1)
{
  byte bVar1;
  undefined uVar2;
  byte bVar3;
  int iVar4;
  
  bVar1 = *(byte *)(iParm1 + 0x46);
  if (bVar1 == 3) {
    bVar1 = *(byte *)(*(int *)(iParm1 + 0x3c) + 4);
    bVar3 = *(byte *)(*(int *)(iParm1 + 0x3c) + 5);
    *(undefined *)(iParm1 + 0x47) = 0;
    *(short *)(iParm1 + 0xe6) = (ushort)bVar3 + (ushort)bVar1 * 0x100;
  }
  else {
    if (3 < bVar1) {
      if (bVar1 != 4) {
        return 1;
      }
      bVar3 = *(char *)(iParm1 + 0x47) + 1;
      bVar1 = *(byte *)(*(int *)(iParm1 + 0x3c) + 4);
      *(byte *)(iParm1 + 0x47) = bVar3;
      *(int *)(iParm1 + 0xec) = *(int *)(iParm1 + 0xec) + 8 + ((uint)bVar1 + 3 & 0x1fc);
      if (*(byte *)(iParm1 + 0xea) <= bVar3) {
        iVar4 = _padGetActSize(iParm1);
        if (iVar4 < 0x81) {
          *(undefined *)(iParm1 + 0x46) = 0xff;
          _padLoadActInfo(iParm1,iParm1 + 99);
          *(undefined *)(iParm1 + 0x46) = 2;
        }
        else {
          *(undefined *)(iParm1 + 0x46) = 0xfe;
          *(undefined *)(iParm1 + 0x49) = 2;
        }
      }
      return 0;
    }
    if (bVar1 != 2) {
      return 1;
    }
    *(undefined *)(iParm1 + 0xe3) = *(undefined *)(*(int *)(iParm1 + 0x3c) + 3);
    uVar2 = *(undefined *)(*(int *)(iParm1 + 0x3c) + 4);
    *(undefined2 *)(iParm1 + 0xe6) = 0;
    *(undefined *)(iParm1 + 0xe4) = uVar2;
    *(undefined *)(iParm1 + 0xe9) = *(undefined *)(*(int *)(iParm1 + 0x3c) + 5);
    uVar2 = *(undefined *)(*(int *)(iParm1 + 0x3c) + 6);
    *(undefined4 *)(iParm1 + 0xec) = 0;
    *(undefined *)(iParm1 + 0xea) = uVar2;
  }
  return 1;


}

int _padGetActSize(int iParm1)
{
  return ((int)((uint)*(byte *)(iParm1 + 0xe3) + 1) >> 1) * 4 +
         ((uint)*(byte *)(iParm1 + 0xe9) * 5 + 3 & 0xffc) + 4 + *(int *)(iParm1 + 0xec);


}

undefined4 _padLoadActInfo(int *piParm1,int iParm2)
{
  int iVar1;
  
  if (iParm2 != 0) {
    if (piParm1[1] != 0) {
      return 0;
    }
    iVar1 = (*_padFuncChkEng)();
    if (iVar1 == 0) {
      *(undefined *)((int)piParm1 + 0x49) = 4;
      *(undefined *)((int)piParm1 + 0x46) = 1;
      piParm1[5] = -0x7fefa728;
      piParm1[6] = -0x7fefa680;
      iVar1 = (iParm2 + 3 >> 2) * 4;
      *piParm1 = iVar1;
      *(undefined *)((int)piParm1 + 0x47) = 0;
      iVar1 = iVar1 + ((int)((uint)*(byte *)((int)piParm1 + 0xe3) + 1) >> 1) * 4;
      piParm1[1] = iVar1;
      piParm1[2] = iVar1 + ((uint)*(byte *)((int)piParm1 + 0xe9) * 5 + 3 & 0xffc);
      return 1;
    }
  }
  return 0;


}

void FUN_801058d8(int iParm1)
{
  byte bVar1;
  
  bVar1 = *(byte *)(iParm1 + 0x46);
  if (bVar1 == 3) {
    FUN_80105ee0(iParm1,(uint)*(byte *)(iParm1 + 0x47));
  }
  else {
    if (bVar1 < 4) {
      if (bVar1 == 2) {
        FUN_80105ec0(iParm1,(uint)*(byte *)(iParm1 + 0x47));
      }
    }
    else {
      if (bVar1 == 4) {
        if (*(char *)(iParm1 + 0x48) == '\0') {
          FUN_80105f00(iParm1,(uint)*(byte *)(iParm1 + 0x47));
        }
        else {
          FUN_80105f20();
        }
      }
    }
  }
  return;


}

uint _padSetActAlign(int iParm1,undefined4 uParm2)
{
  int iVar1;
  
  iVar1 = (*_padFuncChkEng)();
  if (iVar1 == 0) {
    *(undefined *)(iParm1 + 0x46) = 1;
    *(undefined4 *)(iParm1 + 0x14) = 0x80105c5c;
    *(undefined4 *)(iParm1 + 0x20) = uParm2;
    *(undefined4 *)(iParm1 + 0x18) = 0x80105c78;
  }
  return (uint)(iVar1 == 0);


}

uint _padSetMainMode(int iParm1,char cParm2,undefined uParm3)
{
  int iVar1;
  
  iVar1 = (*_padFuncChkEng)();
  if (iVar1 == 0) {
    *(undefined *)(iParm1 + 0x46) = 1;
    *(undefined4 *)(iParm1 + 0x14) = 0x80105dd8;
    *(undefined4 *)(iParm1 + 0x18) = 0x80105e2c;
    *(char *)(iParm1 + 0x51) = cParm2;
    *(undefined *)(iParm1 + 0x52) = uParm3;
    *(bool *)(iParm1 + 0x53) = cParm2 == *(char *)(iParm1 + 0xe4);
  }
  return (uint)(iVar1 == 0);


}

undefined4 FUN_80105e2c(int iParm1)
{
  if (*(char *)(iParm1 + 0x53) == '\0') {
    (*_padFuncClrInfo)();
  }
  else {
    if (*(char *)(iParm1 + 0x46) == '\x02') {
      return 1;
    }
    *(undefined *)(iParm1 + 0x46) = 0xfe;
  }
  return 0;


}

void _padCmdParaMode(int iParm1,undefined uParm2)
{
  *(undefined *)(iParm1 + 0x36) = 0x43;
  *(int *)(iParm1 + 0x2c) = iParm1 + 0x24;
  *(undefined *)(iParm1 + 0x24) = uParm2;
  *(undefined *)(iParm1 + 0x35) = 1;
  return;


}

void FUN_80105eac(int iParm1)
{
  *(undefined *)(iParm1 + 0x36) = 0x45;
  *(undefined4 *)(iParm1 + 0x2c) = 0;
  *(undefined *)(iParm1 + 0x35) = 0;
  return;


}

void FUN_80105ec0(int iParm1,undefined uParm2)
{
  *(undefined *)(iParm1 + 0x36) = 0x4c;
  *(int *)(iParm1 + 0x2c) = iParm1 + 0x24;
  *(undefined *)(iParm1 + 0x24) = uParm2;
  *(undefined *)(iParm1 + 0x35) = 1;
  return;


}

void FUN_80105ee0(int iParm1,undefined uParm2)
{
  *(undefined *)(iParm1 + 0x36) = 0x46;
  *(int *)(iParm1 + 0x2c) = iParm1 + 0x24;
  *(undefined *)(iParm1 + 0x24) = uParm2;
  *(undefined *)(iParm1 + 0x35) = 1;
  return;


}

void FUN_80105f00(int iParm1,undefined uParm2)
{
  *(undefined *)(iParm1 + 0x36) = 0x47;
  *(int *)(iParm1 + 0x2c) = iParm1 + 0x24;
  *(undefined *)(iParm1 + 0x24) = uParm2;
  *(undefined *)(iParm1 + 0x35) = 1;
  return;


}

void FUN_80105f20(int iParm1)
{
  *(undefined *)(iParm1 + 0x36) = 0x4b;
  *(undefined4 *)(iParm1 + 0x2c) = 0;
  *(undefined *)(iParm1 + 0x35) = 0;
  return;


}

void transmult(undefined4 *puParm1,undefined4 *puParm2,undefined4 uParm3)
{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  undefined4 *puVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  undefined4 *puVar12;
  int iVar13;
  int iVar14;
  int local_58 [10];
  undefined4 *local_30;
  undefined4 *local_2c;
  
  iVar11 = 0;
  iVar14 = 8;
  iVar13 = 4;
  puVar12 = puParm1;
  do {
    iVar7 = 0;
    iVar10 = 0x18;
    iVar9 = 0xc;
    local_30 = (undefined4 *)((int)puParm1 + iVar13);
    local_2c = (undefined4 *)((int)puParm1 + iVar14);
    puVar8 = puParm2;
    do {
      uVar6 = *puVar8;
      puVar8 = puVar8 + 1;
      iVar1 = fixedmult(*puVar12,uVar6);
      puVar2 = (undefined4 *)((int)puParm2 + iVar9);
      iVar9 = iVar9 + 4;
      iVar3 = fixedmult(*local_30,*puVar2);
      puVar2 = (undefined4 *)((int)puParm2 + iVar10);
      iVar10 = iVar10 + 4;
      iVar4 = fixedmult(*local_2c,*puVar2);
      iVar5 = iVar11 + iVar7;
      iVar7 = iVar7 + 1;
      local_58[iVar5] = iVar1 + iVar3 + iVar4;
    } while (iVar7 < 3);
    iVar14 = iVar14 + 0xc;
    iVar13 = iVar13 + 0xc;
    iVar11 = iVar11 + 3;
    puVar12 = puVar12 + 3;
  } while (iVar11 < 9);
  blockmove(local_58,uParm3,0x24);
  return;


}

void fastmovfxya(int iParm1,int iParm2,int iParm3)
{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  uint in_t6;
  short local_10;
  short local_e;
  undefined2 local_c;
  undefined2 local_a;
  
  iVar4 = primptr;
  iVar7 = (int)*(short *)(iParm1 + 4);
  iVar6 = (int)*(short *)(iParm1 + 6);
  local_10 = (short)((*(int *)(iParm1 + 0xc) << 0x14) >> 0x14);
  iVar5 = _DAT_801486fc - iParm2;
  local_e = (short)((*(int *)(iParm1 + 0xc) << 4) >> 0x14);
  if (0 < iVar5) {
    iParm2 = iParm2 + iVar5;
    local_10 = local_10 + (short)iVar5;
    iVar7 = iVar7 - iVar5;
  }
  iVar5 = (iParm2 + iVar7) - _DAT_80148704;
  if (0 < iVar5) {
    iVar7 = iVar7 - iVar5;
  }
  iVar5 = _DAT_80148700 - iParm3;
  if (0 < iVar5) {
    iParm3 = iParm3 + iVar5;
    local_e = local_e + (short)iVar5;
    iVar6 = iVar6 - iVar5;
  }
  iVar5 = (iParm3 + iVar6) - _DAT_80148708;
  if (0 < iVar5) {
    iVar6 = iVar6 - iVar5;
  }
  local_c = (undefined2)iVar7;
  local_a = (undefined2)iVar6;
  if ((0 < iVar7) && (0 < iVar6)) {
    primptr = primptr + 0x18;
    SetDrawMove(iVar4,&local_10,_DAT_801486e8 + iParm2,_DAT_801486ec + iParm3);
    uVar1 = nextprim + 2U & 3;
    uVar2 = iVar4 + 2U & 3;
    puVar3 = (uint *)((iVar4 + 2U) - uVar2);
    *puVar3 = *puVar3 & -1 << (uVar2 + 1) * 8 |
              (*(int *)((nextprim + 2U) - uVar1) << (3 - uVar1) * 8 |
              in_t6 & 0xffffffffU >> (uVar1 + 1) * 8) >> (3 - uVar2) * 8;
    uVar1 = nextprim + 2U & 3;
    puVar3 = (uint *)((nextprim + 2U) - uVar1);
    *puVar3 = *puVar3 & -1 << (uVar1 + 1) * 8 | (uint)(iVar4 << 8) >> (3 - uVar1) * 8;
    nextprim = iVar4;
  }
  return;


}

void iSNDmemconstrain(int *piParm1,int *piParm2)
{
  if ((int)(uint)_DAT_80148786 < *piParm1 + *piParm2) {
    *piParm2 = (uint)_DAT_80148786 - *piParm1;
  }
  return;


}

void iSNDmeminit(undefined4 uParm1,int iParm2)
{
  _sndmm = uParm1;
  _DAT_80148784 = 0;
  _DAT_80148786 = (short)(iParm2 >> 2);
  _DAT_80148788 = 0;
  return;


}

uint iSNDmemrestore(void)
{
  if (_DAT_80148786 == 0) {
    trap(0x1c00);
  }
  return (uint)(_DAT_80148788 * 100) / (uint)_DAT_80148786;


}

int iSNDmalloc(int iParm1)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int local_20;
  uint local_1c;
  
  iVar3 = 0;
  if (_DAT_80148784 < 0x80) {
    iVar4 = iParm1 + 3 >> 2;
    if (_DAT_80148784 == 0) {
      local_1c = (uint)_DAT_80148786;
      local_20 = 0;
      iSNDmemconstrain(&local_20,&local_1c);
    }
    else {
      iVar1 = 0;
      if (_DAT_80148784 != 0) {
LAB_801062d4:
        if (iVar3 == 0) {
          local_1c = (uint)*(ushort *)(&DAT_8014878c + iVar1);
          local_20 = 0;
        }
        else {
          local_20 = (uint)*(ushort *)(&DAT_80148788 + iVar1) +
                     (uint)*(ushort *)(&DAT_8014878a + iVar1);
          local_1c = (uint)*(ushort *)(&DAT_8014878c + iVar1) - local_20;
        }
        iSNDmemconstrain(&local_20,&local_1c);
        if ((int)local_1c < iVar4) goto LAB_80106378;
        uVar2 = (uint)_DAT_80148784;
        while (iVar3 < (int)uVar2) {
          iVar1 = uVar2 * 4;
          uVar2 = uVar2 - 1;
          *(undefined4 *)(&DAT_8014878c + iVar1) = *(undefined4 *)(&DAT_8014878c + uVar2 * 4);
        }
        goto LAB_801063d8;
      }
LAB_8010638c:
      local_20 = (uint)*(ushort *)(&DAT_80148788 + iVar1) + (uint)*(ushort *)(&DAT_8014878a + iVar1)
      ;
      local_1c = (uint)_DAT_80148786 - local_20;
      iSNDmemconstrain(&local_20,&local_1c);
    }
    iVar1 = 0;
    if (iVar4 <= (int)local_1c) {
LAB_801063d8:
      *(short *)(&DAT_8014878e + iVar3 * 4) = (short)iVar4;
      *(undefined2 *)(&DAT_8014878c + iVar3 * 4) = (undefined2)local_20;
      _DAT_80148784 = _DAT_80148784 + 1;
      iVar1 = _sndmm + local_20 * 4;
      if (_DAT_80148788 < local_20 + iVar4) {
        _DAT_80148788 = local_20 + iVar4;
      }
    }
  }
  else {
    iVar1 = 0;
  }
  return iVar1;
LAB_80106378:
  iVar3 = iVar3 + 1;
  iVar1 = iVar3 * 4;
  if ((int)(uint)_DAT_80148784 <= iVar3) goto LAB_8010638c;
  goto LAB_801062d4;


}

void _patch_gte(void)
{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  undefined4 unaff_retaddr;
  
  _DAT_8014898c = unaff_retaddr;
  EnterCriticalSection();
  iVar1 = (*(code *)&SUB_000000b0)();
  piVar3 = (int *)(*(int *)(iVar1 + 0x18) + 0x28);
  piVar4 = &DAT_80106500;
  piVar2 = piVar3;
  do {
    iVar1 = *piVar4;
    iVar5 = *piVar2;
    piVar4 = piVar4 + 1;
    piVar2 = piVar2 + 1;
    if (iVar1 != iVar5) goto LAB_801064dc;
  } while (piVar4 != &DAT_80106518);
  piVar4 = &DAT_80106518;
  do {
    *piVar3 = *piVar4;
    piVar4 = piVar4 + 1;
    piVar3 = piVar3 + 1;
  } while (piVar4 != (int *)&UNK_80106530);
LAB_801064dc:
  FlushCache();
  ExitCriticalSection();
  return;


}

undefined * startIntrVSync(void)
{
  _DAT_1f801114 = 0x100;
  Vcount = 0;
  FUN_80106624(&DAT_80137cf0,8);
  InterruptCallback(0,FUN_8010658c);
  return &LAB_801065f8;


}

void FUN_8010658c(void)
{
  code **ppcVar1;
  int iVar2;
  
  iVar2 = 0;
  ppcVar1 = (code **)&DAT_80137cf0;
  Vcount = Vcount + 1;
  do {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
    iVar2 = iVar2 + 1;
    ppcVar1 = ppcVar1 + 1;
  } while (iVar2 < 8);
  return;


}

void FUN_80106624(undefined4 *puParm1,int iParm2)
{
  int iVar1;
  
  iVar1 = iParm2 + -1;
  if (iParm2 != 0) {
    do {
      *puParm1 = 0;
      iVar1 = iVar1 + -1;
      puParm1 = puParm1 + 1;
    } while (iVar1 != -1);
  }
  return;


}

void ChangeClearPAD(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void ChangeClearRCnt(void)
{
                    
  (*(code *)&LAB_000000c0)();
  return;


}

void SetDQA(undefined4 uParm1)
{
  setCopControlWord(2,0xd800,uParm1);
  return;


}

void SetDQB(undefined4 uParm1)
{
  setCopControlWord(2,0xe000,uParm1);
  return;


}

int setjmp(__jmp_buf_tag *__env)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

void HookEntryInt(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

undefined * startIntrDMA(void)
{
  FUN_80106924(&DAT_8013bd24,8);
  _DAT_1f8010f4 = 0;
  InterruptCallback(3,FUN_801066f8);
  return &LAB_80106878;


}

void FUN_801066f8(void)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  code **ppcVar4;
  
  uVar3 = _DAT_1f8010f4 >> 0x18 & 0x7f;
  if (uVar3 != 0) {
    do {
      iVar1 = 0;
      ppcVar4 = (code **)&DAT_8013bd24;
      while ((uVar3 != 0 && (iVar1 < 7))) {
        if ((uVar3 & 1) != 0) {
          _DAT_1f8010f4 = _DAT_1f8010f4 & (1 << (iVar1 + 0x18U & 0x1f) | 0xffffffU);
          if (*ppcVar4 != (code *)0x0) {
            (**ppcVar4)();
          }
        }
        ppcVar4 = ppcVar4 + 1;
        uVar3 = uVar3 >> 1;
        iVar1 = iVar1 + 1;
      }
      uVar3 = _DAT_1f8010f4 >> 0x18 & 0x7f;
    } while (uVar3 != 0);
  }
  if (((_DAT_1f8010f4 & 0xff000000) == 0x80000000) || ((_DAT_1f8010f4 & 0x8000) != 0)) {
    printf("DMA bus error: code=%08x\n",_DAT_1f8010f4);
    iVar1 = 0;
    do {
      iVar2 = iVar1 + 1;
      printf("MADR[%d]=%08x\n",iVar1,*(undefined4 *)(&DAT_1f801080 + iVar1 * 0x10));
      iVar1 = iVar2;
    } while (iVar2 < 7);
  }
  return;


}

void FUN_80106924(undefined4 *puParm1,int iParm2)
{
  int iVar1;
  
  iVar1 = iParm2 + -1;
  if (iParm2 != 0) {
    do {
      *puParm1 = 0;
      iVar1 = iVar1 + -1;
      puParm1 = puParm1 + 1;
    } while (iVar1 != -1);
  }
  return;


}

void _96_remove(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void ExitCriticalSection(void)
{
  syscall(0);
  return;


}

void ReturnFromException(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void EnterCriticalSection(void)
{
  syscall(0);
  return;


}

void ResetEntryInt(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

uint remapshiftjiscode(uint uParm1)
{
  if (uParm1 - 0x20 < 0x60) {
    uParm1 = (uint)*(ushort *)(&DAT_8013bd50 + (uParm1 - 0x20) * 2);
  }
  return uParm1;


}

uint decodeshiftjis(byte **ppbParm1)
{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  pbVar3 = *ppbParm1;
  pbVar4 = pbVar3 + 1;
  if ((*pbVar3 & 0x80) == 0) {
    uVar2 = remapshiftjiscode();
  }
  else {
    bVar1 = *pbVar4;
    pbVar4 = pbVar3 + 2;
    uVar2 = (uint)CONCAT11(*pbVar3,bVar1);
  }
  *ppbParm1 = pbVar4;
  return uVar2 & 0xffff;


}

undefined4 _err_math(int iParm1,undefined4 uParm2)
{
  undefined4 uVar1;
  
  if (iParm1 == 0x21) {
    uVar1 = 0x301;
  }
  else {
    if (iParm1 != 0x22) {
      math_errno = iParm1;
      math_err_point = uParm2;
      return 0;
    }
    uVar1 = 0x302;
  }
  math_errno = iParm1;
  math_err_point = uParm2;
  DeliverEvent(0xf4000002,uVar1);
  return 0;


}

void csincos(undefined4 uParm1,int *piParm2,int *piParm3)
{
  int iVar1;
  int *piVar2;
  uint uVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int local_60 [6];
  int local_48;
  int local_3c [5];
  int local_28;
  int local_1c [5];
  int local_8;
  
  piVar2 = local_60;
  uVar3 = 0;
  piVar6 = local_1c;
  piVar5 = &H_cor_tbl;
  piVar4 = local_3c;
  do {
    if (piVar2[0x10] < 0) {
      piVar2[1] = *piVar2 + (piVar2[8] >> (uVar3 & 0x1f));
      *piVar4 = piVar2[8] - (*piVar2 >> (uVar3 & 0x1f));
      iVar1 = piVar2[0x10] + *piVar5;
    }
    else {
      piVar2[1] = *piVar2 - (piVar2[8] >> (uVar3 & 0x1f));
      *piVar4 = piVar2[8] + (*piVar2 >> (uVar3 & 0x1f));
      iVar1 = piVar2[0x10] - *piVar5;
    }
    *piVar6 = iVar1;
    piVar6 = piVar6 + 1;
    piVar5 = piVar5 + 1;
    piVar4 = piVar4 + 1;
    uVar3 = uVar3 + 1;
    piVar2 = piVar2 + 1;
  } while ((int)uVar3 < 6);
  *piParm3 = local_48 - (local_8 * local_28 >> 0xc);
  *piParm2 = local_28 + (local_8 * local_48 >> 0xc);
  return;


}

int PCread(undefined4 uParm1,int iParm2,uint uParm3)
{
  bool bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  
  iVar4 = 0;
  if (uParm3 != 0) {
    bVar1 = 0x8000 < uParm3;
    while( true ) {
      uVar3 = uParm3;
      if (bVar1) {
        uVar3 = 0x8000;
      }
      iVar2 = _SN_read(0,uParm1,uVar3,iParm2);
      iVar4 = iVar4 + iVar2;
      if (iVar2 == -1) break;
      iParm2 = iParm2 + iVar2;
      uParm3 = uParm3 - iVar2;
      if (iVar2 < (int)uVar3) {
        return iVar4;
      }
      bVar1 = 0x8000 < uParm3;
      if (uParm3 == 0) {
        return iVar4;
      }
    }
    iVar4 = -1;
  }
  return iVar4;


}

void PCopen(void)
{
  trap(0x103);
  return;


}

void PCinit(void)
{
  trap(0x101);
  return;


}

void PCcreat(void)
{
  trap(0x102);
  return;


}

undefined4 psxdevelopmentsystem(void)
{
  int in_zero;
  undefined4 uVar1;
  
  if (*(short *)(in_zero + 0x86) == 0x375a) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
    if (*(short *)(in_zero + 0x86) != 0x275a) {
      return 0xffffffff;
    }
  }
  return uVar1;


}

void PClseek(void)
{
  trap(0x107);
  return;


}

void PCclose(void)
{
  trap(0x104);
  return;


}

int PCwrite(undefined4 uParm1,int iParm2,uint uParm3)
{
  bool bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  
  iVar4 = 0;
  if (uParm3 != 0) {
    bVar1 = 0x8000 < uParm3;
    while( true ) {
      uVar3 = uParm3;
      if (bVar1) {
        uVar3 = 0x8000;
      }
      iVar2 = _SN_write(0,uParm1,uVar3,iParm2);
      iVar4 = iVar4 + iVar2;
      if (iVar2 == -1) break;
      iParm2 = iParm2 + iVar2;
      uParm3 = uParm3 - iVar2;
      if (iVar2 < (int)uVar3) {
        return iVar4;
      }
      bVar1 = 0x8000 < uParm3;
      if (uParm3 == 0) {
        return iVar4;
      }
    }
    iVar4 = -1;
  }
  return iVar4;


}

void EnableEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void OpenEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void DisableEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

uint * _dbl_shift(uint *param_1,int param_2,uint param_3,uint param_4,int param_5)
{
  int iVar1;
  uint local_res8;
  uint local_resc;
  
  if (param_2 == 0) {
    iVar1 = 0;
    local_res8 = param_3;
    local_resc = param_4;
    if (0 < param_5) {
      do {
        local_resc = local_resc << 1;
        if ((local_res8 & 0x80000000) != 0) {
          local_resc = local_resc | 1;
        }
        local_res8 = local_res8 << 1;
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_5);
    }
  }
  else {
    iVar1 = 0;
    local_res8 = param_3;
    local_resc = param_4;
    if (0 < param_5) {
      do {
        local_res8 = local_res8 >> 1;
        if ((local_resc & 1) != 0) {
          local_res8 = local_res8 | 0x80000000;
        }
        local_resc = (int)local_resc >> 1;
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_5);
    }
  }
  *param_1 = local_res8;
  param_1[1] = local_resc;
  return param_1;


}

uint * _mainasu(uint *puParm1,uint uParm2,uint uParm3)
{
  uint local_res4;
  uint local_res8;
  
  local_res8 = ~uParm3;
  local_res4 = ~uParm2;
  _add_mant_d(&local_res4,local_res4,local_res8,1,0);
  *puParm1 = local_res4;
  puParm1[1] = local_res8;
  return puParm1;


}

uint * _add_mant_d(uint *param_1,uint param_2,int param_3,uint param_4,int param_5)
{
  uint uVar1;
  int local_res8;
  uint local_c;
  
  local_c = param_2 >> 0x10;
  uVar1 = (param_2 & 0xffff) + (param_4 & 0xffff);
  if ((uVar1 & 0x10000) != 0) {
    local_c = local_c + 1;
  }
  local_c = local_c + (param_4 >> 0x10);
  local_res8 = param_3;
  if ((local_c & 0x10000) != 0) {
    local_res8 = param_3 + 1;
  }
  *param_1 = local_c * 0x10000 | uVar1 & 0xffff;
  param_1[1] = local_res8 + param_5;
  return param_1;


}

void TermPrim(uint *puParm1)
{
  *puParm1 = *puParm1 | 0xffffff;
  return;


}

void AddPrim(uint *puParm1,uint *puParm2)
{
  *puParm2 = *puParm2 & 0xff000000 | *puParm1 & 0xffffff;
  *puParm1 = *puParm1 & 0xff000000 | (uint)puParm2 & 0xffffff;
  return;


}

undefined4 FUN_80107080(void)
{
  byte bVar1;
  undefined4 uVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  byte local_20;
  byte local_18 [8];
  
  DAT_1f801800 = 0;
  uVar7 = 0;
  if ((DAT_1f801803 & 7) == 0) {
    DAT_1f801800 = 1;
    return 0;
  }
  do {
    local_20 = DAT_1f801803 & 7;
    iVar5 = 0;
  } while (false);
  do {
    pbVar3 = local_18 + iVar5;
    iVar6 = iVar5;
    if ((DAT_1f801800 & 0x20) == 0) break;
    iVar5 = iVar5 + 1;
    *pbVar3 = DAT_1f801801;
    iVar6 = iVar5;
  } while (iVar5 < 8);
  while (iVar5 < 8) {
    local_18[iVar5] = 0;
    iVar5 = iVar5 + 1;
  }
  DAT_1f801800 = 1;
  DAT_1f801803 = 7;
  DAT_1f801802 = 7;
  if ((local_20 != 3) || (*(int *)(&DAT_8013c10c + (uint)CD_com * 4) != 0)) {
    if (((_CD_status & 0x10) == 0) && ((local_18[0] & 0x10) != 0)) {
      CD_nopen = CD_nopen + 1;
    }
    _CD_status = (uint)local_18[0];
    CD_status1 = (uint)local_18[1];
    uVar7 = _CD_status & 0x1d;
  }
  if (((local_20 == 5) && (0 < CD_debug)) && (printf("DiskError: "), 0 < CD_debug)) {
    printf("com=%s,code=(%02x:%02x)\n",(&CD_comstr)[(uint)CD_com],_CD_status,CD_status1);
  }
  switch(local_20) {
  case 1:
    if ((uVar7 != 0) && (iVar6 == 1)) {
      uVar7 = 0;
    }
    DAT_8013c225 = 1;
    if (uVar7 != 0) {
      DAT_8013c225 = 5;
    }
    pbVar3 = &DAT_801489a4;
    pbVar4 = local_18;
    if (true) {
      iVar5 = 7;
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    DAT_1f801800 = 0;
    uVar2 = 4;
    DAT_1f801803 = 0;
    break;
  case 2:
    DAT_8013c224 = 2;
    if (uVar7 != 0) {
      DAT_8013c224 = 5;
    }
    pbVar3 = &DAT_8014899c;
    pbVar4 = local_18;
    if (true) {
      iVar5 = 7;
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    goto LAB_80107420;
  case 3:
    if (uVar7 == 0) {
      if (*(int *)(&DAT_8013c00c + (uint)CD_com * 4) != 0) {
        DAT_8013c224 = 3;
        pbVar3 = &DAT_8014899c;
        pbVar4 = local_18;
        if (true) {
          iVar5 = 7;
          do {
            bVar1 = *pbVar4;
            pbVar4 = pbVar4 + 1;
            iVar5 = iVar5 + -1;
            *pbVar3 = bVar1;
            pbVar3 = pbVar3 + 1;
          } while (iVar5 != -1);
        }
        return 1;
      }
      DAT_8013c224 = 2;
      pbVar3 = &DAT_8014899c;
      pbVar4 = local_18;
      if (true) {
        iVar5 = 7;
        do {
          bVar1 = *pbVar4;
          pbVar4 = pbVar4 + 1;
          iVar5 = iVar5 + -1;
          *pbVar3 = bVar1;
          pbVar3 = pbVar3 + 1;
        } while (iVar5 != -1);
        return 2;
      }
    }
    else {
      DAT_8013c224 = 5;
      pbVar3 = &DAT_8014899c;
      pbVar4 = local_18;
      if (true) {
        iVar5 = 7;
        do {
          bVar1 = *pbVar4;
          pbVar4 = pbVar4 + 1;
          iVar5 = iVar5 + -1;
          *pbVar3 = bVar1;
          pbVar3 = pbVar3 + 1;
        } while (iVar5 != -1);
        return 2;
      }
    }
LAB_80107420:
    uVar2 = 2;
    break;
  case 4:
    pbVar3 = &DAT_801489ac;
    DAT_8013c226 = 4;
    pbVar4 = local_18;
    DAT_8013c225 = 4;
    iVar5 = 7;
    if (true) {
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    pbVar3 = &DAT_801489a4;
    pbVar4 = local_18;
    if (true) {
      iVar5 = 7;
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    uVar2 = 4;
    break;
  case 5:
    pbVar3 = &DAT_8014899c;
    DAT_8013c225 = 5;
    pbVar4 = local_18;
    DAT_8013c224 = 5;
    iVar5 = 7;
    if (true) {
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    pbVar3 = &DAT_801489a4;
    pbVar4 = local_18;
    if (true) {
      iVar5 = 7;
      do {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        iVar5 = iVar5 + -1;
        *pbVar3 = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (iVar5 != -1);
    }
    uVar2 = 6;
    break;
  default:
    puts("CDROM: unknown intr");
    printf("(%d)\n",(uint)local_20);
    return 0;
  }
  return uVar2;


}

uint CD_sync(int iParm1,undefined *puParm2)
{
  undefined uVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined *puVar6;
  byte bVar7;
  
  _DAT_801489b4 = VSync(0xffffffff);
  _DAT_801489b4 = _DAT_801489b4 + 0x3c0;
  _DAT_801489b8 = 0;
  _DAT_801489bc = "CD_sync";
  while( true ) {
    iVar3 = VSync(0xffffffff);
    if ((_DAT_801489b4 < iVar3) ||
       (iVar3 = _DAT_801489b8 + 1, bVar2 = 0x3c0000 < _DAT_801489b8, _DAT_801489b8 = iVar3, bVar2))
    {
      puts("CD timeout: ");
      printf("%s:(%s) Sync=%s, Ready=%s\n",_DAT_801489bc,(&CD_comstr)[(uint)CD_com],
             (&CD_intstr)[(uint)DAT_8013c224],(&CD_intstr)[(uint)DAT_8013c225]);
      CD_flush();
      iVar4 = -1;
    }
    else {
      iVar4 = 0;
      _DAT_801489b8 = iVar3;
    }
    if (iVar4 != 0) {
      return 0xffffffff;
    }
    iVar3 = CheckCallback();
    bVar7 = DAT_1f801800;
    if (iVar3 != 0) {
      bVar7 = DAT_1f801800 & 3;
      while( true ) {
        uVar5 = FUN_80107080();
        if (uVar5 == 0) break;
        if (((uVar5 & 4) != 0) && (CD_cbready != (code *)0x0)) {
          (*CD_cbready)((uint)DAT_8013c225,&DAT_801489a4);
        }
        if (((uVar5 & 2) != 0) && (CD_cbsync != (code *)0x0)) {
          (*CD_cbsync)((uint)DAT_8013c224,&DAT_8014899c);
        }
      }
    }
    DAT_1f801800 = bVar7;
    uVar5 = (uint)DAT_8013c224;
    if ((DAT_8013c224 == 2) || (DAT_8013c224 == 5)) break;
    if (iParm1 != 0) {
      return 0;
    }
  }
  DAT_8013c224 = 2;
  puVar6 = &DAT_8014899c;
  iVar3 = 7;
  if (puParm2 == (undefined *)0x0) {
    DAT_8013c224 = 2;
    return uVar5;
  }
  do {
    uVar1 = *puVar6;
    puVar6 = puVar6 + 1;
    iVar3 = iVar3 + -1;
    *puParm2 = uVar1;
    puParm2 = puParm2 + 1;
  } while (iVar3 != -1);
  return uVar5;


}

uint CD_ready(int iParm1,undefined *puParm2)
{
  undefined uVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined *puVar6;
  byte bVar7;
  
  _DAT_801489b4 = VSync(0xffffffff);
  _DAT_801489b4 = _DAT_801489b4 + 0x3c0;
  _DAT_801489b8 = 0;
  _DAT_801489bc = "CD_ready";
  while( true ) {
    iVar3 = VSync(0xffffffff);
    if ((_DAT_801489b4 < iVar3) ||
       (iVar3 = _DAT_801489b8 + 1, bVar2 = 0x3c0000 < _DAT_801489b8, _DAT_801489b8 = iVar3, bVar2))
    {
      puts("CD timeout: ");
      printf("%s:(%s) Sync=%s, Ready=%s\n",_DAT_801489bc,(&CD_comstr)[(uint)CD_com],
             (&CD_intstr)[(uint)DAT_8013c224],(&CD_intstr)[(uint)DAT_8013c225]);
      CD_flush();
      iVar4 = -1;
    }
    else {
      iVar4 = 0;
      _DAT_801489b8 = iVar3;
    }
    if (iVar4 != 0) {
      return 0xffffffff;
    }
    iVar3 = CheckCallback();
    bVar7 = DAT_1f801800;
    if (iVar3 != 0) {
      bVar7 = DAT_1f801800 & 3;
      while( true ) {
        uVar5 = FUN_80107080();
        if (uVar5 == 0) break;
        if (((uVar5 & 4) != 0) && (CD_cbready != (code *)0x0)) {
          (*CD_cbready)((uint)DAT_8013c225,&DAT_801489a4);
        }
        if (((uVar5 & 2) != 0) && (CD_cbsync != (code *)0x0)) {
          (*CD_cbsync)((uint)DAT_8013c224,&DAT_8014899c);
        }
      }
    }
    DAT_1f801800 = bVar7;
    uVar5 = (uint)DAT_8013c226;
    if (DAT_8013c226 != 0) break;
    uVar5 = (uint)DAT_8013c225;
    if (DAT_8013c225 != 0) {
      DAT_8013c225 = 0;
      puVar6 = &DAT_801489a4;
      iVar3 = 7;
      if (puParm2 == (undefined *)0x0) {
        DAT_8013c225 = 0;
        return uVar5;
      }
      do {
        uVar1 = *puVar6;
        puVar6 = puVar6 + 1;
        iVar3 = iVar3 + -1;
        *puParm2 = uVar1;
        puParm2 = puParm2 + 1;
      } while (iVar3 != -1);
      return uVar5;
    }
    if (iParm1 != 0) {
      return 0;
    }
  }
  DAT_8013c226 = 0;
  puVar6 = &DAT_801489ac;
  if (puParm2 == (undefined *)0x0) {
    DAT_8013c226 = 0;
    return uVar5;
  }
  iVar3 = 7;
  do {
    uVar1 = *puVar6;
    puVar6 = puVar6 + 1;
    iVar3 = iVar3 + -1;
    *puParm2 = uVar1;
    puParm2 = puParm2 + 1;
  } while (iVar3 != -1);
  return uVar5;


}

undefined4 CD_cw(byte bParm1,undefined *puParm2,undefined *puParm3,int iParm4)
{
  undefined uVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined *puVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  byte bVar8;
  
  if (1 < CD_debug) {
    printf("%s...\n",(&CD_comstr)[(uint)bParm1]);
  }
  if ((*(int *)(&DAT_8013c18c + (uint)bParm1 * 4) == 0) || (puParm2 != (undefined *)0x0)) {
    CD_sync(0,0);
    if (bParm1 == 2) {
      iVar7 = 0;
      puVar4 = puParm2;
      do {
        (&CD_pos)[iVar7] = *puVar4;
        iVar7 = iVar7 + 1;
        puVar4 = puParm2 + iVar7;
      } while (iVar7 < 4);
    }
    if (bParm1 == 0xe) {
      CD_mode = *puParm2;
    }
    DAT_8013c224 = 0;
    if (*(int *)(&DAT_8013c08c + (uint)bParm1 * 4) != 0) {
      DAT_8013c225 = 0;
    }
    DAT_1f801800 = 0;
    iVar7 = 0;
    puVar4 = puParm2;
    if (0 < *(int *)(&DAT_8013c18c + (uint)bParm1 * 4)) {
      do {
        DAT_1f801802 = *puVar4;
        iVar7 = iVar7 + 1;
        puVar4 = puParm2 + iVar7;
      } while (iVar7 < *(int *)(&DAT_8013c18c + (uint)bParm1 * 4));
    }
    uVar3 = 0;
    CD_com = bParm1;
    DAT_1f801801 = bParm1;
    if (iParm4 == 0) {
      CD_com = bParm1;
      DAT_1f801801 = bParm1;
      _DAT_801489b4 = VSync(0xffffffff);
      _DAT_801489b4 = _DAT_801489b4 + 0x3c0;
      _DAT_801489b8 = 0;
      _DAT_801489bc = "CD_cw";
      bVar8 = DAT_1f801800;
      while (DAT_1f801800 = bVar8, DAT_8013c224 == 0) {
        iVar7 = VSync(0xffffffff);
        if ((_DAT_801489b4 < iVar7) ||
           (iVar7 = _DAT_801489b8 + 1, bVar2 = 0x3c0000 < _DAT_801489b8, _DAT_801489b8 = iVar7,
           bVar2)) {
          puts("CD timeout: ");
          printf("%s:(%s) Sync=%s, Ready=%s\n",_DAT_801489bc,(&CD_comstr)[(uint)CD_com],
                 (&CD_intstr)[(uint)DAT_8013c224],(&CD_intstr)[(uint)DAT_8013c225]);
          CD_flush();
          iVar5 = -1;
        }
        else {
          iVar5 = 0;
          _DAT_801489b8 = iVar7;
        }
        if (iVar5 != 0) {
          return 0xffffffff;
        }
        iVar7 = CheckCallback();
        bVar8 = DAT_1f801800;
        if (iVar7 != 0) {
          bVar8 = DAT_1f801800 & 3;
          while( true ) {
            uVar6 = FUN_80107080();
            if (uVar6 == 0) break;
            if (((uVar6 & 4) != 0) && (CD_cbready != (code *)0x0)) {
              (*CD_cbready)((uint)DAT_8013c225,&DAT_801489a4);
            }
            if (((uVar6 & 2) != 0) && (CD_cbsync != (code *)0x0)) {
              (*CD_cbsync)((uint)DAT_8013c224,&DAT_8014899c);
            }
          }
        }
      }
      puVar4 = &DAT_8014899c;
      iVar7 = 7;
      if (puParm3 != (undefined *)0x0) {
        do {
          uVar1 = *puVar4;
          puVar4 = puVar4 + 1;
          iVar7 = iVar7 + -1;
          *puParm3 = uVar1;
          puParm3 = puParm3 + 1;
        } while (iVar7 != -1);
      }
      uVar3 = 0;
      if (DAT_8013c224 == 5) {
        uVar3 = 0xffffffff;
      }
    }
  }
  else {
    uVar3 = 0xfffffffe;
    if (0 < CD_debug) {
      printf("%s: no param\n",(&CD_comstr)[(uint)bParm1]);
      uVar3 = 0xfffffffe;
    }
  }
  return uVar3;


}

void CD_flush(void)
{
  if ((DAT_1f801803 & 7) != 0) {
    do {
      DAT_1f801802 = 7;
    } while (true);
  }
  DAT_8013c224 = 2;
  DAT_8013c225 = 0;
  DAT_8013c226 = 0;
  _DAT_1f801020 = 0x1325;
  DAT_1f801800 = 0;
  DAT_1f801803 = 0;
  return;


}

undefined4 CD_initvol(void)
{
  if ((_DAT_1f801db8 == 0) && (_DAT_1f801dba == 0)) {
    _DAT_1f801d80 = 0x3fff;
    _DAT_1f801d82 = 0x3fff;
  }
  DAT_1f801800 = 3;
  DAT_1f801801 = 0x80;
  DAT_1f801802 = 0;
  DAT_1f801803 = 0x20;
  _DAT_1f801daa = 0xc001;
  _DAT_1f801db0 = 0x3fff;
  _DAT_1f801db2 = 0x3fff;
  return 0;


}

void CD_initintr(void)
{
  CD_cbready = 0;
  CD_cbsync = 0;
  CD_status1 = 0;
  _CD_status = 0;
  ResetCallback();
  InterruptCallback(2,FUN_80108680);
  return;


}

undefined4 CD_init(void)
{
  int iVar1;
  undefined4 uVar2;
  
  puts("CD_init:");
  printf("addr=%08x\n",&PTR_DAT_8013c228);
  CD_com = 0;
  CD_mode = 0;
  CD_cbready = 0;
  CD_cbsync = 0;
  CD_status1 = 0;
  _CD_status = 0;
  ResetCallback();
  InterruptCallback(2,FUN_80108680);
  if ((DAT_1f801803 & 7) != 0) {
    do {
      DAT_1f801802 = 7;
    } while (true);
  }
  DAT_8013c226 = 0;
  DAT_8013c225 = 0;
  DAT_8013c224 = 2;
  DAT_1f801800 = 0;
  DAT_1f801803 = 0;
  _DAT_1f801020 = 0x1325;
  CD_cw(1,0,0,0);
  if ((_CD_status & 0x10) != 0) {
    CD_cw(1,0,0,0);
  }
  iVar1 = CD_cw(10,0,0,0);
  uVar2 = 0xffffffff;
  if (iVar1 == 0) {
    iVar1 = CD_cw(0xc,0,0,0);
    if (iVar1 == 0) {
      iVar1 = CD_sync(0,0);
      uVar2 = 0xffffffff;
      if (iVar1 == 2) {
        uVar2 = 0;
      }
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;


}

undefined4 CD_datasync(int iParm1)
{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  
  _DAT_801489b4 = VSync(0xffffffff);
  _DAT_801489b4 = _DAT_801489b4 + 0x3c0;
  _DAT_801489b8 = 0;
  _DAT_801489bc = "CD_datasync";
  do {
    iVar2 = VSync(0xffffffff);
    if ((_DAT_801489b4 < iVar2) ||
       (iVar2 = _DAT_801489b8 + 1, bVar1 = 0x3c0000 < _DAT_801489b8, _DAT_801489b8 = iVar2, bVar1))
    {
      puts("CD timeout: ");
      printf("%s:(%s) Sync=%s, Ready=%s\n",_DAT_801489bc,(&CD_comstr)[(uint)CD_com],
             (&CD_intstr)[(uint)DAT_8013c224],(&CD_intstr)[(uint)DAT_8013c225]);
      CD_flush();
      iVar3 = -1;
    }
    else {
      iVar3 = 0;
      _DAT_801489b8 = iVar2;
    }
    uVar4 = 0xffffffff;
  } while (((iVar3 == 0) && (uVar4 = 0, (_DAT_1f8010b8 & 0x1000000) != 0)) &&
          (uVar4 = 1, iParm1 == 0));
  return uVar4;


}

undefined4 CD_getsector(undefined4 uParm1,uint uParm2)
{
  do {
  } while (true);
  if (true) {
    do {
    } while (true);
  }
  _DAT_1f801018 = 0x20943;
  _DAT_1f801020 = 0x1325;
  _DAT_1f8010b0 = uParm1;
  _DAT_1f8010b4 = uParm2 | 0x10000;
  _DAT_1f8010b8 = 0x11000000;
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0x8000;
  DAT_1f801800 = 0;
  DAT_1f801803 = 0x80;
  return 0;


}

undefined4 CD_getsector2(undefined4 uParm1,uint uParm2)
{
  do {
  } while (true);
  _DAT_1f801018 = 0x21020843;
  _DAT_1f801020 = 0x1325;
  _DAT_1f8010b0 = uParm1;
  _DAT_1f8010b4 = uParm2 | 0x10000;
  _DAT_1f8010b8 = 0x11400100;
  _DAT_1f8010f0 = _DAT_1f8010f0 | 0x8000;
  DAT_1f801800 = 0;
  DAT_1f801803 = 0x80;
  return 0;


}

void FUN_80108680(void)
{
  uint uVar1;
  byte bVar2;
  
  bVar2 = DAT_1f801800 & 3;
  while( true ) {
    uVar1 = FUN_80107080();
    if (uVar1 == 0) break;
    if (((uVar1 & 4) != 0) && (CD_cbready != (code *)0x0)) {
      (*CD_cbready)((uint)DAT_8013c225,&DAT_801489a4);
    }
    if (((uVar1 & 2) != 0) && (CD_cbsync != (code *)0x0)) {
      (*CD_cbsync)((uint)DAT_8013c224,&DAT_8014899c);
    }
  }
  DAT_1f801800 = bVar2;
  return;


}

void init_ring_status(int iParm1,uint uParm2)
{
  int iVar1;
  uint uVar2;
  
  uVar2 = 0;
  if (uParm2 != 0) {
    do {
      iVar1 = uVar2 + iParm1;
      uVar2 = uVar2 + 1;
      *(undefined4 *)(_StRingAddr + iVar1 * 0x20) = 0;
    } while (uVar2 < uParm2);
  }
  return;


}

void data_ready_callback(void)
{
  undefined2 *puVar1;
  
  puVar1 = (undefined2 *)(_StRingAddr + _StRingIdx2 * 0x20);
  *puVar1 = 2;
  _DAT_801489d0 = *(undefined4 *)(puVar1 + 0xe);
  _DAT_801489d4 = *(undefined4 *)(puVar1 + 4);
  _StRingIdx2 = _StRingIdx1;
  if (_StFunc1 != (code *)0x0) {
    (*_StFunc1)();
  }
  _StFinalSector = 0;
  return;


}

undefined4 DsReadyCallback(undefined4 uParm1)
{
  undefined4 uVar1;
  
  uVar1 = _DAT_801489e4;
  _DAT_801489e4 = uParm1;
  return uVar1;


}

void DsDataCallback(undefined4 uParm1)
{
  DMACallback(3,uParm1);
  return;


}

void StSetMask(undefined4 uParm1,undefined4 uParm2,undefined4 uParm3)
{
  _StEndFrame = uParm3;
  _StSTART_FLAG = uParm1;
  _StStartFrame = uParm2;
  return;


}

void FUN_8010887c(void)
{
  CdSyncCallback(DAT_8013c2b8);
  DAT_8013c2b4 = 0;
  return;


}

void FUN_801088b0(char cParm1,undefined4 uParm2)
{
  int iVar1;
  undefined4 uVar2;
  undefined auStack32 [16];
  
  if (cParm1 == '\x01') {
    DAT_8013c2c4 = uParm2;
    if (0 < DAT_8013c2a4) {
      DAT_8013c2c4 = uParm2;
      if (DAT_8013c2a0 == 0x200) {
        if ((CD_read_dma_mode & 1) == 0) {
          DAT_8013c2c4 = uParm2;
          CdGetSector(auStack32,3);
        }
        else {
          DAT_8013c2c4 = uParm2;
          CdDataCallback(0);
          CdGetSector2(auStack32,3);
          CdDataSync(0);
          CdDataCallback(FUN_80108b24);
        }
        iVar1 = CdPosToInt(auStack32);
        if (iVar1 != DAT_8013c2b0) {
          puts("CdRead: sector error\n");
          DAT_8013c2a4 = -1;
        }
      }
      if ((CD_read_dma_mode & 1) == 0) {
        CdGetSector(DAT_8013c298,DAT_8013c2a0);
        DAT_8013c298 = DAT_8013c298 + DAT_8013c2a0 * 4;
        DAT_8013c2a4 = DAT_8013c2a4 + -1;
        DAT_8013c2b0 = DAT_8013c2b0 + 1;
      }
      else {
        CdGetSector2(DAT_8013c298,DAT_8013c2a0);
      }
    }
  }
  else {
    DAT_8013c2a4 = -1;
    DAT_8013c2c4 = uParm2;
  }
  DAT_8013c2a8 = VSync(0xffffffff);
  if (DAT_8013c2a4 < 0) {
    FUN_80108bf4(1);
  }
  iVar1 = VSync(0xffffffff);
  if (DAT_8013c2ac + 0x4b0 < iVar1) {
    DAT_8013c2a4 = -1;
  }
  if ((DAT_8013c2a4 == 0) || (iVar1 = VSync(0xffffffff), DAT_8013c2ac + 0x4b0 < iVar1)) {
    CdReadyCallback(DAT_8013c2bc);
    if ((CD_read_dma_mode & 1) != 0) {
      CdDataCallback(DAT_8013c2c0);
    }
    CdSyncCallback(FUN_8010887c);
    CdControlF(9,0);
    DAT_8013c2b4 = 1;
    if (CD_cbread != (code *)0x0) {
      uVar2 = 5;
      if (DAT_8013c2a4 == 0) {
        uVar2 = 2;
      }
      (*CD_cbread)(uVar2,uParm2);
    }
  }
  return;


}

void FUN_80108b24(void)
{
  DAT_8013c298 = DAT_8013c298 + DAT_8013c2a0 * 4;
  DAT_8013c2a4 = DAT_8013c2a4 + -1;
  DAT_8013c2b0 = DAT_8013c2b0 + 1;
  if (DAT_8013c2a4 == 0) {
    CdReadyCallback(DAT_8013c2bc);
    if ((CD_read_dma_mode & 1) != 0) {
      CdDataCallback(DAT_8013c2c0);
    }
    CdSyncCallback(FUN_8010887c);
    CdControlF(9,0);
    DAT_8013c2b4 = 1;
    if (CD_cbread != (code *)0x0) {
      (*CD_cbread)(2,DAT_8013c2c4);
    }
  }
  return;


}

undefined4 FUN_80108bf4(int iParm1)
{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  undefined local_18 [8];
  
  CdSyncCallback(0);
  CdReadyCallback(0);
  if ((CD_read_dma_mode & 1) != 0) {
    CdDataCallback(0);
  }
  uVar1 = CdStatus();
  if ((uVar1 & 0x10) != 0) {
    uVar1 = VSync(0xffffffff);
    if ((uVar1 & 0x3f) == 0) {
      puts("CdRead: Shell open...\n");
    }
    CdControlF(1,0);
    DAT_8013c2ac = VSync(0xffffffff);
    DAT_8013c2a4 = 0xffffffff;
    return 0xffffffff;
  }
  if (iParm1 != 0) {
    puts("CdRead: retry...\n");
    CdControl(9,0,0);
    uVar2 = CdLastPos();
    iVar3 = CdControl(2,uVar2,0);
    if (iVar3 == 0) {
      DAT_8013c2a4 = 0xffffffff;
      return 0xffffffff;
    }
  }
  CdFlush();
  local_18[0] = (undefined)DAT_8013c29c;
  uVar4 = DAT_8013c29c & 0xff;
  uVar1 = CdMode();
  if (((uVar4 != uVar1) || (iParm1 != 0)) && (iVar3 = CdControl(0xe,local_18,0), iVar3 == 0)) {
    DAT_8013c2a4 = 0xffffffff;
    return 0xffffffff;
  }
  uVar2 = CdLastPos();
  DAT_8013c2b0 = CdPosToInt(uVar2);
  CdReadyCallback(FUN_801088b0);
  if ((CD_read_dma_mode & 1) != 0) {
    CdDataCallback(FUN_80108b24);
  }
  DAT_8013c298 = DAT_8013c294;
  CdControlF(6,0);
  DAT_8013c2a4 = DAT_8013c290;
  DAT_8013c2a8 = VSync(0xffffffff);
  return DAT_8013c2a4;


}

uint CdRead(undefined4 uParm1,undefined4 uParm2,uint uParm3)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  
  if (DAT_8013c2b4 != 0) {
    iVar1 = VSync(0xffffffff);
    do {
      if (DAT_8013c2b4 == 0) goto LAB_80108e58;
      iVar2 = VSync(0xffffffff);
    } while ((uint)(iVar2 - iVar1) < 0x79);
    CdSyncCallback(DAT_8013c2b8);
    DAT_8013c2b4 = 0;
  }
LAB_80108e58:
  if ((uParm3 & 0x30) == 0) {
    DAT_8013c2a0 = 0x200;
  }
  else {
    if ((uParm3 & 0x30) == 0x20) {
      DAT_8013c2a0 = 0x249;
    }
    else {
      DAT_8013c2a0 = 0x246;
    }
  }
  DAT_8013c29c = uParm3 | 0x20;
  DAT_8013c290 = uParm1;
  DAT_8013c294 = uParm2;
  DAT_8013c2b8 = CdSyncCallback(0);
  DAT_8013c2bc = CdReadyCallback(0);
  if ((CD_read_dma_mode & 1) != 0) {
    DAT_8013c2c0 = CdDataCallback(0);
  }
  DAT_8013c2ac = VSync(0xffffffff);
  uVar3 = CdStatus();
  if ((uVar3 & 0xe0) != 0) {
    CdControlB(9,0,0);
  }
  iVar1 = FUN_80108bf4(0);
  return (uint)(0 < iVar1);


}

int CdReadSync(int iParm1,undefined4 uParm2)
{
  int iVar1;
  int iVar2;
  
  do {
    iVar1 = VSync(0xffffffff);
    iVar2 = -1;
    if ((iVar1 <= DAT_8013c2ac + 0x4b0) &&
       ((DAT_8013c2a4 < 0 ||
        (iVar1 = VSync(0xffffffff), iVar2 = DAT_8013c2a4, DAT_8013c2a8 + 0x3c < iVar1)))) {
      FUN_80108bf4(1);
      iVar2 = DAT_8013c290;
    }
  } while ((iParm1 == 0) && (((DAT_8013c2b4 != 0 && (iVar2 == 0)) || (0 < iVar2))));
  CdReady(1,uParm2);
  if ((DAT_8013c2b4 != 0) && (iVar2 == 0)) {
    iVar2 = 1;
  }
  return iVar2;


}

int toupper(int __c)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&LAB_000000a0)();
  return iVar1;


}

undefined4 CdInit(void)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 4;
  do {
    iVar1 = FUN_8010911c();
    if (iVar1 == 1) {
      CD_cbsync = FUN_80109158;
      CD_cbready = FUN_80109180;
      CD_cbread = FUN_801091a8;
      CD_read_dma_mode = 0;
      return 1;
    }
    iVar2 = iVar2 + -1;
  } while (iVar2 != -1);
  printf("CdInit: Init failed\n");
  return 0;


}

uint FUN_8010911c(void)
{
  int iVar1;
  uint uVar2;
  
  iVar1 = CD_init();
  if (iVar1 == 0) {
    iVar1 = CD_initvol();
    uVar2 = (uint)(iVar1 == 0);
  }
  else {
    uVar2 = 0;
  }
  return uVar2;


}

void FUN_80109158(void)
{
  DeliverEvent(0xf0000003,0x20);
  return;


}

void FUN_80109180(void)
{
  DeliverEvent(0xf0000003,0x40);
  return;


}

void FUN_801091a8(void)
{
  DeliverEvent(0xf0000003,0x40);
  return;


}

void * bsearch(void *__key,void *__base,size_t __nmemb,size_t __size,__compar_fn_t __compar)
{
  int iVar1;
  size_t sVar2;
  void *pvVar3;
  uint uVar4;
  uint uVar5;
  
  uVar4 = 0;
  uVar5 = __nmemb;
  if (__nmemb != 0) {
    do {
      sVar2 = __nmemb >> 1;
      pvVar3 = (void *)((int)__base + __size * sVar2);
      iVar1 = (*__compar)(pvVar3,__key);
      if (iVar1 < 0) {
        uVar4 = sVar2 + 1;
        sVar2 = uVar5;
      }
      else {
        if (iVar1 < 1) {
          return pvVar3;
        }
      }
      __nmemb = uVar4 + sVar2;
      uVar5 = sVar2;
    } while (uVar4 < sVar2);
  }
  return (void *)0x0;


}

void CdGetToc(undefined4 uParm1)
{
  CdGetToc2(1,uParm1);
  return;


}

int CdGetToc2(undefined4 uParm1,byte *pbParm2)
{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  byte *pbVar6;
  uint uVar7;
  char local_30 [8];
  undefined uStack40;
  byte local_27;
  byte local_26;
  
  local_30[0] = '\x01';
  uVar2 = CdSyncCallback(0);
  iVar3 = CdControlB(0x13,0,&uStack40);
  if (iVar3 != 0) {
    uVar5 = (uint)(local_27 >> 4) * 10 + ((uint)local_27 & 0xf);
    uVar7 = (uint)(local_26 >> 4) * 10 + ((uint)local_26 & 0xf);
    if (1 < CD_debug) {
      printf("track=%d,%d\n",uVar5,uVar7);
    }
    local_30[0] = '\0';
    iVar3 = CdControlB(0x14,local_30,&uStack40);
    if (iVar3 != 0) {
      *pbParm2 = local_27;
      pbParm2[2] = 0;
      pbParm2[1] = local_26;
      iVar3 = 1;
      if (uVar5 <= uVar7) {
        pbVar6 = pbParm2 + 4;
        do {
          local_30[0] = (char)uVar5 + (char)((int)uVar5 / 10) * '\x06';
          iVar4 = CdControlB(0x14,local_30,&uStack40);
          iVar3 = iVar3 + 1;
          if (iVar4 == 0) goto LAB_80109490;
          *pbVar6 = local_27;
          uVar5 = uVar5 + 1;
          pbVar6[2] = 0;
          pbVar6[1] = local_26;
          pbVar6 = pbVar6 + 4;
        } while ((int)uVar5 <= (int)uVar7);
      }
      iVar3 = iVar3 + -1;
      if ((1 < CD_debug) && (iVar4 = 0, -1 < iVar3)) {
        do {
          bVar1 = *pbParm2;
          pbVar6 = pbParm2 + 1;
          pbParm2 = pbParm2 + 4;
          iVar4 = iVar4 + 1;
          printf("CdGetToc2: %02x:%02x:00\n",(uint)bVar1,(uint)*pbVar6);
        } while (iVar4 <= iVar3);
      }
      CdSyncCallback(uVar2);
      return iVar3;
    }
  }
LAB_80109490:
  if (CD_debug != 0) {
    printf("CdGetToc2: error\n");
  }
  CdSyncCallback(uVar2);
  return 0;


}

undefined4 iSNDplatformcdpanvol(undefined4 uParm1,undefined4 uParm2)
{
  undefined4 local_10;
  undefined4 local_c;
  
  iSNDpvtolrv(uParm1,uParm2,&local_10,&local_c);
  *(ushort *)(_DAT_80147e2c + 0x1b0) = (short)local_10 * 0x102 & 0x7fff;
  *(ushort *)(_DAT_80147e2c + 0x1b2) = (short)local_c * 0x102 & 0x7fff;
  return 0;


}

void _card_open(void)
{
  InitCARD();
  StartCARD();
  _bu_init();
  return;


}

void _card_start(void)
{
  int iVar1;
  
  iVar1 = EnterCriticalSection();
  _DAT_801489ec = OpenEvent(0xf4000001,4,0x1000,&funcEvSpIOE);
  _DAT_801489f0 = OpenEvent(0xf4000001,0x8000,0x1000,&funcEvSpError);
  _DAT_801489f4 = OpenEvent(0xf4000001,0x100,0x1000,&funcEvSpTimeout);
  _DAT_801489f8 = OpenEvent(0xf4000001,0x2000,0x1000,&funcEvSpNewcard);
  _DAT_801489fc = OpenEvent(0xf0000011,4,0x1000,&funcEvSpIOEx);
  _DAT_80148a00 = OpenEvent(0xf0000011,0x8000,0x1000,&funcEvSpErrorx);
  _DAT_80148a04 = OpenEvent(0xf0000011,0x100,0x1000,&funcEvSpTimeoutx);
  _DAT_80148a08 = OpenEvent(0xf0000011,0x2000,0x1000,&funcEvSpNewcardx);
  EnableEvent(_DAT_801489ec);
  EnableEvent(_DAT_801489f0);
  EnableEvent(_DAT_801489f4);
  EnableEvent(_DAT_801489f8);
  EnableEvent(_DAT_801489fc);
  EnableEvent(_DAT_80148a00);
  EnableEvent(_DAT_80148a04);
  EnableEvent(_DAT_80148a08);
  _clr_card_event();
  if (iVar1 == 1) {
    ExitCriticalSection();
  }
  return;


}

void _card_close(void)
{
  StopCARD();
  return;


}

void _card_stop(void)
{
  int iVar1;
  
  iVar1 = EnterCriticalSection();
  CloseEvent(_DAT_801489ec);
  CloseEvent(_DAT_801489f0);
  CloseEvent(_DAT_801489f4);
  CloseEvent(_DAT_801489f8);
  CloseEvent(_DAT_801489fc);
  CloseEvent(_DAT_80148a00);
  CloseEvent(_DAT_80148a04);
  CloseEvent(_DAT_80148a08);
  if (iVar1 == 1) {
    ExitCriticalSection();
  }
  return;


}

void _clr_card_event(void)
{
  TestEvent(_DAT_801489ec);
  TestEvent(_DAT_801489f0);
  TestEvent(_DAT_801489f4);
  TestEvent(_DAT_801489f8);
  TestEvent(_DAT_801489fc);
  TestEvent(_DAT_80148a00);
  TestEvent(_DAT_80148a04);
  TestEvent(_DAT_80148a08);
  _DAT_80148a0c = 0;
  _DAT_80148a10 = 0;
  _DAT_80148a14 = 0;
  _DAT_80148a18 = 0;
  _DAT_80148a1c = 0;
  _DAT_80148a20 = 0;
  _DAT_80148a24 = 0;
  _DAT_80148a28 = 0;
  return;


}

int _get_card_event(void)
{
  int iVar1;
  
  do {
    iVar1 = _DAT_80148a0c + _DAT_80148a10 * 2 + _DAT_80148a14 * 4 + _DAT_80148a18 * 8;
  } while (iVar1 == 0);
  TestEvent(_DAT_801489fc);
  TestEvent(_DAT_80148a00);
  TestEvent(_DAT_80148a04);
  TestEvent(_DAT_80148a08);
  _DAT_80148a0c = 0;
  _DAT_80148a10 = 0;
  _DAT_80148a14 = 0;
  _DAT_80148a18 = 0;
  return iVar1 >> 1;


}

int _get_card_event_x(void)
{
  int iVar1;
  
  do {
    iVar1 = _DAT_80148a1c + _DAT_80148a20 * 2 + _DAT_80148a24 * 4 + _DAT_80148a28 * 8;
  } while (iVar1 == 0);
  TestEvent(_DAT_801489ec);
  TestEvent(_DAT_801489f0);
  TestEvent(_DAT_801489f4);
  TestEvent(_DAT_801489f8);
  _DAT_80148a1c = 0;
  _DAT_80148a20 = 0;
  _DAT_80148a24 = 0;
  _DAT_80148a28 = 0;
  return iVar1 >> 1;


}

int _chk_card_event(void)
{
  return _DAT_80148a0c + _DAT_80148a10 * 2 + _DAT_80148a14 * 4 + _DAT_80148a18 * 8;


}

int _chk_card_event_x(void)
{
  return _DAT_80148a1c + _DAT_80148a20 * 2 + _DAT_80148a24 * 4 + _DAT_80148a28 * 8;


}

void UserFuncInit(void)
{
  DAT_8013c2e0 = 0xffffffff;
  return;


}

void UserFuncOpen(undefined4 uParm1)
{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = DAT_8013c2e0 + 1;
  if (iVar3 < 4) {
    iVar2 = 3;
    puVar1 = (undefined4 *)(&DAT_80148a38 + iVar3 * 0x10);
    DAT_8013c2e0 = iVar3;
    *(undefined4 *)(&DAT_80148a6c + iVar3 * 4) = uParm1;
    do {
      *puVar1 = 0;
      iVar2 = iVar2 + -1;
      puVar1 = puVar1 + -1;
    } while (-1 < iVar2);
  }
  else {
    printf("libmcrd: event overflow\n");
  }
  return;


}

void UserFuncExecute(void)
{
  int iVar1;
  
  if ((-1 < DAT_8013c2e0) &&
     (iVar1 = (**(code **)(&DAT_80148a6c + DAT_8013c2e0 * 4))(DAT_8013c2e0 * 0x10 + -0x7feb75d4),
     iVar1 != 0)) {
    DAT_8013c2e0 = DAT_8013c2e0 + -1;
  }
  return;


}

uint UserFuncComplete(void)
{
  return DAT_8013c2e0 >> 0x1f;


}

void _card_info(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void _card_clear(undefined4 uParm1)
{
  _new_card();
  _card_write(uParm1,0x3f,0);
  return;


}

void _card_load(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

int open(char *__file,int __oflag,...)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&SUB_000000b0)();
  return iVar1;


}

int close(int __fd)
{
  int iVar1;
  
                    
  iVar1 = (*(code *)&SUB_000000b0)();
  return iVar1;


}

__off_t lseek(int __fd,__off_t __offset,int __whence)
{
  __off_t _Var1;
  
                    
  _Var1 = (*(code *)&SUB_000000b0)();
  return _Var1;


}

ssize_t read(int __fd,void *__buf,size_t __nbytes)
{
  ssize_t sVar1;
  
                    
  sVar1 = (*(code *)&SUB_000000b0)();
  return sVar1;


}

ssize_t write(int __fd,void *__buf,size_t __n)
{
  ssize_t sVar1;
  
                    
  sVar1 = (*(code *)&SUB_000000b0)();
  return sVar1;


}

undefined4 firstfile(char *pcParm1,undefined4 uParm2)
{
  char cVar1;
  bool bVar2;
  int in_zero;
  int iVar3;
  undefined4 uVar4;
  char *pcVar5;
  char **ppcVar6;
  char *pcVar7;
  char **ppcVar8;
  
  cVar1 = *pcParm1;
  pcVar7 = &DAT_80148a84;
  pcVar5 = pcParm1;
  while (':' < cVar1) {
    cVar1 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    *pcVar7 = cVar1;
    cVar1 = *pcVar5;
    pcVar7 = pcVar7 + 1;
  }
  *pcVar7 = '\0';
  ppcVar8 = *(char ***)(in_zero + 0x150);
  ppcVar6 = ppcVar8 + (*(uint *)(in_zero + 0x154) / 0x50) * 0x14;
  while (ppcVar8 < ppcVar6) {
    if ((*ppcVar8 != (char *)0x0) && (iVar3 = strcmp(*ppcVar8,&DAT_80148a84), iVar3 == 0)) {
      _DAT_80148a7c = ppcVar8[0xd];
      bVar2 = true;
      goto LAB_80109e90;
    }
    ppcVar8 = ppcVar8 + 0x14;
  }
  bVar2 = false;
LAB_80109e90:
  uVar4 = 0;
  if (bVar2) {
    ppcVar8 = *(char ***)(in_zero + 0x150);
    ppcVar6 = ppcVar8 + (*(uint *)(in_zero + 0x154) / 0x50) * 0x14;
    while (ppcVar8 < ppcVar6) {
      if ((*ppcVar8 != (char *)0x0) && (iVar3 = strcmp(*ppcVar8,&DAT_80148a84), iVar3 == 0)) {
        *(code **)(ppcVar8 + 0xd) = FUN_80109f5c;
        break;
      }
      ppcVar8 = ppcVar8 + 0x14;
    }
    uVar4 = firstfile2(pcParm1,uParm2);
  }
  return uVar4;


}

void FUN_80109f5c(int *piParm1,undefined4 uParm2,undefined4 uParm3)
{
  code *pcVar1;
  int in_zero;
  int iVar2;
  char **ppcVar3;
  char **ppcVar4;
  
  if (*piParm1 == 0) {
    *piParm1 = 1;
  }
  pcVar1 = _DAT_80148a7c;
  ppcVar4 = *(char ***)(in_zero + 0x150);
  ppcVar3 = ppcVar4 + (*(uint *)(in_zero + 0x154) / 0x50) * 0x14;
  do {
    if (ppcVar3 <= ppcVar4) {
LAB_8010a020:
      (*_DAT_80148a7c)(piParm1,uParm2,uParm3);
      return;
    }
    if ((*ppcVar4 != (char *)0x0) && (iVar2 = strcmp(*ppcVar4,&DAT_80148a84), iVar2 == 0)) {
      *(code **)(ppcVar4 + 0xd) = pcVar1;
      goto LAB_8010a020;
    }
    ppcVar4 = ppcVar4 + 0x14;
  } while( true );


}

void nextfile(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void erase(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void format(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _new_card(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _card_write(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _padInitDirSeq(void)
{
  _padFuncSendAuto = FUN_8010a0e4;
  _padFuncChkEng = FUN_8010a510;
  _padFuncRecvAuto = FUN_8010a1e4;
  return;


}

undefined4 FUN_8010a0e4(int iParm1)
{
  byte bVar1;
  
  if (**(char **)(iParm1 + 0x3c) == -0xd) {
    if (*(char *)(iParm1 + 0xe8) != '\0') {
      if (*(char *)(iParm1 + 0x49) == '\x02') {
        (*_padFuncClrInfo)(iParm1);
      }
      goto LAB_8010a140;
    }
LAB_8010a198:
    _padCmdParaMode(iParm1,0);
  }
  else {
LAB_8010a140:
    bVar1 = *(byte *)(iParm1 + 0x46);
    if (bVar1 == 1) {
      _padCmdParaMode(iParm1,1);
      return 0;
    }
    if (bVar1 < 2) {
      if (bVar1 == 0) {
        return 0;
      }
    }
    else {
      if (bVar1 == 0xfe) goto LAB_8010a198;
      if (bVar1 == 0xff) {
        return 0;
      }
    }
    if (*(code **)(iParm1 + 0x14) == (code *)0x0) {
      _padSendAtLoadInfo(iParm1);
    }
    else {
      (**(code **)(iParm1 + 0x14))(iParm1);
    }
  }
  return 0;


}

void FUN_8010a1e4(int iParm1)
{
  byte bVar1;
  char cVar2;
  int iVar3;
  
  cVar2 = *(char *)(iParm1 + 0xe8);
  bVar1 = **(byte **)(iParm1 + 0x3c) >> 4;
  *(byte *)(iParm1 + 0xe8) = bVar1;
  if (bVar1 == 0xf) {
    *(char *)(iParm1 + 0xe8) = cVar2;
  }
  else {
    **(undefined **)(iParm1 + 0x30) = 0;
    *(undefined *)(*(int *)(iParm1 + 0x30) + 1) = **(undefined **)(iParm1 + 0x3c);
    iVar3 = 2;
    if (2 < *(byte *)(iParm1 + 0x44)) {
      do {
        *(undefined *)(*(int *)(iParm1 + 0x30) + iVar3) =
             *(undefined *)(*(int *)(iParm1 + 0x3c) + iVar3);
        iVar3 = iVar3 + 1;
      } while (iVar3 < (int)(uint)*(byte *)(iParm1 + 0x44));
    }
  }
  if (((*(char *)(*(int *)(iParm1 + 0x3c) + 1) == '\0') &&
      (((*(char *)(iParm1 + 0x46) != '\x01' || (*(int *)(iParm1 + 0x14) != 0)) &&
       (*(char *)(iParm1 + 0x50) == '\0')))) ||
     ((((iVar3 = FUN_8010a510(iParm1), iVar3 == 0 && (*(char *)(iParm1 + 0x37) == '\0')) &&
       (*(char *)(iParm1 + 0x4a) == '\0')) && (*(char *)(iParm1 + 0xe8) != cVar2)))) {
    (*_padFuncClrInfo)(iParm1);
  }
  *(undefined *)(iParm1 + 0x4a) = 0;
  if (*(char *)(iParm1 + 0x46) == -1) {
    return;
  }
  if (((byte)(*(char *)(iParm1 + 0x46) - 2U) < 0xfc) && (**(char **)(iParm1 + 0x3c) != -0xd)) {
    (*_padFuncClrInfo)(iParm1);
  }
  if ((*(char *)(iParm1 + 0x46) != '\0') && (*(char *)(iParm1 + 0x36) == '\0')) {
    return;
  }
  bVar1 = *(byte *)(iParm1 + 0x46);
  if (bVar1 == 1) {
    cVar2 = *(char *)(iParm1 + 0x46);
    *(undefined *)(iParm1 + 0x47) = 0;
LAB_8010a3d4:
    *(char *)(iParm1 + 0x46) = cVar2 + '\x01';
  }
  else {
    if (bVar1 < 2) {
      if (bVar1 == 0) {
        cVar2 = *(char *)(iParm1 + 0x46);
        *(undefined *)(iParm1 + 0x49) = 1;
        goto LAB_8010a3d4;
      }
    }
    else {
      if (bVar1 == 0xfe) {
        *(undefined *)(iParm1 + 0x46) = 0xff;
        return;
      }
    }
    if (*(code **)(iParm1 + 0x18) == (code *)0x0) {
      cVar2 = _padRecvAtLoadInfo(iParm1);
    }
    else {
      cVar2 = (**(code **)(iParm1 + 0x18))(iParm1);
    }
    *(char *)(iParm1 + 0x46) = *(char *)(iParm1 + 0x46) + cVar2;
  }
  return;


}

void _dirFailAuto(int iParm1)
{
  byte bVar1;
  
  *(int *)(iParm1 + 0x4c) = *(int *)(iParm1 + 0x4c) + 1;
  if (*(char *)(iParm1 + 0x46) == '\0') {
LAB_8010a4cc:
    if (**(char **)(iParm1 + 0x3c) != -0xd) {
      **(undefined **)(iParm1 + 0x30) = 0xff;
      *(undefined *)(*(int *)(iParm1 + 0x30) + 1) = 0;
      *(undefined *)(iParm1 + 0xe8) = 0;
    }
  }
  else {
    if (*(char *)(iParm1 + 0x46) == '\x01') {
      bVar1 = *(byte *)(iParm1 + 0x4a);
      if (1 < bVar1) {
        *(undefined *)(iParm1 + 0x49) = 2;
        *(undefined *)(iParm1 + 0x46) = 0xff;
        return;
      }
    }
    else {
      bVar1 = *(byte *)(iParm1 + 0x4a);
      if (3 < bVar1) {
        if (*(char *)(iParm1 + 0x49) != '\0') {
          (*_padFuncClrInfo)(iParm1);
        }
        goto LAB_8010a4cc;
      }
    }
    *(char *)(iParm1 + 0x4a) = bVar1 + 1;
  }
  return;


}

undefined4 FUN_8010a510(int iParm1)
{
  undefined4 uVar1;
  
  if ((*(short *)(iParm1 + 0xe6) == 0) || (uVar1 = 0, *(char *)(iParm1 + 0x46) != -1)) {
    uVar1 = 1;
  }
  return uVar1;


}

void bzero(void *__s,size_t __n)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void iSNDpsxmemconstrain(uint *puParm1,int *piParm2)
{
  uint uVar1;
  uint uVar2;
  
  uVar2 = (uint)_DAT_80147e32;
  uVar1 = *puParm1;
  if ((int)uVar1 < (int)uVar2) {
    *puParm1 = uVar2;
    *piParm2 = *piParm2 - (uVar2 - uVar1);
    uVar1 = *puParm1;
  }
  if ((int)(uint)_DAT_80147e34 < (int)(uVar1 + *piParm2)) {
    *piParm2 = (uint)_DAT_80147e34 - uVar1;
  }
  if ((int)(uint)_DAT_80147e36 < (int)(*puParm1 + *piParm2)) {
    *piParm2 = (uint)_DAT_80147e36 - *puParm1;
  }
  return;


}

int iSNDpsxmalloc(int iParm1)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint local_20;
  int local_1c;
  
  iVar3 = 0;
  if (_DAT_80147e30 < 0x80) {
    iVar4 = iParm1 + 0x3f >> 6;
    if (_DAT_80147e30 == 0) {
      local_20 = (uint)_DAT_80147e32;
      local_1c = (uint)_DAT_80147e34 - local_20;
    }
    else {
      if (_DAT_80147e30 != 0) {
        iVar1 = 0;
        do {
          if (iVar3 == 0) {
            local_20 = (uint)_DAT_80147e32;
            local_1c = (uint)*(ushort *)(&DAT_80147e38 + iVar1) - local_20;
          }
          else {
            local_20 = (uint)*(ushort *)(&DAT_80147e34 + iVar1) +
                       (uint)*(ushort *)(&DAT_80147e36 + iVar1);
            local_1c = (uint)*(ushort *)(&DAT_80147e38 + iVar1) - local_20;
          }
          iSNDpsxmemconstrain(&local_20,&local_1c);
          if (iVar4 <= local_1c) {
            uVar2 = (uint)_DAT_80147e30;
            iVar1 = iVar3 << 2;
            if (iVar3 < (int)uVar2) {
              do {
                iVar1 = uVar2 * 4;
                uVar2 = uVar2 - 1;
                *(undefined4 *)(&DAT_80147e38 + iVar1) = *(undefined4 *)(&DAT_80147e38 + uVar2 * 4);
              } while (iVar3 < (int)uVar2);
              iVar1 = iVar3 << 2;
            }
            goto LAB_8010a778;
          }
          iVar3 = iVar3 + 1;
          iVar1 = iVar3 * 4;
        } while (iVar3 < (int)(uint)_DAT_80147e30);
      }
      local_20 = (uint)*(ushort *)(&DAT_80147e34 + iVar3 * 4) +
                 (uint)*(ushort *)(&DAT_80147e36 + iVar3 * 4);
      local_1c = (uint)_DAT_80147e34 - local_20;
    }
    iSNDpsxmemconstrain(&local_20,&local_1c);
    iVar1 = iVar3 << 2;
    if (iVar4 <= local_1c) {
LAB_8010a778:
      *(short *)(&DAT_80147e3a + iVar1) = (short)iVar4;
      *(undefined2 *)(&DAT_80147e38 + iVar1) = (undefined2)local_20;
      _DAT_80147e30 = _DAT_80147e30 + 1;
      return local_20 << 6;
    }
  }
  return 0;


}

undefined4 iSNDpsxfree(int iParm1)
{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  if (_DAT_80147e30 != 0) {
    iVar1 = 0;
    do {
      if ((uint)*(ushort *)(&DAT_80147e38 + iVar1) == iParm1 >> 6) {
        _DAT_80147e30 = _DAT_80147e30 - 1;
        if (iVar2 < (int)(uint)_DAT_80147e30) {
          do {
            iVar1 = iVar2 * 4;
            iVar2 = iVar2 + 1;
            *(undefined4 *)(&DAT_80147e38 + iVar1) = *(undefined4 *)(&DAT_80147e38 + iVar2 * 4);
          } while (iVar2 < (int)(uint)_DAT_80147e30);
        }
        return 0;
      }
      iVar2 = iVar2 + 1;
      iVar1 = iVar2 * 4;
    } while (iVar2 < (int)(uint)_DAT_80147e30);
  }
  return 0xfffffff8;


}

void iSNDdmtransfer(void)
{
  uint uVar1;
  uint *puVar2;
  int iVar3;
  byte bVar4;
  uint uVar5;
  
  uVar1 = Status;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  uVar5 = 0xffffffff;
  if ((int)((uint)DAT_80147924 << 0x18) < 1) {
    setCopReg(0,Status,Status,0);
  }
  else {
    bVar4 = 0;
    DAT_80147926 = 1;
    iVar3 = 0;
    puVar2 = (uint *)&DAT_80147928;
    do {
      if (*puVar2 != 0) {
        if (bVar4 < *(byte *)((int)puVar2 + 0xb)) {
          uVar5 = *puVar2;
          bVar4 = *(byte *)((int)puVar2 + 0xb);
          DAT_80147925 = (char)iVar3;
        }
        else {
          if ((*(byte *)((int)puVar2 + 0xb) == bVar4) && (*puVar2 < uVar5)) {
            uVar5 = *puVar2;
            DAT_80147925 = (char)iVar3;
          }
        }
      }
      iVar3 = iVar3 + 1;
      puVar2 = puVar2 + 5;
    } while (iVar3 < 10);
    iVar3 = (int)DAT_80147925 * 0x14;
    if (((&DAT_80147934)[iVar3] != '\0') && (DAT_80147919 = 1, _DAT_80148040 != (code *)0x0)) {
      (*_DAT_80148040)();
    }
    *(int *)(&DAT_80147938 + iVar3) = _DAT_801478a4 + 0xf;
    *(undefined2 *)(_DAT_80147e2c + 0x1a6) = *(undefined2 *)(&DAT_80147930 + iVar3);
    *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) & 0xffcf | 0x20;
    *_DAT_80147e14 = *_DAT_80147e14 & 0xf0ffffff | 0x20000000;
    *_DAT_80147e18 = *(undefined4 *)(&DAT_8014792c + iVar3);
    *_DAT_80147e1c = (uint)(byte)(&DAT_80147932)[iVar3] << 0x10 | 0x10;
    *_DAT_80147e20 = 0x1000201;
    setCopReg(0,Status,uVar1,0);
  }
  return;


}

void iSNDdmcallback(void)
{
  uint uVar1;
  int iVar2;
  int local_10;
  
  uVar1 = Status;
  local_10 = 0;
  if (true) {
    do {
      local_10 = local_10 + 1;
    } while (local_10 < 0x2ee);
  }
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) & 0xffcf;
  if ((*(ushort *)(_DAT_80147e2c + 0x1aa) & 0x30) != 0) {
    iVar2 = 1;
    do {
      if (4000 < iVar2) break;
      iVar2 = iVar2 + 1;
    } while ((*(ushort *)(_DAT_80147e2c + 0x1aa) & 0x30) != 0);
  }
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (*(int *)(&DAT_80147928 + (int)DAT_80147925 * 0x14) != 0) {
    if ((DAT_80147919 != '\0') && (DAT_80147919 = '\0', _DAT_80148040 != (code *)0x0)) {
      (*_DAT_80148040)();
    }
    *(undefined4 *)(&DAT_80147928 + (int)DAT_80147925 * 0x14) = 0;
    DAT_80147924 = DAT_80147924 - 1;
    if ((int)((uint)DAT_80147924 << 0x18) < 1) {
      setCopReg(0,Status,uVar1,0);
      DAT_80147926 = 0;
      return;
    }
  }
  setCopReg(0,Status,uVar1,0);
  iSNDdmtransfer();
  return;


}

void iSNDdmservice(void)
{
  if (DAT_80147926 == '\0') {
    iSNDdmtransfer();
  }
  else {
    if (*(uint *)(&DAT_80147938 + (int)DAT_80147925 * 0x14) <= _DAT_801478a4) {
      iSNDdmcallback();
    }
  }
  return;


}

int iSNDdmqueue(int param_1,uint param_2,uint param_3,undefined param_4,undefined param_5)
{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  if ((param_3 & 0x3f) != 0) {
    param_3 = param_3 + 0x40;
  }
  _DAT_80147920 = _DAT_80147920 + 1;
  setCopReg(0,Status,Status & 0xfffffbfe,0);
  if (_DAT_80147920 == 0) {
    _DAT_80147920 = 1;
  }
  iVar1 = _DAT_80147920;
  iVar3 = 0;
  piVar2 = (int *)&DAT_80147928;
  do {
    iVar3 = iVar3 + 1;
    if (*piVar2 == 0) {
      DAT_80147924 = DAT_80147924 + '\x01';
      piVar2[1] = param_1;
      *piVar2 = iVar1;
      *(short *)(piVar2 + 2) = (short)(param_2 >> 3);
      *(undefined *)((int)piVar2 + 10) = (char)((int)param_3 >> 6);
      *(undefined *)((int)piVar2 + 0xb) = param_4;
      *(undefined *)(piVar2 + 3) = param_5;
      setCopReg(0,Status,Status,0);
      iSNDdmservice();
      return _DAT_80147920;
    }
    piVar2 = piVar2 + 5;
  } while (iVar3 < 10);
  setCopReg(0,Status,Status,0);
  return 0;


}

undefined4 iSNDdmqueuesplit(int iParm1,int iParm2,int iParm3,undefined4 uParm4)
{
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = 0;
  if (0 < iParm3) {
    do {
      iVar2 = 0x1000;
      if (iParm3 < 0x1000) {
        iVar2 = iParm3;
      }
      while (10 - (int)DAT_80147924 < 7) {
        iSNDdmservice();
      }
      uVar1 = iSNDdmqueue(iParm1,iParm2,iVar2,uParm4,0);
      iParm1 = iParm1 + iVar2;
      iParm3 = iParm3 - iVar2;
      iParm2 = iParm2 + iVar2;
    } while (0 < iParm3);
  }
  return uVar1;


}

undefined4 iSNDdmcomplete(int iParm1)
{
  undefined *puVar1;
  int iVar2;
  
  iSNDdmservice();
  puVar1 = &sndpd;
  iVar2 = 0;
  if (0 < (int)((uint)DAT_80147924 << 0x18)) {
    do {
      iVar2 = iVar2 + 1;
      if (*(int *)(puVar1 + 0x10) == iParm1) {
        return 0;
      }
      puVar1 = puVar1 + 0x14;
    } while (iVar2 < 10);
  }
  return 1;


}

int iSNDabs(int iParm1)
{
  if (iParm1 < 0) {
    iParm1 = -iParm1;
  }
  return iParm1;


}

void iSNDatodlrv(int param_1,undefined4 param_2,int *param_3,int *param_4,int param_5,int param_6)
{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  iSNDlibatodlrv();
  if (param_5 < 0) {
    if (param_6 < 0) {
      uVar2 = 2;
      if (param_5 < param_6) {
        uVar2 = 1;
      }
      goto LAB_8010af88;
    }
  }
  else {
    if (-1 < param_6) {
      uVar2 = 1;
      if (param_5 < param_6) {
        uVar2 = 2;
      }
      goto LAB_8010af88;
    }
  }
  iVar3 = iSNDabs(param_5);
  iVar1 = iSNDabs(param_6);
  uVar2 = 3;
  if (iVar1 < iVar3) {
    uVar2 = 4;
  }
LAB_8010af88:
  iVar3 = 0;
  if (param_1 - 0x4000U < 0x8000) {
    iVar1 = 4;
    if (*param_3 < *param_4) {
      iVar1 = 3;
    }
    if (((uVar2 < 3) && (iVar3 = 2, iVar1 == 3)) && (uVar2 == 2)) {
      iVar3 = 1;
    }
  }
  else {
    iVar1 = 1;
    if (*param_3 < *param_4) {
      iVar1 = 2;
    }
    if (((2 < uVar2) && (iVar3 = 2, iVar1 == 2)) && (uVar2 == 3)) {
      iVar3 = 1;
    }
  }
  if (param_5 < 0) {
    *param_3 = -*param_3;
  }
  if (param_6 < 0) {
    *param_4 = -*param_4;
  }
  if (iVar3 == 1) {
    *param_3 = -*param_3;
  }
  else {
    if (iVar3 == 2) {
      *param_4 = -*param_4;
    }
  }
  return;


}

void iSNDatolrv(undefined4 uParm1,undefined4 uParm2,int *piParm3,int *piParm4)
{
  iSNDlibatodlrv();
  if (*piParm3 < 0) {
    *piParm3 = -*piParm3;
  }
  if (*piParm4 < 0) {
    *piParm4 = -*piParm4;
  }
  return;


}

uint VoxSentence_GetNumPhrases(int iParm1)
{
  return (uint)(*(byte *)(iParm1 + 3) >> 2);


}

int iSPCH_GetOffset8(int iParm1,int iParm2,int iParm3)
{
  return iParm1 + (uint)*(byte *)(iParm2 + iParm3) * 4;


}

int iSPCH_GetOffset16(int iParm1,int iParm2,int iParm3)
{
  return iParm1 + (uint)*(ushort *)(iParm3 * 2 + iParm2) * 4;


}

int iSPCH_GetRuleDataAddr(int iParm1)
{
  return iParm1 + (uint)*(byte *)(iParm1 + 6) * 2 + 0xc;


}

undefined4 iSPCH_SentenceUsesParm(int iParm1,uint uParm2)
{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  
  iVar1 = VoxSentence_GetNumPhrases();
  iVar5 = 0;
  uVar6 = 0;
  if (0 < iVar1) {
    do {
      iVar2 = iSPCH_GetOffset8(iParm1,iParm1 + 4,iVar5);
      iVar4 = 0;
      iVar3 = iVar2;
      if (((uint)*(byte *)(iVar2 + 2) & 0xf) == uParm2) {
        return 1;
      }
      do {
        iVar4 = iVar4 + 1;
        if (((uint)*(byte *)(iVar3 + 4) & 0xf) == uParm2) {
          uVar6 = 1;
          break;
        }
        iVar3 = iVar2 + iVar4;
      } while (iVar4 < 4);
      iVar5 = iVar5 + 1;
    } while (iVar5 < iVar1);
  }
  return uVar6;


}

uint iSPCH_GetRuleID(undefined4 uParm1,uint uParm2)
{
  int iVar1;
  uint uVar2;
  
  uVar2 = 0xffffffff;
  iVar1 = iSPCH_GetRuleDataAddr();
  if (uParm2 < 8) {
    uVar2 = (uint)*(byte *)(uParm2 * 2 + iVar1);
  }
  return uVar2;


}

void iSPCH_RuleSet(ushort *puParm1,undefined4 uParm2,int iParm3)
{
  char cVar1;
  byte bVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  uint local_30;
  byte *pbVar6;
  int iVar7;
  uint local_38;
  uint local_34;
  
  if (gSentenceRuleSet != (code *)0x0) {
    cVar1 = *(char *)((int)puParm1 + 7);
    iVar7 = 0;
    pbVar6 = (byte *)iSPCH_GetRuleDataAddr();
    uVar3 = iSPCH_GetOffset16(puParm1,puParm1 + 6,uParm2);
    if (0 < (int)cVar1) {
      do {
        bVar2 = *pbVar6;
        uVar5 = (uint)pbVar6[1] & 0xf;
        local_30 = (uint)(pbVar6[1] >> 4);
        if (true) {
          switch(pbVar6[1] >> 4) {
          case 0:
          case 3:
            local_38 = (uint)bVar2;
            local_34 = uVar5;
            iVar4 = iSPCH_SentenceUsesParm(uVar3,uVar5);
            if (iVar4 != 0) {
              (*gSentenceRuleSet)((uint)*puParm1,(uint)bVar2,*(undefined4 *)(uVar5 * 4 + iParm3),
                                  iParm3,local_38,local_34,local_30);
            }
          }
        }
        iVar7 = iVar7 + 1;
        pbVar6 = pbVar6 + 2;
      } while (iVar7 < (int)cVar1);
    }
  }
  return;


}

uint iSPCH_GetRuleSettings(ushort *puParm1,undefined4 *puParm2,undefined *puParm3)
{
  char cVar1;
  byte *pbVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  uint uVar6;
  byte *pbVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  undefined4 *puVar13;
  
  uVar12 = 0;
  cVar1 = *(char *)((int)puParm1 + 7);
  uVar11 = 0;
  pbVar2 = (byte *)iSPCH_GetRuleDataAddr();
  uVar10 = 1;
  puVar13 = puParm2;
  do {
    puVar13 = puVar13 + 1;
    iVar8 = 0;
    pbVar7 = pbVar2;
    if (0 < (int)cVar1) {
      do {
        uVar9 = 0;
        uVar4 = (uint)pbVar7[1] & 0xf;
        if (uVar10 == 0xc) {
          uVar5 = 0;
          if ((pbVar7[1] & 0xf) == 0) {
LAB_8010b498:
            uVar6 = 1 << (7U - iVar8 & 0x1f);
            if (pbVar7[1] >> 4 == 4) {
              if (puParm2[uVar4] != 0) {
LAB_8010b4d4:
                uVar9 = uVar6;
              }
            }
            else {
              if (gSentenceRuleTest == (code *)0x0) {
                iVar3 = -1;
              }
              else {
                iVar3 = (*gSentenceRuleTest)
                                  ((uint)*puParm1,(uint)*pbVar7,uVar5,puParm1,(uint)*pbVar7,uVar4);
              }
              if (iVar3 == 0) {
                uVar9 = 0;
              }
              else {
                if (0 < iVar3) goto LAB_8010b4d4;
                uVar11 = uVar11 | uVar6;
              }
            }
            uVar12 = uVar12 | uVar9;
          }
        }
        else {
          if (uVar4 == uVar10) {
            uVar5 = *puVar13;
            goto LAB_8010b498;
          }
        }
        iVar8 = iVar8 + 1;
        pbVar7 = pbVar7 + 2;
      } while (iVar8 < (int)cVar1);
    }
    uVar10 = uVar10 + 1;
    if (0xc < (int)uVar10) {
      *puParm3 = (char)uVar11;
      return uVar12 & 0xff;
    }
  } while( true );


}

uint iSPCH_CheckSentenceRules(byte bParm1,byte bParm2,int iParm3)
{
  return (uint)((byte)((*(byte *)(iParm3 + 2) ^ bParm1) & *(byte *)(iParm3 + 1) & ~bParm2) == 0);


}

void iSPCH_InitSample(undefined4 *puParm1)
{
  puParm1[1] = 0xffffffff;
  *puParm1 = 0;
  puParm1[2] = 0;
  *(undefined *)(puParm1 + 3) = 0xff;
  *(undefined *)((int)puParm1 + 0xd) = 0xff;
  *(undefined *)((int)puParm1 + 0xe) = 0xff;
  *(undefined *)((int)puParm1 + 0xf) = 0xff;
  return;


}

undefined4 iSPCH_UnPackSample(int iParm1,uint uParm2,int *piParm3)
{
  byte bVar1;
  bool bVar2;
  int *piVar3;
  int iVar4;
  byte *pbVar5;
  uint uVar6;
  byte *pbVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  undefined4 uVar11;
  
  uVar11 = 0;
  bVar2 = false;
  iSPCH_InitSample(piParm3);
  iVar10 = 0;
  if ((int)uParm2 < (int)(uint)*(byte *)(iParm1 + 3)) {
    bVar1 = *(byte *)(iParm1 + 2);
    uVar6 = (uint)bVar1 & 0xf;
    iVar9 = uVar6 + 2;
    iVar4 = 0;
    piParm3[2] = uVar6;
    pbVar7 = (byte *)(iParm1 + 8 + uParm2 * iVar9);
    piVar3 = piParm3;
    if ((bVar1 & 0xf) != 0) {
      do {
        iVar8 = iVar4 + 2;
        iVar4 = iVar4 + 1;
        *(byte *)(piVar3 + 3) = pbVar7[iVar8];
        piVar3 = (int *)((int)piParm3 + iVar4);
      } while (iVar4 < (int)uVar6);
    }
    if ((*pbVar7 & 0x80) != 0) {
      uParm2 = (uint)pbVar7[1];
      pbVar7 = (byte *)(iParm1 + 8 + uParm2 * iVar9);
    }
    pbVar5 = pbVar7 + iVar9;
    iVar4 = uParm2 + 1;
    iVar8 = (uint)*pbVar7 * 0x100 + (uint)pbVar7[1];
    piParm3[1] = iVar8 * 0x100;
    if (true) {
      do {
        if (iVar4 < (int)(uint)*(byte *)(iParm1 + 3)) {
          if ((*pbVar5 & 0x80) == 0) {
            bVar2 = true;
            iVar10 = ((uint)*pbVar5 * 0x100 + (uint)pbVar5[1]) * 0x100;
          }
          else {
            pbVar5 = pbVar5 + iVar9;
            iVar4 = iVar4 + 1;
          }
        }
        else {
          bVar2 = true;
          iVar10 = (uint)*(ushort *)(iParm1 + 4) << 8;
        }
      } while (!bVar2);
    }
    *piParm3 = iVar10 + iVar8 * -0x100;
    uVar11 = 1;
  }
  return uVar11;


}

undefined4 iSNDplatformresolve(undefined4 uParm1,int iParm2,int *piParm3)
{
  int iVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  undefined4 local_res0;
  int local_38;
  undefined4 local_34;
  undefined4 local_30 [2];
  
  iVar5 = 0;
  iVar6 = 0;
  iVar3 = 0;
  local_res0 = uParm1;
  iVar1 = 1;
  piVar2 = (int *)0;
  while ((piVar8 = piVar2, iVar9 = iVar1, iVar7 = iVar3,
         iVar3 = iSNDgettag(register0x00000074,&local_38,&local_34,local_30), iVar3 != 0 &&
         (local_38 != 0xfe))) {
    iVar3 = iVar7;
    iVar1 = iVar9;
    piVar2 = piVar8;
    if (((local_38 != 0x80) &&
        (((iVar3 = local_34, iVar1 = iVar9, piVar2 = piVar8, local_38 != 0x88 &&
          (iVar3 = iVar7, iVar1 = iVar9, piVar2 = (int *)local_30[0], local_38 != 0x8a)) &&
         (iVar3 = iVar7, iVar1 = local_34, piVar2 = piVar8, local_38 != 0x82)))) &&
       (iVar3 = iVar7, iVar1 = iVar9, piVar2 = piVar8, local_38 == 0x85)) {
      iVar5 = local_34;
      iVar3 = iVar7;
      iVar1 = iVar9;
      piVar2 = piVar8;
    }
  }
  if (iParm2 != 0) {
    iVar3 = *piParm3;
    piVar2 = piParm3;
    while (iVar3 != -1) {
      if (*piVar2 == iVar7) {
        *piVar8 = piVar2[1];
        break;
      }
      iVar3 = piVar2[2];
      iVar6 = iVar6 + 1;
      piVar2 = piVar2 + 2;
    }
    if (*piVar8 != 0) {
      return 7;
    }
    iVar3 = iVar5 / 0x1c;
    if (iVar5 != iVar3 * 0x1c) {
      iVar3 = iVar3 + 1;
    }
    iVar3 = iVar3 * iVar9 * 0x10;
    iVar5 = iSNDpsxmalloc(iVar3);
    if (iVar5 == 0) {
      return 0xfffffffa;
    }
    uVar4 = iSNDdmqueuesplit(iParm2 + iVar7,iVar5,iVar3,1);
    *piVar8 = iVar5;
    piParm3[iVar6 * 2] = iVar7;
    (piParm3 + iVar6 * 2)[1] = iVar5;
    do {
      iVar6 = iSNDdmcomplete(uVar4);
    } while (iVar6 == 0);
  }
  return 7;


}

undefined4 iSNDplatformremove(undefined4 uParm1,int *piParm2)
{
  int iVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined4 local_res0;
  int local_28;
  undefined auStack36 [4];
  undefined4 local_20 [2];
  
  piVar4 = (int *)0x0;
  local_res0 = uParm1;
  while ((iVar1 = iSNDgettag(register0x00000074,&local_28,auStack36,local_20), iVar1 != 0 &&
         (local_28 != 0xfe))) {
    if (local_28 == 0x8a) {
      piVar4 = (int *)local_20[0];
    }
  }
  iVar1 = 0;
  if (*piParm2 != -1) {
    iVar2 = *piParm2;
    piVar3 = piParm2;
    do {
      piVar3 = piVar3 + 2;
      if (iVar2 == *piVar4) {
        return 0;
      }
      iVar2 = *piVar3;
      iVar1 = iVar1 + 1;
    } while (iVar2 != -1);
  }
  piParm2[iVar1 * 2] = *piVar4;
  if (*piVar4 != 0) {
    iSNDpsxfree();
  }
  return 0;


}

undefined4 iSNDplatformplay(undefined4 param_1,int param_2,undefined param_3,undefined4 param_4, undefined4 param_5,undefined4 param_6,undefined4 param_7)
{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined4 local_res0;
  int local_30;
  undefined4 local_2c;
  undefined4 local_28 [2];
  
  puVar7 = (undefined4 *)0x0;
  iVar5 = 0x5622;
  iVar6 = 0;
  iVar1 = param_2 * 0x2c;
  (&DAT_80147a11)[iVar1] = 0;
  (&DAT_80147a10)[iVar1] = 0xff;
  local_2c._0_1_ = 1;
  *(undefined *)(iVar1 + -0x7feb85f2) = 0;
  local_res0 = param_1;
  do {
    (&DAT_80147a0f)[iVar1] = (undefined)local_2c;
    iVar4 = iVar5;
    iVar2 = iVar6;
    puVar3 = puVar7;
    while( true ) {
      do {
        puVar7 = puVar3;
        iVar6 = iVar2;
        iVar5 = iVar4;
        iVar4 = iSNDgettag(register0x00000074,&local_30,&local_2c,local_28);
        if ((iVar4 == 0) || (local_30 == 0xfe)) {
          *(int *)(iVar1 + -0x7feb860c) = iVar6;
          *(undefined *)(iVar1 + -0x7feb85ee) = param_3;
          *(undefined2 *)(iVar1 + -0x7feb85f8) = (short)param_7;
          *(undefined *)(iVar1 + -0x7feb85ed) = (char)param_6;
          *(undefined4 *)(iVar1 + -0x7feb8610) = *puVar7;
          *(undefined4 *)(&DAT_801479fc + iVar1) = 0;
          *(undefined4 *)(&DAT_80147a00 + iVar1) = 0;
          *(int *)(&DAT_80147a04 + iVar1) = iVar6 << 0xc;
          *(undefined2 *)(iVar1 + -0x7feb85f6) = (short)((uint)(iVar5 * 0x17c7) >> 0x10);
          if (1 < (byte)(&DAT_80147a0f)[iVar1]) {
            (&DAT_80147a10)[iVar1] = *(undefined *)(param_2 * 100 + _DAT_801478f4 + 4);
            (&DAT_80147a11)[(int)(char)(&DAT_80147a10)[iVar1] * 0x2c] = 1;
            *(undefined4 *)(&DAT_801479fc + (int)(char)(&DAT_80147a10)[iVar1] * 0x2c) = 0;
            *(undefined4 *)(&DAT_80147a00 + (int)(char)(&DAT_80147a10)[iVar1] * 0x2c) = 0;
            *(undefined4 *)(&DAT_80147a04 + (int)(char)(&DAT_80147a10)[iVar1] * 0x2c) =
                 *(undefined4 *)(&DAT_80147a04 + iVar1);
          }
          iSNDplatformpitch(param_2,param_4);
          (&DAT_80147a0c)[iVar1] = 1;
          return 0;
        }
        iVar4 = iVar5;
        iVar2 = iVar6;
        puVar3 = (undefined4 *)local_28[0];
      } while ((local_30 == 0x8a) ||
              (iVar4 = iVar5, iVar2 = local_2c, puVar3 = puVar7, local_30 == 0x85));
      if (local_30 == 0x82) break;
      iVar4 = local_2c;
      iVar2 = iVar6;
      puVar3 = puVar7;
      if ((local_30 != 0x84) && (iVar4 = iVar5, iVar2 = iVar6, puVar3 = puVar7, local_30 == 0x92)) {
        *(undefined *)(iVar1 + -0x7feb85f2) = (undefined)local_2c;
        iVar4 = iVar5;
        iVar2 = iVar6;
        puVar3 = puVar7;
      }
    }
  } while( true );


}

int randrange(int iParm1)
{
  uint uVar1;
  
  if (iParm1 < 0x10001) {
    if (iParm1 < 0) {
      iParm1 = 0;
    }
  }
  else {
    iParm1 = 0x10000;
  }
  uVar1 = iSNDrandom();
  return (int)(((uVar1 & 0x7fff) - 0x4000) * iParm1) >> 0xe;


}

undefined4 iSNDgettag(byte **ppbParm1,uint *puParm2,undefined4 *puParm3,byte **ppbParm4)
{
  byte bVar1;
  undefined4 uVar2;
  byte *pbVar3;
  uint uVar4;
  
  bVar1 = **ppbParm1;
  pbVar3 = *ppbParm1;
  while (bVar1 == 0xfc) {
    *ppbParm1 = pbVar3 + 1;
    bVar1 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
  }
  bVar1 = **ppbParm1;
  *puParm2 = (uint)bVar1;
  if (bVar1 == 0xff) {
    uVar2 = 0;
  }
  else {
    pbVar3 = *ppbParm1;
    *ppbParm1 = pbVar3 + 1;
    if ((*puParm2 == 0xfd) || (*puParm2 == 0xfe)) {
      uVar2 = 1;
    }
    else {
      uVar4 = (uint)pbVar3[1];
      if (pbVar3[1] == 0xff) {
        *ppbParm1 = pbVar3 + 2;
        uVar4 = iSNDgetdata(pbVar3 + 2,4);
        *ppbParm1 = *ppbParm1 + 3;
      }
      pbVar3 = *ppbParm1;
      *ppbParm1 = pbVar3 + 1;
      *ppbParm4 = pbVar3 + 1;
      if (uVar4 < 5) {
        uVar2 = iSNDgetdata(*ppbParm1,uVar4);
        *puParm3 = uVar2;
      }
      uVar2 = 1;
      *ppbParm1 = *ppbParm1 + uVar4;
    }
  }
  return uVar2;


}

int iSNDrandom(void)
{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  
  uVar1 = DAT_8013c304 + DAT_8013c300;
  iVar5 = 0;
  if ((uVar1 < DAT_8013c304) || (uVar1 < DAT_8013c300)) {
    iVar5 = 1;
  }
  uVar2 = uVar1 + DAT_8013c2fc + iVar5;
  uVar3 = uVar2 + DAT_8013c2f8 + (uint)(uVar2 < DAT_8013c2fc);
  uVar4 = uVar3 + DAT_8013c2f4 + (uint)(uVar3 < DAT_8013c2f8);
  sndseed = uVar4 + sndseed + (uint)(uVar4 < DAT_8013c2f4);
  DAT_8013c2f4 = uVar4;
  DAT_8013c2f8 = uVar3;
  DAT_8013c2fc = uVar2;
  DAT_8013c300 = uVar1;
  if ((((DAT_8013c304 + 1 == 0) &&
       (DAT_8013c300 = uVar1 + 1, DAT_8013c2f4 = uVar4, DAT_8013c2f8 = uVar3, DAT_8013c2fc = uVar2,
       DAT_8013c300 == 0)) &&
      (DAT_8013c2fc = uVar2 + 1, DAT_8013c2f4 = uVar4, DAT_8013c2f8 = uVar3, DAT_8013c2fc == 0)) &&
     ((DAT_8013c2f8 = uVar3 + 1, DAT_8013c2f4 = uVar4, DAT_8013c2f8 == 0 &&
      (DAT_8013c2f4 = uVar4 + 1, DAT_8013c2f4 == 0)))) {
    sndseed = sndseed + 1;
  }
  DAT_8013c304 = DAT_8013c304 + 1;
  return sndseed;


}

void iSNDpsxenablespuirq(void)
{
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) | 0x40;
  return;


}

void iSNDpsxdisablespuirq(void)
{
  *(ushort *)(_DAT_80147e2c + 0x1aa) = *(ushort *)(_DAT_80147e2c + 0x1aa) & 0xffbf;
  return;


}

void SysDeqIntRP(void)
{
                    
  (*(code *)&LAB_000000c0)();
  return;


}

void SysEnqIntRP(void)
{
                    
  (*(code *)&LAB_000000c0)();
  return;


}

void setRC2wait(undefined4 uParm1)
{
  __waitTime = uParm1;
  __startTime = (uint)_DAT_1f801120;
  return;


}

uint chkRC2wait(void)
{
  uint uVar1;
  
  uVar1 = (uint)_DAT_1f801120;
  if (uVar1 < __startTime) {
    if (_DAT_1f801128 == 0) {
      uVar1 = uVar1 + 0x10000;
    }
    else {
      uVar1 = uVar1 + (uint)_DAT_1f801128;
    }
  }
  if ((_DAT_1f801124 & 0x200) == 0) {
    uVar1 = uVar1 - __startTime >> 3;
  }
  else {
    uVar1 = uVar1 - __startTime;
  }
  return (uint)(uVar1 < __waitTime) ^ 1;


}

void FUN_8010c0a8(int iParm1)
{
  DAT_8013c310 = (*_padFuncSendAuto)();
  **(undefined **)(iParm1 + 0x3c) = 0;
  _padSioRW(iParm1,0xfffffffe);
  return;


}

uint FUN_8010c1c8(int iParm1)
{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  
  if (DAT_8013c310 != 0) {
    (*_padFuncSendAuto)(*(int *)(iParm1 + 0xc) + 0x1e0);
    (*_padFuncSendAuto)(*(int *)(iParm1 + 0xc) + 0x2d0);
  }
  uVar3 = 0;
  if (*(char *)(iParm1 + 0x36) == '\0') {
    uVar3 = _padModeMtap;
  }
  uVar1 = _padSioRW2(iParm1,uVar3);
  if (-1 < (int)uVar1) {
    uVar2 = uVar1 & 0xf;
    if ((uVar1 & 0xf0) == 0) {
      uVar1 = 0xfffffff7;
    }
    else {
      DAT_8013c308 = uVar2 << 1;
      uVar1 = 0;
      if (uVar2 == 0) {
        DAT_8013c308 = 0x20;
        uVar1 = 0;
      }
    }
  }
  return uVar1;


}

int FUN_8010c288(int iParm1)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  
  uVar3 = 0;
  if (**(byte **)(iParm1 + 0x3c) >> 4 == 8) {
    uVar3 = (uint)(*(char *)(iParm1 + 0x36) == '\0');
  }
  uVar3 = (*_padFuncGetTxd)(iParm1,uVar3);
  iVar1 = _padSioRW2(iParm1,uVar3 & 0xff);
  iVar2 = iVar1;
  if (((iVar1 != 0x5a) && (iVar2 = iVar1, iVar1 != 0)) && (iVar2 = -9, iVar1 < 0)) {
    iVar2 = iVar1;
  }
  return iVar2;


}

int FUN_8010c314(int iParm1)
{
  byte bVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int unaff_s3;
  uint uVar7;
  
  (*_padFuncCurrLimit)();
  uVar7 = 0;
  if ((_padModeMtap != 0) && ((int)(uint)**(byte **)(iParm1 + 0x3c) >> 4 == 8)) {
    uVar7 = (uint)(*(char *)(iParm1 + 0x36) == '\0');
  }
  if (uVar7 != 0) {
    iVar4 = -1;
    iVar6 = -0xf0;
    do {
      DAT_8013c308 = DAT_8013c308 + -1;
      if (DAT_8013c308 < 1) break;
      if (-1 < iVar4) {
        (*_padFuncCurrLimit)(*(int *)(iParm1 + 0xc) + iVar6);
      }
      uVar2 = (*_padFuncGetTxd)(iParm1,1);
      iVar3 = _padSioRW2(iParm1,uVar2 & 0xff);
      if (iVar3 < 0) {
        return iVar3;
      }
      setRC2wait(0x3c);
      iVar3 = _padClrIntSio0();
      iVar4 = iVar4 + 1;
      if (iVar3 == 0) {
        return 0xfffffffd;
      }
      iVar6 = iVar6 + 0xf0;
    } while (iVar4 < 4);
  }
  if (1 < DAT_8013c308) {
    piVar5 = (int *)(&_padFixResult + (uint)(_padSioChan == 0) * 4);
    iVar4 = (uint)(_padSioChan == 0) * 0xf0;
    do {
      iVar6 = *piVar5;
      if (iVar6 < 0) break;
      if (0 < iVar6) {
        unaff_s3 = *(int *)(iVar4 + _padInfoDir + 0xc) + iVar6 * 0xf0 + -0xf0;
        (*_padFuncRecvAuto)(unaff_s3);
      }
      iVar6 = *piVar5;
      if (iVar6 == 3) {
        (*_padFuncRecvAuto)(unaff_s3 + -0xf0);
        iVar6 = 1;
LAB_8010c548:
        *piVar5 = iVar6;
      }
      else {
        if (iVar6 < 4) {
          if ((iVar6 < 2) && (-1 < iVar6)) {
            unaff_s3 = _padInfoDir + iVar4;
            (*_padFuncRecvAuto)(unaff_s3);
            (*_padFuncClrCmdNo)(unaff_s3);
            iVar6 = -1;
            goto LAB_8010c548;
          }
        }
        else {
          if (iVar6 == 4) {
            *piVar5 = 3;
          }
        }
      }
      uVar2 = (*_padFuncGetTxd)(iParm1,uVar7);
      iVar6 = _padSioRW(iParm1,uVar2 & 0xff);
      if (iVar6 < 0) {
        return iVar6;
      }
      setRC2wait(0x3c);
      iVar6 = _padClrIntSio0();
      if (iVar6 == 0) {
        return 0xfffffffd;
      }
      DAT_8013c308 = DAT_8013c308 + -1;
    } while (1 < DAT_8013c308);
  }
  while( true ) {
    DAT_8013c308 = DAT_8013c308 + -1;
    if (DAT_8013c308 < 1) {
      _padWaitRXready();
      bVar1 = *(byte *)(iParm1 + 0x44);
      *(char *)(iParm1 + 0x44) = bVar1 + 1;
      *(undefined *)((uint)bVar1 + *(int *)(iParm1 + 0x3c)) = DAT_1f801040;
      (*_padFuncNextPort)(0);
      return 0;
    }
    uVar2 = (*_padFuncGetTxd)(iParm1,uVar7);
    iVar4 = _padSioRW(iParm1,uVar2 & 0xff);
    if (iVar4 < 0) break;
    setRC2wait(0x3c);
    iVar4 = _padClrIntSio0();
    if (iVar4 == 0) {
      return 0xfffffffd;
    }
  }
  return iVar4;


}

void SetDrawMove(int iParm1,undefined4 *puParm2,uint uParm3,int iParm4)
{
  undefined uVar1;
  undefined4 uVar2;
  
  uVar1 = 5;
  if ((*(short *)(puParm2 + 1) == 0) || (*(short *)((int)puParm2 + 6) == 0)) {
    uVar1 = 0;
  }
  *(undefined4 *)(iParm1 + 4) = 0x1000000;
  *(undefined4 *)(iParm1 + 8) = 0x80000000;
  *(undefined *)(iParm1 + 3) = uVar1;
  uVar2 = *puParm2;
  *(uint *)(iParm1 + 0x10) = iParm4 << 0x10 | uParm3 & 0xffff;
  *(undefined4 *)(iParm1 + 0xc) = uVar2;
  *(undefined4 *)(iParm1 + 0x14) = puParm2[1];
  return;


}

void DeliverEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _SN_read(void)
{
  trap(0x105);
  return;


}

void _SN_write(void)
{
  trap(0x106);
  return;


}

void iSNDpvtolrv(int iParm1,int iParm2,int *piParm3,int *piParm4)
{
  *piParm3 = iParm2;
  *piParm4 = iParm2;
  if (iParm1 != 0x40) {
    if (iParm1 < 0x40) {
      *piParm4 = iParm2 * iParm1 >> 6;
      return;
    }
    *piParm3 = iParm2 * (0x7f - iParm1) >> 6;
  }
  return;


}

void InitCARD(undefined4 uParm1)
{
  int iVar1;
  
  ChangeClearPAD(0);
  EnterCriticalSection();
  iVar1 = ReadInitPadFlag();
  if (iVar1 == 0) {
    uParm1 = 0;
  }
  InitCARD2(uParm1);
  _copy_memcard_patch();
  _patch_card();
  _patch_card2();
  ExitCriticalSection();
  return;


}

void StartCARD(void)
{
  EnterCriticalSection();
  StartCARD2();
  ChangeClearPAD(0);
  ExitCriticalSection();
  return;


}

void StopCARD(void)
{
  StopCARD2();
  _ExitCard();
  return;


}

void _bu_init(void)
{
                    
  (*(code *)&LAB_000000a0)();
  return;


}

void CloseEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void TestEvent(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void firstfile2(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void iSNDlibatodlrv(int iParm1,int iParm2,uint *puParm3,uint *puParm4)
{
  int iVar1;
  uint uVar2;
  
  iVar1 = iSNDsin(iParm1 >> 6);
  uVar2 = (uint)(iParm2 * (0x10000 - iVar1)) >> 0x10;
  *puParm3 = uVar2;
  if (0x7f < uVar2) {
    *puParm3 = 0x7f;
  }
  uVar2 = (uint)(iParm2 * (iVar1 + 0x10000)) >> 0x10;
  *puParm4 = uVar2;
  if (0x7f < uVar2) {
    *puParm4 = 0x7f;
  }
  return;


}

int iSNDgetdata(byte *pbParm1,int iParm2)
{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar2 = iParm2 + -1;
  if (iParm2 != 0) {
    do {
      bVar1 = *pbParm1;
      pbParm1 = pbParm1 + 1;
      iVar2 = iVar2 + -1;
      iVar3 = iVar3 * 0x100 + (uint)bVar1;
    } while (iVar2 != -1);
  }
  if ((iParm2 == 1) && (0x7f < iVar3)) {
    iVar3 = iVar3 + -0x100;
  }
  else {
    if (((iParm2 == 2) && (iVar2 = -0x10000, 0x7fff < iVar3)) ||
       ((iParm2 == 3 && (iVar2 = -0x1000000, 0x7fffff < iVar3)))) {
      iVar3 = iVar3 + iVar2;
    }
  }
  return iVar3;


}

undefined4 ReadInitPadFlag(void)
{
  return 0;


}

void InitCARD2(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _patch_card(void)
{
  int iVar1;
  undefined4 *puVar2;
  undefined4 unaff_retaddr;
  
  _DAT_80148ac4 = unaff_retaddr;
  EnterCriticalSection();
  iVar1 = (*(code *)&SUB_000000b0)();
  _DAT_0000dffc =
       (undefined4 *)
       (*(int *)(*(int *)(iVar1 + 0x18) + 0x70) * 0x10000 +
        (*(uint *)(*(int *)(iVar1 + 0x18) + 0x74) & 0xffff) + 0x28);
  puVar2 = &DAT_8010ca40;
  do {
    *_DAT_0000dffc = *puVar2;
    puVar2 = puVar2 + 1;
    _DAT_0000dffc = _DAT_0000dffc + 1;
  } while (puVar2 != &DAT_8010ca54);
  FlushCache();
  return;


}

void _patch_card2(void)
{
  int iVar1;
  undefined4 *puVar2;
  undefined4 unaff_retaddr;
  
  _DAT_80148ac4 = unaff_retaddr;
  EnterCriticalSection();
  iVar1 = (*(code *)&SUB_000000b0)();
  iVar1 = *(int *)(iVar1 + 0x16c);
  puVar2 = &DAT_8010ca54;
  do {
    *(undefined4 *)(iVar1 + 0x9c8) = *puVar2;
    puVar2 = puVar2 + 1;
    iVar1 = iVar1 + 4;
  } while (puVar2 != (undefined4 *)_patch_card);
  FlushCache();
  return;


}

void _copy_memcard_patch(void)
{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  puVar1 = (undefined4 *)&DAT_0000df80;
  puVar2 = &DAT_8010c9d0;
  do {
    *puVar1 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar1 = puVar1 + 1;
  } while (puVar2 != &DAT_8010ca40);
  return;


}

void StartCARD2(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void StopCARD2(void)
{
                    
  (*(code *)&SUB_000000b0)();
  return;


}

void _ExitCard(void)
{
  int iVar1;
  undefined4 *puVar2;
  undefined4 unaff_retaddr;
  
  _DAT_80148ad4 = unaff_retaddr;
  EnterCriticalSection();
  iVar1 = (*(code *)&SUB_000000b0)();
  iVar1 = *(int *)(iVar1 + 0x18);
  puVar2 = &DAT_8010cc30;
  do {
    *(undefined4 *)(iVar1 + 0x70) = *puVar2;
    puVar2 = puVar2 + 1;
    iVar1 = iVar1 + 4;
  } while (puVar2 != (undefined4 *)&UNK_8010cc3c);
  FlushCache();
  ExitCriticalSection();
  return;


}

uint iSNDsin(uint uParm1)
{
  uint uVar1;
  
  uVar1 = (int)uParm1 >> 8 & 3;
  uParm1 = uParm1 & 0xff;
  if (uVar1 != 0) {
    if (uVar1 != 1) {
      if (uVar1 == 2) {
        return -(uint)*(ushort *)(&sndsintbl + uParm1 * 2);
      }
      return -(uint)*(ushort *)(&sndsintbl + (0x100 - uParm1) * 2);
    }
    uParm1 = 0x100 - uParm1;
  }
  return (uint)*(ushort *)(&sndsintbl + uParm1 * 2);


}


